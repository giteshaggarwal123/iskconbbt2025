var qR=Object.defineProperty;var h_=e=>{throw TypeError(e)};var YR=(e,t,r)=>t in e?qR(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r;var tg=(e,t,r)=>YR(e,typeof t!="symbol"?t+"":t,r),rg=(e,t,r)=>t.has(e)||h_("Cannot "+r);var be=(e,t,r)=>(rg(e,t,"read from private field"),r?r.call(e):t.get(e)),yt=(e,t,r)=>t.has(e)?h_("Cannot add the same private member more than once"):t instanceof WeakSet?t.add(e):t.set(e,r),rt=(e,t,r,n)=>(rg(e,t,"write to private field"),n?n.call(e,r):t.set(e,r),r),xr=(e,t,r)=>(rg(e,t,"access private method"),r);var eh=(e,t,r,n)=>({set _(s){rt(e,t,s,r)},get _(){return be(e,t,n)}});function KR(e,t){for(var r=0;r<t.length;r++){const n=t[r];if(typeof n!="string"&&!Array.isArray(n)){for(const s in n)if(s!=="default"&&!(s in e)){const a=Object.getOwnPropertyDescriptor(n,s);a&&Object.defineProperty(e,s,a.get?a:{enumerable:!0,get:()=>n[s]})}}}return Object.freeze(Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}))}(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))n(s);new MutationObserver(s=>{for(const a of s)if(a.type==="childList")for(const o of a.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&n(o)}).observe(document,{childList:!0,subtree:!0});function r(s){const a={};return s.integrity&&(a.integrity=s.integrity),s.referrerPolicy&&(a.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?a.credentials="include":s.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function n(s){if(s.ep)return;s.ep=!0;const a=r(s);fetch(s.href,a)}})();var pn=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function fy(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}function XR(e){if(e.__esModule)return e;var t=e.default;if(typeof t=="function"){var r=function n(){return this instanceof n?Reflect.construct(t,arguments,this.constructor):t.apply(this,arguments)};r.prototype=t.prototype}else r={};return Object.defineProperty(r,"__esModule",{value:!0}),Object.keys(e).forEach(function(n){var s=Object.getOwnPropertyDescriptor(e,n);Object.defineProperty(r,n,s.get?s:{enumerable:!0,get:function(){return e[n]}})}),r}var yN={exports:{}},C0={},wN={exports:{}},_t={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var ff=Symbol.for("react.element"),QR=Symbol.for("react.portal"),JR=Symbol.for("react.fragment"),ZR=Symbol.for("react.strict_mode"),eM=Symbol.for("react.profiler"),tM=Symbol.for("react.provider"),rM=Symbol.for("react.context"),nM=Symbol.for("react.forward_ref"),sM=Symbol.for("react.suspense"),aM=Symbol.for("react.memo"),iM=Symbol.for("react.lazy"),m_=Symbol.iterator;function oM(e){return e===null||typeof e!="object"?null:(e=m_&&e[m_]||e["@@iterator"],typeof e=="function"?e:null)}var _N={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},bN=Object.assign,SN={};function Kc(e,t,r){this.props=e,this.context=t,this.refs=SN,this.updater=r||_N}Kc.prototype.isReactComponent={};Kc.prototype.setState=function(e,t){if(typeof e!="object"&&typeof e!="function"&&e!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,t,"setState")};Kc.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")};function NN(){}NN.prototype=Kc.prototype;function hy(e,t,r){this.props=e,this.context=t,this.refs=SN,this.updater=r||_N}var my=hy.prototype=new NN;my.constructor=hy;bN(my,Kc.prototype);my.isPureReactComponent=!0;var p_=Array.isArray,jN=Object.prototype.hasOwnProperty,py={current:null},EN={key:!0,ref:!0,__self:!0,__source:!0};function kN(e,t,r){var n,s={},a=null,o=null;if(t!=null)for(n in t.ref!==void 0&&(o=t.ref),t.key!==void 0&&(a=""+t.key),t)jN.call(t,n)&&!EN.hasOwnProperty(n)&&(s[n]=t[n]);var l=arguments.length-2;if(l===1)s.children=r;else if(1<l){for(var c=Array(l),u=0;u<l;u++)c[u]=arguments[u+2];s.children=c}if(e&&e.defaultProps)for(n in l=e.defaultProps,l)s[n]===void 0&&(s[n]=l[n]);return{$$typeof:ff,type:e,key:a,ref:o,props:s,_owner:py.current}}function lM(e,t){return{$$typeof:ff,type:e.type,key:t,ref:e.ref,props:e.props,_owner:e._owner}}function gy(e){return typeof e=="object"&&e!==null&&e.$$typeof===ff}function cM(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,function(r){return t[r]})}var g_=/\/+/g;function ng(e,t){return typeof e=="object"&&e!==null&&e.key!=null?cM(""+e.key):t.toString(36)}function Vh(e,t,r,n,s){var a=typeof e;(a==="undefined"||a==="boolean")&&(e=null);var o=!1;if(e===null)o=!0;else switch(a){case"string":case"number":o=!0;break;case"object":switch(e.$$typeof){case ff:case QR:o=!0}}if(o)return o=e,s=s(o),e=n===""?"."+ng(o,0):n,p_(s)?(r="",e!=null&&(r=e.replace(g_,"$&/")+"/"),Vh(s,t,r,"",function(u){return u})):s!=null&&(gy(s)&&(s=lM(s,r+(!s.key||o&&o.key===s.key?"":(""+s.key).replace(g_,"$&/")+"/")+e)),t.push(s)),1;if(o=0,n=n===""?".":n+":",p_(e))for(var l=0;l<e.length;l++){a=e[l];var c=n+ng(a,l);o+=Vh(a,t,r,c,s)}else if(c=oM(e),typeof c=="function")for(e=c.call(e),l=0;!(a=e.next()).done;)a=a.value,c=n+ng(a,l++),o+=Vh(a,t,r,c,s);else if(a==="object")throw t=String(e),Error("Objects are not valid as a React child (found: "+(t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t)+"). If you meant to render a collection of children, use an array instead.");return o}function th(e,t,r){if(e==null)return e;var n=[],s=0;return Vh(e,n,"","",function(a){return t.call(r,a,s++)}),n}function uM(e){if(e._status===-1){var t=e._result;t=t(),t.then(function(r){(e._status===0||e._status===-1)&&(e._status=1,e._result=r)},function(r){(e._status===0||e._status===-1)&&(e._status=2,e._result=r)}),e._status===-1&&(e._status=0,e._result=t)}if(e._status===1)return e._result.default;throw e._result}var Tn={current:null},Wh={transition:null},dM={ReactCurrentDispatcher:Tn,ReactCurrentBatchConfig:Wh,ReactCurrentOwner:py};function CN(){throw Error("act(...) is not supported in production builds of React.")}_t.Children={map:th,forEach:function(e,t,r){th(e,function(){t.apply(this,arguments)},r)},count:function(e){var t=0;return th(e,function(){t++}),t},toArray:function(e){return th(e,function(t){return t})||[]},only:function(e){if(!gy(e))throw Error("React.Children.only expected to receive a single React element child.");return e}};_t.Component=Kc;_t.Fragment=JR;_t.Profiler=eM;_t.PureComponent=hy;_t.StrictMode=ZR;_t.Suspense=sM;_t.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=dM;_t.act=CN;_t.cloneElement=function(e,t,r){if(e==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+e+".");var n=bN({},e.props),s=e.key,a=e.ref,o=e._owner;if(t!=null){if(t.ref!==void 0&&(a=t.ref,o=py.current),t.key!==void 0&&(s=""+t.key),e.type&&e.type.defaultProps)var l=e.type.defaultProps;for(c in t)jN.call(t,c)&&!EN.hasOwnProperty(c)&&(n[c]=t[c]===void 0&&l!==void 0?l[c]:t[c])}var c=arguments.length-2;if(c===1)n.children=r;else if(1<c){l=Array(c);for(var u=0;u<c;u++)l[u]=arguments[u+2];n.children=l}return{$$typeof:ff,type:e.type,key:s,ref:a,props:n,_owner:o}};_t.createContext=function(e){return e={$$typeof:rM,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},e.Provider={$$typeof:tM,_context:e},e.Consumer=e};_t.createElement=kN;_t.createFactory=function(e){var t=kN.bind(null,e);return t.type=e,t};_t.createRef=function(){return{current:null}};_t.forwardRef=function(e){return{$$typeof:nM,render:e}};_t.isValidElement=gy;_t.lazy=function(e){return{$$typeof:iM,_payload:{_status:-1,_result:e},_init:uM}};_t.memo=function(e,t){return{$$typeof:aM,type:e,compare:t===void 0?null:t}};_t.startTransition=function(e){var t=Wh.transition;Wh.transition={};try{e()}finally{Wh.transition=t}};_t.unstable_act=CN;_t.useCallback=function(e,t){return Tn.current.useCallback(e,t)};_t.useContext=function(e){return Tn.current.useContext(e)};_t.useDebugValue=function(){};_t.useDeferredValue=function(e){return Tn.current.useDeferredValue(e)};_t.useEffect=function(e,t){return Tn.current.useEffect(e,t)};_t.useId=function(){return Tn.current.useId()};_t.useImperativeHandle=function(e,t,r){return Tn.current.useImperativeHandle(e,t,r)};_t.useInsertionEffect=function(e,t){return Tn.current.useInsertionEffect(e,t)};_t.useLayoutEffect=function(e,t){return Tn.current.useLayoutEffect(e,t)};_t.useMemo=function(e,t){return Tn.current.useMemo(e,t)};_t.useReducer=function(e,t,r){return Tn.current.useReducer(e,t,r)};_t.useRef=function(e){return Tn.current.useRef(e)};_t.useState=function(e){return Tn.current.useState(e)};_t.useSyncExternalStore=function(e,t,r){return Tn.current.useSyncExternalStore(e,t,r)};_t.useTransition=function(){return Tn.current.useTransition()};_t.version="18.3.1";wN.exports=_t;var y=wN.exports;const ke=fy(y),xy=KR({__proto__:null,default:ke},[y]);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var fM=y,hM=Symbol.for("react.element"),mM=Symbol.for("react.fragment"),pM=Object.prototype.hasOwnProperty,gM=fM.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,xM={key:!0,ref:!0,__self:!0,__source:!0};function TN(e,t,r){var n,s={},a=null,o=null;r!==void 0&&(a=""+r),t.key!==void 0&&(a=""+t.key),t.ref!==void 0&&(o=t.ref);for(n in t)pM.call(t,n)&&!xM.hasOwnProperty(n)&&(s[n]=t[n]);if(e&&e.defaultProps)for(n in t=e.defaultProps,t)s[n]===void 0&&(s[n]=t[n]);return{$$typeof:hM,type:e,key:a,ref:o,props:s,_owner:gM.current}}C0.Fragment=mM;C0.jsx=TN;C0.jsxs=TN;yN.exports=C0;var i=yN.exports,AN={exports:{}},fs={},PN={exports:{}},DN={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(e){function t(z,U){var V=z.length;z.push(U);e:for(;0<V;){var F=V-1>>>1,D=z[F];if(0<s(D,U))z[F]=U,z[V]=D,V=F;else break e}}function r(z){return z.length===0?null:z[0]}function n(z){if(z.length===0)return null;var U=z[0],V=z.pop();if(V!==U){z[0]=V;e:for(var F=0,D=z.length,G=D>>>1;F<G;){var O=2*(F+1)-1,L=z[O],ie=O+1,ne=z[ie];if(0>s(L,V))ie<D&&0>s(ne,L)?(z[F]=ne,z[ie]=V,F=ie):(z[F]=L,z[O]=V,F=O);else if(ie<D&&0>s(ne,V))z[F]=ne,z[ie]=V,F=ie;else break e}}return U}function s(z,U){var V=z.sortIndex-U.sortIndex;return V!==0?V:z.id-U.id}if(typeof performance=="object"&&typeof performance.now=="function"){var a=performance;e.unstable_now=function(){return a.now()}}else{var o=Date,l=o.now();e.unstable_now=function(){return o.now()-l}}var c=[],u=[],d=1,f=null,p=3,h=!1,g=!1,m=!1,x=typeof setTimeout=="function"?setTimeout:null,w=typeof clearTimeout=="function"?clearTimeout:null,v=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function _(z){for(var U=r(u);U!==null;){if(U.callback===null)n(u);else if(U.startTime<=z)n(u),U.sortIndex=U.expirationTime,t(c,U);else break;U=r(u)}}function b(z){if(m=!1,_(z),!g)if(r(c)!==null)g=!0,X(S);else{var U=r(u);U!==null&&Y(b,U.startTime-z)}}function S(z,U){g=!1,m&&(m=!1,w(C),C=-1),h=!0;var V=p;try{for(_(U),f=r(c);f!==null&&(!(f.expirationTime>U)||z&&!R());){var F=f.callback;if(typeof F=="function"){f.callback=null,p=f.priorityLevel;var D=F(f.expirationTime<=U);U=e.unstable_now(),typeof D=="function"?f.callback=D:f===r(c)&&n(c),_(U)}else n(c);f=r(c)}if(f!==null)var G=!0;else{var O=r(u);O!==null&&Y(b,O.startTime-U),G=!1}return G}finally{f=null,p=V,h=!1}}var T=!1,N=null,C=-1,E=5,P=-1;function R(){return!(e.unstable_now()-P<E)}function j(){if(N!==null){var z=e.unstable_now();P=z;var U=!0;try{U=N(!0,z)}finally{U?M():(T=!1,N=null)}}else T=!1}var M;if(typeof v=="function")M=function(){v(j)};else if(typeof MessageChannel<"u"){var A=new MessageChannel,I=A.port2;A.port1.onmessage=j,M=function(){I.postMessage(null)}}else M=function(){x(j,0)};function X(z){N=z,T||(T=!0,M())}function Y(z,U){C=x(function(){z(e.unstable_now())},U)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(z){z.callback=null},e.unstable_continueExecution=function(){g||h||(g=!0,X(S))},e.unstable_forceFrameRate=function(z){0>z||125<z?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):E=0<z?Math.floor(1e3/z):5},e.unstable_getCurrentPriorityLevel=function(){return p},e.unstable_getFirstCallbackNode=function(){return r(c)},e.unstable_next=function(z){switch(p){case 1:case 2:case 3:var U=3;break;default:U=p}var V=p;p=U;try{return z()}finally{p=V}},e.unstable_pauseExecution=function(){},e.unstable_requestPaint=function(){},e.unstable_runWithPriority=function(z,U){switch(z){case 1:case 2:case 3:case 4:case 5:break;default:z=3}var V=p;p=z;try{return U()}finally{p=V}},e.unstable_scheduleCallback=function(z,U,V){var F=e.unstable_now();switch(typeof V=="object"&&V!==null?(V=V.delay,V=typeof V=="number"&&0<V?F+V:F):V=F,z){case 1:var D=-1;break;case 2:D=250;break;case 5:D=1073741823;break;case 4:D=1e4;break;default:D=5e3}return D=V+D,z={id:d++,callback:U,priorityLevel:z,startTime:V,expirationTime:D,sortIndex:-1},V>F?(z.sortIndex=V,t(u,z),r(c)===null&&z===r(u)&&(m?(w(C),C=-1):m=!0,Y(b,V-F))):(z.sortIndex=D,t(c,z),g||h||(g=!0,X(S))),z},e.unstable_shouldYield=R,e.unstable_wrapCallback=function(z){var U=p;return function(){var V=p;p=U;try{return z.apply(this,arguments)}finally{p=V}}}})(DN);PN.exports=DN;var vM=PN.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var yM=y,cs=vM;function Fe(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,r=1;r<arguments.length;r++)t+="&args[]="+encodeURIComponent(arguments[r]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var RN=new Set,wd={};function pl(e,t){Ac(e,t),Ac(e+"Capture",t)}function Ac(e,t){for(wd[e]=t,e=0;e<t.length;e++)RN.add(t[e])}var oi=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Sx=Object.prototype.hasOwnProperty,wM=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,x_={},v_={};function _M(e){return Sx.call(v_,e)?!0:Sx.call(x_,e)?!1:wM.test(e)?v_[e]=!0:(x_[e]=!0,!1)}function bM(e,t,r,n){if(r!==null&&r.type===0)return!1;switch(typeof t){case"function":case"symbol":return!0;case"boolean":return n?!1:r!==null?!r.acceptsBooleans:(e=e.toLowerCase().slice(0,5),e!=="data-"&&e!=="aria-");default:return!1}}function SM(e,t,r,n){if(t===null||typeof t>"u"||bM(e,t,r,n))return!0;if(n)return!1;if(r!==null)switch(r.type){case 3:return!t;case 4:return t===!1;case 5:return isNaN(t);case 6:return isNaN(t)||1>t}return!1}function An(e,t,r,n,s,a,o){this.acceptsBooleans=t===2||t===3||t===4,this.attributeName=n,this.attributeNamespace=s,this.mustUseProperty=r,this.propertyName=e,this.type=t,this.sanitizeURL=a,this.removeEmptyString=o}var sn={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(e){sn[e]=new An(e,0,!1,e,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(e){var t=e[0];sn[t]=new An(t,1,!1,e[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(e){sn[e]=new An(e,2,!1,e.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(e){sn[e]=new An(e,2,!1,e,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(e){sn[e]=new An(e,3,!1,e.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(e){sn[e]=new An(e,3,!0,e,null,!1,!1)});["capture","download"].forEach(function(e){sn[e]=new An(e,4,!1,e,null,!1,!1)});["cols","rows","size","span"].forEach(function(e){sn[e]=new An(e,6,!1,e,null,!1,!1)});["rowSpan","start"].forEach(function(e){sn[e]=new An(e,5,!1,e.toLowerCase(),null,!1,!1)});var vy=/[\-:]([a-z])/g;function yy(e){return e[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(e){var t=e.replace(vy,yy);sn[t]=new An(t,1,!1,e,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(e){var t=e.replace(vy,yy);sn[t]=new An(t,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(e){var t=e.replace(vy,yy);sn[t]=new An(t,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(e){sn[e]=new An(e,1,!1,e.toLowerCase(),null,!1,!1)});sn.xlinkHref=new An("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(e){sn[e]=new An(e,1,!1,e.toLowerCase(),null,!0,!0)});function wy(e,t,r,n){var s=sn.hasOwnProperty(t)?sn[t]:null;(s!==null?s.type!==0:n||!(2<t.length)||t[0]!=="o"&&t[0]!=="O"||t[1]!=="n"&&t[1]!=="N")&&(SM(t,r,s,n)&&(r=null),n||s===null?_M(t)&&(r===null?e.removeAttribute(t):e.setAttribute(t,""+r)):s.mustUseProperty?e[s.propertyName]=r===null?s.type===3?!1:"":r:(t=s.attributeName,n=s.attributeNamespace,r===null?e.removeAttribute(t):(s=s.type,r=s===3||s===4&&r===!0?"":""+r,n?e.setAttributeNS(n,t,r):e.setAttribute(t,r))))}var xi=yM.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,rh=Symbol.for("react.element"),ql=Symbol.for("react.portal"),Yl=Symbol.for("react.fragment"),_y=Symbol.for("react.strict_mode"),Nx=Symbol.for("react.profiler"),MN=Symbol.for("react.provider"),ON=Symbol.for("react.context"),by=Symbol.for("react.forward_ref"),jx=Symbol.for("react.suspense"),Ex=Symbol.for("react.suspense_list"),Sy=Symbol.for("react.memo"),Ci=Symbol.for("react.lazy"),FN=Symbol.for("react.offscreen"),y_=Symbol.iterator;function _u(e){return e===null||typeof e!="object"?null:(e=y_&&e[y_]||e["@@iterator"],typeof e=="function"?e:null)}var ir=Object.assign,sg;function Uu(e){if(sg===void 0)try{throw Error()}catch(r){var t=r.stack.trim().match(/\n( *(at )?)/);sg=t&&t[1]||""}return`
`+sg+e}var ag=!1;function ig(e,t){if(!e||ag)return"";ag=!0;var r=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(t)if(t=function(){throw Error()},Object.defineProperty(t.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(t,[])}catch(u){var n=u}Reflect.construct(e,[],t)}else{try{t.call()}catch(u){n=u}e.call(t.prototype)}else{try{throw Error()}catch(u){n=u}e()}}catch(u){if(u&&n&&typeof u.stack=="string"){for(var s=u.stack.split(`
`),a=n.stack.split(`
`),o=s.length-1,l=a.length-1;1<=o&&0<=l&&s[o]!==a[l];)l--;for(;1<=o&&0<=l;o--,l--)if(s[o]!==a[l]){if(o!==1||l!==1)do if(o--,l--,0>l||s[o]!==a[l]){var c=`
`+s[o].replace(" at new "," at ");return e.displayName&&c.includes("<anonymous>")&&(c=c.replace("<anonymous>",e.displayName)),c}while(1<=o&&0<=l);break}}}finally{ag=!1,Error.prepareStackTrace=r}return(e=e?e.displayName||e.name:"")?Uu(e):""}function NM(e){switch(e.tag){case 5:return Uu(e.type);case 16:return Uu("Lazy");case 13:return Uu("Suspense");case 19:return Uu("SuspenseList");case 0:case 2:case 15:return e=ig(e.type,!1),e;case 11:return e=ig(e.type.render,!1),e;case 1:return e=ig(e.type,!0),e;default:return""}}function kx(e){if(e==null)return null;if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e;switch(e){case Yl:return"Fragment";case ql:return"Portal";case Nx:return"Profiler";case _y:return"StrictMode";case jx:return"Suspense";case Ex:return"SuspenseList"}if(typeof e=="object")switch(e.$$typeof){case ON:return(e.displayName||"Context")+".Consumer";case MN:return(e._context.displayName||"Context")+".Provider";case by:var t=e.render;return e=e.displayName,e||(e=t.displayName||t.name||"",e=e!==""?"ForwardRef("+e+")":"ForwardRef"),e;case Sy:return t=e.displayName||null,t!==null?t:kx(e.type)||"Memo";case Ci:t=e._payload,e=e._init;try{return kx(e(t))}catch{}}return null}function jM(e){var t=e.type;switch(e.tag){case 24:return"Cache";case 9:return(t.displayName||"Context")+".Consumer";case 10:return(t._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=t.render,e=e.displayName||e.name||"",t.displayName||(e!==""?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return t;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return kx(t);case 8:return t===_y?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t}return null}function ao(e){switch(typeof e){case"boolean":case"number":case"string":case"undefined":return e;case"object":return e;default:return""}}function IN(e){var t=e.type;return(e=e.nodeName)&&e.toLowerCase()==="input"&&(t==="checkbox"||t==="radio")}function EM(e){var t=IN(e)?"checked":"value",r=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),n=""+e[t];if(!e.hasOwnProperty(t)&&typeof r<"u"&&typeof r.get=="function"&&typeof r.set=="function"){var s=r.get,a=r.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return s.call(this)},set:function(o){n=""+o,a.call(this,o)}}),Object.defineProperty(e,t,{enumerable:r.enumerable}),{getValue:function(){return n},setValue:function(o){n=""+o},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}function nh(e){e._valueTracker||(e._valueTracker=EM(e))}function LN(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var r=t.getValue(),n="";return e&&(n=IN(e)?e.checked?"true":"false":e.value),e=n,e!==r?(t.setValue(e),!0):!1}function gm(e){if(e=e||(typeof document<"u"?document:void 0),typeof e>"u")return null;try{return e.activeElement||e.body}catch{return e.body}}function Cx(e,t){var r=t.checked;return ir({},t,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:r??e._wrapperState.initialChecked})}function w_(e,t){var r=t.defaultValue==null?"":t.defaultValue,n=t.checked!=null?t.checked:t.defaultChecked;r=ao(t.value!=null?t.value:r),e._wrapperState={initialChecked:n,initialValue:r,controlled:t.type==="checkbox"||t.type==="radio"?t.checked!=null:t.value!=null}}function $N(e,t){t=t.checked,t!=null&&wy(e,"checked",t,!1)}function Tx(e,t){$N(e,t);var r=ao(t.value),n=t.type;if(r!=null)n==="number"?(r===0&&e.value===""||e.value!=r)&&(e.value=""+r):e.value!==""+r&&(e.value=""+r);else if(n==="submit"||n==="reset"){e.removeAttribute("value");return}t.hasOwnProperty("value")?Ax(e,t.type,r):t.hasOwnProperty("defaultValue")&&Ax(e,t.type,ao(t.defaultValue)),t.checked==null&&t.defaultChecked!=null&&(e.defaultChecked=!!t.defaultChecked)}function __(e,t,r){if(t.hasOwnProperty("value")||t.hasOwnProperty("defaultValue")){var n=t.type;if(!(n!=="submit"&&n!=="reset"||t.value!==void 0&&t.value!==null))return;t=""+e._wrapperState.initialValue,r||t===e.value||(e.value=t),e.defaultValue=t}r=e.name,r!==""&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,r!==""&&(e.name=r)}function Ax(e,t,r){(t!=="number"||gm(e.ownerDocument)!==e)&&(r==null?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+r&&(e.defaultValue=""+r))}var zu=Array.isArray;function oc(e,t,r,n){if(e=e.options,t){t={};for(var s=0;s<r.length;s++)t["$"+r[s]]=!0;for(r=0;r<e.length;r++)s=t.hasOwnProperty("$"+e[r].value),e[r].selected!==s&&(e[r].selected=s),s&&n&&(e[r].defaultSelected=!0)}else{for(r=""+ao(r),t=null,s=0;s<e.length;s++){if(e[s].value===r){e[s].selected=!0,n&&(e[s].defaultSelected=!0);return}t!==null||e[s].disabled||(t=e[s])}t!==null&&(t.selected=!0)}}function Px(e,t){if(t.dangerouslySetInnerHTML!=null)throw Error(Fe(91));return ir({},t,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function b_(e,t){var r=t.value;if(r==null){if(r=t.children,t=t.defaultValue,r!=null){if(t!=null)throw Error(Fe(92));if(zu(r)){if(1<r.length)throw Error(Fe(93));r=r[0]}t=r}t==null&&(t=""),r=t}e._wrapperState={initialValue:ao(r)}}function BN(e,t){var r=ao(t.value),n=ao(t.defaultValue);r!=null&&(r=""+r,r!==e.value&&(e.value=r),t.defaultValue==null&&e.defaultValue!==r&&(e.defaultValue=r)),n!=null&&(e.defaultValue=""+n)}function S_(e){var t=e.textContent;t===e._wrapperState.initialValue&&t!==""&&t!==null&&(e.value=t)}function UN(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function Dx(e,t){return e==null||e==="http://www.w3.org/1999/xhtml"?UN(t):e==="http://www.w3.org/2000/svg"&&t==="foreignObject"?"http://www.w3.org/1999/xhtml":e}var sh,zN=function(e){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(t,r,n,s){MSApp.execUnsafeLocalFunction(function(){return e(t,r,n,s)})}:e}(function(e,t){if(e.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in e)e.innerHTML=t;else{for(sh=sh||document.createElement("div"),sh.innerHTML="<svg>"+t.valueOf().toString()+"</svg>",t=sh.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;t.firstChild;)e.appendChild(t.firstChild)}});function _d(e,t){if(t){var r=e.firstChild;if(r&&r===e.lastChild&&r.nodeType===3){r.nodeValue=t;return}}e.textContent=t}var Qu={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},kM=["Webkit","ms","Moz","O"];Object.keys(Qu).forEach(function(e){kM.forEach(function(t){t=t+e.charAt(0).toUpperCase()+e.substring(1),Qu[t]=Qu[e]})});function VN(e,t,r){return t==null||typeof t=="boolean"||t===""?"":r||typeof t!="number"||t===0||Qu.hasOwnProperty(e)&&Qu[e]?(""+t).trim():t+"px"}function WN(e,t){e=e.style;for(var r in t)if(t.hasOwnProperty(r)){var n=r.indexOf("--")===0,s=VN(r,t[r],n);r==="float"&&(r="cssFloat"),n?e.setProperty(r,s):e[r]=s}}var CM=ir({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function Rx(e,t){if(t){if(CM[e]&&(t.children!=null||t.dangerouslySetInnerHTML!=null))throw Error(Fe(137,e));if(t.dangerouslySetInnerHTML!=null){if(t.children!=null)throw Error(Fe(60));if(typeof t.dangerouslySetInnerHTML!="object"||!("__html"in t.dangerouslySetInnerHTML))throw Error(Fe(61))}if(t.style!=null&&typeof t.style!="object")throw Error(Fe(62))}}function Mx(e,t){if(e.indexOf("-")===-1)return typeof t.is=="string";switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Ox=null;function Ny(e){return e=e.target||e.srcElement||window,e.correspondingUseElement&&(e=e.correspondingUseElement),e.nodeType===3?e.parentNode:e}var Fx=null,lc=null,cc=null;function N_(e){if(e=pf(e)){if(typeof Fx!="function")throw Error(Fe(280));var t=e.stateNode;t&&(t=R0(t),Fx(e.stateNode,e.type,t))}}function HN(e){lc?cc?cc.push(e):cc=[e]:lc=e}function GN(){if(lc){var e=lc,t=cc;if(cc=lc=null,N_(e),t)for(e=0;e<t.length;e++)N_(t[e])}}function qN(e,t){return e(t)}function YN(){}var og=!1;function KN(e,t,r){if(og)return e(t,r);og=!0;try{return qN(e,t,r)}finally{og=!1,(lc!==null||cc!==null)&&(YN(),GN())}}function bd(e,t){var r=e.stateNode;if(r===null)return null;var n=R0(r);if(n===null)return null;r=n[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(n=!n.disabled)||(e=e.type,n=!(e==="button"||e==="input"||e==="select"||e==="textarea")),e=!n;break e;default:e=!1}if(e)return null;if(r&&typeof r!="function")throw Error(Fe(231,t,typeof r));return r}var Ix=!1;if(oi)try{var bu={};Object.defineProperty(bu,"passive",{get:function(){Ix=!0}}),window.addEventListener("test",bu,bu),window.removeEventListener("test",bu,bu)}catch{Ix=!1}function TM(e,t,r,n,s,a,o,l,c){var u=Array.prototype.slice.call(arguments,3);try{t.apply(r,u)}catch(d){this.onError(d)}}var Ju=!1,xm=null,vm=!1,Lx=null,AM={onError:function(e){Ju=!0,xm=e}};function PM(e,t,r,n,s,a,o,l,c){Ju=!1,xm=null,TM.apply(AM,arguments)}function DM(e,t,r,n,s,a,o,l,c){if(PM.apply(this,arguments),Ju){if(Ju){var u=xm;Ju=!1,xm=null}else throw Error(Fe(198));vm||(vm=!0,Lx=u)}}function gl(e){var t=e,r=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do t=e,t.flags&4098&&(r=t.return),e=t.return;while(e)}return t.tag===3?r:null}function XN(e){if(e.tag===13){var t=e.memoizedState;if(t===null&&(e=e.alternate,e!==null&&(t=e.memoizedState)),t!==null)return t.dehydrated}return null}function j_(e){if(gl(e)!==e)throw Error(Fe(188))}function RM(e){var t=e.alternate;if(!t){if(t=gl(e),t===null)throw Error(Fe(188));return t!==e?null:e}for(var r=e,n=t;;){var s=r.return;if(s===null)break;var a=s.alternate;if(a===null){if(n=s.return,n!==null){r=n;continue}break}if(s.child===a.child){for(a=s.child;a;){if(a===r)return j_(s),e;if(a===n)return j_(s),t;a=a.sibling}throw Error(Fe(188))}if(r.return!==n.return)r=s,n=a;else{for(var o=!1,l=s.child;l;){if(l===r){o=!0,r=s,n=a;break}if(l===n){o=!0,n=s,r=a;break}l=l.sibling}if(!o){for(l=a.child;l;){if(l===r){o=!0,r=a,n=s;break}if(l===n){o=!0,n=a,r=s;break}l=l.sibling}if(!o)throw Error(Fe(189))}}if(r.alternate!==n)throw Error(Fe(190))}if(r.tag!==3)throw Error(Fe(188));return r.stateNode.current===r?e:t}function QN(e){return e=RM(e),e!==null?JN(e):null}function JN(e){if(e.tag===5||e.tag===6)return e;for(e=e.child;e!==null;){var t=JN(e);if(t!==null)return t;e=e.sibling}return null}var ZN=cs.unstable_scheduleCallback,E_=cs.unstable_cancelCallback,MM=cs.unstable_shouldYield,OM=cs.unstable_requestPaint,vr=cs.unstable_now,FM=cs.unstable_getCurrentPriorityLevel,jy=cs.unstable_ImmediatePriority,ej=cs.unstable_UserBlockingPriority,ym=cs.unstable_NormalPriority,IM=cs.unstable_LowPriority,tj=cs.unstable_IdlePriority,T0=null,ka=null;function LM(e){if(ka&&typeof ka.onCommitFiberRoot=="function")try{ka.onCommitFiberRoot(T0,e,void 0,(e.current.flags&128)===128)}catch{}}var Js=Math.clz32?Math.clz32:UM,$M=Math.log,BM=Math.LN2;function UM(e){return e>>>=0,e===0?32:31-($M(e)/BM|0)|0}var ah=64,ih=4194304;function Vu(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return e&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function wm(e,t){var r=e.pendingLanes;if(r===0)return 0;var n=0,s=e.suspendedLanes,a=e.pingedLanes,o=r&268435455;if(o!==0){var l=o&~s;l!==0?n=Vu(l):(a&=o,a!==0&&(n=Vu(a)))}else o=r&~s,o!==0?n=Vu(o):a!==0&&(n=Vu(a));if(n===0)return 0;if(t!==0&&t!==n&&!(t&s)&&(s=n&-n,a=t&-t,s>=a||s===16&&(a&4194240)!==0))return t;if(n&4&&(n|=r&16),t=e.entangledLanes,t!==0)for(e=e.entanglements,t&=n;0<t;)r=31-Js(t),s=1<<r,n|=e[r],t&=~s;return n}function zM(e,t){switch(e){case 1:case 2:case 4:return t+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function VM(e,t){for(var r=e.suspendedLanes,n=e.pingedLanes,s=e.expirationTimes,a=e.pendingLanes;0<a;){var o=31-Js(a),l=1<<o,c=s[o];c===-1?(!(l&r)||l&n)&&(s[o]=zM(l,t)):c<=t&&(e.expiredLanes|=l),a&=~l}}function $x(e){return e=e.pendingLanes&-1073741825,e!==0?e:e&1073741824?1073741824:0}function rj(){var e=ah;return ah<<=1,!(ah&4194240)&&(ah=64),e}function lg(e){for(var t=[],r=0;31>r;r++)t.push(e);return t}function hf(e,t,r){e.pendingLanes|=t,t!==536870912&&(e.suspendedLanes=0,e.pingedLanes=0),e=e.eventTimes,t=31-Js(t),e[t]=r}function WM(e,t){var r=e.pendingLanes&~t;e.pendingLanes=t,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=t,e.mutableReadLanes&=t,e.entangledLanes&=t,t=e.entanglements;var n=e.eventTimes;for(e=e.expirationTimes;0<r;){var s=31-Js(r),a=1<<s;t[s]=0,n[s]=-1,e[s]=-1,r&=~a}}function Ey(e,t){var r=e.entangledLanes|=t;for(e=e.entanglements;r;){var n=31-Js(r),s=1<<n;s&t|e[n]&t&&(e[n]|=t),r&=~s}}var It=0;function nj(e){return e&=-e,1<e?4<e?e&268435455?16:536870912:4:1}var sj,ky,aj,ij,oj,Bx=!1,oh=[],Yi=null,Ki=null,Xi=null,Sd=new Map,Nd=new Map,Pi=[],HM="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function k_(e,t){switch(e){case"focusin":case"focusout":Yi=null;break;case"dragenter":case"dragleave":Ki=null;break;case"mouseover":case"mouseout":Xi=null;break;case"pointerover":case"pointerout":Sd.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":Nd.delete(t.pointerId)}}function Su(e,t,r,n,s,a){return e===null||e.nativeEvent!==a?(e={blockedOn:t,domEventName:r,eventSystemFlags:n,nativeEvent:a,targetContainers:[s]},t!==null&&(t=pf(t),t!==null&&ky(t)),e):(e.eventSystemFlags|=n,t=e.targetContainers,s!==null&&t.indexOf(s)===-1&&t.push(s),e)}function GM(e,t,r,n,s){switch(t){case"focusin":return Yi=Su(Yi,e,t,r,n,s),!0;case"dragenter":return Ki=Su(Ki,e,t,r,n,s),!0;case"mouseover":return Xi=Su(Xi,e,t,r,n,s),!0;case"pointerover":var a=s.pointerId;return Sd.set(a,Su(Sd.get(a)||null,e,t,r,n,s)),!0;case"gotpointercapture":return a=s.pointerId,Nd.set(a,Su(Nd.get(a)||null,e,t,r,n,s)),!0}return!1}function lj(e){var t=Io(e.target);if(t!==null){var r=gl(t);if(r!==null){if(t=r.tag,t===13){if(t=XN(r),t!==null){e.blockedOn=t,oj(e.priority,function(){aj(r)});return}}else if(t===3&&r.stateNode.current.memoizedState.isDehydrated){e.blockedOn=r.tag===3?r.stateNode.containerInfo:null;return}}}e.blockedOn=null}function Hh(e){if(e.blockedOn!==null)return!1;for(var t=e.targetContainers;0<t.length;){var r=Ux(e.domEventName,e.eventSystemFlags,t[0],e.nativeEvent);if(r===null){r=e.nativeEvent;var n=new r.constructor(r.type,r);Ox=n,r.target.dispatchEvent(n),Ox=null}else return t=pf(r),t!==null&&ky(t),e.blockedOn=r,!1;t.shift()}return!0}function C_(e,t,r){Hh(e)&&r.delete(t)}function qM(){Bx=!1,Yi!==null&&Hh(Yi)&&(Yi=null),Ki!==null&&Hh(Ki)&&(Ki=null),Xi!==null&&Hh(Xi)&&(Xi=null),Sd.forEach(C_),Nd.forEach(C_)}function Nu(e,t){e.blockedOn===t&&(e.blockedOn=null,Bx||(Bx=!0,cs.unstable_scheduleCallback(cs.unstable_NormalPriority,qM)))}function jd(e){function t(s){return Nu(s,e)}if(0<oh.length){Nu(oh[0],e);for(var r=1;r<oh.length;r++){var n=oh[r];n.blockedOn===e&&(n.blockedOn=null)}}for(Yi!==null&&Nu(Yi,e),Ki!==null&&Nu(Ki,e),Xi!==null&&Nu(Xi,e),Sd.forEach(t),Nd.forEach(t),r=0;r<Pi.length;r++)n=Pi[r],n.blockedOn===e&&(n.blockedOn=null);for(;0<Pi.length&&(r=Pi[0],r.blockedOn===null);)lj(r),r.blockedOn===null&&Pi.shift()}var uc=xi.ReactCurrentBatchConfig,_m=!0;function YM(e,t,r,n){var s=It,a=uc.transition;uc.transition=null;try{It=1,Cy(e,t,r,n)}finally{It=s,uc.transition=a}}function KM(e,t,r,n){var s=It,a=uc.transition;uc.transition=null;try{It=4,Cy(e,t,r,n)}finally{It=s,uc.transition=a}}function Cy(e,t,r,n){if(_m){var s=Ux(e,t,r,n);if(s===null)vg(e,t,n,bm,r),k_(e,n);else if(GM(s,e,t,r,n))n.stopPropagation();else if(k_(e,n),t&4&&-1<HM.indexOf(e)){for(;s!==null;){var a=pf(s);if(a!==null&&sj(a),a=Ux(e,t,r,n),a===null&&vg(e,t,n,bm,r),a===s)break;s=a}s!==null&&n.stopPropagation()}else vg(e,t,n,null,r)}}var bm=null;function Ux(e,t,r,n){if(bm=null,e=Ny(n),e=Io(e),e!==null)if(t=gl(e),t===null)e=null;else if(r=t.tag,r===13){if(e=XN(t),e!==null)return e;e=null}else if(r===3){if(t.stateNode.current.memoizedState.isDehydrated)return t.tag===3?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null);return bm=e,null}function cj(e){switch(e){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(FM()){case jy:return 1;case ej:return 4;case ym:case IM:return 16;case tj:return 536870912;default:return 16}default:return 16}}var zi=null,Ty=null,Gh=null;function uj(){if(Gh)return Gh;var e,t=Ty,r=t.length,n,s="value"in zi?zi.value:zi.textContent,a=s.length;for(e=0;e<r&&t[e]===s[e];e++);var o=r-e;for(n=1;n<=o&&t[r-n]===s[a-n];n++);return Gh=s.slice(e,1<n?1-n:void 0)}function qh(e){var t=e.keyCode;return"charCode"in e?(e=e.charCode,e===0&&t===13&&(e=13)):e=t,e===10&&(e=13),32<=e||e===13?e:0}function lh(){return!0}function T_(){return!1}function hs(e){function t(r,n,s,a,o){this._reactName=r,this._targetInst=s,this.type=n,this.nativeEvent=a,this.target=o,this.currentTarget=null;for(var l in e)e.hasOwnProperty(l)&&(r=e[l],this[l]=r?r(a):a[l]);return this.isDefaultPrevented=(a.defaultPrevented!=null?a.defaultPrevented:a.returnValue===!1)?lh:T_,this.isPropagationStopped=T_,this}return ir(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var r=this.nativeEvent;r&&(r.preventDefault?r.preventDefault():typeof r.returnValue!="unknown"&&(r.returnValue=!1),this.isDefaultPrevented=lh)},stopPropagation:function(){var r=this.nativeEvent;r&&(r.stopPropagation?r.stopPropagation():typeof r.cancelBubble!="unknown"&&(r.cancelBubble=!0),this.isPropagationStopped=lh)},persist:function(){},isPersistent:lh}),t}var Xc={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Ay=hs(Xc),mf=ir({},Xc,{view:0,detail:0}),XM=hs(mf),cg,ug,ju,A0=ir({},mf,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Py,button:0,buttons:0,relatedTarget:function(e){return e.relatedTarget===void 0?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==ju&&(ju&&e.type==="mousemove"?(cg=e.screenX-ju.screenX,ug=e.screenY-ju.screenY):ug=cg=0,ju=e),cg)},movementY:function(e){return"movementY"in e?e.movementY:ug}}),A_=hs(A0),QM=ir({},A0,{dataTransfer:0}),JM=hs(QM),ZM=ir({},mf,{relatedTarget:0}),dg=hs(ZM),eO=ir({},Xc,{animationName:0,elapsedTime:0,pseudoElement:0}),tO=hs(eO),rO=ir({},Xc,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),nO=hs(rO),sO=ir({},Xc,{data:0}),P_=hs(sO),aO={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},iO={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},oO={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function lO(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):(e=oO[e])?!!t[e]:!1}function Py(){return lO}var cO=ir({},mf,{key:function(e){if(e.key){var t=aO[e.key]||e.key;if(t!=="Unidentified")return t}return e.type==="keypress"?(e=qh(e),e===13?"Enter":String.fromCharCode(e)):e.type==="keydown"||e.type==="keyup"?iO[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Py,charCode:function(e){return e.type==="keypress"?qh(e):0},keyCode:function(e){return e.type==="keydown"||e.type==="keyup"?e.keyCode:0},which:function(e){return e.type==="keypress"?qh(e):e.type==="keydown"||e.type==="keyup"?e.keyCode:0}}),uO=hs(cO),dO=ir({},A0,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),D_=hs(dO),fO=ir({},mf,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Py}),hO=hs(fO),mO=ir({},Xc,{propertyName:0,elapsedTime:0,pseudoElement:0}),pO=hs(mO),gO=ir({},A0,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),xO=hs(gO),vO=[9,13,27,32],Dy=oi&&"CompositionEvent"in window,Zu=null;oi&&"documentMode"in document&&(Zu=document.documentMode);var yO=oi&&"TextEvent"in window&&!Zu,dj=oi&&(!Dy||Zu&&8<Zu&&11>=Zu),R_=" ",M_=!1;function fj(e,t){switch(e){case"keyup":return vO.indexOf(t.keyCode)!==-1;case"keydown":return t.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function hj(e){return e=e.detail,typeof e=="object"&&"data"in e?e.data:null}var Kl=!1;function wO(e,t){switch(e){case"compositionend":return hj(t);case"keypress":return t.which!==32?null:(M_=!0,R_);case"textInput":return e=t.data,e===R_&&M_?null:e;default:return null}}function _O(e,t){if(Kl)return e==="compositionend"||!Dy&&fj(e,t)?(e=uj(),Gh=Ty=zi=null,Kl=!1,e):null;switch(e){case"paste":return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return dj&&t.locale!=="ko"?null:t.data;default:return null}}var bO={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function O_(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t==="input"?!!bO[e.type]:t==="textarea"}function mj(e,t,r,n){HN(n),t=Sm(t,"onChange"),0<t.length&&(r=new Ay("onChange","change",null,r,n),e.push({event:r,listeners:t}))}var ed=null,Ed=null;function SO(e){jj(e,0)}function P0(e){var t=Jl(e);if(LN(t))return e}function NO(e,t){if(e==="change")return t}var pj=!1;if(oi){var fg;if(oi){var hg="oninput"in document;if(!hg){var F_=document.createElement("div");F_.setAttribute("oninput","return;"),hg=typeof F_.oninput=="function"}fg=hg}else fg=!1;pj=fg&&(!document.documentMode||9<document.documentMode)}function I_(){ed&&(ed.detachEvent("onpropertychange",gj),Ed=ed=null)}function gj(e){if(e.propertyName==="value"&&P0(Ed)){var t=[];mj(t,Ed,e,Ny(e)),KN(SO,t)}}function jO(e,t,r){e==="focusin"?(I_(),ed=t,Ed=r,ed.attachEvent("onpropertychange",gj)):e==="focusout"&&I_()}function EO(e){if(e==="selectionchange"||e==="keyup"||e==="keydown")return P0(Ed)}function kO(e,t){if(e==="click")return P0(t)}function CO(e,t){if(e==="input"||e==="change")return P0(t)}function TO(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var sa=typeof Object.is=="function"?Object.is:TO;function kd(e,t){if(sa(e,t))return!0;if(typeof e!="object"||e===null||typeof t!="object"||t===null)return!1;var r=Object.keys(e),n=Object.keys(t);if(r.length!==n.length)return!1;for(n=0;n<r.length;n++){var s=r[n];if(!Sx.call(t,s)||!sa(e[s],t[s]))return!1}return!0}function L_(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function $_(e,t){var r=L_(e);e=0;for(var n;r;){if(r.nodeType===3){if(n=e+r.textContent.length,e<=t&&n>=t)return{node:r,offset:t-e};e=n}e:{for(;r;){if(r.nextSibling){r=r.nextSibling;break e}r=r.parentNode}r=void 0}r=L_(r)}}function xj(e,t){return e&&t?e===t?!0:e&&e.nodeType===3?!1:t&&t.nodeType===3?xj(e,t.parentNode):"contains"in e?e.contains(t):e.compareDocumentPosition?!!(e.compareDocumentPosition(t)&16):!1:!1}function vj(){for(var e=window,t=gm();t instanceof e.HTMLIFrameElement;){try{var r=typeof t.contentWindow.location.href=="string"}catch{r=!1}if(r)e=t.contentWindow;else break;t=gm(e.document)}return t}function Ry(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&(t==="input"&&(e.type==="text"||e.type==="search"||e.type==="tel"||e.type==="url"||e.type==="password")||t==="textarea"||e.contentEditable==="true")}function AO(e){var t=vj(),r=e.focusedElem,n=e.selectionRange;if(t!==r&&r&&r.ownerDocument&&xj(r.ownerDocument.documentElement,r)){if(n!==null&&Ry(r)){if(t=n.start,e=n.end,e===void 0&&(e=t),"selectionStart"in r)r.selectionStart=t,r.selectionEnd=Math.min(e,r.value.length);else if(e=(t=r.ownerDocument||document)&&t.defaultView||window,e.getSelection){e=e.getSelection();var s=r.textContent.length,a=Math.min(n.start,s);n=n.end===void 0?a:Math.min(n.end,s),!e.extend&&a>n&&(s=n,n=a,a=s),s=$_(r,a);var o=$_(r,n);s&&o&&(e.rangeCount!==1||e.anchorNode!==s.node||e.anchorOffset!==s.offset||e.focusNode!==o.node||e.focusOffset!==o.offset)&&(t=t.createRange(),t.setStart(s.node,s.offset),e.removeAllRanges(),a>n?(e.addRange(t),e.extend(o.node,o.offset)):(t.setEnd(o.node,o.offset),e.addRange(t)))}}for(t=[],e=r;e=e.parentNode;)e.nodeType===1&&t.push({element:e,left:e.scrollLeft,top:e.scrollTop});for(typeof r.focus=="function"&&r.focus(),r=0;r<t.length;r++)e=t[r],e.element.scrollLeft=e.left,e.element.scrollTop=e.top}}var PO=oi&&"documentMode"in document&&11>=document.documentMode,Xl=null,zx=null,td=null,Vx=!1;function B_(e,t,r){var n=r.window===r?r.document:r.nodeType===9?r:r.ownerDocument;Vx||Xl==null||Xl!==gm(n)||(n=Xl,"selectionStart"in n&&Ry(n)?n={start:n.selectionStart,end:n.selectionEnd}:(n=(n.ownerDocument&&n.ownerDocument.defaultView||window).getSelection(),n={anchorNode:n.anchorNode,anchorOffset:n.anchorOffset,focusNode:n.focusNode,focusOffset:n.focusOffset}),td&&kd(td,n)||(td=n,n=Sm(zx,"onSelect"),0<n.length&&(t=new Ay("onSelect","select",null,t,r),e.push({event:t,listeners:n}),t.target=Xl)))}function ch(e,t){var r={};return r[e.toLowerCase()]=t.toLowerCase(),r["Webkit"+e]="webkit"+t,r["Moz"+e]="moz"+t,r}var Ql={animationend:ch("Animation","AnimationEnd"),animationiteration:ch("Animation","AnimationIteration"),animationstart:ch("Animation","AnimationStart"),transitionend:ch("Transition","TransitionEnd")},mg={},yj={};oi&&(yj=document.createElement("div").style,"AnimationEvent"in window||(delete Ql.animationend.animation,delete Ql.animationiteration.animation,delete Ql.animationstart.animation),"TransitionEvent"in window||delete Ql.transitionend.transition);function D0(e){if(mg[e])return mg[e];if(!Ql[e])return e;var t=Ql[e],r;for(r in t)if(t.hasOwnProperty(r)&&r in yj)return mg[e]=t[r];return e}var wj=D0("animationend"),_j=D0("animationiteration"),bj=D0("animationstart"),Sj=D0("transitionend"),Nj=new Map,U_="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function go(e,t){Nj.set(e,t),pl(t,[e])}for(var pg=0;pg<U_.length;pg++){var gg=U_[pg],DO=gg.toLowerCase(),RO=gg[0].toUpperCase()+gg.slice(1);go(DO,"on"+RO)}go(wj,"onAnimationEnd");go(_j,"onAnimationIteration");go(bj,"onAnimationStart");go("dblclick","onDoubleClick");go("focusin","onFocus");go("focusout","onBlur");go(Sj,"onTransitionEnd");Ac("onMouseEnter",["mouseout","mouseover"]);Ac("onMouseLeave",["mouseout","mouseover"]);Ac("onPointerEnter",["pointerout","pointerover"]);Ac("onPointerLeave",["pointerout","pointerover"]);pl("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));pl("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));pl("onBeforeInput",["compositionend","keypress","textInput","paste"]);pl("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));pl("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));pl("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Wu="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),MO=new Set("cancel close invalid load scroll toggle".split(" ").concat(Wu));function z_(e,t,r){var n=e.type||"unknown-event";e.currentTarget=r,DM(n,t,void 0,e),e.currentTarget=null}function jj(e,t){t=(t&4)!==0;for(var r=0;r<e.length;r++){var n=e[r],s=n.event;n=n.listeners;e:{var a=void 0;if(t)for(var o=n.length-1;0<=o;o--){var l=n[o],c=l.instance,u=l.currentTarget;if(l=l.listener,c!==a&&s.isPropagationStopped())break e;z_(s,l,u),a=c}else for(o=0;o<n.length;o++){if(l=n[o],c=l.instance,u=l.currentTarget,l=l.listener,c!==a&&s.isPropagationStopped())break e;z_(s,l,u),a=c}}}if(vm)throw e=Lx,vm=!1,Lx=null,e}function qt(e,t){var r=t[Yx];r===void 0&&(r=t[Yx]=new Set);var n=e+"__bubble";r.has(n)||(Ej(t,e,2,!1),r.add(n))}function xg(e,t,r){var n=0;t&&(n|=4),Ej(r,e,n,t)}var uh="_reactListening"+Math.random().toString(36).slice(2);function Cd(e){if(!e[uh]){e[uh]=!0,RN.forEach(function(r){r!=="selectionchange"&&(MO.has(r)||xg(r,!1,e),xg(r,!0,e))});var t=e.nodeType===9?e:e.ownerDocument;t===null||t[uh]||(t[uh]=!0,xg("selectionchange",!1,t))}}function Ej(e,t,r,n){switch(cj(t)){case 1:var s=YM;break;case 4:s=KM;break;default:s=Cy}r=s.bind(null,t,r,e),s=void 0,!Ix||t!=="touchstart"&&t!=="touchmove"&&t!=="wheel"||(s=!0),n?s!==void 0?e.addEventListener(t,r,{capture:!0,passive:s}):e.addEventListener(t,r,!0):s!==void 0?e.addEventListener(t,r,{passive:s}):e.addEventListener(t,r,!1)}function vg(e,t,r,n,s){var a=n;if(!(t&1)&&!(t&2)&&n!==null)e:for(;;){if(n===null)return;var o=n.tag;if(o===3||o===4){var l=n.stateNode.containerInfo;if(l===s||l.nodeType===8&&l.parentNode===s)break;if(o===4)for(o=n.return;o!==null;){var c=o.tag;if((c===3||c===4)&&(c=o.stateNode.containerInfo,c===s||c.nodeType===8&&c.parentNode===s))return;o=o.return}for(;l!==null;){if(o=Io(l),o===null)return;if(c=o.tag,c===5||c===6){n=a=o;continue e}l=l.parentNode}}n=n.return}KN(function(){var u=a,d=Ny(r),f=[];e:{var p=Nj.get(e);if(p!==void 0){var h=Ay,g=e;switch(e){case"keypress":if(qh(r)===0)break e;case"keydown":case"keyup":h=uO;break;case"focusin":g="focus",h=dg;break;case"focusout":g="blur",h=dg;break;case"beforeblur":case"afterblur":h=dg;break;case"click":if(r.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":h=A_;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":h=JM;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":h=hO;break;case wj:case _j:case bj:h=tO;break;case Sj:h=pO;break;case"scroll":h=XM;break;case"wheel":h=xO;break;case"copy":case"cut":case"paste":h=nO;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":h=D_}var m=(t&4)!==0,x=!m&&e==="scroll",w=m?p!==null?p+"Capture":null:p;m=[];for(var v=u,_;v!==null;){_=v;var b=_.stateNode;if(_.tag===5&&b!==null&&(_=b,w!==null&&(b=bd(v,w),b!=null&&m.push(Td(v,b,_)))),x)break;v=v.return}0<m.length&&(p=new h(p,g,null,r,d),f.push({event:p,listeners:m}))}}if(!(t&7)){e:{if(p=e==="mouseover"||e==="pointerover",h=e==="mouseout"||e==="pointerout",p&&r!==Ox&&(g=r.relatedTarget||r.fromElement)&&(Io(g)||g[li]))break e;if((h||p)&&(p=d.window===d?d:(p=d.ownerDocument)?p.defaultView||p.parentWindow:window,h?(g=r.relatedTarget||r.toElement,h=u,g=g?Io(g):null,g!==null&&(x=gl(g),g!==x||g.tag!==5&&g.tag!==6)&&(g=null)):(h=null,g=u),h!==g)){if(m=A_,b="onMouseLeave",w="onMouseEnter",v="mouse",(e==="pointerout"||e==="pointerover")&&(m=D_,b="onPointerLeave",w="onPointerEnter",v="pointer"),x=h==null?p:Jl(h),_=g==null?p:Jl(g),p=new m(b,v+"leave",h,r,d),p.target=x,p.relatedTarget=_,b=null,Io(d)===u&&(m=new m(w,v+"enter",g,r,d),m.target=_,m.relatedTarget=x,b=m),x=b,h&&g)t:{for(m=h,w=g,v=0,_=m;_;_=Al(_))v++;for(_=0,b=w;b;b=Al(b))_++;for(;0<v-_;)m=Al(m),v--;for(;0<_-v;)w=Al(w),_--;for(;v--;){if(m===w||w!==null&&m===w.alternate)break t;m=Al(m),w=Al(w)}m=null}else m=null;h!==null&&V_(f,p,h,m,!1),g!==null&&x!==null&&V_(f,x,g,m,!0)}}e:{if(p=u?Jl(u):window,h=p.nodeName&&p.nodeName.toLowerCase(),h==="select"||h==="input"&&p.type==="file")var S=NO;else if(O_(p))if(pj)S=CO;else{S=EO;var T=jO}else(h=p.nodeName)&&h.toLowerCase()==="input"&&(p.type==="checkbox"||p.type==="radio")&&(S=kO);if(S&&(S=S(e,u))){mj(f,S,r,d);break e}T&&T(e,p,u),e==="focusout"&&(T=p._wrapperState)&&T.controlled&&p.type==="number"&&Ax(p,"number",p.value)}switch(T=u?Jl(u):window,e){case"focusin":(O_(T)||T.contentEditable==="true")&&(Xl=T,zx=u,td=null);break;case"focusout":td=zx=Xl=null;break;case"mousedown":Vx=!0;break;case"contextmenu":case"mouseup":case"dragend":Vx=!1,B_(f,r,d);break;case"selectionchange":if(PO)break;case"keydown":case"keyup":B_(f,r,d)}var N;if(Dy)e:{switch(e){case"compositionstart":var C="onCompositionStart";break e;case"compositionend":C="onCompositionEnd";break e;case"compositionupdate":C="onCompositionUpdate";break e}C=void 0}else Kl?fj(e,r)&&(C="onCompositionEnd"):e==="keydown"&&r.keyCode===229&&(C="onCompositionStart");C&&(dj&&r.locale!=="ko"&&(Kl||C!=="onCompositionStart"?C==="onCompositionEnd"&&Kl&&(N=uj()):(zi=d,Ty="value"in zi?zi.value:zi.textContent,Kl=!0)),T=Sm(u,C),0<T.length&&(C=new P_(C,e,null,r,d),f.push({event:C,listeners:T}),N?C.data=N:(N=hj(r),N!==null&&(C.data=N)))),(N=yO?wO(e,r):_O(e,r))&&(u=Sm(u,"onBeforeInput"),0<u.length&&(d=new P_("onBeforeInput","beforeinput",null,r,d),f.push({event:d,listeners:u}),d.data=N))}jj(f,t)})}function Td(e,t,r){return{instance:e,listener:t,currentTarget:r}}function Sm(e,t){for(var r=t+"Capture",n=[];e!==null;){var s=e,a=s.stateNode;s.tag===5&&a!==null&&(s=a,a=bd(e,r),a!=null&&n.unshift(Td(e,a,s)),a=bd(e,t),a!=null&&n.push(Td(e,a,s))),e=e.return}return n}function Al(e){if(e===null)return null;do e=e.return;while(e&&e.tag!==5);return e||null}function V_(e,t,r,n,s){for(var a=t._reactName,o=[];r!==null&&r!==n;){var l=r,c=l.alternate,u=l.stateNode;if(c!==null&&c===n)break;l.tag===5&&u!==null&&(l=u,s?(c=bd(r,a),c!=null&&o.unshift(Td(r,c,l))):s||(c=bd(r,a),c!=null&&o.push(Td(r,c,l)))),r=r.return}o.length!==0&&e.push({event:t,listeners:o})}var OO=/\r\n?/g,FO=/\u0000|\uFFFD/g;function W_(e){return(typeof e=="string"?e:""+e).replace(OO,`
`).replace(FO,"")}function dh(e,t,r){if(t=W_(t),W_(e)!==t&&r)throw Error(Fe(425))}function Nm(){}var Wx=null,Hx=null;function Gx(e,t){return e==="textarea"||e==="noscript"||typeof t.children=="string"||typeof t.children=="number"||typeof t.dangerouslySetInnerHTML=="object"&&t.dangerouslySetInnerHTML!==null&&t.dangerouslySetInnerHTML.__html!=null}var qx=typeof setTimeout=="function"?setTimeout:void 0,IO=typeof clearTimeout=="function"?clearTimeout:void 0,H_=typeof Promise=="function"?Promise:void 0,LO=typeof queueMicrotask=="function"?queueMicrotask:typeof H_<"u"?function(e){return H_.resolve(null).then(e).catch($O)}:qx;function $O(e){setTimeout(function(){throw e})}function yg(e,t){var r=t,n=0;do{var s=r.nextSibling;if(e.removeChild(r),s&&s.nodeType===8)if(r=s.data,r==="/$"){if(n===0){e.removeChild(s),jd(t);return}n--}else r!=="$"&&r!=="$?"&&r!=="$!"||n++;r=s}while(r);jd(t)}function Qi(e){for(;e!=null;e=e.nextSibling){var t=e.nodeType;if(t===1||t===3)break;if(t===8){if(t=e.data,t==="$"||t==="$!"||t==="$?")break;if(t==="/$")return null}}return e}function G_(e){e=e.previousSibling;for(var t=0;e;){if(e.nodeType===8){var r=e.data;if(r==="$"||r==="$!"||r==="$?"){if(t===0)return e;t--}else r==="/$"&&t++}e=e.previousSibling}return null}var Qc=Math.random().toString(36).slice(2),Sa="__reactFiber$"+Qc,Ad="__reactProps$"+Qc,li="__reactContainer$"+Qc,Yx="__reactEvents$"+Qc,BO="__reactListeners$"+Qc,UO="__reactHandles$"+Qc;function Io(e){var t=e[Sa];if(t)return t;for(var r=e.parentNode;r;){if(t=r[li]||r[Sa]){if(r=t.alternate,t.child!==null||r!==null&&r.child!==null)for(e=G_(e);e!==null;){if(r=e[Sa])return r;e=G_(e)}return t}e=r,r=e.parentNode}return null}function pf(e){return e=e[Sa]||e[li],!e||e.tag!==5&&e.tag!==6&&e.tag!==13&&e.tag!==3?null:e}function Jl(e){if(e.tag===5||e.tag===6)return e.stateNode;throw Error(Fe(33))}function R0(e){return e[Ad]||null}var Kx=[],Zl=-1;function xo(e){return{current:e}}function Yt(e){0>Zl||(e.current=Kx[Zl],Kx[Zl]=null,Zl--)}function Wt(e,t){Zl++,Kx[Zl]=e.current,e.current=t}var io={},vn=xo(io),Bn=xo(!1),Jo=io;function Pc(e,t){var r=e.type.contextTypes;if(!r)return io;var n=e.stateNode;if(n&&n.__reactInternalMemoizedUnmaskedChildContext===t)return n.__reactInternalMemoizedMaskedChildContext;var s={},a;for(a in r)s[a]=t[a];return n&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=t,e.__reactInternalMemoizedMaskedChildContext=s),s}function Un(e){return e=e.childContextTypes,e!=null}function jm(){Yt(Bn),Yt(vn)}function q_(e,t,r){if(vn.current!==io)throw Error(Fe(168));Wt(vn,t),Wt(Bn,r)}function kj(e,t,r){var n=e.stateNode;if(t=t.childContextTypes,typeof n.getChildContext!="function")return r;n=n.getChildContext();for(var s in n)if(!(s in t))throw Error(Fe(108,jM(e)||"Unknown",s));return ir({},r,n)}function Em(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||io,Jo=vn.current,Wt(vn,e),Wt(Bn,Bn.current),!0}function Y_(e,t,r){var n=e.stateNode;if(!n)throw Error(Fe(169));r?(e=kj(e,t,Jo),n.__reactInternalMemoizedMergedChildContext=e,Yt(Bn),Yt(vn),Wt(vn,e)):Yt(Bn),Wt(Bn,r)}var Ga=null,M0=!1,wg=!1;function Cj(e){Ga===null?Ga=[e]:Ga.push(e)}function zO(e){M0=!0,Cj(e)}function vo(){if(!wg&&Ga!==null){wg=!0;var e=0,t=It;try{var r=Ga;for(It=1;e<r.length;e++){var n=r[e];do n=n(!0);while(n!==null)}Ga=null,M0=!1}catch(s){throw Ga!==null&&(Ga=Ga.slice(e+1)),ZN(jy,vo),s}finally{It=t,wg=!1}}return null}var ec=[],tc=0,km=null,Cm=0,_s=[],bs=0,Zo=null,Ka=1,Xa="";function Ao(e,t){ec[tc++]=Cm,ec[tc++]=km,km=e,Cm=t}function Tj(e,t,r){_s[bs++]=Ka,_s[bs++]=Xa,_s[bs++]=Zo,Zo=e;var n=Ka;e=Xa;var s=32-Js(n)-1;n&=~(1<<s),r+=1;var a=32-Js(t)+s;if(30<a){var o=s-s%5;a=(n&(1<<o)-1).toString(32),n>>=o,s-=o,Ka=1<<32-Js(t)+s|r<<s|n,Xa=a+e}else Ka=1<<a|r<<s|n,Xa=e}function My(e){e.return!==null&&(Ao(e,1),Tj(e,1,0))}function Oy(e){for(;e===km;)km=ec[--tc],ec[tc]=null,Cm=ec[--tc],ec[tc]=null;for(;e===Zo;)Zo=_s[--bs],_s[bs]=null,Xa=_s[--bs],_s[bs]=null,Ka=_s[--bs],_s[bs]=null}var is=null,ss=null,er=!1,Hs=null;function Aj(e,t){var r=Ss(5,null,null,0);r.elementType="DELETED",r.stateNode=t,r.return=e,t=e.deletions,t===null?(e.deletions=[r],e.flags|=16):t.push(r)}function K_(e,t){switch(e.tag){case 5:var r=e.type;return t=t.nodeType!==1||r.toLowerCase()!==t.nodeName.toLowerCase()?null:t,t!==null?(e.stateNode=t,is=e,ss=Qi(t.firstChild),!0):!1;case 6:return t=e.pendingProps===""||t.nodeType!==3?null:t,t!==null?(e.stateNode=t,is=e,ss=null,!0):!1;case 13:return t=t.nodeType!==8?null:t,t!==null?(r=Zo!==null?{id:Ka,overflow:Xa}:null,e.memoizedState={dehydrated:t,treeContext:r,retryLane:1073741824},r=Ss(18,null,null,0),r.stateNode=t,r.return=e,e.child=r,is=e,ss=null,!0):!1;default:return!1}}function Xx(e){return(e.mode&1)!==0&&(e.flags&128)===0}function Qx(e){if(er){var t=ss;if(t){var r=t;if(!K_(e,t)){if(Xx(e))throw Error(Fe(418));t=Qi(r.nextSibling);var n=is;t&&K_(e,t)?Aj(n,r):(e.flags=e.flags&-4097|2,er=!1,is=e)}}else{if(Xx(e))throw Error(Fe(418));e.flags=e.flags&-4097|2,er=!1,is=e}}}function X_(e){for(e=e.return;e!==null&&e.tag!==5&&e.tag!==3&&e.tag!==13;)e=e.return;is=e}function fh(e){if(e!==is)return!1;if(!er)return X_(e),er=!0,!1;var t;if((t=e.tag!==3)&&!(t=e.tag!==5)&&(t=e.type,t=t!=="head"&&t!=="body"&&!Gx(e.type,e.memoizedProps)),t&&(t=ss)){if(Xx(e))throw Pj(),Error(Fe(418));for(;t;)Aj(e,t),t=Qi(t.nextSibling)}if(X_(e),e.tag===13){if(e=e.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(Fe(317));e:{for(e=e.nextSibling,t=0;e;){if(e.nodeType===8){var r=e.data;if(r==="/$"){if(t===0){ss=Qi(e.nextSibling);break e}t--}else r!=="$"&&r!=="$!"&&r!=="$?"||t++}e=e.nextSibling}ss=null}}else ss=is?Qi(e.stateNode.nextSibling):null;return!0}function Pj(){for(var e=ss;e;)e=Qi(e.nextSibling)}function Dc(){ss=is=null,er=!1}function Fy(e){Hs===null?Hs=[e]:Hs.push(e)}var VO=xi.ReactCurrentBatchConfig;function Eu(e,t,r){if(e=r.ref,e!==null&&typeof e!="function"&&typeof e!="object"){if(r._owner){if(r=r._owner,r){if(r.tag!==1)throw Error(Fe(309));var n=r.stateNode}if(!n)throw Error(Fe(147,e));var s=n,a=""+e;return t!==null&&t.ref!==null&&typeof t.ref=="function"&&t.ref._stringRef===a?t.ref:(t=function(o){var l=s.refs;o===null?delete l[a]:l[a]=o},t._stringRef=a,t)}if(typeof e!="string")throw Error(Fe(284));if(!r._owner)throw Error(Fe(290,e))}return e}function hh(e,t){throw e=Object.prototype.toString.call(t),Error(Fe(31,e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e))}function Q_(e){var t=e._init;return t(e._payload)}function Dj(e){function t(w,v){if(e){var _=w.deletions;_===null?(w.deletions=[v],w.flags|=16):_.push(v)}}function r(w,v){if(!e)return null;for(;v!==null;)t(w,v),v=v.sibling;return null}function n(w,v){for(w=new Map;v!==null;)v.key!==null?w.set(v.key,v):w.set(v.index,v),v=v.sibling;return w}function s(w,v){return w=to(w,v),w.index=0,w.sibling=null,w}function a(w,v,_){return w.index=_,e?(_=w.alternate,_!==null?(_=_.index,_<v?(w.flags|=2,v):_):(w.flags|=2,v)):(w.flags|=1048576,v)}function o(w){return e&&w.alternate===null&&(w.flags|=2),w}function l(w,v,_,b){return v===null||v.tag!==6?(v=kg(_,w.mode,b),v.return=w,v):(v=s(v,_),v.return=w,v)}function c(w,v,_,b){var S=_.type;return S===Yl?d(w,v,_.props.children,b,_.key):v!==null&&(v.elementType===S||typeof S=="object"&&S!==null&&S.$$typeof===Ci&&Q_(S)===v.type)?(b=s(v,_.props),b.ref=Eu(w,v,_),b.return=w,b):(b=em(_.type,_.key,_.props,null,w.mode,b),b.ref=Eu(w,v,_),b.return=w,b)}function u(w,v,_,b){return v===null||v.tag!==4||v.stateNode.containerInfo!==_.containerInfo||v.stateNode.implementation!==_.implementation?(v=Cg(_,w.mode,b),v.return=w,v):(v=s(v,_.children||[]),v.return=w,v)}function d(w,v,_,b,S){return v===null||v.tag!==7?(v=Ko(_,w.mode,b,S),v.return=w,v):(v=s(v,_),v.return=w,v)}function f(w,v,_){if(typeof v=="string"&&v!==""||typeof v=="number")return v=kg(""+v,w.mode,_),v.return=w,v;if(typeof v=="object"&&v!==null){switch(v.$$typeof){case rh:return _=em(v.type,v.key,v.props,null,w.mode,_),_.ref=Eu(w,null,v),_.return=w,_;case ql:return v=Cg(v,w.mode,_),v.return=w,v;case Ci:var b=v._init;return f(w,b(v._payload),_)}if(zu(v)||_u(v))return v=Ko(v,w.mode,_,null),v.return=w,v;hh(w,v)}return null}function p(w,v,_,b){var S=v!==null?v.key:null;if(typeof _=="string"&&_!==""||typeof _=="number")return S!==null?null:l(w,v,""+_,b);if(typeof _=="object"&&_!==null){switch(_.$$typeof){case rh:return _.key===S?c(w,v,_,b):null;case ql:return _.key===S?u(w,v,_,b):null;case Ci:return S=_._init,p(w,v,S(_._payload),b)}if(zu(_)||_u(_))return S!==null?null:d(w,v,_,b,null);hh(w,_)}return null}function h(w,v,_,b,S){if(typeof b=="string"&&b!==""||typeof b=="number")return w=w.get(_)||null,l(v,w,""+b,S);if(typeof b=="object"&&b!==null){switch(b.$$typeof){case rh:return w=w.get(b.key===null?_:b.key)||null,c(v,w,b,S);case ql:return w=w.get(b.key===null?_:b.key)||null,u(v,w,b,S);case Ci:var T=b._init;return h(w,v,_,T(b._payload),S)}if(zu(b)||_u(b))return w=w.get(_)||null,d(v,w,b,S,null);hh(v,b)}return null}function g(w,v,_,b){for(var S=null,T=null,N=v,C=v=0,E=null;N!==null&&C<_.length;C++){N.index>C?(E=N,N=null):E=N.sibling;var P=p(w,N,_[C],b);if(P===null){N===null&&(N=E);break}e&&N&&P.alternate===null&&t(w,N),v=a(P,v,C),T===null?S=P:T.sibling=P,T=P,N=E}if(C===_.length)return r(w,N),er&&Ao(w,C),S;if(N===null){for(;C<_.length;C++)N=f(w,_[C],b),N!==null&&(v=a(N,v,C),T===null?S=N:T.sibling=N,T=N);return er&&Ao(w,C),S}for(N=n(w,N);C<_.length;C++)E=h(N,w,C,_[C],b),E!==null&&(e&&E.alternate!==null&&N.delete(E.key===null?C:E.key),v=a(E,v,C),T===null?S=E:T.sibling=E,T=E);return e&&N.forEach(function(R){return t(w,R)}),er&&Ao(w,C),S}function m(w,v,_,b){var S=_u(_);if(typeof S!="function")throw Error(Fe(150));if(_=S.call(_),_==null)throw Error(Fe(151));for(var T=S=null,N=v,C=v=0,E=null,P=_.next();N!==null&&!P.done;C++,P=_.next()){N.index>C?(E=N,N=null):E=N.sibling;var R=p(w,N,P.value,b);if(R===null){N===null&&(N=E);break}e&&N&&R.alternate===null&&t(w,N),v=a(R,v,C),T===null?S=R:T.sibling=R,T=R,N=E}if(P.done)return r(w,N),er&&Ao(w,C),S;if(N===null){for(;!P.done;C++,P=_.next())P=f(w,P.value,b),P!==null&&(v=a(P,v,C),T===null?S=P:T.sibling=P,T=P);return er&&Ao(w,C),S}for(N=n(w,N);!P.done;C++,P=_.next())P=h(N,w,C,P.value,b),P!==null&&(e&&P.alternate!==null&&N.delete(P.key===null?C:P.key),v=a(P,v,C),T===null?S=P:T.sibling=P,T=P);return e&&N.forEach(function(j){return t(w,j)}),er&&Ao(w,C),S}function x(w,v,_,b){if(typeof _=="object"&&_!==null&&_.type===Yl&&_.key===null&&(_=_.props.children),typeof _=="object"&&_!==null){switch(_.$$typeof){case rh:e:{for(var S=_.key,T=v;T!==null;){if(T.key===S){if(S=_.type,S===Yl){if(T.tag===7){r(w,T.sibling),v=s(T,_.props.children),v.return=w,w=v;break e}}else if(T.elementType===S||typeof S=="object"&&S!==null&&S.$$typeof===Ci&&Q_(S)===T.type){r(w,T.sibling),v=s(T,_.props),v.ref=Eu(w,T,_),v.return=w,w=v;break e}r(w,T);break}else t(w,T);T=T.sibling}_.type===Yl?(v=Ko(_.props.children,w.mode,b,_.key),v.return=w,w=v):(b=em(_.type,_.key,_.props,null,w.mode,b),b.ref=Eu(w,v,_),b.return=w,w=b)}return o(w);case ql:e:{for(T=_.key;v!==null;){if(v.key===T)if(v.tag===4&&v.stateNode.containerInfo===_.containerInfo&&v.stateNode.implementation===_.implementation){r(w,v.sibling),v=s(v,_.children||[]),v.return=w,w=v;break e}else{r(w,v);break}else t(w,v);v=v.sibling}v=Cg(_,w.mode,b),v.return=w,w=v}return o(w);case Ci:return T=_._init,x(w,v,T(_._payload),b)}if(zu(_))return g(w,v,_,b);if(_u(_))return m(w,v,_,b);hh(w,_)}return typeof _=="string"&&_!==""||typeof _=="number"?(_=""+_,v!==null&&v.tag===6?(r(w,v.sibling),v=s(v,_),v.return=w,w=v):(r(w,v),v=kg(_,w.mode,b),v.return=w,w=v),o(w)):r(w,v)}return x}var Rc=Dj(!0),Rj=Dj(!1),Tm=xo(null),Am=null,rc=null,Iy=null;function Ly(){Iy=rc=Am=null}function $y(e){var t=Tm.current;Yt(Tm),e._currentValue=t}function Jx(e,t,r){for(;e!==null;){var n=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,n!==null&&(n.childLanes|=t)):n!==null&&(n.childLanes&t)!==t&&(n.childLanes|=t),e===r)break;e=e.return}}function dc(e,t){Am=e,Iy=rc=null,e=e.dependencies,e!==null&&e.firstContext!==null&&(e.lanes&t&&(Ln=!0),e.firstContext=null)}function ks(e){var t=e._currentValue;if(Iy!==e)if(e={context:e,memoizedValue:t,next:null},rc===null){if(Am===null)throw Error(Fe(308));rc=e,Am.dependencies={lanes:0,firstContext:e}}else rc=rc.next=e;return t}var Lo=null;function By(e){Lo===null?Lo=[e]:Lo.push(e)}function Mj(e,t,r,n){var s=t.interleaved;return s===null?(r.next=r,By(t)):(r.next=s.next,s.next=r),t.interleaved=r,ci(e,n)}function ci(e,t){e.lanes|=t;var r=e.alternate;for(r!==null&&(r.lanes|=t),r=e,e=e.return;e!==null;)e.childLanes|=t,r=e.alternate,r!==null&&(r.childLanes|=t),r=e,e=e.return;return r.tag===3?r.stateNode:null}var Ti=!1;function Uy(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function Oj(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function ei(e,t){return{eventTime:e,lane:t,tag:0,payload:null,callback:null,next:null}}function Ji(e,t,r){var n=e.updateQueue;if(n===null)return null;if(n=n.shared,Ct&2){var s=n.pending;return s===null?t.next=t:(t.next=s.next,s.next=t),n.pending=t,ci(e,r)}return s=n.interleaved,s===null?(t.next=t,By(n)):(t.next=s.next,s.next=t),n.interleaved=t,ci(e,r)}function Yh(e,t,r){if(t=t.updateQueue,t!==null&&(t=t.shared,(r&4194240)!==0)){var n=t.lanes;n&=e.pendingLanes,r|=n,t.lanes=r,Ey(e,r)}}function J_(e,t){var r=e.updateQueue,n=e.alternate;if(n!==null&&(n=n.updateQueue,r===n)){var s=null,a=null;if(r=r.firstBaseUpdate,r!==null){do{var o={eventTime:r.eventTime,lane:r.lane,tag:r.tag,payload:r.payload,callback:r.callback,next:null};a===null?s=a=o:a=a.next=o,r=r.next}while(r!==null);a===null?s=a=t:a=a.next=t}else s=a=t;r={baseState:n.baseState,firstBaseUpdate:s,lastBaseUpdate:a,shared:n.shared,effects:n.effects},e.updateQueue=r;return}e=r.lastBaseUpdate,e===null?r.firstBaseUpdate=t:e.next=t,r.lastBaseUpdate=t}function Pm(e,t,r,n){var s=e.updateQueue;Ti=!1;var a=s.firstBaseUpdate,o=s.lastBaseUpdate,l=s.shared.pending;if(l!==null){s.shared.pending=null;var c=l,u=c.next;c.next=null,o===null?a=u:o.next=u,o=c;var d=e.alternate;d!==null&&(d=d.updateQueue,l=d.lastBaseUpdate,l!==o&&(l===null?d.firstBaseUpdate=u:l.next=u,d.lastBaseUpdate=c))}if(a!==null){var f=s.baseState;o=0,d=u=c=null,l=a;do{var p=l.lane,h=l.eventTime;if((n&p)===p){d!==null&&(d=d.next={eventTime:h,lane:0,tag:l.tag,payload:l.payload,callback:l.callback,next:null});e:{var g=e,m=l;switch(p=t,h=r,m.tag){case 1:if(g=m.payload,typeof g=="function"){f=g.call(h,f,p);break e}f=g;break e;case 3:g.flags=g.flags&-65537|128;case 0:if(g=m.payload,p=typeof g=="function"?g.call(h,f,p):g,p==null)break e;f=ir({},f,p);break e;case 2:Ti=!0}}l.callback!==null&&l.lane!==0&&(e.flags|=64,p=s.effects,p===null?s.effects=[l]:p.push(l))}else h={eventTime:h,lane:p,tag:l.tag,payload:l.payload,callback:l.callback,next:null},d===null?(u=d=h,c=f):d=d.next=h,o|=p;if(l=l.next,l===null){if(l=s.shared.pending,l===null)break;p=l,l=p.next,p.next=null,s.lastBaseUpdate=p,s.shared.pending=null}}while(!0);if(d===null&&(c=f),s.baseState=c,s.firstBaseUpdate=u,s.lastBaseUpdate=d,t=s.shared.interleaved,t!==null){s=t;do o|=s.lane,s=s.next;while(s!==t)}else a===null&&(s.shared.lanes=0);tl|=o,e.lanes=o,e.memoizedState=f}}function Z_(e,t,r){if(e=t.effects,t.effects=null,e!==null)for(t=0;t<e.length;t++){var n=e[t],s=n.callback;if(s!==null){if(n.callback=null,n=r,typeof s!="function")throw Error(Fe(191,s));s.call(n)}}}var gf={},Ca=xo(gf),Pd=xo(gf),Dd=xo(gf);function $o(e){if(e===gf)throw Error(Fe(174));return e}function zy(e,t){switch(Wt(Dd,t),Wt(Pd,e),Wt(Ca,gf),e=t.nodeType,e){case 9:case 11:t=(t=t.documentElement)?t.namespaceURI:Dx(null,"");break;default:e=e===8?t.parentNode:t,t=e.namespaceURI||null,e=e.tagName,t=Dx(t,e)}Yt(Ca),Wt(Ca,t)}function Mc(){Yt(Ca),Yt(Pd),Yt(Dd)}function Fj(e){$o(Dd.current);var t=$o(Ca.current),r=Dx(t,e.type);t!==r&&(Wt(Pd,e),Wt(Ca,r))}function Vy(e){Pd.current===e&&(Yt(Ca),Yt(Pd))}var sr=xo(0);function Dm(e){for(var t=e;t!==null;){if(t.tag===13){var r=t.memoizedState;if(r!==null&&(r=r.dehydrated,r===null||r.data==="$?"||r.data==="$!"))return t}else if(t.tag===19&&t.memoizedProps.revealOrder!==void 0){if(t.flags&128)return t}else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var _g=[];function Wy(){for(var e=0;e<_g.length;e++)_g[e]._workInProgressVersionPrimary=null;_g.length=0}var Kh=xi.ReactCurrentDispatcher,bg=xi.ReactCurrentBatchConfig,el=0,ar=null,Dr=null,Ur=null,Rm=!1,rd=!1,Rd=0,WO=0;function cn(){throw Error(Fe(321))}function Hy(e,t){if(t===null)return!1;for(var r=0;r<t.length&&r<e.length;r++)if(!sa(e[r],t[r]))return!1;return!0}function Gy(e,t,r,n,s,a){if(el=a,ar=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,Kh.current=e===null||e.memoizedState===null?YO:KO,e=r(n,s),rd){a=0;do{if(rd=!1,Rd=0,25<=a)throw Error(Fe(301));a+=1,Ur=Dr=null,t.updateQueue=null,Kh.current=XO,e=r(n,s)}while(rd)}if(Kh.current=Mm,t=Dr!==null&&Dr.next!==null,el=0,Ur=Dr=ar=null,Rm=!1,t)throw Error(Fe(300));return e}function qy(){var e=Rd!==0;return Rd=0,e}function va(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Ur===null?ar.memoizedState=Ur=e:Ur=Ur.next=e,Ur}function Cs(){if(Dr===null){var e=ar.alternate;e=e!==null?e.memoizedState:null}else e=Dr.next;var t=Ur===null?ar.memoizedState:Ur.next;if(t!==null)Ur=t,Dr=e;else{if(e===null)throw Error(Fe(310));Dr=e,e={memoizedState:Dr.memoizedState,baseState:Dr.baseState,baseQueue:Dr.baseQueue,queue:Dr.queue,next:null},Ur===null?ar.memoizedState=Ur=e:Ur=Ur.next=e}return Ur}function Md(e,t){return typeof t=="function"?t(e):t}function Sg(e){var t=Cs(),r=t.queue;if(r===null)throw Error(Fe(311));r.lastRenderedReducer=e;var n=Dr,s=n.baseQueue,a=r.pending;if(a!==null){if(s!==null){var o=s.next;s.next=a.next,a.next=o}n.baseQueue=s=a,r.pending=null}if(s!==null){a=s.next,n=n.baseState;var l=o=null,c=null,u=a;do{var d=u.lane;if((el&d)===d)c!==null&&(c=c.next={lane:0,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null}),n=u.hasEagerState?u.eagerState:e(n,u.action);else{var f={lane:d,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null};c===null?(l=c=f,o=n):c=c.next=f,ar.lanes|=d,tl|=d}u=u.next}while(u!==null&&u!==a);c===null?o=n:c.next=l,sa(n,t.memoizedState)||(Ln=!0),t.memoizedState=n,t.baseState=o,t.baseQueue=c,r.lastRenderedState=n}if(e=r.interleaved,e!==null){s=e;do a=s.lane,ar.lanes|=a,tl|=a,s=s.next;while(s!==e)}else s===null&&(r.lanes=0);return[t.memoizedState,r.dispatch]}function Ng(e){var t=Cs(),r=t.queue;if(r===null)throw Error(Fe(311));r.lastRenderedReducer=e;var n=r.dispatch,s=r.pending,a=t.memoizedState;if(s!==null){r.pending=null;var o=s=s.next;do a=e(a,o.action),o=o.next;while(o!==s);sa(a,t.memoizedState)||(Ln=!0),t.memoizedState=a,t.baseQueue===null&&(t.baseState=a),r.lastRenderedState=a}return[a,n]}function Ij(){}function Lj(e,t){var r=ar,n=Cs(),s=t(),a=!sa(n.memoizedState,s);if(a&&(n.memoizedState=s,Ln=!0),n=n.queue,Yy(Uj.bind(null,r,n,e),[e]),n.getSnapshot!==t||a||Ur!==null&&Ur.memoizedState.tag&1){if(r.flags|=2048,Od(9,Bj.bind(null,r,n,s,t),void 0,null),Gr===null)throw Error(Fe(349));el&30||$j(r,t,s)}return s}function $j(e,t,r){e.flags|=16384,e={getSnapshot:t,value:r},t=ar.updateQueue,t===null?(t={lastEffect:null,stores:null},ar.updateQueue=t,t.stores=[e]):(r=t.stores,r===null?t.stores=[e]:r.push(e))}function Bj(e,t,r,n){t.value=r,t.getSnapshot=n,zj(t)&&Vj(e)}function Uj(e,t,r){return r(function(){zj(t)&&Vj(e)})}function zj(e){var t=e.getSnapshot;e=e.value;try{var r=t();return!sa(e,r)}catch{return!0}}function Vj(e){var t=ci(e,1);t!==null&&Zs(t,e,1,-1)}function eb(e){var t=va();return typeof e=="function"&&(e=e()),t.memoizedState=t.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Md,lastRenderedState:e},t.queue=e,e=e.dispatch=qO.bind(null,ar,e),[t.memoizedState,e]}function Od(e,t,r,n){return e={tag:e,create:t,destroy:r,deps:n,next:null},t=ar.updateQueue,t===null?(t={lastEffect:null,stores:null},ar.updateQueue=t,t.lastEffect=e.next=e):(r=t.lastEffect,r===null?t.lastEffect=e.next=e:(n=r.next,r.next=e,e.next=n,t.lastEffect=e)),e}function Wj(){return Cs().memoizedState}function Xh(e,t,r,n){var s=va();ar.flags|=e,s.memoizedState=Od(1|t,r,void 0,n===void 0?null:n)}function O0(e,t,r,n){var s=Cs();n=n===void 0?null:n;var a=void 0;if(Dr!==null){var o=Dr.memoizedState;if(a=o.destroy,n!==null&&Hy(n,o.deps)){s.memoizedState=Od(t,r,a,n);return}}ar.flags|=e,s.memoizedState=Od(1|t,r,a,n)}function tb(e,t){return Xh(8390656,8,e,t)}function Yy(e,t){return O0(2048,8,e,t)}function Hj(e,t){return O0(4,2,e,t)}function Gj(e,t){return O0(4,4,e,t)}function qj(e,t){if(typeof t=="function")return e=e(),t(e),function(){t(null)};if(t!=null)return e=e(),t.current=e,function(){t.current=null}}function Yj(e,t,r){return r=r!=null?r.concat([e]):null,O0(4,4,qj.bind(null,t,e),r)}function Ky(){}function Kj(e,t){var r=Cs();t=t===void 0?null:t;var n=r.memoizedState;return n!==null&&t!==null&&Hy(t,n[1])?n[0]:(r.memoizedState=[e,t],e)}function Xj(e,t){var r=Cs();t=t===void 0?null:t;var n=r.memoizedState;return n!==null&&t!==null&&Hy(t,n[1])?n[0]:(e=e(),r.memoizedState=[e,t],e)}function Qj(e,t,r){return el&21?(sa(r,t)||(r=rj(),ar.lanes|=r,tl|=r,e.baseState=!0),t):(e.baseState&&(e.baseState=!1,Ln=!0),e.memoizedState=r)}function HO(e,t){var r=It;It=r!==0&&4>r?r:4,e(!0);var n=bg.transition;bg.transition={};try{e(!1),t()}finally{It=r,bg.transition=n}}function Jj(){return Cs().memoizedState}function GO(e,t,r){var n=eo(e);if(r={lane:n,action:r,hasEagerState:!1,eagerState:null,next:null},Zj(e))eE(t,r);else if(r=Mj(e,t,r,n),r!==null){var s=En();Zs(r,e,n,s),tE(r,t,n)}}function qO(e,t,r){var n=eo(e),s={lane:n,action:r,hasEagerState:!1,eagerState:null,next:null};if(Zj(e))eE(t,s);else{var a=e.alternate;if(e.lanes===0&&(a===null||a.lanes===0)&&(a=t.lastRenderedReducer,a!==null))try{var o=t.lastRenderedState,l=a(o,r);if(s.hasEagerState=!0,s.eagerState=l,sa(l,o)){var c=t.interleaved;c===null?(s.next=s,By(t)):(s.next=c.next,c.next=s),t.interleaved=s;return}}catch{}finally{}r=Mj(e,t,s,n),r!==null&&(s=En(),Zs(r,e,n,s),tE(r,t,n))}}function Zj(e){var t=e.alternate;return e===ar||t!==null&&t===ar}function eE(e,t){rd=Rm=!0;var r=e.pending;r===null?t.next=t:(t.next=r.next,r.next=t),e.pending=t}function tE(e,t,r){if(r&4194240){var n=t.lanes;n&=e.pendingLanes,r|=n,t.lanes=r,Ey(e,r)}}var Mm={readContext:ks,useCallback:cn,useContext:cn,useEffect:cn,useImperativeHandle:cn,useInsertionEffect:cn,useLayoutEffect:cn,useMemo:cn,useReducer:cn,useRef:cn,useState:cn,useDebugValue:cn,useDeferredValue:cn,useTransition:cn,useMutableSource:cn,useSyncExternalStore:cn,useId:cn,unstable_isNewReconciler:!1},YO={readContext:ks,useCallback:function(e,t){return va().memoizedState=[e,t===void 0?null:t],e},useContext:ks,useEffect:tb,useImperativeHandle:function(e,t,r){return r=r!=null?r.concat([e]):null,Xh(4194308,4,qj.bind(null,t,e),r)},useLayoutEffect:function(e,t){return Xh(4194308,4,e,t)},useInsertionEffect:function(e,t){return Xh(4,2,e,t)},useMemo:function(e,t){var r=va();return t=t===void 0?null:t,e=e(),r.memoizedState=[e,t],e},useReducer:function(e,t,r){var n=va();return t=r!==void 0?r(t):t,n.memoizedState=n.baseState=t,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:t},n.queue=e,e=e.dispatch=GO.bind(null,ar,e),[n.memoizedState,e]},useRef:function(e){var t=va();return e={current:e},t.memoizedState=e},useState:eb,useDebugValue:Ky,useDeferredValue:function(e){return va().memoizedState=e},useTransition:function(){var e=eb(!1),t=e[0];return e=HO.bind(null,e[1]),va().memoizedState=e,[t,e]},useMutableSource:function(){},useSyncExternalStore:function(e,t,r){var n=ar,s=va();if(er){if(r===void 0)throw Error(Fe(407));r=r()}else{if(r=t(),Gr===null)throw Error(Fe(349));el&30||$j(n,t,r)}s.memoizedState=r;var a={value:r,getSnapshot:t};return s.queue=a,tb(Uj.bind(null,n,a,e),[e]),n.flags|=2048,Od(9,Bj.bind(null,n,a,r,t),void 0,null),r},useId:function(){var e=va(),t=Gr.identifierPrefix;if(er){var r=Xa,n=Ka;r=(n&~(1<<32-Js(n)-1)).toString(32)+r,t=":"+t+"R"+r,r=Rd++,0<r&&(t+="H"+r.toString(32)),t+=":"}else r=WO++,t=":"+t+"r"+r.toString(32)+":";return e.memoizedState=t},unstable_isNewReconciler:!1},KO={readContext:ks,useCallback:Kj,useContext:ks,useEffect:Yy,useImperativeHandle:Yj,useInsertionEffect:Hj,useLayoutEffect:Gj,useMemo:Xj,useReducer:Sg,useRef:Wj,useState:function(){return Sg(Md)},useDebugValue:Ky,useDeferredValue:function(e){var t=Cs();return Qj(t,Dr.memoizedState,e)},useTransition:function(){var e=Sg(Md)[0],t=Cs().memoizedState;return[e,t]},useMutableSource:Ij,useSyncExternalStore:Lj,useId:Jj,unstable_isNewReconciler:!1},XO={readContext:ks,useCallback:Kj,useContext:ks,useEffect:Yy,useImperativeHandle:Yj,useInsertionEffect:Hj,useLayoutEffect:Gj,useMemo:Xj,useReducer:Ng,useRef:Wj,useState:function(){return Ng(Md)},useDebugValue:Ky,useDeferredValue:function(e){var t=Cs();return Dr===null?t.memoizedState=e:Qj(t,Dr.memoizedState,e)},useTransition:function(){var e=Ng(Md)[0],t=Cs().memoizedState;return[e,t]},useMutableSource:Ij,useSyncExternalStore:Lj,useId:Jj,unstable_isNewReconciler:!1};function Bs(e,t){if(e&&e.defaultProps){t=ir({},t),e=e.defaultProps;for(var r in e)t[r]===void 0&&(t[r]=e[r]);return t}return t}function Zx(e,t,r,n){t=e.memoizedState,r=r(n,t),r=r==null?t:ir({},t,r),e.memoizedState=r,e.lanes===0&&(e.updateQueue.baseState=r)}var F0={isMounted:function(e){return(e=e._reactInternals)?gl(e)===e:!1},enqueueSetState:function(e,t,r){e=e._reactInternals;var n=En(),s=eo(e),a=ei(n,s);a.payload=t,r!=null&&(a.callback=r),t=Ji(e,a,s),t!==null&&(Zs(t,e,s,n),Yh(t,e,s))},enqueueReplaceState:function(e,t,r){e=e._reactInternals;var n=En(),s=eo(e),a=ei(n,s);a.tag=1,a.payload=t,r!=null&&(a.callback=r),t=Ji(e,a,s),t!==null&&(Zs(t,e,s,n),Yh(t,e,s))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var r=En(),n=eo(e),s=ei(r,n);s.tag=2,t!=null&&(s.callback=t),t=Ji(e,s,n),t!==null&&(Zs(t,e,n,r),Yh(t,e,n))}};function rb(e,t,r,n,s,a,o){return e=e.stateNode,typeof e.shouldComponentUpdate=="function"?e.shouldComponentUpdate(n,a,o):t.prototype&&t.prototype.isPureReactComponent?!kd(r,n)||!kd(s,a):!0}function rE(e,t,r){var n=!1,s=io,a=t.contextType;return typeof a=="object"&&a!==null?a=ks(a):(s=Un(t)?Jo:vn.current,n=t.contextTypes,a=(n=n!=null)?Pc(e,s):io),t=new t(r,a),e.memoizedState=t.state!==null&&t.state!==void 0?t.state:null,t.updater=F0,e.stateNode=t,t._reactInternals=e,n&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=s,e.__reactInternalMemoizedMaskedChildContext=a),t}function nb(e,t,r,n){e=t.state,typeof t.componentWillReceiveProps=="function"&&t.componentWillReceiveProps(r,n),typeof t.UNSAFE_componentWillReceiveProps=="function"&&t.UNSAFE_componentWillReceiveProps(r,n),t.state!==e&&F0.enqueueReplaceState(t,t.state,null)}function ev(e,t,r,n){var s=e.stateNode;s.props=r,s.state=e.memoizedState,s.refs={},Uy(e);var a=t.contextType;typeof a=="object"&&a!==null?s.context=ks(a):(a=Un(t)?Jo:vn.current,s.context=Pc(e,a)),s.state=e.memoizedState,a=t.getDerivedStateFromProps,typeof a=="function"&&(Zx(e,t,a,r),s.state=e.memoizedState),typeof t.getDerivedStateFromProps=="function"||typeof s.getSnapshotBeforeUpdate=="function"||typeof s.UNSAFE_componentWillMount!="function"&&typeof s.componentWillMount!="function"||(t=s.state,typeof s.componentWillMount=="function"&&s.componentWillMount(),typeof s.UNSAFE_componentWillMount=="function"&&s.UNSAFE_componentWillMount(),t!==s.state&&F0.enqueueReplaceState(s,s.state,null),Pm(e,r,s,n),s.state=e.memoizedState),typeof s.componentDidMount=="function"&&(e.flags|=4194308)}function Oc(e,t){try{var r="",n=t;do r+=NM(n),n=n.return;while(n);var s=r}catch(a){s=`
Error generating stack: `+a.message+`
`+a.stack}return{value:e,source:t,stack:s,digest:null}}function jg(e,t,r){return{value:e,source:null,stack:r??null,digest:t??null}}function tv(e,t){try{console.error(t.value)}catch(r){setTimeout(function(){throw r})}}var QO=typeof WeakMap=="function"?WeakMap:Map;function nE(e,t,r){r=ei(-1,r),r.tag=3,r.payload={element:null};var n=t.value;return r.callback=function(){Fm||(Fm=!0,dv=n),tv(e,t)},r}function sE(e,t,r){r=ei(-1,r),r.tag=3;var n=e.type.getDerivedStateFromError;if(typeof n=="function"){var s=t.value;r.payload=function(){return n(s)},r.callback=function(){tv(e,t)}}var a=e.stateNode;return a!==null&&typeof a.componentDidCatch=="function"&&(r.callback=function(){tv(e,t),typeof n!="function"&&(Zi===null?Zi=new Set([this]):Zi.add(this));var o=t.stack;this.componentDidCatch(t.value,{componentStack:o!==null?o:""})}),r}function sb(e,t,r){var n=e.pingCache;if(n===null){n=e.pingCache=new QO;var s=new Set;n.set(t,s)}else s=n.get(t),s===void 0&&(s=new Set,n.set(t,s));s.has(r)||(s.add(r),e=d5.bind(null,e,t,r),t.then(e,e))}function ab(e){do{var t;if((t=e.tag===13)&&(t=e.memoizedState,t=t!==null?t.dehydrated!==null:!0),t)return e;e=e.return}while(e!==null);return null}function ib(e,t,r,n,s){return e.mode&1?(e.flags|=65536,e.lanes=s,e):(e===t?e.flags|=65536:(e.flags|=128,r.flags|=131072,r.flags&=-52805,r.tag===1&&(r.alternate===null?r.tag=17:(t=ei(-1,1),t.tag=2,Ji(r,t,1))),r.lanes|=1),e)}var JO=xi.ReactCurrentOwner,Ln=!1;function bn(e,t,r,n){t.child=e===null?Rj(t,null,r,n):Rc(t,e.child,r,n)}function ob(e,t,r,n,s){r=r.render;var a=t.ref;return dc(t,s),n=Gy(e,t,r,n,a,s),r=qy(),e!==null&&!Ln?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~s,ui(e,t,s)):(er&&r&&My(t),t.flags|=1,bn(e,t,n,s),t.child)}function lb(e,t,r,n,s){if(e===null){var a=r.type;return typeof a=="function"&&!n1(a)&&a.defaultProps===void 0&&r.compare===null&&r.defaultProps===void 0?(t.tag=15,t.type=a,aE(e,t,a,n,s)):(e=em(r.type,null,n,t,t.mode,s),e.ref=t.ref,e.return=t,t.child=e)}if(a=e.child,!(e.lanes&s)){var o=a.memoizedProps;if(r=r.compare,r=r!==null?r:kd,r(o,n)&&e.ref===t.ref)return ui(e,t,s)}return t.flags|=1,e=to(a,n),e.ref=t.ref,e.return=t,t.child=e}function aE(e,t,r,n,s){if(e!==null){var a=e.memoizedProps;if(kd(a,n)&&e.ref===t.ref)if(Ln=!1,t.pendingProps=n=a,(e.lanes&s)!==0)e.flags&131072&&(Ln=!0);else return t.lanes=e.lanes,ui(e,t,s)}return rv(e,t,r,n,s)}function iE(e,t,r){var n=t.pendingProps,s=n.children,a=e!==null?e.memoizedState:null;if(n.mode==="hidden")if(!(t.mode&1))t.memoizedState={baseLanes:0,cachePool:null,transitions:null},Wt(sc,Zn),Zn|=r;else{if(!(r&1073741824))return e=a!==null?a.baseLanes|r:r,t.lanes=t.childLanes=1073741824,t.memoizedState={baseLanes:e,cachePool:null,transitions:null},t.updateQueue=null,Wt(sc,Zn),Zn|=e,null;t.memoizedState={baseLanes:0,cachePool:null,transitions:null},n=a!==null?a.baseLanes:r,Wt(sc,Zn),Zn|=n}else a!==null?(n=a.baseLanes|r,t.memoizedState=null):n=r,Wt(sc,Zn),Zn|=n;return bn(e,t,s,r),t.child}function oE(e,t){var r=t.ref;(e===null&&r!==null||e!==null&&e.ref!==r)&&(t.flags|=512,t.flags|=2097152)}function rv(e,t,r,n,s){var a=Un(r)?Jo:vn.current;return a=Pc(t,a),dc(t,s),r=Gy(e,t,r,n,a,s),n=qy(),e!==null&&!Ln?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~s,ui(e,t,s)):(er&&n&&My(t),t.flags|=1,bn(e,t,r,s),t.child)}function cb(e,t,r,n,s){if(Un(r)){var a=!0;Em(t)}else a=!1;if(dc(t,s),t.stateNode===null)Qh(e,t),rE(t,r,n),ev(t,r,n,s),n=!0;else if(e===null){var o=t.stateNode,l=t.memoizedProps;o.props=l;var c=o.context,u=r.contextType;typeof u=="object"&&u!==null?u=ks(u):(u=Un(r)?Jo:vn.current,u=Pc(t,u));var d=r.getDerivedStateFromProps,f=typeof d=="function"||typeof o.getSnapshotBeforeUpdate=="function";f||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(l!==n||c!==u)&&nb(t,o,n,u),Ti=!1;var p=t.memoizedState;o.state=p,Pm(t,n,o,s),c=t.memoizedState,l!==n||p!==c||Bn.current||Ti?(typeof d=="function"&&(Zx(t,r,d,n),c=t.memoizedState),(l=Ti||rb(t,r,l,n,p,c,u))?(f||typeof o.UNSAFE_componentWillMount!="function"&&typeof o.componentWillMount!="function"||(typeof o.componentWillMount=="function"&&o.componentWillMount(),typeof o.UNSAFE_componentWillMount=="function"&&o.UNSAFE_componentWillMount()),typeof o.componentDidMount=="function"&&(t.flags|=4194308)):(typeof o.componentDidMount=="function"&&(t.flags|=4194308),t.memoizedProps=n,t.memoizedState=c),o.props=n,o.state=c,o.context=u,n=l):(typeof o.componentDidMount=="function"&&(t.flags|=4194308),n=!1)}else{o=t.stateNode,Oj(e,t),l=t.memoizedProps,u=t.type===t.elementType?l:Bs(t.type,l),o.props=u,f=t.pendingProps,p=o.context,c=r.contextType,typeof c=="object"&&c!==null?c=ks(c):(c=Un(r)?Jo:vn.current,c=Pc(t,c));var h=r.getDerivedStateFromProps;(d=typeof h=="function"||typeof o.getSnapshotBeforeUpdate=="function")||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(l!==f||p!==c)&&nb(t,o,n,c),Ti=!1,p=t.memoizedState,o.state=p,Pm(t,n,o,s);var g=t.memoizedState;l!==f||p!==g||Bn.current||Ti?(typeof h=="function"&&(Zx(t,r,h,n),g=t.memoizedState),(u=Ti||rb(t,r,u,n,p,g,c)||!1)?(d||typeof o.UNSAFE_componentWillUpdate!="function"&&typeof o.componentWillUpdate!="function"||(typeof o.componentWillUpdate=="function"&&o.componentWillUpdate(n,g,c),typeof o.UNSAFE_componentWillUpdate=="function"&&o.UNSAFE_componentWillUpdate(n,g,c)),typeof o.componentDidUpdate=="function"&&(t.flags|=4),typeof o.getSnapshotBeforeUpdate=="function"&&(t.flags|=1024)):(typeof o.componentDidUpdate!="function"||l===e.memoizedProps&&p===e.memoizedState||(t.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||l===e.memoizedProps&&p===e.memoizedState||(t.flags|=1024),t.memoizedProps=n,t.memoizedState=g),o.props=n,o.state=g,o.context=c,n=u):(typeof o.componentDidUpdate!="function"||l===e.memoizedProps&&p===e.memoizedState||(t.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||l===e.memoizedProps&&p===e.memoizedState||(t.flags|=1024),n=!1)}return nv(e,t,r,n,a,s)}function nv(e,t,r,n,s,a){oE(e,t);var o=(t.flags&128)!==0;if(!n&&!o)return s&&Y_(t,r,!1),ui(e,t,a);n=t.stateNode,JO.current=t;var l=o&&typeof r.getDerivedStateFromError!="function"?null:n.render();return t.flags|=1,e!==null&&o?(t.child=Rc(t,e.child,null,a),t.child=Rc(t,null,l,a)):bn(e,t,l,a),t.memoizedState=n.state,s&&Y_(t,r,!0),t.child}function lE(e){var t=e.stateNode;t.pendingContext?q_(e,t.pendingContext,t.pendingContext!==t.context):t.context&&q_(e,t.context,!1),zy(e,t.containerInfo)}function ub(e,t,r,n,s){return Dc(),Fy(s),t.flags|=256,bn(e,t,r,n),t.child}var sv={dehydrated:null,treeContext:null,retryLane:0};function av(e){return{baseLanes:e,cachePool:null,transitions:null}}function cE(e,t,r){var n=t.pendingProps,s=sr.current,a=!1,o=(t.flags&128)!==0,l;if((l=o)||(l=e!==null&&e.memoizedState===null?!1:(s&2)!==0),l?(a=!0,t.flags&=-129):(e===null||e.memoizedState!==null)&&(s|=1),Wt(sr,s&1),e===null)return Qx(t),e=t.memoizedState,e!==null&&(e=e.dehydrated,e!==null)?(t.mode&1?e.data==="$!"?t.lanes=8:t.lanes=1073741824:t.lanes=1,null):(o=n.children,e=n.fallback,a?(n=t.mode,a=t.child,o={mode:"hidden",children:o},!(n&1)&&a!==null?(a.childLanes=0,a.pendingProps=o):a=$0(o,n,0,null),e=Ko(e,n,r,null),a.return=t,e.return=t,a.sibling=e,t.child=a,t.child.memoizedState=av(r),t.memoizedState=sv,e):Xy(t,o));if(s=e.memoizedState,s!==null&&(l=s.dehydrated,l!==null))return ZO(e,t,o,n,l,s,r);if(a){a=n.fallback,o=t.mode,s=e.child,l=s.sibling;var c={mode:"hidden",children:n.children};return!(o&1)&&t.child!==s?(n=t.child,n.childLanes=0,n.pendingProps=c,t.deletions=null):(n=to(s,c),n.subtreeFlags=s.subtreeFlags&14680064),l!==null?a=to(l,a):(a=Ko(a,o,r,null),a.flags|=2),a.return=t,n.return=t,n.sibling=a,t.child=n,n=a,a=t.child,o=e.child.memoizedState,o=o===null?av(r):{baseLanes:o.baseLanes|r,cachePool:null,transitions:o.transitions},a.memoizedState=o,a.childLanes=e.childLanes&~r,t.memoizedState=sv,n}return a=e.child,e=a.sibling,n=to(a,{mode:"visible",children:n.children}),!(t.mode&1)&&(n.lanes=r),n.return=t,n.sibling=null,e!==null&&(r=t.deletions,r===null?(t.deletions=[e],t.flags|=16):r.push(e)),t.child=n,t.memoizedState=null,n}function Xy(e,t){return t=$0({mode:"visible",children:t},e.mode,0,null),t.return=e,e.child=t}function mh(e,t,r,n){return n!==null&&Fy(n),Rc(t,e.child,null,r),e=Xy(t,t.pendingProps.children),e.flags|=2,t.memoizedState=null,e}function ZO(e,t,r,n,s,a,o){if(r)return t.flags&256?(t.flags&=-257,n=jg(Error(Fe(422))),mh(e,t,o,n)):t.memoizedState!==null?(t.child=e.child,t.flags|=128,null):(a=n.fallback,s=t.mode,n=$0({mode:"visible",children:n.children},s,0,null),a=Ko(a,s,o,null),a.flags|=2,n.return=t,a.return=t,n.sibling=a,t.child=n,t.mode&1&&Rc(t,e.child,null,o),t.child.memoizedState=av(o),t.memoizedState=sv,a);if(!(t.mode&1))return mh(e,t,o,null);if(s.data==="$!"){if(n=s.nextSibling&&s.nextSibling.dataset,n)var l=n.dgst;return n=l,a=Error(Fe(419)),n=jg(a,n,void 0),mh(e,t,o,n)}if(l=(o&e.childLanes)!==0,Ln||l){if(n=Gr,n!==null){switch(o&-o){case 4:s=2;break;case 16:s=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:s=32;break;case 536870912:s=268435456;break;default:s=0}s=s&(n.suspendedLanes|o)?0:s,s!==0&&s!==a.retryLane&&(a.retryLane=s,ci(e,s),Zs(n,e,s,-1))}return r1(),n=jg(Error(Fe(421))),mh(e,t,o,n)}return s.data==="$?"?(t.flags|=128,t.child=e.child,t=f5.bind(null,e),s._reactRetry=t,null):(e=a.treeContext,ss=Qi(s.nextSibling),is=t,er=!0,Hs=null,e!==null&&(_s[bs++]=Ka,_s[bs++]=Xa,_s[bs++]=Zo,Ka=e.id,Xa=e.overflow,Zo=t),t=Xy(t,n.children),t.flags|=4096,t)}function db(e,t,r){e.lanes|=t;var n=e.alternate;n!==null&&(n.lanes|=t),Jx(e.return,t,r)}function Eg(e,t,r,n,s){var a=e.memoizedState;a===null?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:n,tail:r,tailMode:s}:(a.isBackwards=t,a.rendering=null,a.renderingStartTime=0,a.last=n,a.tail=r,a.tailMode=s)}function uE(e,t,r){var n=t.pendingProps,s=n.revealOrder,a=n.tail;if(bn(e,t,n.children,r),n=sr.current,n&2)n=n&1|2,t.flags|=128;else{if(e!==null&&e.flags&128)e:for(e=t.child;e!==null;){if(e.tag===13)e.memoizedState!==null&&db(e,r,t);else if(e.tag===19)db(e,r,t);else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;e.sibling===null;){if(e.return===null||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}n&=1}if(Wt(sr,n),!(t.mode&1))t.memoizedState=null;else switch(s){case"forwards":for(r=t.child,s=null;r!==null;)e=r.alternate,e!==null&&Dm(e)===null&&(s=r),r=r.sibling;r=s,r===null?(s=t.child,t.child=null):(s=r.sibling,r.sibling=null),Eg(t,!1,s,r,a);break;case"backwards":for(r=null,s=t.child,t.child=null;s!==null;){if(e=s.alternate,e!==null&&Dm(e)===null){t.child=s;break}e=s.sibling,s.sibling=r,r=s,s=e}Eg(t,!0,r,null,a);break;case"together":Eg(t,!1,null,null,void 0);break;default:t.memoizedState=null}return t.child}function Qh(e,t){!(t.mode&1)&&e!==null&&(e.alternate=null,t.alternate=null,t.flags|=2)}function ui(e,t,r){if(e!==null&&(t.dependencies=e.dependencies),tl|=t.lanes,!(r&t.childLanes))return null;if(e!==null&&t.child!==e.child)throw Error(Fe(153));if(t.child!==null){for(e=t.child,r=to(e,e.pendingProps),t.child=r,r.return=t;e.sibling!==null;)e=e.sibling,r=r.sibling=to(e,e.pendingProps),r.return=t;r.sibling=null}return t.child}function e5(e,t,r){switch(t.tag){case 3:lE(t),Dc();break;case 5:Fj(t);break;case 1:Un(t.type)&&Em(t);break;case 4:zy(t,t.stateNode.containerInfo);break;case 10:var n=t.type._context,s=t.memoizedProps.value;Wt(Tm,n._currentValue),n._currentValue=s;break;case 13:if(n=t.memoizedState,n!==null)return n.dehydrated!==null?(Wt(sr,sr.current&1),t.flags|=128,null):r&t.child.childLanes?cE(e,t,r):(Wt(sr,sr.current&1),e=ui(e,t,r),e!==null?e.sibling:null);Wt(sr,sr.current&1);break;case 19:if(n=(r&t.childLanes)!==0,e.flags&128){if(n)return uE(e,t,r);t.flags|=128}if(s=t.memoizedState,s!==null&&(s.rendering=null,s.tail=null,s.lastEffect=null),Wt(sr,sr.current),n)break;return null;case 22:case 23:return t.lanes=0,iE(e,t,r)}return ui(e,t,r)}var dE,iv,fE,hE;dE=function(e,t){for(var r=t.child;r!==null;){if(r.tag===5||r.tag===6)e.appendChild(r.stateNode);else if(r.tag!==4&&r.child!==null){r.child.return=r,r=r.child;continue}if(r===t)break;for(;r.sibling===null;){if(r.return===null||r.return===t)return;r=r.return}r.sibling.return=r.return,r=r.sibling}};iv=function(){};fE=function(e,t,r,n){var s=e.memoizedProps;if(s!==n){e=t.stateNode,$o(Ca.current);var a=null;switch(r){case"input":s=Cx(e,s),n=Cx(e,n),a=[];break;case"select":s=ir({},s,{value:void 0}),n=ir({},n,{value:void 0}),a=[];break;case"textarea":s=Px(e,s),n=Px(e,n),a=[];break;default:typeof s.onClick!="function"&&typeof n.onClick=="function"&&(e.onclick=Nm)}Rx(r,n);var o;r=null;for(u in s)if(!n.hasOwnProperty(u)&&s.hasOwnProperty(u)&&s[u]!=null)if(u==="style"){var l=s[u];for(o in l)l.hasOwnProperty(o)&&(r||(r={}),r[o]="")}else u!=="dangerouslySetInnerHTML"&&u!=="children"&&u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&u!=="autoFocus"&&(wd.hasOwnProperty(u)?a||(a=[]):(a=a||[]).push(u,null));for(u in n){var c=n[u];if(l=s!=null?s[u]:void 0,n.hasOwnProperty(u)&&c!==l&&(c!=null||l!=null))if(u==="style")if(l){for(o in l)!l.hasOwnProperty(o)||c&&c.hasOwnProperty(o)||(r||(r={}),r[o]="");for(o in c)c.hasOwnProperty(o)&&l[o]!==c[o]&&(r||(r={}),r[o]=c[o])}else r||(a||(a=[]),a.push(u,r)),r=c;else u==="dangerouslySetInnerHTML"?(c=c?c.__html:void 0,l=l?l.__html:void 0,c!=null&&l!==c&&(a=a||[]).push(u,c)):u==="children"?typeof c!="string"&&typeof c!="number"||(a=a||[]).push(u,""+c):u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&(wd.hasOwnProperty(u)?(c!=null&&u==="onScroll"&&qt("scroll",e),a||l===c||(a=[])):(a=a||[]).push(u,c))}r&&(a=a||[]).push("style",r);var u=a;(t.updateQueue=u)&&(t.flags|=4)}};hE=function(e,t,r,n){r!==n&&(t.flags|=4)};function ku(e,t){if(!er)switch(e.tailMode){case"hidden":t=e.tail;for(var r=null;t!==null;)t.alternate!==null&&(r=t),t=t.sibling;r===null?e.tail=null:r.sibling=null;break;case"collapsed":r=e.tail;for(var n=null;r!==null;)r.alternate!==null&&(n=r),r=r.sibling;n===null?t||e.tail===null?e.tail=null:e.tail.sibling=null:n.sibling=null}}function un(e){var t=e.alternate!==null&&e.alternate.child===e.child,r=0,n=0;if(t)for(var s=e.child;s!==null;)r|=s.lanes|s.childLanes,n|=s.subtreeFlags&14680064,n|=s.flags&14680064,s.return=e,s=s.sibling;else for(s=e.child;s!==null;)r|=s.lanes|s.childLanes,n|=s.subtreeFlags,n|=s.flags,s.return=e,s=s.sibling;return e.subtreeFlags|=n,e.childLanes=r,t}function t5(e,t,r){var n=t.pendingProps;switch(Oy(t),t.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return un(t),null;case 1:return Un(t.type)&&jm(),un(t),null;case 3:return n=t.stateNode,Mc(),Yt(Bn),Yt(vn),Wy(),n.pendingContext&&(n.context=n.pendingContext,n.pendingContext=null),(e===null||e.child===null)&&(fh(t)?t.flags|=4:e===null||e.memoizedState.isDehydrated&&!(t.flags&256)||(t.flags|=1024,Hs!==null&&(mv(Hs),Hs=null))),iv(e,t),un(t),null;case 5:Vy(t);var s=$o(Dd.current);if(r=t.type,e!==null&&t.stateNode!=null)fE(e,t,r,n,s),e.ref!==t.ref&&(t.flags|=512,t.flags|=2097152);else{if(!n){if(t.stateNode===null)throw Error(Fe(166));return un(t),null}if(e=$o(Ca.current),fh(t)){n=t.stateNode,r=t.type;var a=t.memoizedProps;switch(n[Sa]=t,n[Ad]=a,e=(t.mode&1)!==0,r){case"dialog":qt("cancel",n),qt("close",n);break;case"iframe":case"object":case"embed":qt("load",n);break;case"video":case"audio":for(s=0;s<Wu.length;s++)qt(Wu[s],n);break;case"source":qt("error",n);break;case"img":case"image":case"link":qt("error",n),qt("load",n);break;case"details":qt("toggle",n);break;case"input":w_(n,a),qt("invalid",n);break;case"select":n._wrapperState={wasMultiple:!!a.multiple},qt("invalid",n);break;case"textarea":b_(n,a),qt("invalid",n)}Rx(r,a),s=null;for(var o in a)if(a.hasOwnProperty(o)){var l=a[o];o==="children"?typeof l=="string"?n.textContent!==l&&(a.suppressHydrationWarning!==!0&&dh(n.textContent,l,e),s=["children",l]):typeof l=="number"&&n.textContent!==""+l&&(a.suppressHydrationWarning!==!0&&dh(n.textContent,l,e),s=["children",""+l]):wd.hasOwnProperty(o)&&l!=null&&o==="onScroll"&&qt("scroll",n)}switch(r){case"input":nh(n),__(n,a,!0);break;case"textarea":nh(n),S_(n);break;case"select":case"option":break;default:typeof a.onClick=="function"&&(n.onclick=Nm)}n=s,t.updateQueue=n,n!==null&&(t.flags|=4)}else{o=s.nodeType===9?s:s.ownerDocument,e==="http://www.w3.org/1999/xhtml"&&(e=UN(r)),e==="http://www.w3.org/1999/xhtml"?r==="script"?(e=o.createElement("div"),e.innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):typeof n.is=="string"?e=o.createElement(r,{is:n.is}):(e=o.createElement(r),r==="select"&&(o=e,n.multiple?o.multiple=!0:n.size&&(o.size=n.size))):e=o.createElementNS(e,r),e[Sa]=t,e[Ad]=n,dE(e,t,!1,!1),t.stateNode=e;e:{switch(o=Mx(r,n),r){case"dialog":qt("cancel",e),qt("close",e),s=n;break;case"iframe":case"object":case"embed":qt("load",e),s=n;break;case"video":case"audio":for(s=0;s<Wu.length;s++)qt(Wu[s],e);s=n;break;case"source":qt("error",e),s=n;break;case"img":case"image":case"link":qt("error",e),qt("load",e),s=n;break;case"details":qt("toggle",e),s=n;break;case"input":w_(e,n),s=Cx(e,n),qt("invalid",e);break;case"option":s=n;break;case"select":e._wrapperState={wasMultiple:!!n.multiple},s=ir({},n,{value:void 0}),qt("invalid",e);break;case"textarea":b_(e,n),s=Px(e,n),qt("invalid",e);break;default:s=n}Rx(r,s),l=s;for(a in l)if(l.hasOwnProperty(a)){var c=l[a];a==="style"?WN(e,c):a==="dangerouslySetInnerHTML"?(c=c?c.__html:void 0,c!=null&&zN(e,c)):a==="children"?typeof c=="string"?(r!=="textarea"||c!=="")&&_d(e,c):typeof c=="number"&&_d(e,""+c):a!=="suppressContentEditableWarning"&&a!=="suppressHydrationWarning"&&a!=="autoFocus"&&(wd.hasOwnProperty(a)?c!=null&&a==="onScroll"&&qt("scroll",e):c!=null&&wy(e,a,c,o))}switch(r){case"input":nh(e),__(e,n,!1);break;case"textarea":nh(e),S_(e);break;case"option":n.value!=null&&e.setAttribute("value",""+ao(n.value));break;case"select":e.multiple=!!n.multiple,a=n.value,a!=null?oc(e,!!n.multiple,a,!1):n.defaultValue!=null&&oc(e,!!n.multiple,n.defaultValue,!0);break;default:typeof s.onClick=="function"&&(e.onclick=Nm)}switch(r){case"button":case"input":case"select":case"textarea":n=!!n.autoFocus;break e;case"img":n=!0;break e;default:n=!1}}n&&(t.flags|=4)}t.ref!==null&&(t.flags|=512,t.flags|=2097152)}return un(t),null;case 6:if(e&&t.stateNode!=null)hE(e,t,e.memoizedProps,n);else{if(typeof n!="string"&&t.stateNode===null)throw Error(Fe(166));if(r=$o(Dd.current),$o(Ca.current),fh(t)){if(n=t.stateNode,r=t.memoizedProps,n[Sa]=t,(a=n.nodeValue!==r)&&(e=is,e!==null))switch(e.tag){case 3:dh(n.nodeValue,r,(e.mode&1)!==0);break;case 5:e.memoizedProps.suppressHydrationWarning!==!0&&dh(n.nodeValue,r,(e.mode&1)!==0)}a&&(t.flags|=4)}else n=(r.nodeType===9?r:r.ownerDocument).createTextNode(n),n[Sa]=t,t.stateNode=n}return un(t),null;case 13:if(Yt(sr),n=t.memoizedState,e===null||e.memoizedState!==null&&e.memoizedState.dehydrated!==null){if(er&&ss!==null&&t.mode&1&&!(t.flags&128))Pj(),Dc(),t.flags|=98560,a=!1;else if(a=fh(t),n!==null&&n.dehydrated!==null){if(e===null){if(!a)throw Error(Fe(318));if(a=t.memoizedState,a=a!==null?a.dehydrated:null,!a)throw Error(Fe(317));a[Sa]=t}else Dc(),!(t.flags&128)&&(t.memoizedState=null),t.flags|=4;un(t),a=!1}else Hs!==null&&(mv(Hs),Hs=null),a=!0;if(!a)return t.flags&65536?t:null}return t.flags&128?(t.lanes=r,t):(n=n!==null,n!==(e!==null&&e.memoizedState!==null)&&n&&(t.child.flags|=8192,t.mode&1&&(e===null||sr.current&1?Rr===0&&(Rr=3):r1())),t.updateQueue!==null&&(t.flags|=4),un(t),null);case 4:return Mc(),iv(e,t),e===null&&Cd(t.stateNode.containerInfo),un(t),null;case 10:return $y(t.type._context),un(t),null;case 17:return Un(t.type)&&jm(),un(t),null;case 19:if(Yt(sr),a=t.memoizedState,a===null)return un(t),null;if(n=(t.flags&128)!==0,o=a.rendering,o===null)if(n)ku(a,!1);else{if(Rr!==0||e!==null&&e.flags&128)for(e=t.child;e!==null;){if(o=Dm(e),o!==null){for(t.flags|=128,ku(a,!1),n=o.updateQueue,n!==null&&(t.updateQueue=n,t.flags|=4),t.subtreeFlags=0,n=r,r=t.child;r!==null;)a=r,e=n,a.flags&=14680066,o=a.alternate,o===null?(a.childLanes=0,a.lanes=e,a.child=null,a.subtreeFlags=0,a.memoizedProps=null,a.memoizedState=null,a.updateQueue=null,a.dependencies=null,a.stateNode=null):(a.childLanes=o.childLanes,a.lanes=o.lanes,a.child=o.child,a.subtreeFlags=0,a.deletions=null,a.memoizedProps=o.memoizedProps,a.memoizedState=o.memoizedState,a.updateQueue=o.updateQueue,a.type=o.type,e=o.dependencies,a.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext}),r=r.sibling;return Wt(sr,sr.current&1|2),t.child}e=e.sibling}a.tail!==null&&vr()>Fc&&(t.flags|=128,n=!0,ku(a,!1),t.lanes=4194304)}else{if(!n)if(e=Dm(o),e!==null){if(t.flags|=128,n=!0,r=e.updateQueue,r!==null&&(t.updateQueue=r,t.flags|=4),ku(a,!0),a.tail===null&&a.tailMode==="hidden"&&!o.alternate&&!er)return un(t),null}else 2*vr()-a.renderingStartTime>Fc&&r!==1073741824&&(t.flags|=128,n=!0,ku(a,!1),t.lanes=4194304);a.isBackwards?(o.sibling=t.child,t.child=o):(r=a.last,r!==null?r.sibling=o:t.child=o,a.last=o)}return a.tail!==null?(t=a.tail,a.rendering=t,a.tail=t.sibling,a.renderingStartTime=vr(),t.sibling=null,r=sr.current,Wt(sr,n?r&1|2:r&1),t):(un(t),null);case 22:case 23:return t1(),n=t.memoizedState!==null,e!==null&&e.memoizedState!==null!==n&&(t.flags|=8192),n&&t.mode&1?Zn&1073741824&&(un(t),t.subtreeFlags&6&&(t.flags|=8192)):un(t),null;case 24:return null;case 25:return null}throw Error(Fe(156,t.tag))}function r5(e,t){switch(Oy(t),t.tag){case 1:return Un(t.type)&&jm(),e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 3:return Mc(),Yt(Bn),Yt(vn),Wy(),e=t.flags,e&65536&&!(e&128)?(t.flags=e&-65537|128,t):null;case 5:return Vy(t),null;case 13:if(Yt(sr),e=t.memoizedState,e!==null&&e.dehydrated!==null){if(t.alternate===null)throw Error(Fe(340));Dc()}return e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 19:return Yt(sr),null;case 4:return Mc(),null;case 10:return $y(t.type._context),null;case 22:case 23:return t1(),null;case 24:return null;default:return null}}var ph=!1,mn=!1,n5=typeof WeakSet=="function"?WeakSet:Set,qe=null;function nc(e,t){var r=e.ref;if(r!==null)if(typeof r=="function")try{r(null)}catch(n){cr(e,t,n)}else r.current=null}function ov(e,t,r){try{r()}catch(n){cr(e,t,n)}}var fb=!1;function s5(e,t){if(Wx=_m,e=vj(),Ry(e)){if("selectionStart"in e)var r={start:e.selectionStart,end:e.selectionEnd};else e:{r=(r=e.ownerDocument)&&r.defaultView||window;var n=r.getSelection&&r.getSelection();if(n&&n.rangeCount!==0){r=n.anchorNode;var s=n.anchorOffset,a=n.focusNode;n=n.focusOffset;try{r.nodeType,a.nodeType}catch{r=null;break e}var o=0,l=-1,c=-1,u=0,d=0,f=e,p=null;t:for(;;){for(var h;f!==r||s!==0&&f.nodeType!==3||(l=o+s),f!==a||n!==0&&f.nodeType!==3||(c=o+n),f.nodeType===3&&(o+=f.nodeValue.length),(h=f.firstChild)!==null;)p=f,f=h;for(;;){if(f===e)break t;if(p===r&&++u===s&&(l=o),p===a&&++d===n&&(c=o),(h=f.nextSibling)!==null)break;f=p,p=f.parentNode}f=h}r=l===-1||c===-1?null:{start:l,end:c}}else r=null}r=r||{start:0,end:0}}else r=null;for(Hx={focusedElem:e,selectionRange:r},_m=!1,qe=t;qe!==null;)if(t=qe,e=t.child,(t.subtreeFlags&1028)!==0&&e!==null)e.return=t,qe=e;else for(;qe!==null;){t=qe;try{var g=t.alternate;if(t.flags&1024)switch(t.tag){case 0:case 11:case 15:break;case 1:if(g!==null){var m=g.memoizedProps,x=g.memoizedState,w=t.stateNode,v=w.getSnapshotBeforeUpdate(t.elementType===t.type?m:Bs(t.type,m),x);w.__reactInternalSnapshotBeforeUpdate=v}break;case 3:var _=t.stateNode.containerInfo;_.nodeType===1?_.textContent="":_.nodeType===9&&_.documentElement&&_.removeChild(_.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(Fe(163))}}catch(b){cr(t,t.return,b)}if(e=t.sibling,e!==null){e.return=t.return,qe=e;break}qe=t.return}return g=fb,fb=!1,g}function nd(e,t,r){var n=t.updateQueue;if(n=n!==null?n.lastEffect:null,n!==null){var s=n=n.next;do{if((s.tag&e)===e){var a=s.destroy;s.destroy=void 0,a!==void 0&&ov(t,r,a)}s=s.next}while(s!==n)}}function I0(e,t){if(t=t.updateQueue,t=t!==null?t.lastEffect:null,t!==null){var r=t=t.next;do{if((r.tag&e)===e){var n=r.create;r.destroy=n()}r=r.next}while(r!==t)}}function lv(e){var t=e.ref;if(t!==null){var r=e.stateNode;switch(e.tag){case 5:e=r;break;default:e=r}typeof t=="function"?t(e):t.current=e}}function mE(e){var t=e.alternate;t!==null&&(e.alternate=null,mE(t)),e.child=null,e.deletions=null,e.sibling=null,e.tag===5&&(t=e.stateNode,t!==null&&(delete t[Sa],delete t[Ad],delete t[Yx],delete t[BO],delete t[UO])),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function pE(e){return e.tag===5||e.tag===3||e.tag===4}function hb(e){e:for(;;){for(;e.sibling===null;){if(e.return===null||pE(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;e.tag!==5&&e.tag!==6&&e.tag!==18;){if(e.flags&2||e.child===null||e.tag===4)continue e;e.child.return=e,e=e.child}if(!(e.flags&2))return e.stateNode}}function cv(e,t,r){var n=e.tag;if(n===5||n===6)e=e.stateNode,t?r.nodeType===8?r.parentNode.insertBefore(e,t):r.insertBefore(e,t):(r.nodeType===8?(t=r.parentNode,t.insertBefore(e,r)):(t=r,t.appendChild(e)),r=r._reactRootContainer,r!=null||t.onclick!==null||(t.onclick=Nm));else if(n!==4&&(e=e.child,e!==null))for(cv(e,t,r),e=e.sibling;e!==null;)cv(e,t,r),e=e.sibling}function uv(e,t,r){var n=e.tag;if(n===5||n===6)e=e.stateNode,t?r.insertBefore(e,t):r.appendChild(e);else if(n!==4&&(e=e.child,e!==null))for(uv(e,t,r),e=e.sibling;e!==null;)uv(e,t,r),e=e.sibling}var Kr=null,Vs=!1;function wi(e,t,r){for(r=r.child;r!==null;)gE(e,t,r),r=r.sibling}function gE(e,t,r){if(ka&&typeof ka.onCommitFiberUnmount=="function")try{ka.onCommitFiberUnmount(T0,r)}catch{}switch(r.tag){case 5:mn||nc(r,t);case 6:var n=Kr,s=Vs;Kr=null,wi(e,t,r),Kr=n,Vs=s,Kr!==null&&(Vs?(e=Kr,r=r.stateNode,e.nodeType===8?e.parentNode.removeChild(r):e.removeChild(r)):Kr.removeChild(r.stateNode));break;case 18:Kr!==null&&(Vs?(e=Kr,r=r.stateNode,e.nodeType===8?yg(e.parentNode,r):e.nodeType===1&&yg(e,r),jd(e)):yg(Kr,r.stateNode));break;case 4:n=Kr,s=Vs,Kr=r.stateNode.containerInfo,Vs=!0,wi(e,t,r),Kr=n,Vs=s;break;case 0:case 11:case 14:case 15:if(!mn&&(n=r.updateQueue,n!==null&&(n=n.lastEffect,n!==null))){s=n=n.next;do{var a=s,o=a.destroy;a=a.tag,o!==void 0&&(a&2||a&4)&&ov(r,t,o),s=s.next}while(s!==n)}wi(e,t,r);break;case 1:if(!mn&&(nc(r,t),n=r.stateNode,typeof n.componentWillUnmount=="function"))try{n.props=r.memoizedProps,n.state=r.memoizedState,n.componentWillUnmount()}catch(l){cr(r,t,l)}wi(e,t,r);break;case 21:wi(e,t,r);break;case 22:r.mode&1?(mn=(n=mn)||r.memoizedState!==null,wi(e,t,r),mn=n):wi(e,t,r);break;default:wi(e,t,r)}}function mb(e){var t=e.updateQueue;if(t!==null){e.updateQueue=null;var r=e.stateNode;r===null&&(r=e.stateNode=new n5),t.forEach(function(n){var s=h5.bind(null,e,n);r.has(n)||(r.add(n),n.then(s,s))})}}function Ms(e,t){var r=t.deletions;if(r!==null)for(var n=0;n<r.length;n++){var s=r[n];try{var a=e,o=t,l=o;e:for(;l!==null;){switch(l.tag){case 5:Kr=l.stateNode,Vs=!1;break e;case 3:Kr=l.stateNode.containerInfo,Vs=!0;break e;case 4:Kr=l.stateNode.containerInfo,Vs=!0;break e}l=l.return}if(Kr===null)throw Error(Fe(160));gE(a,o,s),Kr=null,Vs=!1;var c=s.alternate;c!==null&&(c.return=null),s.return=null}catch(u){cr(s,t,u)}}if(t.subtreeFlags&12854)for(t=t.child;t!==null;)xE(t,e),t=t.sibling}function xE(e,t){var r=e.alternate,n=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:if(Ms(t,e),ma(e),n&4){try{nd(3,e,e.return),I0(3,e)}catch(m){cr(e,e.return,m)}try{nd(5,e,e.return)}catch(m){cr(e,e.return,m)}}break;case 1:Ms(t,e),ma(e),n&512&&r!==null&&nc(r,r.return);break;case 5:if(Ms(t,e),ma(e),n&512&&r!==null&&nc(r,r.return),e.flags&32){var s=e.stateNode;try{_d(s,"")}catch(m){cr(e,e.return,m)}}if(n&4&&(s=e.stateNode,s!=null)){var a=e.memoizedProps,o=r!==null?r.memoizedProps:a,l=e.type,c=e.updateQueue;if(e.updateQueue=null,c!==null)try{l==="input"&&a.type==="radio"&&a.name!=null&&$N(s,a),Mx(l,o);var u=Mx(l,a);for(o=0;o<c.length;o+=2){var d=c[o],f=c[o+1];d==="style"?WN(s,f):d==="dangerouslySetInnerHTML"?zN(s,f):d==="children"?_d(s,f):wy(s,d,f,u)}switch(l){case"input":Tx(s,a);break;case"textarea":BN(s,a);break;case"select":var p=s._wrapperState.wasMultiple;s._wrapperState.wasMultiple=!!a.multiple;var h=a.value;h!=null?oc(s,!!a.multiple,h,!1):p!==!!a.multiple&&(a.defaultValue!=null?oc(s,!!a.multiple,a.defaultValue,!0):oc(s,!!a.multiple,a.multiple?[]:"",!1))}s[Ad]=a}catch(m){cr(e,e.return,m)}}break;case 6:if(Ms(t,e),ma(e),n&4){if(e.stateNode===null)throw Error(Fe(162));s=e.stateNode,a=e.memoizedProps;try{s.nodeValue=a}catch(m){cr(e,e.return,m)}}break;case 3:if(Ms(t,e),ma(e),n&4&&r!==null&&r.memoizedState.isDehydrated)try{jd(t.containerInfo)}catch(m){cr(e,e.return,m)}break;case 4:Ms(t,e),ma(e);break;case 13:Ms(t,e),ma(e),s=e.child,s.flags&8192&&(a=s.memoizedState!==null,s.stateNode.isHidden=a,!a||s.alternate!==null&&s.alternate.memoizedState!==null||(Zy=vr())),n&4&&mb(e);break;case 22:if(d=r!==null&&r.memoizedState!==null,e.mode&1?(mn=(u=mn)||d,Ms(t,e),mn=u):Ms(t,e),ma(e),n&8192){if(u=e.memoizedState!==null,(e.stateNode.isHidden=u)&&!d&&e.mode&1)for(qe=e,d=e.child;d!==null;){for(f=qe=d;qe!==null;){switch(p=qe,h=p.child,p.tag){case 0:case 11:case 14:case 15:nd(4,p,p.return);break;case 1:nc(p,p.return);var g=p.stateNode;if(typeof g.componentWillUnmount=="function"){n=p,r=p.return;try{t=n,g.props=t.memoizedProps,g.state=t.memoizedState,g.componentWillUnmount()}catch(m){cr(n,r,m)}}break;case 5:nc(p,p.return);break;case 22:if(p.memoizedState!==null){gb(f);continue}}h!==null?(h.return=p,qe=h):gb(f)}d=d.sibling}e:for(d=null,f=e;;){if(f.tag===5){if(d===null){d=f;try{s=f.stateNode,u?(a=s.style,typeof a.setProperty=="function"?a.setProperty("display","none","important"):a.display="none"):(l=f.stateNode,c=f.memoizedProps.style,o=c!=null&&c.hasOwnProperty("display")?c.display:null,l.style.display=VN("display",o))}catch(m){cr(e,e.return,m)}}}else if(f.tag===6){if(d===null)try{f.stateNode.nodeValue=u?"":f.memoizedProps}catch(m){cr(e,e.return,m)}}else if((f.tag!==22&&f.tag!==23||f.memoizedState===null||f===e)&&f.child!==null){f.child.return=f,f=f.child;continue}if(f===e)break e;for(;f.sibling===null;){if(f.return===null||f.return===e)break e;d===f&&(d=null),f=f.return}d===f&&(d=null),f.sibling.return=f.return,f=f.sibling}}break;case 19:Ms(t,e),ma(e),n&4&&mb(e);break;case 21:break;default:Ms(t,e),ma(e)}}function ma(e){var t=e.flags;if(t&2){try{e:{for(var r=e.return;r!==null;){if(pE(r)){var n=r;break e}r=r.return}throw Error(Fe(160))}switch(n.tag){case 5:var s=n.stateNode;n.flags&32&&(_d(s,""),n.flags&=-33);var a=hb(e);uv(e,a,s);break;case 3:case 4:var o=n.stateNode.containerInfo,l=hb(e);cv(e,l,o);break;default:throw Error(Fe(161))}}catch(c){cr(e,e.return,c)}e.flags&=-3}t&4096&&(e.flags&=-4097)}function a5(e,t,r){qe=e,vE(e)}function vE(e,t,r){for(var n=(e.mode&1)!==0;qe!==null;){var s=qe,a=s.child;if(s.tag===22&&n){var o=s.memoizedState!==null||ph;if(!o){var l=s.alternate,c=l!==null&&l.memoizedState!==null||mn;l=ph;var u=mn;if(ph=o,(mn=c)&&!u)for(qe=s;qe!==null;)o=qe,c=o.child,o.tag===22&&o.memoizedState!==null?xb(s):c!==null?(c.return=o,qe=c):xb(s);for(;a!==null;)qe=a,vE(a),a=a.sibling;qe=s,ph=l,mn=u}pb(e)}else s.subtreeFlags&8772&&a!==null?(a.return=s,qe=a):pb(e)}}function pb(e){for(;qe!==null;){var t=qe;if(t.flags&8772){var r=t.alternate;try{if(t.flags&8772)switch(t.tag){case 0:case 11:case 15:mn||I0(5,t);break;case 1:var n=t.stateNode;if(t.flags&4&&!mn)if(r===null)n.componentDidMount();else{var s=t.elementType===t.type?r.memoizedProps:Bs(t.type,r.memoizedProps);n.componentDidUpdate(s,r.memoizedState,n.__reactInternalSnapshotBeforeUpdate)}var a=t.updateQueue;a!==null&&Z_(t,a,n);break;case 3:var o=t.updateQueue;if(o!==null){if(r=null,t.child!==null)switch(t.child.tag){case 5:r=t.child.stateNode;break;case 1:r=t.child.stateNode}Z_(t,o,r)}break;case 5:var l=t.stateNode;if(r===null&&t.flags&4){r=l;var c=t.memoizedProps;switch(t.type){case"button":case"input":case"select":case"textarea":c.autoFocus&&r.focus();break;case"img":c.src&&(r.src=c.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(t.memoizedState===null){var u=t.alternate;if(u!==null){var d=u.memoizedState;if(d!==null){var f=d.dehydrated;f!==null&&jd(f)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(Fe(163))}mn||t.flags&512&&lv(t)}catch(p){cr(t,t.return,p)}}if(t===e){qe=null;break}if(r=t.sibling,r!==null){r.return=t.return,qe=r;break}qe=t.return}}function gb(e){for(;qe!==null;){var t=qe;if(t===e){qe=null;break}var r=t.sibling;if(r!==null){r.return=t.return,qe=r;break}qe=t.return}}function xb(e){for(;qe!==null;){var t=qe;try{switch(t.tag){case 0:case 11:case 15:var r=t.return;try{I0(4,t)}catch(c){cr(t,r,c)}break;case 1:var n=t.stateNode;if(typeof n.componentDidMount=="function"){var s=t.return;try{n.componentDidMount()}catch(c){cr(t,s,c)}}var a=t.return;try{lv(t)}catch(c){cr(t,a,c)}break;case 5:var o=t.return;try{lv(t)}catch(c){cr(t,o,c)}}}catch(c){cr(t,t.return,c)}if(t===e){qe=null;break}var l=t.sibling;if(l!==null){l.return=t.return,qe=l;break}qe=t.return}}var i5=Math.ceil,Om=xi.ReactCurrentDispatcher,Qy=xi.ReactCurrentOwner,Ns=xi.ReactCurrentBatchConfig,Ct=0,Gr=null,jr=null,rn=0,Zn=0,sc=xo(0),Rr=0,Fd=null,tl=0,L0=0,Jy=0,sd=null,Fn=null,Zy=0,Fc=1/0,Va=null,Fm=!1,dv=null,Zi=null,gh=!1,Vi=null,Im=0,ad=0,fv=null,Jh=-1,Zh=0;function En(){return Ct&6?vr():Jh!==-1?Jh:Jh=vr()}function eo(e){return e.mode&1?Ct&2&&rn!==0?rn&-rn:VO.transition!==null?(Zh===0&&(Zh=rj()),Zh):(e=It,e!==0||(e=window.event,e=e===void 0?16:cj(e.type)),e):1}function Zs(e,t,r,n){if(50<ad)throw ad=0,fv=null,Error(Fe(185));hf(e,r,n),(!(Ct&2)||e!==Gr)&&(e===Gr&&(!(Ct&2)&&(L0|=r),Rr===4&&Di(e,rn)),zn(e,n),r===1&&Ct===0&&!(t.mode&1)&&(Fc=vr()+500,M0&&vo()))}function zn(e,t){var r=e.callbackNode;VM(e,t);var n=wm(e,e===Gr?rn:0);if(n===0)r!==null&&E_(r),e.callbackNode=null,e.callbackPriority=0;else if(t=n&-n,e.callbackPriority!==t){if(r!=null&&E_(r),t===1)e.tag===0?zO(vb.bind(null,e)):Cj(vb.bind(null,e)),LO(function(){!(Ct&6)&&vo()}),r=null;else{switch(nj(n)){case 1:r=jy;break;case 4:r=ej;break;case 16:r=ym;break;case 536870912:r=tj;break;default:r=ym}r=EE(r,yE.bind(null,e))}e.callbackPriority=t,e.callbackNode=r}}function yE(e,t){if(Jh=-1,Zh=0,Ct&6)throw Error(Fe(327));var r=e.callbackNode;if(fc()&&e.callbackNode!==r)return null;var n=wm(e,e===Gr?rn:0);if(n===0)return null;if(n&30||n&e.expiredLanes||t)t=Lm(e,n);else{t=n;var s=Ct;Ct|=2;var a=_E();(Gr!==e||rn!==t)&&(Va=null,Fc=vr()+500,Yo(e,t));do try{c5();break}catch(l){wE(e,l)}while(!0);Ly(),Om.current=a,Ct=s,jr!==null?t=0:(Gr=null,rn=0,t=Rr)}if(t!==0){if(t===2&&(s=$x(e),s!==0&&(n=s,t=hv(e,s))),t===1)throw r=Fd,Yo(e,0),Di(e,n),zn(e,vr()),r;if(t===6)Di(e,n);else{if(s=e.current.alternate,!(n&30)&&!o5(s)&&(t=Lm(e,n),t===2&&(a=$x(e),a!==0&&(n=a,t=hv(e,a))),t===1))throw r=Fd,Yo(e,0),Di(e,n),zn(e,vr()),r;switch(e.finishedWork=s,e.finishedLanes=n,t){case 0:case 1:throw Error(Fe(345));case 2:Po(e,Fn,Va);break;case 3:if(Di(e,n),(n&130023424)===n&&(t=Zy+500-vr(),10<t)){if(wm(e,0)!==0)break;if(s=e.suspendedLanes,(s&n)!==n){En(),e.pingedLanes|=e.suspendedLanes&s;break}e.timeoutHandle=qx(Po.bind(null,e,Fn,Va),t);break}Po(e,Fn,Va);break;case 4:if(Di(e,n),(n&4194240)===n)break;for(t=e.eventTimes,s=-1;0<n;){var o=31-Js(n);a=1<<o,o=t[o],o>s&&(s=o),n&=~a}if(n=s,n=vr()-n,n=(120>n?120:480>n?480:1080>n?1080:1920>n?1920:3e3>n?3e3:4320>n?4320:1960*i5(n/1960))-n,10<n){e.timeoutHandle=qx(Po.bind(null,e,Fn,Va),n);break}Po(e,Fn,Va);break;case 5:Po(e,Fn,Va);break;default:throw Error(Fe(329))}}}return zn(e,vr()),e.callbackNode===r?yE.bind(null,e):null}function hv(e,t){var r=sd;return e.current.memoizedState.isDehydrated&&(Yo(e,t).flags|=256),e=Lm(e,t),e!==2&&(t=Fn,Fn=r,t!==null&&mv(t)),e}function mv(e){Fn===null?Fn=e:Fn.push.apply(Fn,e)}function o5(e){for(var t=e;;){if(t.flags&16384){var r=t.updateQueue;if(r!==null&&(r=r.stores,r!==null))for(var n=0;n<r.length;n++){var s=r[n],a=s.getSnapshot;s=s.value;try{if(!sa(a(),s))return!1}catch{return!1}}}if(r=t.child,t.subtreeFlags&16384&&r!==null)r.return=t,t=r;else{if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}function Di(e,t){for(t&=~Jy,t&=~L0,e.suspendedLanes|=t,e.pingedLanes&=~t,e=e.expirationTimes;0<t;){var r=31-Js(t),n=1<<r;e[r]=-1,t&=~n}}function vb(e){if(Ct&6)throw Error(Fe(327));fc();var t=wm(e,0);if(!(t&1))return zn(e,vr()),null;var r=Lm(e,t);if(e.tag!==0&&r===2){var n=$x(e);n!==0&&(t=n,r=hv(e,n))}if(r===1)throw r=Fd,Yo(e,0),Di(e,t),zn(e,vr()),r;if(r===6)throw Error(Fe(345));return e.finishedWork=e.current.alternate,e.finishedLanes=t,Po(e,Fn,Va),zn(e,vr()),null}function e1(e,t){var r=Ct;Ct|=1;try{return e(t)}finally{Ct=r,Ct===0&&(Fc=vr()+500,M0&&vo())}}function rl(e){Vi!==null&&Vi.tag===0&&!(Ct&6)&&fc();var t=Ct;Ct|=1;var r=Ns.transition,n=It;try{if(Ns.transition=null,It=1,e)return e()}finally{It=n,Ns.transition=r,Ct=t,!(Ct&6)&&vo()}}function t1(){Zn=sc.current,Yt(sc)}function Yo(e,t){e.finishedWork=null,e.finishedLanes=0;var r=e.timeoutHandle;if(r!==-1&&(e.timeoutHandle=-1,IO(r)),jr!==null)for(r=jr.return;r!==null;){var n=r;switch(Oy(n),n.tag){case 1:n=n.type.childContextTypes,n!=null&&jm();break;case 3:Mc(),Yt(Bn),Yt(vn),Wy();break;case 5:Vy(n);break;case 4:Mc();break;case 13:Yt(sr);break;case 19:Yt(sr);break;case 10:$y(n.type._context);break;case 22:case 23:t1()}r=r.return}if(Gr=e,jr=e=to(e.current,null),rn=Zn=t,Rr=0,Fd=null,Jy=L0=tl=0,Fn=sd=null,Lo!==null){for(t=0;t<Lo.length;t++)if(r=Lo[t],n=r.interleaved,n!==null){r.interleaved=null;var s=n.next,a=r.pending;if(a!==null){var o=a.next;a.next=s,n.next=o}r.pending=n}Lo=null}return e}function wE(e,t){do{var r=jr;try{if(Ly(),Kh.current=Mm,Rm){for(var n=ar.memoizedState;n!==null;){var s=n.queue;s!==null&&(s.pending=null),n=n.next}Rm=!1}if(el=0,Ur=Dr=ar=null,rd=!1,Rd=0,Qy.current=null,r===null||r.return===null){Rr=1,Fd=t,jr=null;break}e:{var a=e,o=r.return,l=r,c=t;if(t=rn,l.flags|=32768,c!==null&&typeof c=="object"&&typeof c.then=="function"){var u=c,d=l,f=d.tag;if(!(d.mode&1)&&(f===0||f===11||f===15)){var p=d.alternate;p?(d.updateQueue=p.updateQueue,d.memoizedState=p.memoizedState,d.lanes=p.lanes):(d.updateQueue=null,d.memoizedState=null)}var h=ab(o);if(h!==null){h.flags&=-257,ib(h,o,l,a,t),h.mode&1&&sb(a,u,t),t=h,c=u;var g=t.updateQueue;if(g===null){var m=new Set;m.add(c),t.updateQueue=m}else g.add(c);break e}else{if(!(t&1)){sb(a,u,t),r1();break e}c=Error(Fe(426))}}else if(er&&l.mode&1){var x=ab(o);if(x!==null){!(x.flags&65536)&&(x.flags|=256),ib(x,o,l,a,t),Fy(Oc(c,l));break e}}a=c=Oc(c,l),Rr!==4&&(Rr=2),sd===null?sd=[a]:sd.push(a),a=o;do{switch(a.tag){case 3:a.flags|=65536,t&=-t,a.lanes|=t;var w=nE(a,c,t);J_(a,w);break e;case 1:l=c;var v=a.type,_=a.stateNode;if(!(a.flags&128)&&(typeof v.getDerivedStateFromError=="function"||_!==null&&typeof _.componentDidCatch=="function"&&(Zi===null||!Zi.has(_)))){a.flags|=65536,t&=-t,a.lanes|=t;var b=sE(a,l,t);J_(a,b);break e}}a=a.return}while(a!==null)}SE(r)}catch(S){t=S,jr===r&&r!==null&&(jr=r=r.return);continue}break}while(!0)}function _E(){var e=Om.current;return Om.current=Mm,e===null?Mm:e}function r1(){(Rr===0||Rr===3||Rr===2)&&(Rr=4),Gr===null||!(tl&268435455)&&!(L0&268435455)||Di(Gr,rn)}function Lm(e,t){var r=Ct;Ct|=2;var n=_E();(Gr!==e||rn!==t)&&(Va=null,Yo(e,t));do try{l5();break}catch(s){wE(e,s)}while(!0);if(Ly(),Ct=r,Om.current=n,jr!==null)throw Error(Fe(261));return Gr=null,rn=0,Rr}function l5(){for(;jr!==null;)bE(jr)}function c5(){for(;jr!==null&&!MM();)bE(jr)}function bE(e){var t=jE(e.alternate,e,Zn);e.memoizedProps=e.pendingProps,t===null?SE(e):jr=t,Qy.current=null}function SE(e){var t=e;do{var r=t.alternate;if(e=t.return,t.flags&32768){if(r=r5(r,t),r!==null){r.flags&=32767,jr=r;return}if(e!==null)e.flags|=32768,e.subtreeFlags=0,e.deletions=null;else{Rr=6,jr=null;return}}else if(r=t5(r,t,Zn),r!==null){jr=r;return}if(t=t.sibling,t!==null){jr=t;return}jr=t=e}while(t!==null);Rr===0&&(Rr=5)}function Po(e,t,r){var n=It,s=Ns.transition;try{Ns.transition=null,It=1,u5(e,t,r,n)}finally{Ns.transition=s,It=n}return null}function u5(e,t,r,n){do fc();while(Vi!==null);if(Ct&6)throw Error(Fe(327));r=e.finishedWork;var s=e.finishedLanes;if(r===null)return null;if(e.finishedWork=null,e.finishedLanes=0,r===e.current)throw Error(Fe(177));e.callbackNode=null,e.callbackPriority=0;var a=r.lanes|r.childLanes;if(WM(e,a),e===Gr&&(jr=Gr=null,rn=0),!(r.subtreeFlags&2064)&&!(r.flags&2064)||gh||(gh=!0,EE(ym,function(){return fc(),null})),a=(r.flags&15990)!==0,r.subtreeFlags&15990||a){a=Ns.transition,Ns.transition=null;var o=It;It=1;var l=Ct;Ct|=4,Qy.current=null,s5(e,r),xE(r,e),AO(Hx),_m=!!Wx,Hx=Wx=null,e.current=r,a5(r),OM(),Ct=l,It=o,Ns.transition=a}else e.current=r;if(gh&&(gh=!1,Vi=e,Im=s),a=e.pendingLanes,a===0&&(Zi=null),LM(r.stateNode),zn(e,vr()),t!==null)for(n=e.onRecoverableError,r=0;r<t.length;r++)s=t[r],n(s.value,{componentStack:s.stack,digest:s.digest});if(Fm)throw Fm=!1,e=dv,dv=null,e;return Im&1&&e.tag!==0&&fc(),a=e.pendingLanes,a&1?e===fv?ad++:(ad=0,fv=e):ad=0,vo(),null}function fc(){if(Vi!==null){var e=nj(Im),t=Ns.transition,r=It;try{if(Ns.transition=null,It=16>e?16:e,Vi===null)var n=!1;else{if(e=Vi,Vi=null,Im=0,Ct&6)throw Error(Fe(331));var s=Ct;for(Ct|=4,qe=e.current;qe!==null;){var a=qe,o=a.child;if(qe.flags&16){var l=a.deletions;if(l!==null){for(var c=0;c<l.length;c++){var u=l[c];for(qe=u;qe!==null;){var d=qe;switch(d.tag){case 0:case 11:case 15:nd(8,d,a)}var f=d.child;if(f!==null)f.return=d,qe=f;else for(;qe!==null;){d=qe;var p=d.sibling,h=d.return;if(mE(d),d===u){qe=null;break}if(p!==null){p.return=h,qe=p;break}qe=h}}}var g=a.alternate;if(g!==null){var m=g.child;if(m!==null){g.child=null;do{var x=m.sibling;m.sibling=null,m=x}while(m!==null)}}qe=a}}if(a.subtreeFlags&2064&&o!==null)o.return=a,qe=o;else e:for(;qe!==null;){if(a=qe,a.flags&2048)switch(a.tag){case 0:case 11:case 15:nd(9,a,a.return)}var w=a.sibling;if(w!==null){w.return=a.return,qe=w;break e}qe=a.return}}var v=e.current;for(qe=v;qe!==null;){o=qe;var _=o.child;if(o.subtreeFlags&2064&&_!==null)_.return=o,qe=_;else e:for(o=v;qe!==null;){if(l=qe,l.flags&2048)try{switch(l.tag){case 0:case 11:case 15:I0(9,l)}}catch(S){cr(l,l.return,S)}if(l===o){qe=null;break e}var b=l.sibling;if(b!==null){b.return=l.return,qe=b;break e}qe=l.return}}if(Ct=s,vo(),ka&&typeof ka.onPostCommitFiberRoot=="function")try{ka.onPostCommitFiberRoot(T0,e)}catch{}n=!0}return n}finally{It=r,Ns.transition=t}}return!1}function yb(e,t,r){t=Oc(r,t),t=nE(e,t,1),e=Ji(e,t,1),t=En(),e!==null&&(hf(e,1,t),zn(e,t))}function cr(e,t,r){if(e.tag===3)yb(e,e,r);else for(;t!==null;){if(t.tag===3){yb(t,e,r);break}else if(t.tag===1){var n=t.stateNode;if(typeof t.type.getDerivedStateFromError=="function"||typeof n.componentDidCatch=="function"&&(Zi===null||!Zi.has(n))){e=Oc(r,e),e=sE(t,e,1),t=Ji(t,e,1),e=En(),t!==null&&(hf(t,1,e),zn(t,e));break}}t=t.return}}function d5(e,t,r){var n=e.pingCache;n!==null&&n.delete(t),t=En(),e.pingedLanes|=e.suspendedLanes&r,Gr===e&&(rn&r)===r&&(Rr===4||Rr===3&&(rn&130023424)===rn&&500>vr()-Zy?Yo(e,0):Jy|=r),zn(e,t)}function NE(e,t){t===0&&(e.mode&1?(t=ih,ih<<=1,!(ih&130023424)&&(ih=4194304)):t=1);var r=En();e=ci(e,t),e!==null&&(hf(e,t,r),zn(e,r))}function f5(e){var t=e.memoizedState,r=0;t!==null&&(r=t.retryLane),NE(e,r)}function h5(e,t){var r=0;switch(e.tag){case 13:var n=e.stateNode,s=e.memoizedState;s!==null&&(r=s.retryLane);break;case 19:n=e.stateNode;break;default:throw Error(Fe(314))}n!==null&&n.delete(t),NE(e,r)}var jE;jE=function(e,t,r){if(e!==null)if(e.memoizedProps!==t.pendingProps||Bn.current)Ln=!0;else{if(!(e.lanes&r)&&!(t.flags&128))return Ln=!1,e5(e,t,r);Ln=!!(e.flags&131072)}else Ln=!1,er&&t.flags&1048576&&Tj(t,Cm,t.index);switch(t.lanes=0,t.tag){case 2:var n=t.type;Qh(e,t),e=t.pendingProps;var s=Pc(t,vn.current);dc(t,r),s=Gy(null,t,n,e,s,r);var a=qy();return t.flags|=1,typeof s=="object"&&s!==null&&typeof s.render=="function"&&s.$$typeof===void 0?(t.tag=1,t.memoizedState=null,t.updateQueue=null,Un(n)?(a=!0,Em(t)):a=!1,t.memoizedState=s.state!==null&&s.state!==void 0?s.state:null,Uy(t),s.updater=F0,t.stateNode=s,s._reactInternals=t,ev(t,n,e,r),t=nv(null,t,n,!0,a,r)):(t.tag=0,er&&a&&My(t),bn(null,t,s,r),t=t.child),t;case 16:n=t.elementType;e:{switch(Qh(e,t),e=t.pendingProps,s=n._init,n=s(n._payload),t.type=n,s=t.tag=p5(n),e=Bs(n,e),s){case 0:t=rv(null,t,n,e,r);break e;case 1:t=cb(null,t,n,e,r);break e;case 11:t=ob(null,t,n,e,r);break e;case 14:t=lb(null,t,n,Bs(n.type,e),r);break e}throw Error(Fe(306,n,""))}return t;case 0:return n=t.type,s=t.pendingProps,s=t.elementType===n?s:Bs(n,s),rv(e,t,n,s,r);case 1:return n=t.type,s=t.pendingProps,s=t.elementType===n?s:Bs(n,s),cb(e,t,n,s,r);case 3:e:{if(lE(t),e===null)throw Error(Fe(387));n=t.pendingProps,a=t.memoizedState,s=a.element,Oj(e,t),Pm(t,n,null,r);var o=t.memoizedState;if(n=o.element,a.isDehydrated)if(a={element:n,isDehydrated:!1,cache:o.cache,pendingSuspenseBoundaries:o.pendingSuspenseBoundaries,transitions:o.transitions},t.updateQueue.baseState=a,t.memoizedState=a,t.flags&256){s=Oc(Error(Fe(423)),t),t=ub(e,t,n,r,s);break e}else if(n!==s){s=Oc(Error(Fe(424)),t),t=ub(e,t,n,r,s);break e}else for(ss=Qi(t.stateNode.containerInfo.firstChild),is=t,er=!0,Hs=null,r=Rj(t,null,n,r),t.child=r;r;)r.flags=r.flags&-3|4096,r=r.sibling;else{if(Dc(),n===s){t=ui(e,t,r);break e}bn(e,t,n,r)}t=t.child}return t;case 5:return Fj(t),e===null&&Qx(t),n=t.type,s=t.pendingProps,a=e!==null?e.memoizedProps:null,o=s.children,Gx(n,s)?o=null:a!==null&&Gx(n,a)&&(t.flags|=32),oE(e,t),bn(e,t,o,r),t.child;case 6:return e===null&&Qx(t),null;case 13:return cE(e,t,r);case 4:return zy(t,t.stateNode.containerInfo),n=t.pendingProps,e===null?t.child=Rc(t,null,n,r):bn(e,t,n,r),t.child;case 11:return n=t.type,s=t.pendingProps,s=t.elementType===n?s:Bs(n,s),ob(e,t,n,s,r);case 7:return bn(e,t,t.pendingProps,r),t.child;case 8:return bn(e,t,t.pendingProps.children,r),t.child;case 12:return bn(e,t,t.pendingProps.children,r),t.child;case 10:e:{if(n=t.type._context,s=t.pendingProps,a=t.memoizedProps,o=s.value,Wt(Tm,n._currentValue),n._currentValue=o,a!==null)if(sa(a.value,o)){if(a.children===s.children&&!Bn.current){t=ui(e,t,r);break e}}else for(a=t.child,a!==null&&(a.return=t);a!==null;){var l=a.dependencies;if(l!==null){o=a.child;for(var c=l.firstContext;c!==null;){if(c.context===n){if(a.tag===1){c=ei(-1,r&-r),c.tag=2;var u=a.updateQueue;if(u!==null){u=u.shared;var d=u.pending;d===null?c.next=c:(c.next=d.next,d.next=c),u.pending=c}}a.lanes|=r,c=a.alternate,c!==null&&(c.lanes|=r),Jx(a.return,r,t),l.lanes|=r;break}c=c.next}}else if(a.tag===10)o=a.type===t.type?null:a.child;else if(a.tag===18){if(o=a.return,o===null)throw Error(Fe(341));o.lanes|=r,l=o.alternate,l!==null&&(l.lanes|=r),Jx(o,r,t),o=a.sibling}else o=a.child;if(o!==null)o.return=a;else for(o=a;o!==null;){if(o===t){o=null;break}if(a=o.sibling,a!==null){a.return=o.return,o=a;break}o=o.return}a=o}bn(e,t,s.children,r),t=t.child}return t;case 9:return s=t.type,n=t.pendingProps.children,dc(t,r),s=ks(s),n=n(s),t.flags|=1,bn(e,t,n,r),t.child;case 14:return n=t.type,s=Bs(n,t.pendingProps),s=Bs(n.type,s),lb(e,t,n,s,r);case 15:return aE(e,t,t.type,t.pendingProps,r);case 17:return n=t.type,s=t.pendingProps,s=t.elementType===n?s:Bs(n,s),Qh(e,t),t.tag=1,Un(n)?(e=!0,Em(t)):e=!1,dc(t,r),rE(t,n,s),ev(t,n,s,r),nv(null,t,n,!0,e,r);case 19:return uE(e,t,r);case 22:return iE(e,t,r)}throw Error(Fe(156,t.tag))};function EE(e,t){return ZN(e,t)}function m5(e,t,r,n){this.tag=e,this.key=r,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=n,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Ss(e,t,r,n){return new m5(e,t,r,n)}function n1(e){return e=e.prototype,!(!e||!e.isReactComponent)}function p5(e){if(typeof e=="function")return n1(e)?1:0;if(e!=null){if(e=e.$$typeof,e===by)return 11;if(e===Sy)return 14}return 2}function to(e,t){var r=e.alternate;return r===null?(r=Ss(e.tag,t,e.key,e.mode),r.elementType=e.elementType,r.type=e.type,r.stateNode=e.stateNode,r.alternate=e,e.alternate=r):(r.pendingProps=t,r.type=e.type,r.flags=0,r.subtreeFlags=0,r.deletions=null),r.flags=e.flags&14680064,r.childLanes=e.childLanes,r.lanes=e.lanes,r.child=e.child,r.memoizedProps=e.memoizedProps,r.memoizedState=e.memoizedState,r.updateQueue=e.updateQueue,t=e.dependencies,r.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext},r.sibling=e.sibling,r.index=e.index,r.ref=e.ref,r}function em(e,t,r,n,s,a){var o=2;if(n=e,typeof e=="function")n1(e)&&(o=1);else if(typeof e=="string")o=5;else e:switch(e){case Yl:return Ko(r.children,s,a,t);case _y:o=8,s|=8;break;case Nx:return e=Ss(12,r,t,s|2),e.elementType=Nx,e.lanes=a,e;case jx:return e=Ss(13,r,t,s),e.elementType=jx,e.lanes=a,e;case Ex:return e=Ss(19,r,t,s),e.elementType=Ex,e.lanes=a,e;case FN:return $0(r,s,a,t);default:if(typeof e=="object"&&e!==null)switch(e.$$typeof){case MN:o=10;break e;case ON:o=9;break e;case by:o=11;break e;case Sy:o=14;break e;case Ci:o=16,n=null;break e}throw Error(Fe(130,e==null?e:typeof e,""))}return t=Ss(o,r,t,s),t.elementType=e,t.type=n,t.lanes=a,t}function Ko(e,t,r,n){return e=Ss(7,e,n,t),e.lanes=r,e}function $0(e,t,r,n){return e=Ss(22,e,n,t),e.elementType=FN,e.lanes=r,e.stateNode={isHidden:!1},e}function kg(e,t,r){return e=Ss(6,e,null,t),e.lanes=r,e}function Cg(e,t,r){return t=Ss(4,e.children!==null?e.children:[],e.key,t),t.lanes=r,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}function g5(e,t,r,n,s){this.tag=t,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=lg(0),this.expirationTimes=lg(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=lg(0),this.identifierPrefix=n,this.onRecoverableError=s,this.mutableSourceEagerHydrationData=null}function s1(e,t,r,n,s,a,o,l,c){return e=new g5(e,t,r,l,c),t===1?(t=1,a===!0&&(t|=8)):t=0,a=Ss(3,null,null,t),e.current=a,a.stateNode=e,a.memoizedState={element:n,isDehydrated:r,cache:null,transitions:null,pendingSuspenseBoundaries:null},Uy(a),e}function x5(e,t,r){var n=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:ql,key:n==null?null:""+n,children:e,containerInfo:t,implementation:r}}function kE(e){if(!e)return io;e=e._reactInternals;e:{if(gl(e)!==e||e.tag!==1)throw Error(Fe(170));var t=e;do{switch(t.tag){case 3:t=t.stateNode.context;break e;case 1:if(Un(t.type)){t=t.stateNode.__reactInternalMemoizedMergedChildContext;break e}}t=t.return}while(t!==null);throw Error(Fe(171))}if(e.tag===1){var r=e.type;if(Un(r))return kj(e,r,t)}return t}function CE(e,t,r,n,s,a,o,l,c){return e=s1(r,n,!0,e,s,a,o,l,c),e.context=kE(null),r=e.current,n=En(),s=eo(r),a=ei(n,s),a.callback=t??null,Ji(r,a,s),e.current.lanes=s,hf(e,s,n),zn(e,n),e}function B0(e,t,r,n){var s=t.current,a=En(),o=eo(s);return r=kE(r),t.context===null?t.context=r:t.pendingContext=r,t=ei(a,o),t.payload={element:e},n=n===void 0?null:n,n!==null&&(t.callback=n),e=Ji(s,t,o),e!==null&&(Zs(e,s,o,a),Yh(e,s,o)),o}function $m(e){if(e=e.current,!e.child)return null;switch(e.child.tag){case 5:return e.child.stateNode;default:return e.child.stateNode}}function wb(e,t){if(e=e.memoizedState,e!==null&&e.dehydrated!==null){var r=e.retryLane;e.retryLane=r!==0&&r<t?r:t}}function a1(e,t){wb(e,t),(e=e.alternate)&&wb(e,t)}function v5(){return null}var TE=typeof reportError=="function"?reportError:function(e){console.error(e)};function i1(e){this._internalRoot=e}U0.prototype.render=i1.prototype.render=function(e){var t=this._internalRoot;if(t===null)throw Error(Fe(409));B0(e,t,null,null)};U0.prototype.unmount=i1.prototype.unmount=function(){var e=this._internalRoot;if(e!==null){this._internalRoot=null;var t=e.containerInfo;rl(function(){B0(null,e,null,null)}),t[li]=null}};function U0(e){this._internalRoot=e}U0.prototype.unstable_scheduleHydration=function(e){if(e){var t=ij();e={blockedOn:null,target:e,priority:t};for(var r=0;r<Pi.length&&t!==0&&t<Pi[r].priority;r++);Pi.splice(r,0,e),r===0&&lj(e)}};function o1(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11)}function z0(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11&&(e.nodeType!==8||e.nodeValue!==" react-mount-point-unstable "))}function _b(){}function y5(e,t,r,n,s){if(s){if(typeof n=="function"){var a=n;n=function(){var u=$m(o);a.call(u)}}var o=CE(t,n,e,0,null,!1,!1,"",_b);return e._reactRootContainer=o,e[li]=o.current,Cd(e.nodeType===8?e.parentNode:e),rl(),o}for(;s=e.lastChild;)e.removeChild(s);if(typeof n=="function"){var l=n;n=function(){var u=$m(c);l.call(u)}}var c=s1(e,0,!1,null,null,!1,!1,"",_b);return e._reactRootContainer=c,e[li]=c.current,Cd(e.nodeType===8?e.parentNode:e),rl(function(){B0(t,c,r,n)}),c}function V0(e,t,r,n,s){var a=r._reactRootContainer;if(a){var o=a;if(typeof s=="function"){var l=s;s=function(){var c=$m(o);l.call(c)}}B0(t,o,e,s)}else o=y5(r,t,e,s,n);return $m(o)}sj=function(e){switch(e.tag){case 3:var t=e.stateNode;if(t.current.memoizedState.isDehydrated){var r=Vu(t.pendingLanes);r!==0&&(Ey(t,r|1),zn(t,vr()),!(Ct&6)&&(Fc=vr()+500,vo()))}break;case 13:rl(function(){var n=ci(e,1);if(n!==null){var s=En();Zs(n,e,1,s)}}),a1(e,1)}};ky=function(e){if(e.tag===13){var t=ci(e,134217728);if(t!==null){var r=En();Zs(t,e,134217728,r)}a1(e,134217728)}};aj=function(e){if(e.tag===13){var t=eo(e),r=ci(e,t);if(r!==null){var n=En();Zs(r,e,t,n)}a1(e,t)}};ij=function(){return It};oj=function(e,t){var r=It;try{return It=e,t()}finally{It=r}};Fx=function(e,t,r){switch(t){case"input":if(Tx(e,r),t=r.name,r.type==="radio"&&t!=null){for(r=e;r.parentNode;)r=r.parentNode;for(r=r.querySelectorAll("input[name="+JSON.stringify(""+t)+'][type="radio"]'),t=0;t<r.length;t++){var n=r[t];if(n!==e&&n.form===e.form){var s=R0(n);if(!s)throw Error(Fe(90));LN(n),Tx(n,s)}}}break;case"textarea":BN(e,r);break;case"select":t=r.value,t!=null&&oc(e,!!r.multiple,t,!1)}};qN=e1;YN=rl;var w5={usingClientEntryPoint:!1,Events:[pf,Jl,R0,HN,GN,e1]},Cu={findFiberByHostInstance:Io,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},_5={bundleType:Cu.bundleType,version:Cu.version,rendererPackageName:Cu.rendererPackageName,rendererConfig:Cu.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:xi.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return e=QN(e),e===null?null:e.stateNode},findFiberByHostInstance:Cu.findFiberByHostInstance||v5,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var xh=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!xh.isDisabled&&xh.supportsFiber)try{T0=xh.inject(_5),ka=xh}catch{}}fs.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=w5;fs.createPortal=function(e,t){var r=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!o1(t))throw Error(Fe(200));return x5(e,t,null,r)};fs.createRoot=function(e,t){if(!o1(e))throw Error(Fe(299));var r=!1,n="",s=TE;return t!=null&&(t.unstable_strictMode===!0&&(r=!0),t.identifierPrefix!==void 0&&(n=t.identifierPrefix),t.onRecoverableError!==void 0&&(s=t.onRecoverableError)),t=s1(e,1,!1,null,null,r,!1,n,s),e[li]=t.current,Cd(e.nodeType===8?e.parentNode:e),new i1(t)};fs.findDOMNode=function(e){if(e==null)return null;if(e.nodeType===1)return e;var t=e._reactInternals;if(t===void 0)throw typeof e.render=="function"?Error(Fe(188)):(e=Object.keys(e).join(","),Error(Fe(268,e)));return e=QN(t),e=e===null?null:e.stateNode,e};fs.flushSync=function(e){return rl(e)};fs.hydrate=function(e,t,r){if(!z0(t))throw Error(Fe(200));return V0(null,e,t,!0,r)};fs.hydrateRoot=function(e,t,r){if(!o1(e))throw Error(Fe(405));var n=r!=null&&r.hydratedSources||null,s=!1,a="",o=TE;if(r!=null&&(r.unstable_strictMode===!0&&(s=!0),r.identifierPrefix!==void 0&&(a=r.identifierPrefix),r.onRecoverableError!==void 0&&(o=r.onRecoverableError)),t=CE(t,null,e,1,r??null,s,!1,a,o),e[li]=t.current,Cd(e),n)for(e=0;e<n.length;e++)r=n[e],s=r._getVersion,s=s(r._source),t.mutableSourceEagerHydrationData==null?t.mutableSourceEagerHydrationData=[r,s]:t.mutableSourceEagerHydrationData.push(r,s);return new U0(t)};fs.render=function(e,t,r){if(!z0(t))throw Error(Fe(200));return V0(null,e,t,!1,r)};fs.unmountComponentAtNode=function(e){if(!z0(e))throw Error(Fe(40));return e._reactRootContainer?(rl(function(){V0(null,null,e,!1,function(){e._reactRootContainer=null,e[li]=null})}),!0):!1};fs.unstable_batchedUpdates=e1;fs.unstable_renderSubtreeIntoContainer=function(e,t,r,n){if(!z0(r))throw Error(Fe(200));if(e==null||e._reactInternals===void 0)throw Error(Fe(38));return V0(e,t,r,!1,n)};fs.version="18.3.1-next-f1338f8080-20240426";function AE(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(AE)}catch(e){console.error(e)}}AE(),AN.exports=fs;var xl=AN.exports;const PE=fy(xl);var DE,bb=xl;DE=bb.createRoot,bb.hydrateRoot;const b5=1,S5=1e6;let Tg=0;function N5(){return Tg=(Tg+1)%Number.MAX_SAFE_INTEGER,Tg.toString()}const Ag=new Map,Sb=e=>{if(Ag.has(e))return;const t=setTimeout(()=>{Ag.delete(e),id({type:"REMOVE_TOAST",toastId:e})},S5);Ag.set(e,t)},j5=(e,t)=>{switch(t.type){case"ADD_TOAST":return{...e,toasts:[t.toast,...e.toasts].slice(0,b5)};case"UPDATE_TOAST":return{...e,toasts:e.toasts.map(r=>r.id===t.toast.id?{...r,...t.toast}:r)};case"DISMISS_TOAST":{const{toastId:r}=t;return r?Sb(r):e.toasts.forEach(n=>{Sb(n.id)}),{...e,toasts:e.toasts.map(n=>n.id===r||r===void 0?{...n,open:!1}:n)}}case"REMOVE_TOAST":return t.toastId===void 0?{...e,toasts:[]}:{...e,toasts:e.toasts.filter(r=>r.id!==t.toastId)}}},tm=[];let rm={toasts:[]};function id(e){rm=j5(rm,e),tm.forEach(t=>{t(rm)})}function E5({...e}){const t=N5(),r=s=>id({type:"UPDATE_TOAST",toast:{...s,id:t}}),n=()=>id({type:"DISMISS_TOAST",toastId:t});return id({type:"ADD_TOAST",toast:{...e,id:t,open:!0,onOpenChange:s=>{s||n()}}}),{id:t,dismiss:n,update:r}}function St(){const[e,t]=y.useState(rm);return y.useEffect(()=>(tm.push(t),()=>{const r=tm.indexOf(t);r>-1&&tm.splice(r,1)}),[]),{...e,toast:E5,dismiss:r=>id({type:"DISMISS_TOAST",toastId:r})}}function Oe(e,t,{checkForDefaultPrevented:r=!0}={}){return function(s){if(e==null||e(s),r===!1||!s.defaultPrevented)return t==null?void 0:t(s)}}function Nb(e,t){if(typeof e=="function")return e(t);e!=null&&(e.current=t)}function di(...e){return t=>{let r=!1;const n=e.map(s=>{const a=Nb(s,t);return!r&&typeof a=="function"&&(r=!0),a});if(r)return()=>{for(let s=0;s<n.length;s++){const a=n[s];typeof a=="function"?a():Nb(e[s],null)}}}}function st(...e){return y.useCallback(di(...e),e)}function k5(e,t){const r=y.createContext(t),n=a=>{const{children:o,...l}=a,c=y.useMemo(()=>l,Object.values(l));return i.jsx(r.Provider,{value:c,children:o})};n.displayName=e+"Provider";function s(a){const o=y.useContext(r);if(o)return o;if(t!==void 0)return t;throw new Error(`\`${a}\` must be used within \`${e}\``)}return[n,s]}function Fr(e,t=[]){let r=[];function n(a,o){const l=y.createContext(o),c=r.length;r=[...r,o];const u=f=>{var w;const{scope:p,children:h,...g}=f,m=((w=p==null?void 0:p[e])==null?void 0:w[c])||l,x=y.useMemo(()=>g,Object.values(g));return i.jsx(m.Provider,{value:x,children:h})};u.displayName=a+"Provider";function d(f,p){var m;const h=((m=p==null?void 0:p[e])==null?void 0:m[c])||l,g=y.useContext(h);if(g)return g;if(o!==void 0)return o;throw new Error(`\`${f}\` must be used within \`${a}\``)}return[u,d]}const s=()=>{const a=r.map(o=>y.createContext(o));return function(l){const c=(l==null?void 0:l[e])||a;return y.useMemo(()=>({[`__scope${e}`]:{...l,[e]:c}}),[l,c])}};return s.scopeName=e,[n,C5(s,...t)]}function C5(...e){const t=e[0];if(e.length===1)return t;const r=()=>{const n=e.map(s=>({useScope:s(),scopeName:s.scopeName}));return function(a){const o=n.reduce((l,{useScope:c,scopeName:u})=>{const f=c(a)[`__scope${u}`];return{...l,...f}},{});return y.useMemo(()=>({[`__scope${t.scopeName}`]:o}),[o])}};return r.scopeName=t.scopeName,r}function oo(e){const t=T5(e),r=y.forwardRef((n,s)=>{const{children:a,...o}=n,l=y.Children.toArray(a),c=l.find(A5);if(c){const u=c.props.children,d=l.map(f=>f===c?y.Children.count(u)>1?y.Children.only(null):y.isValidElement(u)?u.props.children:null:f);return i.jsx(t,{...o,ref:s,children:y.isValidElement(u)?y.cloneElement(u,void 0,d):null})}return i.jsx(t,{...o,ref:s,children:a})});return r.displayName=`${e}.Slot`,r}var RE=oo("Slot");function T5(e){const t=y.forwardRef((r,n)=>{const{children:s,...a}=r;if(y.isValidElement(s)){const o=D5(s),l=P5(a,s.props);return s.type!==y.Fragment&&(l.ref=n?di(n,o):o),y.cloneElement(s,l)}return y.Children.count(s)>1?y.Children.only(null):null});return t.displayName=`${e}.SlotClone`,t}var ME=Symbol("radix.slottable");function OE(e){const t=({children:r})=>i.jsx(i.Fragment,{children:r});return t.displayName=`${e}.Slottable`,t.__radixId=ME,t}function A5(e){return y.isValidElement(e)&&typeof e.type=="function"&&"__radixId"in e.type&&e.type.__radixId===ME}function P5(e,t){const r={...t};for(const n in t){const s=e[n],a=t[n];/^on[A-Z]/.test(n)?s&&a?r[n]=(...l)=>{const c=a(...l);return s(...l),c}:s&&(r[n]=s):n==="style"?r[n]={...s,...a}:n==="className"&&(r[n]=[s,a].filter(Boolean).join(" "))}return{...e,...r}}function D5(e){var n,s;let t=(n=Object.getOwnPropertyDescriptor(e.props,"ref"))==null?void 0:n.get,r=t&&"isReactWarning"in t&&t.isReactWarning;return r?e.ref:(t=(s=Object.getOwnPropertyDescriptor(e,"ref"))==null?void 0:s.get,r=t&&"isReactWarning"in t&&t.isReactWarning,r?e.props.ref:e.props.ref||e.ref)}function xf(e){const t=e+"CollectionProvider",[r,n]=Fr(t),[s,a]=r(t,{collectionRef:{current:null},itemMap:new Map}),o=m=>{const{scope:x,children:w}=m,v=ke.useRef(null),_=ke.useRef(new Map).current;return i.jsx(s,{scope:x,itemMap:_,collectionRef:v,children:w})};o.displayName=t;const l=e+"CollectionSlot",c=oo(l),u=ke.forwardRef((m,x)=>{const{scope:w,children:v}=m,_=a(l,w),b=st(x,_.collectionRef);return i.jsx(c,{ref:b,children:v})});u.displayName=l;const d=e+"CollectionItemSlot",f="data-radix-collection-item",p=oo(d),h=ke.forwardRef((m,x)=>{const{scope:w,children:v,..._}=m,b=ke.useRef(null),S=st(x,b),T=a(d,w);return ke.useEffect(()=>(T.itemMap.set(b,{ref:b,..._}),()=>void T.itemMap.delete(b))),i.jsx(p,{[f]:"",ref:S,children:v})});h.displayName=d;function g(m){const x=a(e+"CollectionConsumer",m);return ke.useCallback(()=>{const v=x.collectionRef.current;if(!v)return[];const _=Array.from(v.querySelectorAll(`[${f}]`));return Array.from(x.itemMap.values()).sort((T,N)=>_.indexOf(T.ref.current)-_.indexOf(N.ref.current))},[x.collectionRef,x.itemMap])}return[{Provider:o,Slot:u,ItemSlot:h},g,n]}var R5=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","select","span","svg","ul"],ze=R5.reduce((e,t)=>{const r=oo(`Primitive.${t}`),n=y.forwardRef((s,a)=>{const{asChild:o,...l}=s,c=o?r:t;return typeof window<"u"&&(window[Symbol.for("radix-ui")]=!0),i.jsx(c,{...l,ref:a})});return n.displayName=`Primitive.${t}`,{...e,[t]:n}},{});function l1(e,t){e&&xl.flushSync(()=>e.dispatchEvent(t))}function hr(e){const t=y.useRef(e);return y.useEffect(()=>{t.current=e}),y.useMemo(()=>(...r)=>{var n;return(n=t.current)==null?void 0:n.call(t,...r)},[])}function M5(e,t=globalThis==null?void 0:globalThis.document){const r=hr(e);y.useEffect(()=>{const n=s=>{s.key==="Escape"&&r(s)};return t.addEventListener("keydown",n,{capture:!0}),()=>t.removeEventListener("keydown",n,{capture:!0})},[r,t])}var O5="DismissableLayer",pv="dismissableLayer.update",F5="dismissableLayer.pointerDownOutside",I5="dismissableLayer.focusOutside",jb,FE=y.createContext({layers:new Set,layersWithOutsidePointerEventsDisabled:new Set,branches:new Set}),vl=y.forwardRef((e,t)=>{const{disableOutsidePointerEvents:r=!1,onEscapeKeyDown:n,onPointerDownOutside:s,onFocusOutside:a,onInteractOutside:o,onDismiss:l,...c}=e,u=y.useContext(FE),[d,f]=y.useState(null),p=(d==null?void 0:d.ownerDocument)??(globalThis==null?void 0:globalThis.document),[,h]=y.useState({}),g=st(t,N=>f(N)),m=Array.from(u.layers),[x]=[...u.layersWithOutsidePointerEventsDisabled].slice(-1),w=m.indexOf(x),v=d?m.indexOf(d):-1,_=u.layersWithOutsidePointerEventsDisabled.size>0,b=v>=w,S=$5(N=>{const C=N.target,E=[...u.branches].some(P=>P.contains(C));!b||E||(s==null||s(N),o==null||o(N),N.defaultPrevented||l==null||l())},p),T=B5(N=>{const C=N.target;[...u.branches].some(P=>P.contains(C))||(a==null||a(N),o==null||o(N),N.defaultPrevented||l==null||l())},p);return M5(N=>{v===u.layers.size-1&&(n==null||n(N),!N.defaultPrevented&&l&&(N.preventDefault(),l()))},p),y.useEffect(()=>{if(d)return r&&(u.layersWithOutsidePointerEventsDisabled.size===0&&(jb=p.body.style.pointerEvents,p.body.style.pointerEvents="none"),u.layersWithOutsidePointerEventsDisabled.add(d)),u.layers.add(d),Eb(),()=>{r&&u.layersWithOutsidePointerEventsDisabled.size===1&&(p.body.style.pointerEvents=jb)}},[d,p,r,u]),y.useEffect(()=>()=>{d&&(u.layers.delete(d),u.layersWithOutsidePointerEventsDisabled.delete(d),Eb())},[d,u]),y.useEffect(()=>{const N=()=>h({});return document.addEventListener(pv,N),()=>document.removeEventListener(pv,N)},[]),i.jsx(ze.div,{...c,ref:g,style:{pointerEvents:_?b?"auto":"none":void 0,...e.style},onFocusCapture:Oe(e.onFocusCapture,T.onFocusCapture),onBlurCapture:Oe(e.onBlurCapture,T.onBlurCapture),onPointerDownCapture:Oe(e.onPointerDownCapture,S.onPointerDownCapture)})});vl.displayName=O5;var L5="DismissableLayerBranch",IE=y.forwardRef((e,t)=>{const r=y.useContext(FE),n=y.useRef(null),s=st(t,n);return y.useEffect(()=>{const a=n.current;if(a)return r.branches.add(a),()=>{r.branches.delete(a)}},[r.branches]),i.jsx(ze.div,{...e,ref:s})});IE.displayName=L5;function $5(e,t=globalThis==null?void 0:globalThis.document){const r=hr(e),n=y.useRef(!1),s=y.useRef(()=>{});return y.useEffect(()=>{const a=l=>{if(l.target&&!n.current){let c=function(){LE(F5,r,u,{discrete:!0})};const u={originalEvent:l};l.pointerType==="touch"?(t.removeEventListener("click",s.current),s.current=c,t.addEventListener("click",s.current,{once:!0})):c()}else t.removeEventListener("click",s.current);n.current=!1},o=window.setTimeout(()=>{t.addEventListener("pointerdown",a)},0);return()=>{window.clearTimeout(o),t.removeEventListener("pointerdown",a),t.removeEventListener("click",s.current)}},[t,r]),{onPointerDownCapture:()=>n.current=!0}}function B5(e,t=globalThis==null?void 0:globalThis.document){const r=hr(e),n=y.useRef(!1);return y.useEffect(()=>{const s=a=>{a.target&&!n.current&&LE(I5,r,{originalEvent:a},{discrete:!1})};return t.addEventListener("focusin",s),()=>t.removeEventListener("focusin",s)},[t,r]),{onFocusCapture:()=>n.current=!0,onBlurCapture:()=>n.current=!1}}function Eb(){const e=new CustomEvent(pv);document.dispatchEvent(e)}function LE(e,t,r,{discrete:n}){const s=r.originalEvent.target,a=new CustomEvent(e,{bubbles:!1,cancelable:!0,detail:r});t&&s.addEventListener(e,t,{once:!0}),n?l1(s,a):s.dispatchEvent(a)}var U5=vl,z5=IE,gr=globalThis!=null&&globalThis.document?y.useLayoutEffect:()=>{},V5="Portal",Jc=y.forwardRef((e,t)=>{var l;const{container:r,...n}=e,[s,a]=y.useState(!1);gr(()=>a(!0),[]);const o=r||s&&((l=globalThis==null?void 0:globalThis.document)==null?void 0:l.body);return o?PE.createPortal(i.jsx(ze.div,{...n,ref:t}),o):null});Jc.displayName=V5;function W5(e,t){return y.useReducer((r,n)=>t[r][n]??r,e)}var Ir=e=>{const{present:t,children:r}=e,n=H5(t),s=typeof r=="function"?r({present:n.isPresent}):y.Children.only(r),a=st(n.ref,G5(s));return typeof r=="function"||n.isPresent?y.cloneElement(s,{ref:a}):null};Ir.displayName="Presence";function H5(e){const[t,r]=y.useState(),n=y.useRef(null),s=y.useRef(e),a=y.useRef("none"),o=e?"mounted":"unmounted",[l,c]=W5(o,{mounted:{UNMOUNT:"unmounted",ANIMATION_OUT:"unmountSuspended"},unmountSuspended:{MOUNT:"mounted",ANIMATION_END:"unmounted"},unmounted:{MOUNT:"mounted"}});return y.useEffect(()=>{const u=vh(n.current);a.current=l==="mounted"?u:"none"},[l]),gr(()=>{const u=n.current,d=s.current;if(d!==e){const p=a.current,h=vh(u);e?c("MOUNT"):h==="none"||(u==null?void 0:u.display)==="none"?c("UNMOUNT"):c(d&&p!==h?"ANIMATION_OUT":"UNMOUNT"),s.current=e}},[e,c]),gr(()=>{if(t){let u;const d=t.ownerDocument.defaultView??window,f=h=>{const m=vh(n.current).includes(h.animationName);if(h.target===t&&m&&(c("ANIMATION_END"),!s.current)){const x=t.style.animationFillMode;t.style.animationFillMode="forwards",u=d.setTimeout(()=>{t.style.animationFillMode==="forwards"&&(t.style.animationFillMode=x)})}},p=h=>{h.target===t&&(a.current=vh(n.current))};return t.addEventListener("animationstart",p),t.addEventListener("animationcancel",f),t.addEventListener("animationend",f),()=>{d.clearTimeout(u),t.removeEventListener("animationstart",p),t.removeEventListener("animationcancel",f),t.removeEventListener("animationend",f)}}else c("ANIMATION_END")},[t,c]),{isPresent:["mounted","unmountSuspended"].includes(l),ref:y.useCallback(u=>{n.current=u?getComputedStyle(u):null,r(u)},[])}}function vh(e){return(e==null?void 0:e.animationName)||"none"}function G5(e){var n,s;let t=(n=Object.getOwnPropertyDescriptor(e.props,"ref"))==null?void 0:n.get,r=t&&"isReactWarning"in t&&t.isReactWarning;return r?e.ref:(t=(s=Object.getOwnPropertyDescriptor(e,"ref"))==null?void 0:s.get,r=t&&"isReactWarning"in t&&t.isReactWarning,r?e.props.ref:e.props.ref||e.ref)}var q5=xy[" useInsertionEffect ".trim().toString()]||gr;function Hn({prop:e,defaultProp:t,onChange:r=()=>{},caller:n}){const[s,a,o]=Y5({defaultProp:t,onChange:r}),l=e!==void 0,c=l?e:s;{const d=y.useRef(e!==void 0);y.useEffect(()=>{const f=d.current;f!==l&&console.warn(`${n} is changing from ${f?"controlled":"uncontrolled"} to ${l?"controlled":"uncontrolled"}. Components should not switch from controlled to uncontrolled (or vice versa). Decide between using a controlled or uncontrolled value for the lifetime of the component.`),d.current=l},[l,n])}const u=y.useCallback(d=>{var f;if(l){const p=K5(d)?d(e):d;p!==e&&((f=o.current)==null||f.call(o,p))}else a(d)},[l,e,a,o]);return[c,u]}function Y5({defaultProp:e,onChange:t}){const[r,n]=y.useState(e),s=y.useRef(r),a=y.useRef(t);return q5(()=>{a.current=t},[t]),y.useEffect(()=>{var o;s.current!==r&&((o=a.current)==null||o.call(a,r),s.current=r)},[r,s]),[r,n,a]}function K5(e){return typeof e=="function"}var $E=Object.freeze({position:"absolute",border:0,width:1,height:1,padding:0,margin:-1,overflow:"hidden",clip:"rect(0, 0, 0, 0)",whiteSpace:"nowrap",wordWrap:"normal"}),X5="VisuallyHidden",W0=y.forwardRef((e,t)=>i.jsx(ze.span,{...e,ref:t,style:{...$E,...e.style}}));W0.displayName=X5;var Q5=W0,c1="ToastProvider",[u1,J5,Z5]=xf("Toast"),[BE,Gne]=Fr("Toast",[Z5]),[eF,H0]=BE(c1),UE=e=>{const{__scopeToast:t,label:r="Notification",duration:n=5e3,swipeDirection:s="right",swipeThreshold:a=50,children:o}=e,[l,c]=y.useState(null),[u,d]=y.useState(0),f=y.useRef(!1),p=y.useRef(!1);return r.trim()||console.error(`Invalid prop \`label\` supplied to \`${c1}\`. Expected non-empty \`string\`.`),i.jsx(u1.Provider,{scope:t,children:i.jsx(eF,{scope:t,label:r,duration:n,swipeDirection:s,swipeThreshold:a,toastCount:u,viewport:l,onViewportChange:c,onToastAdd:y.useCallback(()=>d(h=>h+1),[]),onToastRemove:y.useCallback(()=>d(h=>h-1),[]),isFocusedToastEscapeKeyDownRef:f,isClosePausedRef:p,children:o})})};UE.displayName=c1;var zE="ToastViewport",tF=["F8"],gv="toast.viewportPause",xv="toast.viewportResume",VE=y.forwardRef((e,t)=>{const{__scopeToast:r,hotkey:n=tF,label:s="Notifications ({hotkey})",...a}=e,o=H0(zE,r),l=J5(r),c=y.useRef(null),u=y.useRef(null),d=y.useRef(null),f=y.useRef(null),p=st(t,f,o.onViewportChange),h=n.join("+").replace(/Key/g,"").replace(/Digit/g,""),g=o.toastCount>0;y.useEffect(()=>{const x=w=>{var _;n.length!==0&&n.every(b=>w[b]||w.code===b)&&((_=f.current)==null||_.focus())};return document.addEventListener("keydown",x),()=>document.removeEventListener("keydown",x)},[n]),y.useEffect(()=>{const x=c.current,w=f.current;if(g&&x&&w){const v=()=>{if(!o.isClosePausedRef.current){const T=new CustomEvent(gv);w.dispatchEvent(T),o.isClosePausedRef.current=!0}},_=()=>{if(o.isClosePausedRef.current){const T=new CustomEvent(xv);w.dispatchEvent(T),o.isClosePausedRef.current=!1}},b=T=>{!x.contains(T.relatedTarget)&&_()},S=()=>{x.contains(document.activeElement)||_()};return x.addEventListener("focusin",v),x.addEventListener("focusout",b),x.addEventListener("pointermove",v),x.addEventListener("pointerleave",S),window.addEventListener("blur",v),window.addEventListener("focus",_),()=>{x.removeEventListener("focusin",v),x.removeEventListener("focusout",b),x.removeEventListener("pointermove",v),x.removeEventListener("pointerleave",S),window.removeEventListener("blur",v),window.removeEventListener("focus",_)}}},[g,o.isClosePausedRef]);const m=y.useCallback(({tabbingDirection:x})=>{const v=l().map(_=>{const b=_.ref.current,S=[b,...mF(b)];return x==="forwards"?S:S.reverse()});return(x==="forwards"?v.reverse():v).flat()},[l]);return y.useEffect(()=>{const x=f.current;if(x){const w=v=>{var S,T,N;const _=v.altKey||v.ctrlKey||v.metaKey;if(v.key==="Tab"&&!_){const C=document.activeElement,E=v.shiftKey;if(v.target===x&&E){(S=u.current)==null||S.focus();return}const j=m({tabbingDirection:E?"backwards":"forwards"}),M=j.findIndex(A=>A===C);Pg(j.slice(M+1))?v.preventDefault():E?(T=u.current)==null||T.focus():(N=d.current)==null||N.focus()}};return x.addEventListener("keydown",w),()=>x.removeEventListener("keydown",w)}},[l,m]),i.jsxs(z5,{ref:c,role:"region","aria-label":s.replace("{hotkey}",h),tabIndex:-1,style:{pointerEvents:g?void 0:"none"},children:[g&&i.jsx(vv,{ref:u,onFocusFromOutsideViewport:()=>{const x=m({tabbingDirection:"forwards"});Pg(x)}}),i.jsx(u1.Slot,{scope:r,children:i.jsx(ze.ol,{tabIndex:-1,...a,ref:p})}),g&&i.jsx(vv,{ref:d,onFocusFromOutsideViewport:()=>{const x=m({tabbingDirection:"backwards"});Pg(x)}})]})});VE.displayName=zE;var WE="ToastFocusProxy",vv=y.forwardRef((e,t)=>{const{__scopeToast:r,onFocusFromOutsideViewport:n,...s}=e,a=H0(WE,r);return i.jsx(W0,{"aria-hidden":!0,tabIndex:0,...s,ref:t,style:{position:"fixed"},onFocus:o=>{var u;const l=o.relatedTarget;!((u=a.viewport)!=null&&u.contains(l))&&n()}})});vv.displayName=WE;var vf="Toast",rF="toast.swipeStart",nF="toast.swipeMove",sF="toast.swipeCancel",aF="toast.swipeEnd",HE=y.forwardRef((e,t)=>{const{forceMount:r,open:n,defaultOpen:s,onOpenChange:a,...o}=e,[l,c]=Hn({prop:n,defaultProp:s??!0,onChange:a,caller:vf});return i.jsx(Ir,{present:r||l,children:i.jsx(lF,{open:l,...o,ref:t,onClose:()=>c(!1),onPause:hr(e.onPause),onResume:hr(e.onResume),onSwipeStart:Oe(e.onSwipeStart,u=>{u.currentTarget.setAttribute("data-swipe","start")}),onSwipeMove:Oe(e.onSwipeMove,u=>{const{x:d,y:f}=u.detail.delta;u.currentTarget.setAttribute("data-swipe","move"),u.currentTarget.style.setProperty("--radix-toast-swipe-move-x",`${d}px`),u.currentTarget.style.setProperty("--radix-toast-swipe-move-y",`${f}px`)}),onSwipeCancel:Oe(e.onSwipeCancel,u=>{u.currentTarget.setAttribute("data-swipe","cancel"),u.currentTarget.style.removeProperty("--radix-toast-swipe-move-x"),u.currentTarget.style.removeProperty("--radix-toast-swipe-move-y"),u.currentTarget.style.removeProperty("--radix-toast-swipe-end-x"),u.currentTarget.style.removeProperty("--radix-toast-swipe-end-y")}),onSwipeEnd:Oe(e.onSwipeEnd,u=>{const{x:d,y:f}=u.detail.delta;u.currentTarget.setAttribute("data-swipe","end"),u.currentTarget.style.removeProperty("--radix-toast-swipe-move-x"),u.currentTarget.style.removeProperty("--radix-toast-swipe-move-y"),u.currentTarget.style.setProperty("--radix-toast-swipe-end-x",`${d}px`),u.currentTarget.style.setProperty("--radix-toast-swipe-end-y",`${f}px`),c(!1)})})})});HE.displayName=vf;var[iF,oF]=BE(vf,{onClose(){}}),lF=y.forwardRef((e,t)=>{const{__scopeToast:r,type:n="foreground",duration:s,open:a,onClose:o,onEscapeKeyDown:l,onPause:c,onResume:u,onSwipeStart:d,onSwipeMove:f,onSwipeCancel:p,onSwipeEnd:h,...g}=e,m=H0(vf,r),[x,w]=y.useState(null),v=st(t,A=>w(A)),_=y.useRef(null),b=y.useRef(null),S=s||m.duration,T=y.useRef(0),N=y.useRef(S),C=y.useRef(0),{onToastAdd:E,onToastRemove:P}=m,R=hr(()=>{var I;(x==null?void 0:x.contains(document.activeElement))&&((I=m.viewport)==null||I.focus()),o()}),j=y.useCallback(A=>{!A||A===1/0||(window.clearTimeout(C.current),T.current=new Date().getTime(),C.current=window.setTimeout(R,A))},[R]);y.useEffect(()=>{const A=m.viewport;if(A){const I=()=>{j(N.current),u==null||u()},X=()=>{const Y=new Date().getTime()-T.current;N.current=N.current-Y,window.clearTimeout(C.current),c==null||c()};return A.addEventListener(gv,X),A.addEventListener(xv,I),()=>{A.removeEventListener(gv,X),A.removeEventListener(xv,I)}}},[m.viewport,S,c,u,j]),y.useEffect(()=>{a&&!m.isClosePausedRef.current&&j(S)},[a,S,m.isClosePausedRef,j]),y.useEffect(()=>(E(),()=>P()),[E,P]);const M=y.useMemo(()=>x?JE(x):null,[x]);return m.viewport?i.jsxs(i.Fragment,{children:[M&&i.jsx(cF,{__scopeToast:r,role:"status","aria-live":n==="foreground"?"assertive":"polite","aria-atomic":!0,children:M}),i.jsx(iF,{scope:r,onClose:R,children:xl.createPortal(i.jsx(u1.ItemSlot,{scope:r,children:i.jsx(U5,{asChild:!0,onEscapeKeyDown:Oe(l,()=>{m.isFocusedToastEscapeKeyDownRef.current||R(),m.isFocusedToastEscapeKeyDownRef.current=!1}),children:i.jsx(ze.li,{role:"status","aria-live":"off","aria-atomic":!0,tabIndex:0,"data-state":a?"open":"closed","data-swipe-direction":m.swipeDirection,...g,ref:v,style:{userSelect:"none",touchAction:"none",...e.style},onKeyDown:Oe(e.onKeyDown,A=>{A.key==="Escape"&&(l==null||l(A.nativeEvent),A.nativeEvent.defaultPrevented||(m.isFocusedToastEscapeKeyDownRef.current=!0,R()))}),onPointerDown:Oe(e.onPointerDown,A=>{A.button===0&&(_.current={x:A.clientX,y:A.clientY})}),onPointerMove:Oe(e.onPointerMove,A=>{if(!_.current)return;const I=A.clientX-_.current.x,X=A.clientY-_.current.y,Y=!!b.current,z=["left","right"].includes(m.swipeDirection),U=["left","up"].includes(m.swipeDirection)?Math.min:Math.max,V=z?U(0,I):0,F=z?0:U(0,X),D=A.pointerType==="touch"?10:2,G={x:V,y:F},O={originalEvent:A,delta:G};Y?(b.current=G,yh(nF,f,O,{discrete:!1})):kb(G,m.swipeDirection,D)?(b.current=G,yh(rF,d,O,{discrete:!1}),A.target.setPointerCapture(A.pointerId)):(Math.abs(I)>D||Math.abs(X)>D)&&(_.current=null)}),onPointerUp:Oe(e.onPointerUp,A=>{const I=b.current,X=A.target;if(X.hasPointerCapture(A.pointerId)&&X.releasePointerCapture(A.pointerId),b.current=null,_.current=null,I){const Y=A.currentTarget,z={originalEvent:A,delta:I};kb(I,m.swipeDirection,m.swipeThreshold)?yh(aF,h,z,{discrete:!0}):yh(sF,p,z,{discrete:!0}),Y.addEventListener("click",U=>U.preventDefault(),{once:!0})}})})})}),m.viewport)})]}):null}),cF=e=>{const{__scopeToast:t,children:r,...n}=e,s=H0(vf,t),[a,o]=y.useState(!1),[l,c]=y.useState(!1);return fF(()=>o(!0)),y.useEffect(()=>{const u=window.setTimeout(()=>c(!0),1e3);return()=>window.clearTimeout(u)},[]),l?null:i.jsx(Jc,{asChild:!0,children:i.jsx(W0,{...n,children:a&&i.jsxs(i.Fragment,{children:[s.label," ",r]})})})},uF="ToastTitle",GE=y.forwardRef((e,t)=>{const{__scopeToast:r,...n}=e;return i.jsx(ze.div,{...n,ref:t})});GE.displayName=uF;var dF="ToastDescription",qE=y.forwardRef((e,t)=>{const{__scopeToast:r,...n}=e;return i.jsx(ze.div,{...n,ref:t})});qE.displayName=dF;var YE="ToastAction",KE=y.forwardRef((e,t)=>{const{altText:r,...n}=e;return r.trim()?i.jsx(QE,{altText:r,asChild:!0,children:i.jsx(d1,{...n,ref:t})}):(console.error(`Invalid prop \`altText\` supplied to \`${YE}\`. Expected non-empty \`string\`.`),null)});KE.displayName=YE;var XE="ToastClose",d1=y.forwardRef((e,t)=>{const{__scopeToast:r,...n}=e,s=oF(XE,r);return i.jsx(QE,{asChild:!0,children:i.jsx(ze.button,{type:"button",...n,ref:t,onClick:Oe(e.onClick,s.onClose)})})});d1.displayName=XE;var QE=y.forwardRef((e,t)=>{const{__scopeToast:r,altText:n,...s}=e;return i.jsx(ze.div,{"data-radix-toast-announce-exclude":"","data-radix-toast-announce-alt":n||void 0,...s,ref:t})});function JE(e){const t=[];return Array.from(e.childNodes).forEach(n=>{if(n.nodeType===n.TEXT_NODE&&n.textContent&&t.push(n.textContent),hF(n)){const s=n.ariaHidden||n.hidden||n.style.display==="none",a=n.dataset.radixToastAnnounceExclude==="";if(!s)if(a){const o=n.dataset.radixToastAnnounceAlt;o&&t.push(o)}else t.push(...JE(n))}}),t}function yh(e,t,r,{discrete:n}){const s=r.originalEvent.currentTarget,a=new CustomEvent(e,{bubbles:!0,cancelable:!0,detail:r});t&&s.addEventListener(e,t,{once:!0}),n?l1(s,a):s.dispatchEvent(a)}var kb=(e,t,r=0)=>{const n=Math.abs(e.x),s=Math.abs(e.y),a=n>s;return t==="left"||t==="right"?a&&n>r:!a&&s>r};function fF(e=()=>{}){const t=hr(e);gr(()=>{let r=0,n=0;return r=window.requestAnimationFrame(()=>n=window.requestAnimationFrame(t)),()=>{window.cancelAnimationFrame(r),window.cancelAnimationFrame(n)}},[t])}function hF(e){return e.nodeType===e.ELEMENT_NODE}function mF(e){const t=[],r=document.createTreeWalker(e,NodeFilter.SHOW_ELEMENT,{acceptNode:n=>{const s=n.tagName==="INPUT"&&n.type==="hidden";return n.disabled||n.hidden||s?NodeFilter.FILTER_SKIP:n.tabIndex>=0?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP}});for(;r.nextNode();)t.push(r.currentNode);return t}function Pg(e){const t=document.activeElement;return e.some(r=>r===t?!0:(r.focus(),document.activeElement!==t))}var pF=UE,ZE=VE,ek=HE,tk=GE,rk=qE,nk=KE,sk=d1;function ak(e){var t,r,n="";if(typeof e=="string"||typeof e=="number")n+=e;else if(typeof e=="object")if(Array.isArray(e)){var s=e.length;for(t=0;t<s;t++)e[t]&&(r=ak(e[t]))&&(n&&(n+=" "),n+=r)}else for(r in e)e[r]&&(n&&(n+=" "),n+=r);return n}function ik(){for(var e,t,r=0,n="",s=arguments.length;r<s;r++)(e=arguments[r])&&(t=ak(e))&&(n&&(n+=" "),n+=t);return n}const Cb=e=>typeof e=="boolean"?`${e}`:e===0?"0":e,Tb=ik,yf=(e,t)=>r=>{var n;if((t==null?void 0:t.variants)==null)return Tb(e,r==null?void 0:r.class,r==null?void 0:r.className);const{variants:s,defaultVariants:a}=t,o=Object.keys(s).map(u=>{const d=r==null?void 0:r[u],f=a==null?void 0:a[u];if(d===null)return null;const p=Cb(d)||Cb(f);return s[u][p]}),l=r&&Object.entries(r).reduce((u,d)=>{let[f,p]=d;return p===void 0||(u[f]=p),u},{}),c=t==null||(n=t.compoundVariants)===null||n===void 0?void 0:n.reduce((u,d)=>{let{class:f,className:p,...h}=d;return Object.entries(h).every(g=>{let[m,x]=g;return Array.isArray(x)?x.includes({...a,...l}[m]):{...a,...l}[m]===x})?[...u,f,p]:u},[]);return Tb(e,o,c,r==null?void 0:r.class,r==null?void 0:r.className)};/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const gF=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),ok=(...e)=>e.filter((t,r,n)=>!!t&&t.trim()!==""&&n.indexOf(t)===r).join(" ").trim();/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var xF={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const vF=y.forwardRef(({color:e="currentColor",size:t=24,strokeWidth:r=2,absoluteStrokeWidth:n,className:s="",children:a,iconNode:o,...l},c)=>y.createElement("svg",{ref:c,...xF,width:t,height:t,stroke:e,strokeWidth:n?Number(r)*24/Number(t):r,className:ok("lucide",s),...l},[...o.map(([u,d])=>y.createElement(u,d)),...Array.isArray(a)?a:[a]]));/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Be=(e,t)=>{const r=y.forwardRef(({className:n,...s},a)=>y.createElement(vF,{ref:a,iconNode:t,className:ok(`lucide-${gF(e)}`,n),...s}));return r.displayName=`${e}`,r};/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Hu=Be("Activity",[["path",{d:"M22 12h-2.48a2 2 0 0 0-1.93 1.46l-2.35 8.36a.25.25 0 0 1-.48 0L9.24 2.18a.25.25 0 0 0-.48 0l-2.35 8.36A2 2 0 0 1 4.49 12H2",key:"169zse"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const G0=Be("ArrowLeft",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Bo=Be("Bell",[["path",{d:"M6 8a6 6 0 0 1 12 0c0 7 3 9 3 9H3s3-2 3-9",key:"1qo2s2"}],["path",{d:"M10.3 21a1.94 1.94 0 0 0 3.4 0",key:"qgo35s"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const yF=Be("CalendarDays",[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}],["path",{d:"M8 14h.01",key:"6423bh"}],["path",{d:"M12 14h.01",key:"1etili"}],["path",{d:"M16 14h.01",key:"1gbofw"}],["path",{d:"M8 18h.01",key:"lrp35t"}],["path",{d:"M12 18h.01",key:"mhygvu"}],["path",{d:"M16 18h.01",key:"kzsmim"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const en=Be("Calendar",[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Wi=Be("ChartColumn",[["path",{d:"M3 3v16a2 2 0 0 0 2 2h16",key:"c24i48"}],["path",{d:"M18 17V9",key:"2bz60n"}],["path",{d:"M13 17V5",key:"1frdt8"}],["path",{d:"M8 17v-3",key:"17ska0"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Qa=Be("Check",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Zc=Be("ChevronDown",[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const lk=Be("ChevronLeft",[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const f1=Be("ChevronRight",[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const h1=Be("ChevronUp",[["path",{d:"m18 15-6-6-6 6",key:"153udz"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ea=Be("CircleAlert",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const as=Be("CircleCheckBig",[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const yv=Be("CircleMinus",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M8 12h8",key:"1wcyev"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ro=Be("CircleX",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ck=Be("Circle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const qr=Be("Clock",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Bm=Be("Copy",[["rect",{width:"14",height:"14",x:"8",y:"8",rx:"2",ry:"2",key:"17jyea"}],["path",{d:"M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2",key:"zix9uf"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const wv=Be("Crown",[["path",{d:"M11.562 3.266a.5.5 0 0 1 .876 0L15.39 8.87a1 1 0 0 0 1.516.294L21.183 5.5a.5.5 0 0 1 .798.519l-2.834 10.246a1 1 0 0 1-.956.734H5.81a1 1 0 0 1-.957-.734L2.02 6.02a.5.5 0 0 1 .798-.519l4.276 3.664a1 1 0 0 0 1.516-.294z",key:"1vdc57"}],["path",{d:"M5 21h14",key:"11awu3"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const wF=Be("Dot",[["circle",{cx:"12.1",cy:"12.1",r:"1",key:"18d7e5"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const js=Be("Download",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"7 10 12 15 17 10",key:"2ggqvy"}],["line",{x1:"12",x2:"12",y1:"15",y2:"3",key:"1vk2je"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Id=Be("EllipsisVertical",[["circle",{cx:"12",cy:"12",r:"1",key:"41hilf"}],["circle",{cx:"12",cy:"5",r:"1",key:"gxeob9"}],["circle",{cx:"12",cy:"19",r:"1",key:"lyex9k"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ta=Be("ExternalLink",[["path",{d:"M15 3h6v6",key:"1q9fwt"}],["path",{d:"M10 14 21 3",key:"gplh6r"}],["path",{d:"M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6",key:"a6xqqp"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const nm=Be("EyeOff",[["path",{d:"M10.733 5.076a10.744 10.744 0 0 1 11.205 6.575 1 1 0 0 1 0 .696 10.747 10.747 0 0 1-1.444 2.49",key:"ct8e1f"}],["path",{d:"M14.084 14.158a3 3 0 0 1-4.242-4.242",key:"151rxh"}],["path",{d:"M17.479 17.499a10.75 10.75 0 0 1-15.417-5.151 1 1 0 0 1 0-.696 10.75 10.75 0 0 1 4.446-5.143",key:"13bj9a"}],["path",{d:"m2 2 20 20",key:"1ooewy"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Or=Be("Eye",[["path",{d:"M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0",key:"1nclc0"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const tr=Be("FileText",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ld=Be("File",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ac=Be("FolderOpen",[["path",{d:"m6 14 1.5-2.9A2 2 0 0 1 9.24 10H20a2 2 0 0 1 1.94 2.5l-1.54 6a2 2 0 0 1-1.95 1.5H4a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h3.9a2 2 0 0 1 1.69.9l.81 1.2a2 2 0 0 0 1.67.9H18a2 2 0 0 1 2 2v2",key:"usdka0"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _F=Be("Globe",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 2a14.5 14.5 0 0 0 0 20 14.5 14.5 0 0 0 0-20",key:"13o1zl"}],["path",{d:"M2 12h20",key:"9i4pu4"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const bF=Be("Grid3x3",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M3 9h18",key:"1pudct"}],["path",{d:"M3 15h18",key:"5xshup"}],["path",{d:"M9 3v18",key:"fh3hqa"}],["path",{d:"M15 3v18",key:"14nvp0"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const wf=Be("House",[["path",{d:"M15 21v-8a1 1 0 0 0-1-1h-4a1 1 0 0 0-1 1v8",key:"5wwlr5"}],["path",{d:"M3 10a2 2 0 0 1 .709-1.528l7-5.999a2 2 0 0 1 2.582 0l7 5.999A2 2 0 0 1 21 10v9a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z",key:"1d0kgt"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const SF=Be("List",[["path",{d:"M3 12h.01",key:"nlz23k"}],["path",{d:"M3 18h.01",key:"1tta3j"}],["path",{d:"M3 6h.01",key:"1rqtza"}],["path",{d:"M8 12h13",key:"1za7za"}],["path",{d:"M8 18h13",key:"1lx6n3"}],["path",{d:"M8 6h13",key:"ik3vkj"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const NF=Be("LoaderCircle",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Dg=Be("Loader",[["path",{d:"M12 2v4",key:"3427ic"}],["path",{d:"m16.2 7.8 2.9-2.9",key:"r700ao"}],["path",{d:"M18 12h4",key:"wj9ykh"}],["path",{d:"m16.2 16.2 2.9 2.9",key:"1bxg5t"}],["path",{d:"M12 18v4",key:"jadmvz"}],["path",{d:"m4.9 19.1 2.9-2.9",key:"bwix9q"}],["path",{d:"M2 12h4",key:"j09sii"}],["path",{d:"m4.9 4.9 2.9 2.9",key:"giyufr"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const jF=Be("LockOpen",[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 9.9-1",key:"1mm8w8"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ti=Be("Lock",[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const EF=Be("LogOut",[["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}],["polyline",{points:"16 17 21 12 16 7",key:"1gabdz"}],["line",{x1:"21",x2:"9",y1:"12",y2:"12",key:"1uyos4"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ta=Be("Mail",[["rect",{width:"20",height:"16",x:"2",y:"4",rx:"2",key:"18n3k1"}],["path",{d:"m22 7-8.97 5.7a1.94 1.94 0 0 1-2.06 0L2 7",key:"1ocrg3"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ri=Be("MapPin",[["path",{d:"M20 10c0 4.993-5.539 10.193-7.399 11.799a1 1 0 0 1-1.202 0C9.539 20.193 4 14.993 4 10a8 8 0 0 1 16 0",key:"1r0f0z"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const kF=Be("Menu",[["line",{x1:"4",x2:"20",y1:"12",y2:"12",key:"1e0a9i"}],["line",{x1:"4",x2:"20",y1:"6",y2:"6",key:"1owob3"}],["line",{x1:"4",x2:"20",y1:"18",y2:"18",key:"yk5zj1"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const CF=Be("Minus",[["path",{d:"M5 12h14",key:"1ays0h"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const TF=Be("Monitor",[["rect",{width:"20",height:"14",x:"2",y:"3",rx:"2",key:"48i651"}],["line",{x1:"8",x2:"16",y1:"21",y2:"21",key:"1svkeh"}],["line",{x1:"12",x2:"12",y1:"17",y2:"21",key:"vw1qmm"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ab=Be("Move",[["path",{d:"M12 2v20",key:"t6zp3m"}],["path",{d:"m15 19-3 3-3-3",key:"11eu04"}],["path",{d:"m19 9 3 3-3 3",key:"1mg7y2"}],["path",{d:"M2 12h20",key:"9i4pu4"}],["path",{d:"m5 9-3 3 3 3",key:"j64kie"}],["path",{d:"m9 5 3-3 3 3",key:"l8vdw6"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ic=Be("Paperclip",[["path",{d:"m21.44 11.05-9.19 9.19a6 6 0 0 1-8.49-8.49l8.57-8.57A4 4 0 1 1 18 8.84l-8.59 8.57a2 2 0 0 1-2.83-2.83l8.49-8.48",key:"1u3ebp"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _v=Be("PenLine",[["path",{d:"M12 20h9",key:"t2du7b"}],["path",{d:"M16.376 3.622a1 1 0 0 1 3.002 3.002L7.368 18.635a2 2 0 0 1-.855.506l-2.872.838a.5.5 0 0 1-.62-.62l.838-2.872a2 2 0 0 1 .506-.854z",key:"1ykcvy"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const AF=Be("Pencil",[["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}],["path",{d:"m15 5 4 4",key:"1mk7zo"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _f=Be("Phone",[["path",{d:"M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z",key:"foiqr5"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const PF=Be("Plug",[["path",{d:"M12 22v-5",key:"1ega77"}],["path",{d:"M9 8V2",key:"14iosj"}],["path",{d:"M15 8V2",key:"18g5xt"}],["path",{d:"M18 8v5a4 4 0 0 1-4 4h-4a4 4 0 0 1-4-4V8Z",key:"osxo6l"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Pa=Be("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const os=Be("RefreshCw",[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const bv=Be("RotateCcw",[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const m1=Be("Save",[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z",key:"1c8476"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7",key:"1ydtos"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7",key:"t51u73"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const q0=Be("Search",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const bf=Be("Settings",[["path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z",key:"1qme2f"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const nl=Be("Shield",[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const DF=Be("Smartphone",[["rect",{width:"14",height:"20",x:"5",y:"2",rx:"2",ry:"2",key:"1yt0o3"}],["path",{d:"M12 18h.01",key:"mhygvu"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const uk=Be("SquareCheckBig",[["path",{d:"M21 10.5V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h12.5",key:"1uzm8b"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const sm=Be("SquarePen",[["path",{d:"M12 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1m0v6g"}],["path",{d:"M18.375 2.625a1 1 0 0 1 3 3l-9.013 9.014a2 2 0 0 1-.853.505l-2.873.84a.5.5 0 0 1-.62-.62l.84-2.873a2 2 0 0 1 .506-.852z",key:"ohrbg2"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const RF=Be("Square",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const MF=Be("StarOff",[["path",{d:"M8.34 8.34 2 9.27l5 4.87L5.82 21 12 17.77 18.18 21l-.59-3.43",key:"16m0ql"}],["path",{d:"M18.42 12.76 22 9.27l-6.91-1L12 2l-1.44 2.91",key:"1vt8nq"}],["line",{x1:"2",x2:"22",y1:"2",y2:"22",key:"a6p6uj"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Sv=Be("Star",[["path",{d:"M11.525 2.295a.53.53 0 0 1 .95 0l2.31 4.679a2.123 2.123 0 0 0 1.595 1.16l5.166.756a.53.53 0 0 1 .294.904l-3.736 3.638a2.123 2.123 0 0 0-.611 1.878l.882 5.14a.53.53 0 0 1-.771.56l-4.618-2.428a2.122 2.122 0 0 0-1.973 0L6.396 21.01a.53.53 0 0 1-.77-.56l.881-5.139a2.122 2.122 0 0 0-.611-1.879L2.16 9.795a.53.53 0 0 1 .294-.906l5.165-.755a2.122 2.122 0 0 0 1.597-1.16z",key:"r04s7s"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const OF=Be("Target",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["circle",{cx:"12",cy:"12",r:"6",key:"1vlfrh"}],["circle",{cx:"12",cy:"12",r:"2",key:"1c9p78"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const FF=Be("ThumbsDown",[["path",{d:"M17 14V2",key:"8ymqnk"}],["path",{d:"M9 18.12 10 14H4.17a2 2 0 0 1-1.92-2.56l2.33-8A2 2 0 0 1 6.5 2H20a2 2 0 0 1 2 2v8a2 2 0 0 1-2 2h-2.76a2 2 0 0 0-1.79 1.11L12 22a3.13 3.13 0 0 1-3-3.88Z",key:"m61m77"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const IF=Be("ThumbsUp",[["path",{d:"M7 10v12",key:"1qc93n"}],["path",{d:"M15 5.88 14 10h5.83a2 2 0 0 1 1.92 2.56l-2.33 8A2 2 0 0 1 17.5 22H4a2 2 0 0 1-2-2v-8a2 2 0 0 1 2-2h2.76a2 2 0 0 0 1.79-1.11L12 2a3.13 3.13 0 0 1 3 3.88Z",key:"emmmcr"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const yr=Be("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const LF=Be("TrendingUp",[["polyline",{points:"22 7 13.5 15.5 8.5 10.5 2 17",key:"126l90"}],["polyline",{points:"16 7 22 7 22 13",key:"kwv8wd"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const p1=Be("TriangleAlert",[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3",key:"wmoenq"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Pb=Be("Unlink",[["path",{d:"m18.84 12.25 1.72-1.71h-.02a5.004 5.004 0 0 0-.12-7.07 5.006 5.006 0 0 0-6.95 0l-1.72 1.71",key:"yqzxt4"}],["path",{d:"m5.17 11.75-1.71 1.71a5.004 5.004 0 0 0 .12 7.07 5.006 5.006 0 0 0 6.95 0l1.71-1.71",key:"4qinb0"}],["line",{x1:"8",x2:"8",y1:"2",y2:"5",key:"1041cp"}],["line",{x1:"2",x2:"5",y1:"8",y2:"8",key:"14m1p5"}],["line",{x1:"16",x2:"16",y1:"19",y2:"22",key:"rzdirn"}],["line",{x1:"19",x2:"22",y1:"16",y2:"16",key:"ox905f"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const g1=Be("Upload",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"17 8 12 3 7 8",key:"t8dd8p"}],["line",{x1:"12",x2:"12",y1:"3",y2:"15",key:"widbto"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const sl=Be("UserCheck",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["polyline",{points:"16 11 18 13 22 9",key:"1pwet4"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Nv=Be("UserX",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"17",x2:"22",y1:"8",y2:"13",key:"3nzzx3"}],["line",{x1:"22",x2:"17",y1:"8",y2:"13",key:"1swrse"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const lo=Be("User",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const mr=Be("Users",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["path",{d:"M16 3.13a4 4 0 0 1 0 7.75",key:"1da9ce"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ra=Be("Video",[["path",{d:"m16 13 5.223 3.482a.5.5 0 0 0 .777-.416V7.87a.5.5 0 0 0-.752-.432L16 10.5",key:"ftymec"}],["rect",{x:"2",y:"6",width:"14",height:"12",rx:"2",key:"158x01"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Gs=Be("Vote",[["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}],["path",{d:"M5 7c0-1.1.9-2 2-2h10a2 2 0 0 1 2 2v12H5V7Z",key:"1ezoue"}],["path",{d:"M22 19H2",key:"nuriw5"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $F=Be("Wifi",[["path",{d:"M12 20h.01",key:"zekei9"}],["path",{d:"M2 8.82a15 15 0 0 1 20 0",key:"dnpr2z"}],["path",{d:"M5 12.859a10 10 0 0 1 14 0",key:"1x1e6c"}],["path",{d:"M8.5 16.429a5 5 0 0 1 7 0",key:"1bycff"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Cn=Be("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const BF=Be("ZoomIn",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["line",{x1:"21",x2:"16.65",y1:"21",y2:"16.65",key:"13gj7c"}],["line",{x1:"11",x2:"11",y1:"8",y2:"14",key:"1vmskp"}],["line",{x1:"8",x2:"14",y1:"11",y2:"11",key:"durymu"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const UF=Be("ZoomOut",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["line",{x1:"21",x2:"16.65",y1:"21",y2:"16.65",key:"13gj7c"}],["line",{x1:"8",x2:"14",y1:"11",y2:"11",key:"durymu"}]]),x1="-",zF=e=>{const t=WF(e),{conflictingClassGroups:r,conflictingClassGroupModifiers:n}=e;return{getClassGroupId:o=>{const l=o.split(x1);return l[0]===""&&l.length!==1&&l.shift(),dk(l,t)||VF(o)},getConflictingClassGroupIds:(o,l)=>{const c=r[o]||[];return l&&n[o]?[...c,...n[o]]:c}}},dk=(e,t)=>{var o;if(e.length===0)return t.classGroupId;const r=e[0],n=t.nextPart.get(r),s=n?dk(e.slice(1),n):void 0;if(s)return s;if(t.validators.length===0)return;const a=e.join(x1);return(o=t.validators.find(({validator:l})=>l(a)))==null?void 0:o.classGroupId},Db=/^\[(.+)\]$/,VF=e=>{if(Db.test(e)){const t=Db.exec(e)[1],r=t==null?void 0:t.substring(0,t.indexOf(":"));if(r)return"arbitrary.."+r}},WF=e=>{const{theme:t,prefix:r}=e,n={nextPart:new Map,validators:[]};return GF(Object.entries(e.classGroups),r).forEach(([a,o])=>{jv(o,n,a,t)}),n},jv=(e,t,r,n)=>{e.forEach(s=>{if(typeof s=="string"){const a=s===""?t:Rb(t,s);a.classGroupId=r;return}if(typeof s=="function"){if(HF(s)){jv(s(n),t,r,n);return}t.validators.push({validator:s,classGroupId:r});return}Object.entries(s).forEach(([a,o])=>{jv(o,Rb(t,a),r,n)})})},Rb=(e,t)=>{let r=e;return t.split(x1).forEach(n=>{r.nextPart.has(n)||r.nextPart.set(n,{nextPart:new Map,validators:[]}),r=r.nextPart.get(n)}),r},HF=e=>e.isThemeGetter,GF=(e,t)=>t?e.map(([r,n])=>{const s=n.map(a=>typeof a=="string"?t+a:typeof a=="object"?Object.fromEntries(Object.entries(a).map(([o,l])=>[t+o,l])):a);return[r,s]}):e,qF=e=>{if(e<1)return{get:()=>{},set:()=>{}};let t=0,r=new Map,n=new Map;const s=(a,o)=>{r.set(a,o),t++,t>e&&(t=0,n=r,r=new Map)};return{get(a){let o=r.get(a);if(o!==void 0)return o;if((o=n.get(a))!==void 0)return s(a,o),o},set(a,o){r.has(a)?r.set(a,o):s(a,o)}}},fk="!",YF=e=>{const{separator:t,experimentalParseClassName:r}=e,n=t.length===1,s=t[0],a=t.length,o=l=>{const c=[];let u=0,d=0,f;for(let x=0;x<l.length;x++){let w=l[x];if(u===0){if(w===s&&(n||l.slice(x,x+a)===t)){c.push(l.slice(d,x)),d=x+a;continue}if(w==="/"){f=x;continue}}w==="["?u++:w==="]"&&u--}const p=c.length===0?l:l.substring(d),h=p.startsWith(fk),g=h?p.substring(1):p,m=f&&f>d?f-d:void 0;return{modifiers:c,hasImportantModifier:h,baseClassName:g,maybePostfixModifierPosition:m}};return r?l=>r({className:l,parseClassName:o}):o},KF=e=>{if(e.length<=1)return e;const t=[];let r=[];return e.forEach(n=>{n[0]==="["?(t.push(...r.sort(),n),r=[]):r.push(n)}),t.push(...r.sort()),t},XF=e=>({cache:qF(e.cacheSize),parseClassName:YF(e),...zF(e)}),QF=/\s+/,JF=(e,t)=>{const{parseClassName:r,getClassGroupId:n,getConflictingClassGroupIds:s}=t,a=[],o=e.trim().split(QF);let l="";for(let c=o.length-1;c>=0;c-=1){const u=o[c],{modifiers:d,hasImportantModifier:f,baseClassName:p,maybePostfixModifierPosition:h}=r(u);let g=!!h,m=n(g?p.substring(0,h):p);if(!m){if(!g){l=u+(l.length>0?" "+l:l);continue}if(m=n(p),!m){l=u+(l.length>0?" "+l:l);continue}g=!1}const x=KF(d).join(":"),w=f?x+fk:x,v=w+m;if(a.includes(v))continue;a.push(v);const _=s(m,g);for(let b=0;b<_.length;++b){const S=_[b];a.push(w+S)}l=u+(l.length>0?" "+l:l)}return l};function ZF(){let e=0,t,r,n="";for(;e<arguments.length;)(t=arguments[e++])&&(r=hk(t))&&(n&&(n+=" "),n+=r);return n}const hk=e=>{if(typeof e=="string")return e;let t,r="";for(let n=0;n<e.length;n++)e[n]&&(t=hk(e[n]))&&(r&&(r+=" "),r+=t);return r};function eI(e,...t){let r,n,s,a=o;function o(c){const u=t.reduce((d,f)=>f(d),e());return r=XF(u),n=r.cache.get,s=r.cache.set,a=l,l(c)}function l(c){const u=n(c);if(u)return u;const d=JF(c,r);return s(c,d),d}return function(){return a(ZF.apply(null,arguments))}}const Gt=e=>{const t=r=>r[e]||[];return t.isThemeGetter=!0,t},mk=/^\[(?:([a-z-]+):)?(.+)\]$/i,tI=/^\d+\/\d+$/,rI=new Set(["px","full","screen"]),nI=/^(\d+(\.\d+)?)?(xs|sm|md|lg|xl)$/,sI=/\d+(%|px|r?em|[sdl]?v([hwib]|min|max)|pt|pc|in|cm|mm|cap|ch|ex|r?lh|cq(w|h|i|b|min|max))|\b(calc|min|max|clamp)\(.+\)|^0$/,aI=/^(rgba?|hsla?|hwb|(ok)?(lab|lch))\(.+\)$/,iI=/^(inset_)?-?((\d+)?\.?(\d+)[a-z]+|0)_-?((\d+)?\.?(\d+)[a-z]+|0)/,oI=/^(url|image|image-set|cross-fade|element|(repeating-)?(linear|radial|conic)-gradient)\(.+\)$/,La=e=>hc(e)||rI.has(e)||tI.test(e),_i=e=>eu(e,"length",pI),hc=e=>!!e&&!Number.isNaN(Number(e)),Rg=e=>eu(e,"number",hc),Tu=e=>!!e&&Number.isInteger(Number(e)),lI=e=>e.endsWith("%")&&hc(e.slice(0,-1)),ut=e=>mk.test(e),bi=e=>nI.test(e),cI=new Set(["length","size","percentage"]),uI=e=>eu(e,cI,pk),dI=e=>eu(e,"position",pk),fI=new Set(["image","url"]),hI=e=>eu(e,fI,xI),mI=e=>eu(e,"",gI),Au=()=>!0,eu=(e,t,r)=>{const n=mk.exec(e);return n?n[1]?typeof t=="string"?n[1]===t:t.has(n[1]):r(n[2]):!1},pI=e=>sI.test(e)&&!aI.test(e),pk=()=>!1,gI=e=>iI.test(e),xI=e=>oI.test(e),vI=()=>{const e=Gt("colors"),t=Gt("spacing"),r=Gt("blur"),n=Gt("brightness"),s=Gt("borderColor"),a=Gt("borderRadius"),o=Gt("borderSpacing"),l=Gt("borderWidth"),c=Gt("contrast"),u=Gt("grayscale"),d=Gt("hueRotate"),f=Gt("invert"),p=Gt("gap"),h=Gt("gradientColorStops"),g=Gt("gradientColorStopPositions"),m=Gt("inset"),x=Gt("margin"),w=Gt("opacity"),v=Gt("padding"),_=Gt("saturate"),b=Gt("scale"),S=Gt("sepia"),T=Gt("skew"),N=Gt("space"),C=Gt("translate"),E=()=>["auto","contain","none"],P=()=>["auto","hidden","clip","visible","scroll"],R=()=>["auto",ut,t],j=()=>[ut,t],M=()=>["",La,_i],A=()=>["auto",hc,ut],I=()=>["bottom","center","left","left-bottom","left-top","right","right-bottom","right-top","top"],X=()=>["solid","dashed","dotted","double","none"],Y=()=>["normal","multiply","screen","overlay","darken","lighten","color-dodge","color-burn","hard-light","soft-light","difference","exclusion","hue","saturation","color","luminosity"],z=()=>["start","end","center","between","around","evenly","stretch"],U=()=>["","0",ut],V=()=>["auto","avoid","all","avoid-page","page","left","right","column"],F=()=>[hc,ut];return{cacheSize:500,separator:":",theme:{colors:[Au],spacing:[La,_i],blur:["none","",bi,ut],brightness:F(),borderColor:[e],borderRadius:["none","","full",bi,ut],borderSpacing:j(),borderWidth:M(),contrast:F(),grayscale:U(),hueRotate:F(),invert:U(),gap:j(),gradientColorStops:[e],gradientColorStopPositions:[lI,_i],inset:R(),margin:R(),opacity:F(),padding:j(),saturate:F(),scale:F(),sepia:U(),skew:F(),space:j(),translate:j()},classGroups:{aspect:[{aspect:["auto","square","video",ut]}],container:["container"],columns:[{columns:[bi]}],"break-after":[{"break-after":V()}],"break-before":[{"break-before":V()}],"break-inside":[{"break-inside":["auto","avoid","avoid-page","avoid-column"]}],"box-decoration":[{"box-decoration":["slice","clone"]}],box:[{box:["border","content"]}],display:["block","inline-block","inline","flex","inline-flex","table","inline-table","table-caption","table-cell","table-column","table-column-group","table-footer-group","table-header-group","table-row-group","table-row","flow-root","grid","inline-grid","contents","list-item","hidden"],float:[{float:["right","left","none","start","end"]}],clear:[{clear:["left","right","both","none","start","end"]}],isolation:["isolate","isolation-auto"],"object-fit":[{object:["contain","cover","fill","none","scale-down"]}],"object-position":[{object:[...I(),ut]}],overflow:[{overflow:P()}],"overflow-x":[{"overflow-x":P()}],"overflow-y":[{"overflow-y":P()}],overscroll:[{overscroll:E()}],"overscroll-x":[{"overscroll-x":E()}],"overscroll-y":[{"overscroll-y":E()}],position:["static","fixed","absolute","relative","sticky"],inset:[{inset:[m]}],"inset-x":[{"inset-x":[m]}],"inset-y":[{"inset-y":[m]}],start:[{start:[m]}],end:[{end:[m]}],top:[{top:[m]}],right:[{right:[m]}],bottom:[{bottom:[m]}],left:[{left:[m]}],visibility:["visible","invisible","collapse"],z:[{z:["auto",Tu,ut]}],basis:[{basis:R()}],"flex-direction":[{flex:["row","row-reverse","col","col-reverse"]}],"flex-wrap":[{flex:["wrap","wrap-reverse","nowrap"]}],flex:[{flex:["1","auto","initial","none",ut]}],grow:[{grow:U()}],shrink:[{shrink:U()}],order:[{order:["first","last","none",Tu,ut]}],"grid-cols":[{"grid-cols":[Au]}],"col-start-end":[{col:["auto",{span:["full",Tu,ut]},ut]}],"col-start":[{"col-start":A()}],"col-end":[{"col-end":A()}],"grid-rows":[{"grid-rows":[Au]}],"row-start-end":[{row:["auto",{span:[Tu,ut]},ut]}],"row-start":[{"row-start":A()}],"row-end":[{"row-end":A()}],"grid-flow":[{"grid-flow":["row","col","dense","row-dense","col-dense"]}],"auto-cols":[{"auto-cols":["auto","min","max","fr",ut]}],"auto-rows":[{"auto-rows":["auto","min","max","fr",ut]}],gap:[{gap:[p]}],"gap-x":[{"gap-x":[p]}],"gap-y":[{"gap-y":[p]}],"justify-content":[{justify:["normal",...z()]}],"justify-items":[{"justify-items":["start","end","center","stretch"]}],"justify-self":[{"justify-self":["auto","start","end","center","stretch"]}],"align-content":[{content:["normal",...z(),"baseline"]}],"align-items":[{items:["start","end","center","baseline","stretch"]}],"align-self":[{self:["auto","start","end","center","stretch","baseline"]}],"place-content":[{"place-content":[...z(),"baseline"]}],"place-items":[{"place-items":["start","end","center","baseline","stretch"]}],"place-self":[{"place-self":["auto","start","end","center","stretch"]}],p:[{p:[v]}],px:[{px:[v]}],py:[{py:[v]}],ps:[{ps:[v]}],pe:[{pe:[v]}],pt:[{pt:[v]}],pr:[{pr:[v]}],pb:[{pb:[v]}],pl:[{pl:[v]}],m:[{m:[x]}],mx:[{mx:[x]}],my:[{my:[x]}],ms:[{ms:[x]}],me:[{me:[x]}],mt:[{mt:[x]}],mr:[{mr:[x]}],mb:[{mb:[x]}],ml:[{ml:[x]}],"space-x":[{"space-x":[N]}],"space-x-reverse":["space-x-reverse"],"space-y":[{"space-y":[N]}],"space-y-reverse":["space-y-reverse"],w:[{w:["auto","min","max","fit","svw","lvw","dvw",ut,t]}],"min-w":[{"min-w":[ut,t,"min","max","fit"]}],"max-w":[{"max-w":[ut,t,"none","full","min","max","fit","prose",{screen:[bi]},bi]}],h:[{h:[ut,t,"auto","min","max","fit","svh","lvh","dvh"]}],"min-h":[{"min-h":[ut,t,"min","max","fit","svh","lvh","dvh"]}],"max-h":[{"max-h":[ut,t,"min","max","fit","svh","lvh","dvh"]}],size:[{size:[ut,t,"auto","min","max","fit"]}],"font-size":[{text:["base",bi,_i]}],"font-smoothing":["antialiased","subpixel-antialiased"],"font-style":["italic","not-italic"],"font-weight":[{font:["thin","extralight","light","normal","medium","semibold","bold","extrabold","black",Rg]}],"font-family":[{font:[Au]}],"fvn-normal":["normal-nums"],"fvn-ordinal":["ordinal"],"fvn-slashed-zero":["slashed-zero"],"fvn-figure":["lining-nums","oldstyle-nums"],"fvn-spacing":["proportional-nums","tabular-nums"],"fvn-fraction":["diagonal-fractions","stacked-fractions"],tracking:[{tracking:["tighter","tight","normal","wide","wider","widest",ut]}],"line-clamp":[{"line-clamp":["none",hc,Rg]}],leading:[{leading:["none","tight","snug","normal","relaxed","loose",La,ut]}],"list-image":[{"list-image":["none",ut]}],"list-style-type":[{list:["none","disc","decimal",ut]}],"list-style-position":[{list:["inside","outside"]}],"placeholder-color":[{placeholder:[e]}],"placeholder-opacity":[{"placeholder-opacity":[w]}],"text-alignment":[{text:["left","center","right","justify","start","end"]}],"text-color":[{text:[e]}],"text-opacity":[{"text-opacity":[w]}],"text-decoration":["underline","overline","line-through","no-underline"],"text-decoration-style":[{decoration:[...X(),"wavy"]}],"text-decoration-thickness":[{decoration:["auto","from-font",La,_i]}],"underline-offset":[{"underline-offset":["auto",La,ut]}],"text-decoration-color":[{decoration:[e]}],"text-transform":["uppercase","lowercase","capitalize","normal-case"],"text-overflow":["truncate","text-ellipsis","text-clip"],"text-wrap":[{text:["wrap","nowrap","balance","pretty"]}],indent:[{indent:j()}],"vertical-align":[{align:["baseline","top","middle","bottom","text-top","text-bottom","sub","super",ut]}],whitespace:[{whitespace:["normal","nowrap","pre","pre-line","pre-wrap","break-spaces"]}],break:[{break:["normal","words","all","keep"]}],hyphens:[{hyphens:["none","manual","auto"]}],content:[{content:["none",ut]}],"bg-attachment":[{bg:["fixed","local","scroll"]}],"bg-clip":[{"bg-clip":["border","padding","content","text"]}],"bg-opacity":[{"bg-opacity":[w]}],"bg-origin":[{"bg-origin":["border","padding","content"]}],"bg-position":[{bg:[...I(),dI]}],"bg-repeat":[{bg:["no-repeat",{repeat:["","x","y","round","space"]}]}],"bg-size":[{bg:["auto","cover","contain",uI]}],"bg-image":[{bg:["none",{"gradient-to":["t","tr","r","br","b","bl","l","tl"]},hI]}],"bg-color":[{bg:[e]}],"gradient-from-pos":[{from:[g]}],"gradient-via-pos":[{via:[g]}],"gradient-to-pos":[{to:[g]}],"gradient-from":[{from:[h]}],"gradient-via":[{via:[h]}],"gradient-to":[{to:[h]}],rounded:[{rounded:[a]}],"rounded-s":[{"rounded-s":[a]}],"rounded-e":[{"rounded-e":[a]}],"rounded-t":[{"rounded-t":[a]}],"rounded-r":[{"rounded-r":[a]}],"rounded-b":[{"rounded-b":[a]}],"rounded-l":[{"rounded-l":[a]}],"rounded-ss":[{"rounded-ss":[a]}],"rounded-se":[{"rounded-se":[a]}],"rounded-ee":[{"rounded-ee":[a]}],"rounded-es":[{"rounded-es":[a]}],"rounded-tl":[{"rounded-tl":[a]}],"rounded-tr":[{"rounded-tr":[a]}],"rounded-br":[{"rounded-br":[a]}],"rounded-bl":[{"rounded-bl":[a]}],"border-w":[{border:[l]}],"border-w-x":[{"border-x":[l]}],"border-w-y":[{"border-y":[l]}],"border-w-s":[{"border-s":[l]}],"border-w-e":[{"border-e":[l]}],"border-w-t":[{"border-t":[l]}],"border-w-r":[{"border-r":[l]}],"border-w-b":[{"border-b":[l]}],"border-w-l":[{"border-l":[l]}],"border-opacity":[{"border-opacity":[w]}],"border-style":[{border:[...X(),"hidden"]}],"divide-x":[{"divide-x":[l]}],"divide-x-reverse":["divide-x-reverse"],"divide-y":[{"divide-y":[l]}],"divide-y-reverse":["divide-y-reverse"],"divide-opacity":[{"divide-opacity":[w]}],"divide-style":[{divide:X()}],"border-color":[{border:[s]}],"border-color-x":[{"border-x":[s]}],"border-color-y":[{"border-y":[s]}],"border-color-s":[{"border-s":[s]}],"border-color-e":[{"border-e":[s]}],"border-color-t":[{"border-t":[s]}],"border-color-r":[{"border-r":[s]}],"border-color-b":[{"border-b":[s]}],"border-color-l":[{"border-l":[s]}],"divide-color":[{divide:[s]}],"outline-style":[{outline:["",...X()]}],"outline-offset":[{"outline-offset":[La,ut]}],"outline-w":[{outline:[La,_i]}],"outline-color":[{outline:[e]}],"ring-w":[{ring:M()}],"ring-w-inset":["ring-inset"],"ring-color":[{ring:[e]}],"ring-opacity":[{"ring-opacity":[w]}],"ring-offset-w":[{"ring-offset":[La,_i]}],"ring-offset-color":[{"ring-offset":[e]}],shadow:[{shadow:["","inner","none",bi,mI]}],"shadow-color":[{shadow:[Au]}],opacity:[{opacity:[w]}],"mix-blend":[{"mix-blend":[...Y(),"plus-lighter","plus-darker"]}],"bg-blend":[{"bg-blend":Y()}],filter:[{filter:["","none"]}],blur:[{blur:[r]}],brightness:[{brightness:[n]}],contrast:[{contrast:[c]}],"drop-shadow":[{"drop-shadow":["","none",bi,ut]}],grayscale:[{grayscale:[u]}],"hue-rotate":[{"hue-rotate":[d]}],invert:[{invert:[f]}],saturate:[{saturate:[_]}],sepia:[{sepia:[S]}],"backdrop-filter":[{"backdrop-filter":["","none"]}],"backdrop-blur":[{"backdrop-blur":[r]}],"backdrop-brightness":[{"backdrop-brightness":[n]}],"backdrop-contrast":[{"backdrop-contrast":[c]}],"backdrop-grayscale":[{"backdrop-grayscale":[u]}],"backdrop-hue-rotate":[{"backdrop-hue-rotate":[d]}],"backdrop-invert":[{"backdrop-invert":[f]}],"backdrop-opacity":[{"backdrop-opacity":[w]}],"backdrop-saturate":[{"backdrop-saturate":[_]}],"backdrop-sepia":[{"backdrop-sepia":[S]}],"border-collapse":[{border:["collapse","separate"]}],"border-spacing":[{"border-spacing":[o]}],"border-spacing-x":[{"border-spacing-x":[o]}],"border-spacing-y":[{"border-spacing-y":[o]}],"table-layout":[{table:["auto","fixed"]}],caption:[{caption:["top","bottom"]}],transition:[{transition:["none","all","","colors","opacity","shadow","transform",ut]}],duration:[{duration:F()}],ease:[{ease:["linear","in","out","in-out",ut]}],delay:[{delay:F()}],animate:[{animate:["none","spin","ping","pulse","bounce",ut]}],transform:[{transform:["","gpu","none"]}],scale:[{scale:[b]}],"scale-x":[{"scale-x":[b]}],"scale-y":[{"scale-y":[b]}],rotate:[{rotate:[Tu,ut]}],"translate-x":[{"translate-x":[C]}],"translate-y":[{"translate-y":[C]}],"skew-x":[{"skew-x":[T]}],"skew-y":[{"skew-y":[T]}],"transform-origin":[{origin:["center","top","top-right","right","bottom-right","bottom","bottom-left","left","top-left",ut]}],accent:[{accent:["auto",e]}],appearance:[{appearance:["none","auto"]}],cursor:[{cursor:["auto","default","pointer","wait","text","move","help","not-allowed","none","context-menu","progress","cell","crosshair","vertical-text","alias","copy","no-drop","grab","grabbing","all-scroll","col-resize","row-resize","n-resize","e-resize","s-resize","w-resize","ne-resize","nw-resize","se-resize","sw-resize","ew-resize","ns-resize","nesw-resize","nwse-resize","zoom-in","zoom-out",ut]}],"caret-color":[{caret:[e]}],"pointer-events":[{"pointer-events":["none","auto"]}],resize:[{resize:["none","y","x",""]}],"scroll-behavior":[{scroll:["auto","smooth"]}],"scroll-m":[{"scroll-m":j()}],"scroll-mx":[{"scroll-mx":j()}],"scroll-my":[{"scroll-my":j()}],"scroll-ms":[{"scroll-ms":j()}],"scroll-me":[{"scroll-me":j()}],"scroll-mt":[{"scroll-mt":j()}],"scroll-mr":[{"scroll-mr":j()}],"scroll-mb":[{"scroll-mb":j()}],"scroll-ml":[{"scroll-ml":j()}],"scroll-p":[{"scroll-p":j()}],"scroll-px":[{"scroll-px":j()}],"scroll-py":[{"scroll-py":j()}],"scroll-ps":[{"scroll-ps":j()}],"scroll-pe":[{"scroll-pe":j()}],"scroll-pt":[{"scroll-pt":j()}],"scroll-pr":[{"scroll-pr":j()}],"scroll-pb":[{"scroll-pb":j()}],"scroll-pl":[{"scroll-pl":j()}],"snap-align":[{snap:["start","end","center","align-none"]}],"snap-stop":[{snap:["normal","always"]}],"snap-type":[{snap:["none","x","y","both"]}],"snap-strictness":[{snap:["mandatory","proximity"]}],touch:[{touch:["auto","none","manipulation"]}],"touch-x":[{"touch-pan":["x","left","right"]}],"touch-y":[{"touch-pan":["y","up","down"]}],"touch-pz":["touch-pinch-zoom"],select:[{select:["none","text","all","auto"]}],"will-change":[{"will-change":["auto","scroll","contents","transform",ut]}],fill:[{fill:[e,"none"]}],"stroke-w":[{stroke:[La,_i,Rg]}],stroke:[{stroke:[e,"none"]}],sr:["sr-only","not-sr-only"],"forced-color-adjust":[{"forced-color-adjust":["auto","none"]}]},conflictingClassGroups:{overflow:["overflow-x","overflow-y"],overscroll:["overscroll-x","overscroll-y"],inset:["inset-x","inset-y","start","end","top","right","bottom","left"],"inset-x":["right","left"],"inset-y":["top","bottom"],flex:["basis","grow","shrink"],gap:["gap-x","gap-y"],p:["px","py","ps","pe","pt","pr","pb","pl"],px:["pr","pl"],py:["pt","pb"],m:["mx","my","ms","me","mt","mr","mb","ml"],mx:["mr","ml"],my:["mt","mb"],size:["w","h"],"font-size":["leading"],"fvn-normal":["fvn-ordinal","fvn-slashed-zero","fvn-figure","fvn-spacing","fvn-fraction"],"fvn-ordinal":["fvn-normal"],"fvn-slashed-zero":["fvn-normal"],"fvn-figure":["fvn-normal"],"fvn-spacing":["fvn-normal"],"fvn-fraction":["fvn-normal"],"line-clamp":["display","overflow"],rounded:["rounded-s","rounded-e","rounded-t","rounded-r","rounded-b","rounded-l","rounded-ss","rounded-se","rounded-ee","rounded-es","rounded-tl","rounded-tr","rounded-br","rounded-bl"],"rounded-s":["rounded-ss","rounded-es"],"rounded-e":["rounded-se","rounded-ee"],"rounded-t":["rounded-tl","rounded-tr"],"rounded-r":["rounded-tr","rounded-br"],"rounded-b":["rounded-br","rounded-bl"],"rounded-l":["rounded-tl","rounded-bl"],"border-spacing":["border-spacing-x","border-spacing-y"],"border-w":["border-w-s","border-w-e","border-w-t","border-w-r","border-w-b","border-w-l"],"border-w-x":["border-w-r","border-w-l"],"border-w-y":["border-w-t","border-w-b"],"border-color":["border-color-s","border-color-e","border-color-t","border-color-r","border-color-b","border-color-l"],"border-color-x":["border-color-r","border-color-l"],"border-color-y":["border-color-t","border-color-b"],"scroll-m":["scroll-mx","scroll-my","scroll-ms","scroll-me","scroll-mt","scroll-mr","scroll-mb","scroll-ml"],"scroll-mx":["scroll-mr","scroll-ml"],"scroll-my":["scroll-mt","scroll-mb"],"scroll-p":["scroll-px","scroll-py","scroll-ps","scroll-pe","scroll-pt","scroll-pr","scroll-pb","scroll-pl"],"scroll-px":["scroll-pr","scroll-pl"],"scroll-py":["scroll-pt","scroll-pb"],touch:["touch-x","touch-y","touch-pz"],"touch-x":["touch"],"touch-y":["touch"],"touch-pz":["touch"]},conflictingClassGroupModifiers:{"font-size":["leading"]}}},yI=eI(vI);function De(...e){return yI(ik(e))}const od={log:(...e)=>{},error:(...e)=>{},warn:(...e)=>{},info:(...e)=>{}},wI=pF,gk=y.forwardRef(({className:e,...t},r)=>i.jsx(ZE,{ref:r,className:De("fixed top-0 z-[100] flex max-h-screen w-full flex-col-reverse p-4 sm:bottom-0 sm:right-0 sm:top-auto sm:flex-col md:max-w-[420px]",e),...t}));gk.displayName=ZE.displayName;const _I=yf("group pointer-events-auto relative flex w-full items-center justify-between space-x-4 overflow-hidden rounded-md border p-6 pr-8 shadow-lg transition-all data-[swipe=cancel]:translate-x-0 data-[swipe=end]:translate-x-[var(--radix-toast-swipe-end-x)] data-[swipe=move]:translate-x-[var(--radix-toast-swipe-move-x)] data-[swipe=move]:transition-none data-[state=open]:animate-in data-[state=closed]:animate-out data-[swipe=end]:animate-out data-[state=closed]:fade-out-80 data-[state=closed]:slide-out-to-right-full data-[state=open]:slide-in-from-top-full data-[state=open]:sm:slide-in-from-bottom-full",{variants:{variant:{default:"border bg-background text-foreground",destructive:"destructive group border-destructive bg-destructive text-destructive-foreground"}},defaultVariants:{variant:"default"}}),xk=y.forwardRef(({className:e,variant:t,...r},n)=>i.jsx(ek,{ref:n,className:De(_I({variant:t}),e),...r}));xk.displayName=ek.displayName;const bI=y.forwardRef(({className:e,...t},r)=>i.jsx(nk,{ref:r,className:De("inline-flex h-8 shrink-0 items-center justify-center rounded-md border bg-transparent px-3 text-sm font-medium ring-offset-background transition-colors hover:bg-secondary focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 group-[.destructive]:border-muted/40 group-[.destructive]:hover:border-destructive/30 group-[.destructive]:hover:bg-destructive group-[.destructive]:hover:text-destructive-foreground group-[.destructive]:focus:ring-destructive",e),...t}));bI.displayName=nk.displayName;const vk=y.forwardRef(({className:e,...t},r)=>i.jsx(sk,{ref:r,className:De("absolute right-2 top-2 rounded-md p-1 text-foreground/50 opacity-0 transition-opacity hover:text-foreground focus:opacity-100 focus:outline-none focus:ring-2 group-hover:opacity-100 group-[.destructive]:text-red-300 group-[.destructive]:hover:text-red-50 group-[.destructive]:focus:ring-red-400 group-[.destructive]:focus:ring-offset-red-600",e),"toast-close":"",...t,children:i.jsx(Cn,{className:"h-4 w-4"})}));vk.displayName=sk.displayName;const yk=y.forwardRef(({className:e,...t},r)=>i.jsx(tk,{ref:r,className:De("text-sm font-semibold",e),...t}));yk.displayName=tk.displayName;const wk=y.forwardRef(({className:e,...t},r)=>i.jsx(rk,{ref:r,className:De("text-sm opacity-90",e),...t}));wk.displayName=rk.displayName;function SI(){const{toasts:e}=St();return i.jsxs(wI,{children:[e.map(function({id:t,title:r,description:n,action:s,...a}){return i.jsxs(xk,{...a,children:[i.jsxs("div",{className:"grid gap-1",children:[r&&i.jsx(yk,{children:r}),n&&i.jsx(wk,{children:n})]}),s,i.jsx(vk,{})]},t)}),i.jsx(gk,{})]})}var Mb=["light","dark"],NI="(prefers-color-scheme: dark)",jI=y.createContext(void 0),EI={setTheme:e=>{},themes:[]},kI=()=>{var e;return(e=y.useContext(jI))!=null?e:EI};y.memo(({forcedTheme:e,storageKey:t,attribute:r,enableSystem:n,enableColorScheme:s,defaultTheme:a,value:o,attrs:l,nonce:c})=>{let u=a==="system",d=r==="class"?`var d=document.documentElement,c=d.classList;${`c.remove(${l.map(g=>`'${g}'`).join(",")})`};`:`var d=document.documentElement,n='${r}',s='setAttribute';`,f=s?Mb.includes(a)&&a?`if(e==='light'||e==='dark'||!e)d.style.colorScheme=e||'${a}'`:"if(e==='light'||e==='dark')d.style.colorScheme=e":"",p=(g,m=!1,x=!0)=>{let w=o?o[g]:g,v=m?g+"|| ''":`'${w}'`,_="";return s&&x&&!m&&Mb.includes(g)&&(_+=`d.style.colorScheme = '${g}';`),r==="class"?m||w?_+=`c.add(${v})`:_+="null":w&&(_+=`d[s](n,${v})`),_},h=e?`!function(){${d}${p(e)}}()`:n?`!function(){try{${d}var e=localStorage.getItem('${t}');if('system'===e||(!e&&${u})){var t='${NI}',m=window.matchMedia(t);if(m.media!==t||m.matches){${p("dark")}}else{${p("light")}}}else if(e){${o?`var x=${JSON.stringify(o)};`:""}${p(o?"x[e]":"e",!0)}}${u?"":"else{"+p(a,!1,!1)+"}"}${f}}catch(e){}}()`:`!function(){try{${d}var e=localStorage.getItem('${t}');if(e){${o?`var x=${JSON.stringify(o)};`:""}${p(o?"x[e]":"e",!0)}}else{${p(a,!1,!1)};}${f}}catch(t){}}();`;return y.createElement("script",{nonce:c,dangerouslySetInnerHTML:{__html:h}})});var CI=e=>{switch(e){case"success":return PI;case"info":return RI;case"warning":return DI;case"error":return MI;default:return null}},TI=Array(12).fill(0),AI=({visible:e,className:t})=>ke.createElement("div",{className:["sonner-loading-wrapper",t].filter(Boolean).join(" "),"data-visible":e},ke.createElement("div",{className:"sonner-spinner"},TI.map((r,n)=>ke.createElement("div",{className:"sonner-loading-bar",key:`spinner-bar-${n}`})))),PI=ke.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",height:"20",width:"20"},ke.createElement("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm3.857-9.809a.75.75 0 00-1.214-.882l-3.483 4.79-1.88-1.88a.75.75 0 10-1.06 1.061l2.5 2.5a.75.75 0 001.137-.089l4-5.5z",clipRule:"evenodd"})),DI=ke.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor",height:"20",width:"20"},ke.createElement("path",{fillRule:"evenodd",d:"M9.401 3.003c1.155-2 4.043-2 5.197 0l7.355 12.748c1.154 2-.29 4.5-2.599 4.5H4.645c-2.309 0-3.752-2.5-2.598-4.5L9.4 3.003zM12 8.25a.75.75 0 01.75.75v3.75a.75.75 0 01-1.5 0V9a.75.75 0 01.75-.75zm0 8.25a.75.75 0 100-1.5.75.75 0 000 1.5z",clipRule:"evenodd"})),RI=ke.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",height:"20",width:"20"},ke.createElement("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a.75.75 0 000 1.5h.253a.25.25 0 01.244.304l-.459 2.066A1.75 1.75 0 0010.747 15H11a.75.75 0 000-1.5h-.253a.25.25 0 01-.244-.304l.459-2.066A1.75 1.75 0 009.253 9H9z",clipRule:"evenodd"})),MI=ke.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",height:"20",width:"20"},ke.createElement("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-8-5a.75.75 0 01.75.75v4.5a.75.75 0 01-1.5 0v-4.5A.75.75 0 0110 5zm0 10a1 1 0 100-2 1 1 0 000 2z",clipRule:"evenodd"})),OI=ke.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:"12",height:"12",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round"},ke.createElement("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),ke.createElement("line",{x1:"6",y1:"6",x2:"18",y2:"18"})),FI=()=>{let[e,t]=ke.useState(document.hidden);return ke.useEffect(()=>{let r=()=>{t(document.hidden)};return document.addEventListener("visibilitychange",r),()=>window.removeEventListener("visibilitychange",r)},[]),e},Ev=1,II=class{constructor(){this.subscribe=e=>(this.subscribers.push(e),()=>{let t=this.subscribers.indexOf(e);this.subscribers.splice(t,1)}),this.publish=e=>{this.subscribers.forEach(t=>t(e))},this.addToast=e=>{this.publish(e),this.toasts=[...this.toasts,e]},this.create=e=>{var t;let{message:r,...n}=e,s=typeof(e==null?void 0:e.id)=="number"||((t=e.id)==null?void 0:t.length)>0?e.id:Ev++,a=this.toasts.find(l=>l.id===s),o=e.dismissible===void 0?!0:e.dismissible;return this.dismissedToasts.has(s)&&this.dismissedToasts.delete(s),a?this.toasts=this.toasts.map(l=>l.id===s?(this.publish({...l,...e,id:s,title:r}),{...l,...e,id:s,dismissible:o,title:r}):l):this.addToast({title:r,...n,dismissible:o,id:s}),s},this.dismiss=e=>(this.dismissedToasts.add(e),e||this.toasts.forEach(t=>{this.subscribers.forEach(r=>r({id:t.id,dismiss:!0}))}),this.subscribers.forEach(t=>t({id:e,dismiss:!0})),e),this.message=(e,t)=>this.create({...t,message:e}),this.error=(e,t)=>this.create({...t,message:e,type:"error"}),this.success=(e,t)=>this.create({...t,type:"success",message:e}),this.info=(e,t)=>this.create({...t,type:"info",message:e}),this.warning=(e,t)=>this.create({...t,type:"warning",message:e}),this.loading=(e,t)=>this.create({...t,type:"loading",message:e}),this.promise=(e,t)=>{if(!t)return;let r;t.loading!==void 0&&(r=this.create({...t,promise:e,type:"loading",message:t.loading,description:typeof t.description!="function"?t.description:void 0}));let n=e instanceof Promise?e:e(),s=r!==void 0,a,o=n.then(async c=>{if(a=["resolve",c],ke.isValidElement(c))s=!1,this.create({id:r,type:"default",message:c});else if($I(c)&&!c.ok){s=!1;let u=typeof t.error=="function"?await t.error(`HTTP error! status: ${c.status}`):t.error,d=typeof t.description=="function"?await t.description(`HTTP error! status: ${c.status}`):t.description;this.create({id:r,type:"error",message:u,description:d})}else if(t.success!==void 0){s=!1;let u=typeof t.success=="function"?await t.success(c):t.success,d=typeof t.description=="function"?await t.description(c):t.description;this.create({id:r,type:"success",message:u,description:d})}}).catch(async c=>{if(a=["reject",c],t.error!==void 0){s=!1;let u=typeof t.error=="function"?await t.error(c):t.error,d=typeof t.description=="function"?await t.description(c):t.description;this.create({id:r,type:"error",message:u,description:d})}}).finally(()=>{var c;s&&(this.dismiss(r),r=void 0),(c=t.finally)==null||c.call(t)}),l=()=>new Promise((c,u)=>o.then(()=>a[0]==="reject"?u(a[1]):c(a[1])).catch(u));return typeof r!="string"&&typeof r!="number"?{unwrap:l}:Object.assign(r,{unwrap:l})},this.custom=(e,t)=>{let r=(t==null?void 0:t.id)||Ev++;return this.create({jsx:e(r),id:r,...t}),r},this.getActiveToasts=()=>this.toasts.filter(e=>!this.dismissedToasts.has(e.id)),this.subscribers=[],this.toasts=[],this.dismissedToasts=new Set}},On=new II,LI=(e,t)=>{let r=(t==null?void 0:t.id)||Ev++;return On.addToast({title:e,...t,id:r}),r},$I=e=>e&&typeof e=="object"&&"ok"in e&&typeof e.ok=="boolean"&&"status"in e&&typeof e.status=="number",BI=LI,UI=()=>On.toasts,zI=()=>On.getActiveToasts(),gt=Object.assign(BI,{success:On.success,info:On.info,warning:On.warning,error:On.error,custom:On.custom,message:On.message,promise:On.promise,dismiss:On.dismiss,loading:On.loading},{getHistory:UI,getToasts:zI});function VI(e,{insertAt:t}={}){if(typeof document>"u")return;let r=document.head||document.getElementsByTagName("head")[0],n=document.createElement("style");n.type="text/css",t==="top"&&r.firstChild?r.insertBefore(n,r.firstChild):r.appendChild(n),n.styleSheet?n.styleSheet.cssText=e:n.appendChild(document.createTextNode(e))}VI(`:where(html[dir="ltr"]),:where([data-sonner-toaster][dir="ltr"]){--toast-icon-margin-start: -3px;--toast-icon-margin-end: 4px;--toast-svg-margin-start: -1px;--toast-svg-margin-end: 0px;--toast-button-margin-start: auto;--toast-button-margin-end: 0;--toast-close-button-start: 0;--toast-close-button-end: unset;--toast-close-button-transform: translate(-35%, -35%)}:where(html[dir="rtl"]),:where([data-sonner-toaster][dir="rtl"]){--toast-icon-margin-start: 4px;--toast-icon-margin-end: -3px;--toast-svg-margin-start: 0px;--toast-svg-margin-end: -1px;--toast-button-margin-start: 0;--toast-button-margin-end: auto;--toast-close-button-start: unset;--toast-close-button-end: 0;--toast-close-button-transform: translate(35%, -35%)}:where([data-sonner-toaster]){position:fixed;width:var(--width);font-family:ui-sans-serif,system-ui,-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Helvetica Neue,Arial,Noto Sans,sans-serif,Apple Color Emoji,Segoe UI Emoji,Segoe UI Symbol,Noto Color Emoji;--gray1: hsl(0, 0%, 99%);--gray2: hsl(0, 0%, 97.3%);--gray3: hsl(0, 0%, 95.1%);--gray4: hsl(0, 0%, 93%);--gray5: hsl(0, 0%, 90.9%);--gray6: hsl(0, 0%, 88.7%);--gray7: hsl(0, 0%, 85.8%);--gray8: hsl(0, 0%, 78%);--gray9: hsl(0, 0%, 56.1%);--gray10: hsl(0, 0%, 52.3%);--gray11: hsl(0, 0%, 43.5%);--gray12: hsl(0, 0%, 9%);--border-radius: 8px;box-sizing:border-box;padding:0;margin:0;list-style:none;outline:none;z-index:999999999;transition:transform .4s ease}:where([data-sonner-toaster][data-lifted="true"]){transform:translateY(-10px)}@media (hover: none) and (pointer: coarse){:where([data-sonner-toaster][data-lifted="true"]){transform:none}}:where([data-sonner-toaster][data-x-position="right"]){right:var(--offset-right)}:where([data-sonner-toaster][data-x-position="left"]){left:var(--offset-left)}:where([data-sonner-toaster][data-x-position="center"]){left:50%;transform:translate(-50%)}:where([data-sonner-toaster][data-y-position="top"]){top:var(--offset-top)}:where([data-sonner-toaster][data-y-position="bottom"]){bottom:var(--offset-bottom)}:where([data-sonner-toast]){--y: translateY(100%);--lift-amount: calc(var(--lift) * var(--gap));z-index:var(--z-index);position:absolute;opacity:0;transform:var(--y);filter:blur(0);touch-action:none;transition:transform .4s,opacity .4s,height .4s,box-shadow .2s;box-sizing:border-box;outline:none;overflow-wrap:anywhere}:where([data-sonner-toast][data-styled="true"]){padding:16px;background:var(--normal-bg);border:1px solid var(--normal-border);color:var(--normal-text);border-radius:var(--border-radius);box-shadow:0 4px 12px #0000001a;width:var(--width);font-size:13px;display:flex;align-items:center;gap:6px}:where([data-sonner-toast]:focus-visible){box-shadow:0 4px 12px #0000001a,0 0 0 2px #0003}:where([data-sonner-toast][data-y-position="top"]){top:0;--y: translateY(-100%);--lift: 1;--lift-amount: calc(1 * var(--gap))}:where([data-sonner-toast][data-y-position="bottom"]){bottom:0;--y: translateY(100%);--lift: -1;--lift-amount: calc(var(--lift) * var(--gap))}:where([data-sonner-toast]) :where([data-description]){font-weight:400;line-height:1.4;color:inherit}:where([data-sonner-toast]) :where([data-title]){font-weight:500;line-height:1.5;color:inherit}:where([data-sonner-toast]) :where([data-icon]){display:flex;height:16px;width:16px;position:relative;justify-content:flex-start;align-items:center;flex-shrink:0;margin-left:var(--toast-icon-margin-start);margin-right:var(--toast-icon-margin-end)}:where([data-sonner-toast][data-promise="true"]) :where([data-icon])>svg{opacity:0;transform:scale(.8);transform-origin:center;animation:sonner-fade-in .3s ease forwards}:where([data-sonner-toast]) :where([data-icon])>*{flex-shrink:0}:where([data-sonner-toast]) :where([data-icon]) svg{margin-left:var(--toast-svg-margin-start);margin-right:var(--toast-svg-margin-end)}:where([data-sonner-toast]) :where([data-content]){display:flex;flex-direction:column;gap:2px}[data-sonner-toast][data-styled=true] [data-button]{border-radius:4px;padding-left:8px;padding-right:8px;height:24px;font-size:12px;color:var(--normal-bg);background:var(--normal-text);margin-left:var(--toast-button-margin-start);margin-right:var(--toast-button-margin-end);border:none;cursor:pointer;outline:none;display:flex;align-items:center;flex-shrink:0;transition:opacity .4s,box-shadow .2s}:where([data-sonner-toast]) :where([data-button]):focus-visible{box-shadow:0 0 0 2px #0006}:where([data-sonner-toast]) :where([data-button]):first-of-type{margin-left:var(--toast-button-margin-start);margin-right:var(--toast-button-margin-end)}:where([data-sonner-toast]) :where([data-cancel]){color:var(--normal-text);background:rgba(0,0,0,.08)}:where([data-sonner-toast][data-theme="dark"]) :where([data-cancel]){background:rgba(255,255,255,.3)}:where([data-sonner-toast]) :where([data-close-button]){position:absolute;left:var(--toast-close-button-start);right:var(--toast-close-button-end);top:0;height:20px;width:20px;display:flex;justify-content:center;align-items:center;padding:0;color:var(--gray12);border:1px solid var(--gray4);transform:var(--toast-close-button-transform);border-radius:50%;cursor:pointer;z-index:1;transition:opacity .1s,background .2s,border-color .2s}[data-sonner-toast] [data-close-button]{background:var(--gray1)}:where([data-sonner-toast]) :where([data-close-button]):focus-visible{box-shadow:0 4px 12px #0000001a,0 0 0 2px #0003}:where([data-sonner-toast]) :where([data-disabled="true"]){cursor:not-allowed}:where([data-sonner-toast]):hover :where([data-close-button]):hover{background:var(--gray2);border-color:var(--gray5)}:where([data-sonner-toast][data-swiping="true"]):before{content:"";position:absolute;left:-50%;right:-50%;height:100%;z-index:-1}:where([data-sonner-toast][data-y-position="top"][data-swiping="true"]):before{bottom:50%;transform:scaleY(3) translateY(50%)}:where([data-sonner-toast][data-y-position="bottom"][data-swiping="true"]):before{top:50%;transform:scaleY(3) translateY(-50%)}:where([data-sonner-toast][data-swiping="false"][data-removed="true"]):before{content:"";position:absolute;inset:0;transform:scaleY(2)}:where([data-sonner-toast]):after{content:"";position:absolute;left:0;height:calc(var(--gap) + 1px);bottom:100%;width:100%}:where([data-sonner-toast][data-mounted="true"]){--y: translateY(0);opacity:1}:where([data-sonner-toast][data-expanded="false"][data-front="false"]){--scale: var(--toasts-before) * .05 + 1;--y: translateY(calc(var(--lift-amount) * var(--toasts-before))) scale(calc(-1 * var(--scale)));height:var(--front-toast-height)}:where([data-sonner-toast])>*{transition:opacity .4s}:where([data-sonner-toast][data-expanded="false"][data-front="false"][data-styled="true"])>*{opacity:0}:where([data-sonner-toast][data-visible="false"]){opacity:0;pointer-events:none}:where([data-sonner-toast][data-mounted="true"][data-expanded="true"]){--y: translateY(calc(var(--lift) * var(--offset)));height:var(--initial-height)}:where([data-sonner-toast][data-removed="true"][data-front="true"][data-swipe-out="false"]){--y: translateY(calc(var(--lift) * -100%));opacity:0}:where([data-sonner-toast][data-removed="true"][data-front="false"][data-swipe-out="false"][data-expanded="true"]){--y: translateY(calc(var(--lift) * var(--offset) + var(--lift) * -100%));opacity:0}:where([data-sonner-toast][data-removed="true"][data-front="false"][data-swipe-out="false"][data-expanded="false"]){--y: translateY(40%);opacity:0;transition:transform .5s,opacity .2s}:where([data-sonner-toast][data-removed="true"][data-front="false"]):before{height:calc(var(--initial-height) + 20%)}[data-sonner-toast][data-swiping=true]{transform:var(--y) translateY(var(--swipe-amount-y, 0px)) translate(var(--swipe-amount-x, 0px));transition:none}[data-sonner-toast][data-swiped=true]{user-select:none}[data-sonner-toast][data-swipe-out=true][data-y-position=bottom],[data-sonner-toast][data-swipe-out=true][data-y-position=top]{animation-duration:.2s;animation-timing-function:ease-out;animation-fill-mode:forwards}[data-sonner-toast][data-swipe-out=true][data-swipe-direction=left]{animation-name:swipe-out-left}[data-sonner-toast][data-swipe-out=true][data-swipe-direction=right]{animation-name:swipe-out-right}[data-sonner-toast][data-swipe-out=true][data-swipe-direction=up]{animation-name:swipe-out-up}[data-sonner-toast][data-swipe-out=true][data-swipe-direction=down]{animation-name:swipe-out-down}@keyframes swipe-out-left{0%{transform:var(--y) translate(var(--swipe-amount-x));opacity:1}to{transform:var(--y) translate(calc(var(--swipe-amount-x) - 100%));opacity:0}}@keyframes swipe-out-right{0%{transform:var(--y) translate(var(--swipe-amount-x));opacity:1}to{transform:var(--y) translate(calc(var(--swipe-amount-x) + 100%));opacity:0}}@keyframes swipe-out-up{0%{transform:var(--y) translateY(var(--swipe-amount-y));opacity:1}to{transform:var(--y) translateY(calc(var(--swipe-amount-y) - 100%));opacity:0}}@keyframes swipe-out-down{0%{transform:var(--y) translateY(var(--swipe-amount-y));opacity:1}to{transform:var(--y) translateY(calc(var(--swipe-amount-y) + 100%));opacity:0}}@media (max-width: 600px){[data-sonner-toaster]{position:fixed;right:var(--mobile-offset-right);left:var(--mobile-offset-left);width:100%}[data-sonner-toaster][dir=rtl]{left:calc(var(--mobile-offset-left) * -1)}[data-sonner-toaster] [data-sonner-toast]{left:0;right:0;width:calc(100% - var(--mobile-offset-left) * 2)}[data-sonner-toaster][data-x-position=left]{left:var(--mobile-offset-left)}[data-sonner-toaster][data-y-position=bottom]{bottom:var(--mobile-offset-bottom)}[data-sonner-toaster][data-y-position=top]{top:var(--mobile-offset-top)}[data-sonner-toaster][data-x-position=center]{left:var(--mobile-offset-left);right:var(--mobile-offset-right);transform:none}}[data-sonner-toaster][data-theme=light]{--normal-bg: #fff;--normal-border: var(--gray4);--normal-text: var(--gray12);--success-bg: hsl(143, 85%, 96%);--success-border: hsl(145, 92%, 91%);--success-text: hsl(140, 100%, 27%);--info-bg: hsl(208, 100%, 97%);--info-border: hsl(221, 91%, 91%);--info-text: hsl(210, 92%, 45%);--warning-bg: hsl(49, 100%, 97%);--warning-border: hsl(49, 91%, 91%);--warning-text: hsl(31, 92%, 45%);--error-bg: hsl(359, 100%, 97%);--error-border: hsl(359, 100%, 94%);--error-text: hsl(360, 100%, 45%)}[data-sonner-toaster][data-theme=light] [data-sonner-toast][data-invert=true]{--normal-bg: #000;--normal-border: hsl(0, 0%, 20%);--normal-text: var(--gray1)}[data-sonner-toaster][data-theme=dark] [data-sonner-toast][data-invert=true]{--normal-bg: #fff;--normal-border: var(--gray3);--normal-text: var(--gray12)}[data-sonner-toaster][data-theme=dark]{--normal-bg: #000;--normal-bg-hover: hsl(0, 0%, 12%);--normal-border: hsl(0, 0%, 20%);--normal-border-hover: hsl(0, 0%, 25%);--normal-text: var(--gray1);--success-bg: hsl(150, 100%, 6%);--success-border: hsl(147, 100%, 12%);--success-text: hsl(150, 86%, 65%);--info-bg: hsl(215, 100%, 6%);--info-border: hsl(223, 100%, 12%);--info-text: hsl(216, 87%, 65%);--warning-bg: hsl(64, 100%, 6%);--warning-border: hsl(60, 100%, 12%);--warning-text: hsl(46, 87%, 65%);--error-bg: hsl(358, 76%, 10%);--error-border: hsl(357, 89%, 16%);--error-text: hsl(358, 100%, 81%)}[data-sonner-toaster][data-theme=dark] [data-sonner-toast] [data-close-button]{background:var(--normal-bg);border-color:var(--normal-border);color:var(--normal-text)}[data-sonner-toaster][data-theme=dark] [data-sonner-toast] [data-close-button]:hover{background:var(--normal-bg-hover);border-color:var(--normal-border-hover)}[data-rich-colors=true][data-sonner-toast][data-type=success],[data-rich-colors=true][data-sonner-toast][data-type=success] [data-close-button]{background:var(--success-bg);border-color:var(--success-border);color:var(--success-text)}[data-rich-colors=true][data-sonner-toast][data-type=info],[data-rich-colors=true][data-sonner-toast][data-type=info] [data-close-button]{background:var(--info-bg);border-color:var(--info-border);color:var(--info-text)}[data-rich-colors=true][data-sonner-toast][data-type=warning],[data-rich-colors=true][data-sonner-toast][data-type=warning] [data-close-button]{background:var(--warning-bg);border-color:var(--warning-border);color:var(--warning-text)}[data-rich-colors=true][data-sonner-toast][data-type=error],[data-rich-colors=true][data-sonner-toast][data-type=error] [data-close-button]{background:var(--error-bg);border-color:var(--error-border);color:var(--error-text)}.sonner-loading-wrapper{--size: 16px;height:var(--size);width:var(--size);position:absolute;inset:0;z-index:10}.sonner-loading-wrapper[data-visible=false]{transform-origin:center;animation:sonner-fade-out .2s ease forwards}.sonner-spinner{position:relative;top:50%;left:50%;height:var(--size);width:var(--size)}.sonner-loading-bar{animation:sonner-spin 1.2s linear infinite;background:var(--gray11);border-radius:6px;height:8%;left:-10%;position:absolute;top:-3.9%;width:24%}.sonner-loading-bar:nth-child(1){animation-delay:-1.2s;transform:rotate(.0001deg) translate(146%)}.sonner-loading-bar:nth-child(2){animation-delay:-1.1s;transform:rotate(30deg) translate(146%)}.sonner-loading-bar:nth-child(3){animation-delay:-1s;transform:rotate(60deg) translate(146%)}.sonner-loading-bar:nth-child(4){animation-delay:-.9s;transform:rotate(90deg) translate(146%)}.sonner-loading-bar:nth-child(5){animation-delay:-.8s;transform:rotate(120deg) translate(146%)}.sonner-loading-bar:nth-child(6){animation-delay:-.7s;transform:rotate(150deg) translate(146%)}.sonner-loading-bar:nth-child(7){animation-delay:-.6s;transform:rotate(180deg) translate(146%)}.sonner-loading-bar:nth-child(8){animation-delay:-.5s;transform:rotate(210deg) translate(146%)}.sonner-loading-bar:nth-child(9){animation-delay:-.4s;transform:rotate(240deg) translate(146%)}.sonner-loading-bar:nth-child(10){animation-delay:-.3s;transform:rotate(270deg) translate(146%)}.sonner-loading-bar:nth-child(11){animation-delay:-.2s;transform:rotate(300deg) translate(146%)}.sonner-loading-bar:nth-child(12){animation-delay:-.1s;transform:rotate(330deg) translate(146%)}@keyframes sonner-fade-in{0%{opacity:0;transform:scale(.8)}to{opacity:1;transform:scale(1)}}@keyframes sonner-fade-out{0%{opacity:1;transform:scale(1)}to{opacity:0;transform:scale(.8)}}@keyframes sonner-spin{0%{opacity:1}to{opacity:.15}}@media (prefers-reduced-motion){[data-sonner-toast],[data-sonner-toast]>*,.sonner-loading-bar{transition:none!important;animation:none!important}}.sonner-loader{position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);transform-origin:center;transition:opacity .2s,transform .2s}.sonner-loader[data-visible=false]{opacity:0;transform:scale(.8) translate(-50%,-50%)}
`);function wh(e){return e.label!==void 0}var WI=3,HI="32px",GI="16px",Ob=4e3,qI=356,YI=14,KI=20,XI=200;function Os(...e){return e.filter(Boolean).join(" ")}function QI(e){let[t,r]=e.split("-"),n=[];return t&&n.push(t),r&&n.push(r),n}var JI=e=>{var t,r,n,s,a,o,l,c,u,d,f;let{invert:p,toast:h,unstyled:g,interacting:m,setHeights:x,visibleToasts:w,heights:v,index:_,toasts:b,expanded:S,removeToast:T,defaultRichColors:N,closeButton:C,style:E,cancelButtonStyle:P,actionButtonStyle:R,className:j="",descriptionClassName:M="",duration:A,position:I,gap:X,loadingIcon:Y,expandByDefault:z,classNames:U,icons:V,closeButtonAriaLabel:F="Close toast",pauseWhenPageIsHidden:D}=e,[G,O]=ke.useState(null),[L,ie]=ke.useState(null),[ne,me]=ke.useState(!1),[pe,xe]=ke.useState(!1),[Ae,ge]=ke.useState(!1),[je,k]=ke.useState(!1),[le,ce]=ke.useState(!1),[H,K]=ke.useState(0),[oe,W]=ke.useState(0),J=ke.useRef(h.duration||A||Ob),B=ke.useRef(null),ae=ke.useRef(null),de=_===0,Q=_+1<=w,fe=h.type,Ce=h.dismissible!==!1,Ne=h.className||"",Xe=h.descriptionClassName||"",it=ke.useMemo(()=>v.findIndex(Ze=>Ze.toastId===h.id)||0,[v,h.id]),at=ke.useMemo(()=>{var Ze;return(Ze=h.closeButton)!=null?Ze:C},[h.closeButton,C]),ht=ke.useMemo(()=>h.duration||A||Ob,[h.duration,A]),Ke=ke.useRef(0),Bt=ke.useRef(0),Te=ke.useRef(0),Re=ke.useRef(null),[tt,Dt]=I.split("-"),or=ke.useMemo(()=>v.reduce((Ze,pt,xt)=>xt>=it?Ze:Ze+pt.height,0),[v,it]),Xt=FI(),Qt=h.invert||p,Pt=fe==="loading";Bt.current=ke.useMemo(()=>it*X+or,[it,or]),ke.useEffect(()=>{J.current=ht},[ht]),ke.useEffect(()=>{me(!0)},[]),ke.useEffect(()=>{let Ze=ae.current;if(Ze){let pt=Ze.getBoundingClientRect().height;return W(pt),x(xt=>[{toastId:h.id,height:pt,position:h.position},...xt]),()=>x(xt=>xt.filter(_r=>_r.toastId!==h.id))}},[x,h.id]),ke.useLayoutEffect(()=>{if(!ne)return;let Ze=ae.current,pt=Ze.style.height;Ze.style.height="auto";let xt=Ze.getBoundingClientRect().height;Ze.style.height=pt,W(xt),x(_r=>_r.find(on=>on.toastId===h.id)?_r.map(on=>on.toastId===h.id?{...on,height:xt}:on):[{toastId:h.id,height:xt,position:h.position},..._r])},[ne,h.title,h.description,x,h.id]);let Jt=ke.useCallback(()=>{xe(!0),K(Bt.current),x(Ze=>Ze.filter(pt=>pt.toastId!==h.id)),setTimeout(()=>{T(h)},XI)},[h,T,x,Bt]);ke.useEffect(()=>{if(h.promise&&fe==="loading"||h.duration===1/0||h.type==="loading")return;let Ze;return S||m||D&&Xt?(()=>{if(Te.current<Ke.current){let pt=new Date().getTime()-Ke.current;J.current=J.current-pt}Te.current=new Date().getTime()})():J.current!==1/0&&(Ke.current=new Date().getTime(),Ze=setTimeout(()=>{var pt;(pt=h.onAutoClose)==null||pt.call(h,h),Jt()},J.current)),()=>clearTimeout(Ze)},[S,m,h,fe,D,Xt,Jt]),ke.useEffect(()=>{h.delete&&Jt()},[Jt,h.delete]);function yn(){var Ze,pt,xt;return V!=null&&V.loading?ke.createElement("div",{className:Os(U==null?void 0:U.loader,(Ze=h==null?void 0:h.classNames)==null?void 0:Ze.loader,"sonner-loader"),"data-visible":fe==="loading"},V.loading):Y?ke.createElement("div",{className:Os(U==null?void 0:U.loader,(pt=h==null?void 0:h.classNames)==null?void 0:pt.loader,"sonner-loader"),"data-visible":fe==="loading"},Y):ke.createElement(AI,{className:Os(U==null?void 0:U.loader,(xt=h==null?void 0:h.classNames)==null?void 0:xt.loader),visible:fe==="loading"})}return ke.createElement("li",{tabIndex:0,ref:ae,className:Os(j,Ne,U==null?void 0:U.toast,(t=h==null?void 0:h.classNames)==null?void 0:t.toast,U==null?void 0:U.default,U==null?void 0:U[fe],(r=h==null?void 0:h.classNames)==null?void 0:r[fe]),"data-sonner-toast":"","data-rich-colors":(n=h.richColors)!=null?n:N,"data-styled":!(h.jsx||h.unstyled||g),"data-mounted":ne,"data-promise":!!h.promise,"data-swiped":le,"data-removed":pe,"data-visible":Q,"data-y-position":tt,"data-x-position":Dt,"data-index":_,"data-front":de,"data-swiping":Ae,"data-dismissible":Ce,"data-type":fe,"data-invert":Qt,"data-swipe-out":je,"data-swipe-direction":L,"data-expanded":!!(S||z&&ne),style:{"--index":_,"--toasts-before":_,"--z-index":b.length-_,"--offset":`${pe?H:Bt.current}px`,"--initial-height":z?"auto":`${oe}px`,...E,...h.style},onDragEnd:()=>{ge(!1),O(null),Re.current=null},onPointerDown:Ze=>{Pt||!Ce||(B.current=new Date,K(Bt.current),Ze.target.setPointerCapture(Ze.pointerId),Ze.target.tagName!=="BUTTON"&&(ge(!0),Re.current={x:Ze.clientX,y:Ze.clientY}))},onPointerUp:()=>{var Ze,pt,xt,_r;if(je||!Ce)return;Re.current=null;let on=Number(((Ze=ae.current)==null?void 0:Ze.style.getPropertyValue("--swipe-amount-x").replace("px",""))||0),ms=Number(((pt=ae.current)==null?void 0:pt.style.getPropertyValue("--swipe-amount-y").replace("px",""))||0),Xn=new Date().getTime()-((xt=B.current)==null?void 0:xt.getTime()),wn=G==="x"?on:ms,ha=Math.abs(wn)/Xn;if(Math.abs(wn)>=KI||ha>.11){K(Bt.current),(_r=h.onDismiss)==null||_r.call(h,h),ie(G==="x"?on>0?"right":"left":ms>0?"down":"up"),Jt(),k(!0),ce(!1);return}ge(!1),O(null)},onPointerMove:Ze=>{var pt,xt,_r,on;if(!Re.current||!Ce||((pt=window.getSelection())==null?void 0:pt.toString().length)>0)return;let ms=Ze.clientY-Re.current.y,Xn=Ze.clientX-Re.current.x,wn=(xt=e.swipeDirections)!=null?xt:QI(I);!G&&(Math.abs(Xn)>1||Math.abs(ms)>1)&&O(Math.abs(Xn)>Math.abs(ms)?"x":"y");let ha={x:0,y:0};G==="y"?(wn.includes("top")||wn.includes("bottom"))&&(wn.includes("top")&&ms<0||wn.includes("bottom")&&ms>0)&&(ha.y=ms):G==="x"&&(wn.includes("left")||wn.includes("right"))&&(wn.includes("left")&&Xn<0||wn.includes("right")&&Xn>0)&&(ha.x=Xn),(Math.abs(ha.x)>0||Math.abs(ha.y)>0)&&ce(!0),(_r=ae.current)==null||_r.style.setProperty("--swipe-amount-x",`${ha.x}px`),(on=ae.current)==null||on.style.setProperty("--swipe-amount-y",`${ha.y}px`)}},at&&!h.jsx?ke.createElement("button",{"aria-label":F,"data-disabled":Pt,"data-close-button":!0,onClick:Pt||!Ce?()=>{}:()=>{var Ze;Jt(),(Ze=h.onDismiss)==null||Ze.call(h,h)},className:Os(U==null?void 0:U.closeButton,(s=h==null?void 0:h.classNames)==null?void 0:s.closeButton)},(a=V==null?void 0:V.close)!=null?a:OI):null,h.jsx||y.isValidElement(h.title)?h.jsx?h.jsx:typeof h.title=="function"?h.title():h.title:ke.createElement(ke.Fragment,null,fe||h.icon||h.promise?ke.createElement("div",{"data-icon":"",className:Os(U==null?void 0:U.icon,(o=h==null?void 0:h.classNames)==null?void 0:o.icon)},h.promise||h.type==="loading"&&!h.icon?h.icon||yn():null,h.type!=="loading"?h.icon||(V==null?void 0:V[fe])||CI(fe):null):null,ke.createElement("div",{"data-content":"",className:Os(U==null?void 0:U.content,(l=h==null?void 0:h.classNames)==null?void 0:l.content)},ke.createElement("div",{"data-title":"",className:Os(U==null?void 0:U.title,(c=h==null?void 0:h.classNames)==null?void 0:c.title)},typeof h.title=="function"?h.title():h.title),h.description?ke.createElement("div",{"data-description":"",className:Os(M,Xe,U==null?void 0:U.description,(u=h==null?void 0:h.classNames)==null?void 0:u.description)},typeof h.description=="function"?h.description():h.description):null),y.isValidElement(h.cancel)?h.cancel:h.cancel&&wh(h.cancel)?ke.createElement("button",{"data-button":!0,"data-cancel":!0,style:h.cancelButtonStyle||P,onClick:Ze=>{var pt,xt;wh(h.cancel)&&Ce&&((xt=(pt=h.cancel).onClick)==null||xt.call(pt,Ze),Jt())},className:Os(U==null?void 0:U.cancelButton,(d=h==null?void 0:h.classNames)==null?void 0:d.cancelButton)},h.cancel.label):null,y.isValidElement(h.action)?h.action:h.action&&wh(h.action)?ke.createElement("button",{"data-button":!0,"data-action":!0,style:h.actionButtonStyle||R,onClick:Ze=>{var pt,xt;wh(h.action)&&((xt=(pt=h.action).onClick)==null||xt.call(pt,Ze),!Ze.defaultPrevented&&Jt())},className:Os(U==null?void 0:U.actionButton,(f=h==null?void 0:h.classNames)==null?void 0:f.actionButton)},h.action.label):null))};function Fb(){if(typeof window>"u"||typeof document>"u")return"ltr";let e=document.documentElement.getAttribute("dir");return e==="auto"||!e?window.getComputedStyle(document.documentElement).direction:e}function ZI(e,t){let r={};return[e,t].forEach((n,s)=>{let a=s===1,o=a?"--mobile-offset":"--offset",l=a?GI:HI;function c(u){["top","right","bottom","left"].forEach(d=>{r[`${o}-${d}`]=typeof u=="number"?`${u}px`:u})}typeof n=="number"||typeof n=="string"?c(n):typeof n=="object"?["top","right","bottom","left"].forEach(u=>{n[u]===void 0?r[`${o}-${u}`]=l:r[`${o}-${u}`]=typeof n[u]=="number"?`${n[u]}px`:n[u]}):c(l)}),r}var e6=y.forwardRef(function(e,t){let{invert:r,position:n="bottom-right",hotkey:s=["altKey","KeyT"],expand:a,closeButton:o,className:l,offset:c,mobileOffset:u,theme:d="light",richColors:f,duration:p,style:h,visibleToasts:g=WI,toastOptions:m,dir:x=Fb(),gap:w=YI,loadingIcon:v,icons:_,containerAriaLabel:b="Notifications",pauseWhenPageIsHidden:S}=e,[T,N]=ke.useState([]),C=ke.useMemo(()=>Array.from(new Set([n].concat(T.filter(D=>D.position).map(D=>D.position)))),[T,n]),[E,P]=ke.useState([]),[R,j]=ke.useState(!1),[M,A]=ke.useState(!1),[I,X]=ke.useState(d!=="system"?d:typeof window<"u"&&window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light"),Y=ke.useRef(null),z=s.join("+").replace(/Key/g,"").replace(/Digit/g,""),U=ke.useRef(null),V=ke.useRef(!1),F=ke.useCallback(D=>{N(G=>{var O;return(O=G.find(L=>L.id===D.id))!=null&&O.delete||On.dismiss(D.id),G.filter(({id:L})=>L!==D.id)})},[]);return ke.useEffect(()=>On.subscribe(D=>{if(D.dismiss){N(G=>G.map(O=>O.id===D.id?{...O,delete:!0}:O));return}setTimeout(()=>{PE.flushSync(()=>{N(G=>{let O=G.findIndex(L=>L.id===D.id);return O!==-1?[...G.slice(0,O),{...G[O],...D},...G.slice(O+1)]:[D,...G]})})})}),[]),ke.useEffect(()=>{if(d!=="system"){X(d);return}if(d==="system"&&(window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches?X("dark"):X("light")),typeof window>"u")return;let D=window.matchMedia("(prefers-color-scheme: dark)");try{D.addEventListener("change",({matches:G})=>{X(G?"dark":"light")})}catch{D.addListener(({matches:O})=>{try{X(O?"dark":"light")}catch(L){console.error(L)}})}},[d]),ke.useEffect(()=>{T.length<=1&&j(!1)},[T]),ke.useEffect(()=>{let D=G=>{var O,L;s.every(ie=>G[ie]||G.code===ie)&&(j(!0),(O=Y.current)==null||O.focus()),G.code==="Escape"&&(document.activeElement===Y.current||(L=Y.current)!=null&&L.contains(document.activeElement))&&j(!1)};return document.addEventListener("keydown",D),()=>document.removeEventListener("keydown",D)},[s]),ke.useEffect(()=>{if(Y.current)return()=>{U.current&&(U.current.focus({preventScroll:!0}),U.current=null,V.current=!1)}},[Y.current]),ke.createElement("section",{ref:t,"aria-label":`${b} ${z}`,tabIndex:-1,"aria-live":"polite","aria-relevant":"additions text","aria-atomic":"false",suppressHydrationWarning:!0},C.map((D,G)=>{var O;let[L,ie]=D.split("-");return T.length?ke.createElement("ol",{key:D,dir:x==="auto"?Fb():x,tabIndex:-1,ref:Y,className:l,"data-sonner-toaster":!0,"data-theme":I,"data-y-position":L,"data-lifted":R&&T.length>1&&!a,"data-x-position":ie,style:{"--front-toast-height":`${((O=E[0])==null?void 0:O.height)||0}px`,"--width":`${qI}px`,"--gap":`${w}px`,...h,...ZI(c,u)},onBlur:ne=>{V.current&&!ne.currentTarget.contains(ne.relatedTarget)&&(V.current=!1,U.current&&(U.current.focus({preventScroll:!0}),U.current=null))},onFocus:ne=>{ne.target instanceof HTMLElement&&ne.target.dataset.dismissible==="false"||V.current||(V.current=!0,U.current=ne.relatedTarget)},onMouseEnter:()=>j(!0),onMouseMove:()=>j(!0),onMouseLeave:()=>{M||j(!1)},onDragEnd:()=>j(!1),onPointerDown:ne=>{ne.target instanceof HTMLElement&&ne.target.dataset.dismissible==="false"||A(!0)},onPointerUp:()=>A(!1)},T.filter(ne=>!ne.position&&G===0||ne.position===D).map((ne,me)=>{var pe,xe;return ke.createElement(JI,{key:ne.id,icons:_,index:me,toast:ne,defaultRichColors:f,duration:(pe=m==null?void 0:m.duration)!=null?pe:p,className:m==null?void 0:m.className,descriptionClassName:m==null?void 0:m.descriptionClassName,invert:r,visibleToasts:g,closeButton:(xe=m==null?void 0:m.closeButton)!=null?xe:o,interacting:M,position:D,style:m==null?void 0:m.style,unstyled:m==null?void 0:m.unstyled,classNames:m==null?void 0:m.classNames,cancelButtonStyle:m==null?void 0:m.cancelButtonStyle,actionButtonStyle:m==null?void 0:m.actionButtonStyle,removeToast:F,toasts:T.filter(Ae=>Ae.position==ne.position),heights:E.filter(Ae=>Ae.position==ne.position),setHeights:P,expandByDefault:a,gap:w,loadingIcon:v,expanded:R,pauseWhenPageIsHidden:S,swipeDirections:e.swipeDirections})})):null}))});const t6=({...e})=>{const{theme:t="system"}=kI();return i.jsx(e6,{theme:t,className:"toaster group",toastOptions:{classNames:{toast:"group toast group-[.toaster]:bg-background group-[.toaster]:text-foreground group-[.toaster]:border-border group-[.toaster]:shadow-lg",description:"group-[.toast]:text-muted-foreground",actionButton:"group-[.toast]:bg-primary group-[.toast]:text-primary-foreground",cancelButton:"group-[.toast]:bg-muted group-[.toast]:text-muted-foreground"}},...e})};var r6=xy[" useId ".trim().toString()]||(()=>{}),n6=0;function Er(e){const[t,r]=y.useState(r6());return gr(()=>{r(n=>n??String(n6++))},[e]),t?`radix-${t}`:""}const s6=["top","right","bottom","left"],co=Math.min,ts=Math.max,Um=Math.round,_h=Math.floor,Aa=e=>({x:e,y:e}),a6={left:"right",right:"left",bottom:"top",top:"bottom"},i6={start:"end",end:"start"};function kv(e,t,r){return ts(e,co(t,r))}function fi(e,t){return typeof e=="function"?e(t):e}function hi(e){return e.split("-")[0]}function tu(e){return e.split("-")[1]}function v1(e){return e==="x"?"y":"x"}function y1(e){return e==="y"?"height":"width"}const o6=new Set(["top","bottom"]);function ja(e){return o6.has(hi(e))?"y":"x"}function w1(e){return v1(ja(e))}function l6(e,t,r){r===void 0&&(r=!1);const n=tu(e),s=w1(e),a=y1(s);let o=s==="x"?n===(r?"end":"start")?"right":"left":n==="start"?"bottom":"top";return t.reference[a]>t.floating[a]&&(o=zm(o)),[o,zm(o)]}function c6(e){const t=zm(e);return[Cv(e),t,Cv(t)]}function Cv(e){return e.replace(/start|end/g,t=>i6[t])}const Ib=["left","right"],Lb=["right","left"],u6=["top","bottom"],d6=["bottom","top"];function f6(e,t,r){switch(e){case"top":case"bottom":return r?t?Lb:Ib:t?Ib:Lb;case"left":case"right":return t?u6:d6;default:return[]}}function h6(e,t,r,n){const s=tu(e);let a=f6(hi(e),r==="start",n);return s&&(a=a.map(o=>o+"-"+s),t&&(a=a.concat(a.map(Cv)))),a}function zm(e){return e.replace(/left|right|bottom|top/g,t=>a6[t])}function m6(e){return{top:0,right:0,bottom:0,left:0,...e}}function _k(e){return typeof e!="number"?m6(e):{top:e,right:e,bottom:e,left:e}}function Vm(e){const{x:t,y:r,width:n,height:s}=e;return{width:n,height:s,top:r,left:t,right:t+n,bottom:r+s,x:t,y:r}}function $b(e,t,r){let{reference:n,floating:s}=e;const a=ja(t),o=w1(t),l=y1(o),c=hi(t),u=a==="y",d=n.x+n.width/2-s.width/2,f=n.y+n.height/2-s.height/2,p=n[l]/2-s[l]/2;let h;switch(c){case"top":h={x:d,y:n.y-s.height};break;case"bottom":h={x:d,y:n.y+n.height};break;case"right":h={x:n.x+n.width,y:f};break;case"left":h={x:n.x-s.width,y:f};break;default:h={x:n.x,y:n.y}}switch(tu(t)){case"start":h[o]-=p*(r&&u?-1:1);break;case"end":h[o]+=p*(r&&u?-1:1);break}return h}const p6=async(e,t,r)=>{const{placement:n="bottom",strategy:s="absolute",middleware:a=[],platform:o}=r,l=a.filter(Boolean),c=await(o.isRTL==null?void 0:o.isRTL(t));let u=await o.getElementRects({reference:e,floating:t,strategy:s}),{x:d,y:f}=$b(u,n,c),p=n,h={},g=0;for(let m=0;m<l.length;m++){const{name:x,fn:w}=l[m],{x:v,y:_,data:b,reset:S}=await w({x:d,y:f,initialPlacement:n,placement:p,strategy:s,middlewareData:h,rects:u,platform:o,elements:{reference:e,floating:t}});d=v??d,f=_??f,h={...h,[x]:{...h[x],...b}},S&&g<=50&&(g++,typeof S=="object"&&(S.placement&&(p=S.placement),S.rects&&(u=S.rects===!0?await o.getElementRects({reference:e,floating:t,strategy:s}):S.rects),{x:d,y:f}=$b(u,p,c)),m=-1)}return{x:d,y:f,placement:p,strategy:s,middlewareData:h}};async function $d(e,t){var r;t===void 0&&(t={});const{x:n,y:s,platform:a,rects:o,elements:l,strategy:c}=e,{boundary:u="clippingAncestors",rootBoundary:d="viewport",elementContext:f="floating",altBoundary:p=!1,padding:h=0}=fi(t,e),g=_k(h),x=l[p?f==="floating"?"reference":"floating":f],w=Vm(await a.getClippingRect({element:(r=await(a.isElement==null?void 0:a.isElement(x)))==null||r?x:x.contextElement||await(a.getDocumentElement==null?void 0:a.getDocumentElement(l.floating)),boundary:u,rootBoundary:d,strategy:c})),v=f==="floating"?{x:n,y:s,width:o.floating.width,height:o.floating.height}:o.reference,_=await(a.getOffsetParent==null?void 0:a.getOffsetParent(l.floating)),b=await(a.isElement==null?void 0:a.isElement(_))?await(a.getScale==null?void 0:a.getScale(_))||{x:1,y:1}:{x:1,y:1},S=Vm(a.convertOffsetParentRelativeRectToViewportRelativeRect?await a.convertOffsetParentRelativeRectToViewportRelativeRect({elements:l,rect:v,offsetParent:_,strategy:c}):v);return{top:(w.top-S.top+g.top)/b.y,bottom:(S.bottom-w.bottom+g.bottom)/b.y,left:(w.left-S.left+g.left)/b.x,right:(S.right-w.right+g.right)/b.x}}const g6=e=>({name:"arrow",options:e,async fn(t){const{x:r,y:n,placement:s,rects:a,platform:o,elements:l,middlewareData:c}=t,{element:u,padding:d=0}=fi(e,t)||{};if(u==null)return{};const f=_k(d),p={x:r,y:n},h=w1(s),g=y1(h),m=await o.getDimensions(u),x=h==="y",w=x?"top":"left",v=x?"bottom":"right",_=x?"clientHeight":"clientWidth",b=a.reference[g]+a.reference[h]-p[h]-a.floating[g],S=p[h]-a.reference[h],T=await(o.getOffsetParent==null?void 0:o.getOffsetParent(u));let N=T?T[_]:0;(!N||!await(o.isElement==null?void 0:o.isElement(T)))&&(N=l.floating[_]||a.floating[g]);const C=b/2-S/2,E=N/2-m[g]/2-1,P=co(f[w],E),R=co(f[v],E),j=P,M=N-m[g]-R,A=N/2-m[g]/2+C,I=kv(j,A,M),X=!c.arrow&&tu(s)!=null&&A!==I&&a.reference[g]/2-(A<j?P:R)-m[g]/2<0,Y=X?A<j?A-j:A-M:0;return{[h]:p[h]+Y,data:{[h]:I,centerOffset:A-I-Y,...X&&{alignmentOffset:Y}},reset:X}}}),x6=function(e){return e===void 0&&(e={}),{name:"flip",options:e,async fn(t){var r,n;const{placement:s,middlewareData:a,rects:o,initialPlacement:l,platform:c,elements:u}=t,{mainAxis:d=!0,crossAxis:f=!0,fallbackPlacements:p,fallbackStrategy:h="bestFit",fallbackAxisSideDirection:g="none",flipAlignment:m=!0,...x}=fi(e,t);if((r=a.arrow)!=null&&r.alignmentOffset)return{};const w=hi(s),v=ja(l),_=hi(l)===l,b=await(c.isRTL==null?void 0:c.isRTL(u.floating)),S=p||(_||!m?[zm(l)]:c6(l)),T=g!=="none";!p&&T&&S.push(...h6(l,m,g,b));const N=[l,...S],C=await $d(t,x),E=[];let P=((n=a.flip)==null?void 0:n.overflows)||[];if(d&&E.push(C[w]),f){const A=l6(s,o,b);E.push(C[A[0]],C[A[1]])}if(P=[...P,{placement:s,overflows:E}],!E.every(A=>A<=0)){var R,j;const A=(((R=a.flip)==null?void 0:R.index)||0)+1,I=N[A];if(I&&(!(f==="alignment"?v!==ja(I):!1)||P.every(z=>z.overflows[0]>0&&ja(z.placement)===v)))return{data:{index:A,overflows:P},reset:{placement:I}};let X=(j=P.filter(Y=>Y.overflows[0]<=0).sort((Y,z)=>Y.overflows[1]-z.overflows[1])[0])==null?void 0:j.placement;if(!X)switch(h){case"bestFit":{var M;const Y=(M=P.filter(z=>{if(T){const U=ja(z.placement);return U===v||U==="y"}return!0}).map(z=>[z.placement,z.overflows.filter(U=>U>0).reduce((U,V)=>U+V,0)]).sort((z,U)=>z[1]-U[1])[0])==null?void 0:M[0];Y&&(X=Y);break}case"initialPlacement":X=l;break}if(s!==X)return{reset:{placement:X}}}return{}}}};function Bb(e,t){return{top:e.top-t.height,right:e.right-t.width,bottom:e.bottom-t.height,left:e.left-t.width}}function Ub(e){return s6.some(t=>e[t]>=0)}const v6=function(e){return e===void 0&&(e={}),{name:"hide",options:e,async fn(t){const{rects:r}=t,{strategy:n="referenceHidden",...s}=fi(e,t);switch(n){case"referenceHidden":{const a=await $d(t,{...s,elementContext:"reference"}),o=Bb(a,r.reference);return{data:{referenceHiddenOffsets:o,referenceHidden:Ub(o)}}}case"escaped":{const a=await $d(t,{...s,altBoundary:!0}),o=Bb(a,r.floating);return{data:{escapedOffsets:o,escaped:Ub(o)}}}default:return{}}}}},bk=new Set(["left","top"]);async function y6(e,t){const{placement:r,platform:n,elements:s}=e,a=await(n.isRTL==null?void 0:n.isRTL(s.floating)),o=hi(r),l=tu(r),c=ja(r)==="y",u=bk.has(o)?-1:1,d=a&&c?-1:1,f=fi(t,e);let{mainAxis:p,crossAxis:h,alignmentAxis:g}=typeof f=="number"?{mainAxis:f,crossAxis:0,alignmentAxis:null}:{mainAxis:f.mainAxis||0,crossAxis:f.crossAxis||0,alignmentAxis:f.alignmentAxis};return l&&typeof g=="number"&&(h=l==="end"?g*-1:g),c?{x:h*d,y:p*u}:{x:p*u,y:h*d}}const w6=function(e){return e===void 0&&(e=0),{name:"offset",options:e,async fn(t){var r,n;const{x:s,y:a,placement:o,middlewareData:l}=t,c=await y6(t,e);return o===((r=l.offset)==null?void 0:r.placement)&&(n=l.arrow)!=null&&n.alignmentOffset?{}:{x:s+c.x,y:a+c.y,data:{...c,placement:o}}}}},_6=function(e){return e===void 0&&(e={}),{name:"shift",options:e,async fn(t){const{x:r,y:n,placement:s}=t,{mainAxis:a=!0,crossAxis:o=!1,limiter:l={fn:x=>{let{x:w,y:v}=x;return{x:w,y:v}}},...c}=fi(e,t),u={x:r,y:n},d=await $d(t,c),f=ja(hi(s)),p=v1(f);let h=u[p],g=u[f];if(a){const x=p==="y"?"top":"left",w=p==="y"?"bottom":"right",v=h+d[x],_=h-d[w];h=kv(v,h,_)}if(o){const x=f==="y"?"top":"left",w=f==="y"?"bottom":"right",v=g+d[x],_=g-d[w];g=kv(v,g,_)}const m=l.fn({...t,[p]:h,[f]:g});return{...m,data:{x:m.x-r,y:m.y-n,enabled:{[p]:a,[f]:o}}}}}},b6=function(e){return e===void 0&&(e={}),{options:e,fn(t){const{x:r,y:n,placement:s,rects:a,middlewareData:o}=t,{offset:l=0,mainAxis:c=!0,crossAxis:u=!0}=fi(e,t),d={x:r,y:n},f=ja(s),p=v1(f);let h=d[p],g=d[f];const m=fi(l,t),x=typeof m=="number"?{mainAxis:m,crossAxis:0}:{mainAxis:0,crossAxis:0,...m};if(c){const _=p==="y"?"height":"width",b=a.reference[p]-a.floating[_]+x.mainAxis,S=a.reference[p]+a.reference[_]-x.mainAxis;h<b?h=b:h>S&&(h=S)}if(u){var w,v;const _=p==="y"?"width":"height",b=bk.has(hi(s)),S=a.reference[f]-a.floating[_]+(b&&((w=o.offset)==null?void 0:w[f])||0)+(b?0:x.crossAxis),T=a.reference[f]+a.reference[_]+(b?0:((v=o.offset)==null?void 0:v[f])||0)-(b?x.crossAxis:0);g<S?g=S:g>T&&(g=T)}return{[p]:h,[f]:g}}}},S6=function(e){return e===void 0&&(e={}),{name:"size",options:e,async fn(t){var r,n;const{placement:s,rects:a,platform:o,elements:l}=t,{apply:c=()=>{},...u}=fi(e,t),d=await $d(t,u),f=hi(s),p=tu(s),h=ja(s)==="y",{width:g,height:m}=a.floating;let x,w;f==="top"||f==="bottom"?(x=f,w=p===(await(o.isRTL==null?void 0:o.isRTL(l.floating))?"start":"end")?"left":"right"):(w=f,x=p==="end"?"top":"bottom");const v=m-d.top-d.bottom,_=g-d.left-d.right,b=co(m-d[x],v),S=co(g-d[w],_),T=!t.middlewareData.shift;let N=b,C=S;if((r=t.middlewareData.shift)!=null&&r.enabled.x&&(C=_),(n=t.middlewareData.shift)!=null&&n.enabled.y&&(N=v),T&&!p){const P=ts(d.left,0),R=ts(d.right,0),j=ts(d.top,0),M=ts(d.bottom,0);h?C=g-2*(P!==0||R!==0?P+R:ts(d.left,d.right)):N=m-2*(j!==0||M!==0?j+M:ts(d.top,d.bottom))}await c({...t,availableWidth:C,availableHeight:N});const E=await o.getDimensions(l.floating);return g!==E.width||m!==E.height?{reset:{rects:!0}}:{}}}};function Y0(){return typeof window<"u"}function ru(e){return Sk(e)?(e.nodeName||"").toLowerCase():"#document"}function ls(e){var t;return(e==null||(t=e.ownerDocument)==null?void 0:t.defaultView)||window}function Oa(e){var t;return(t=(Sk(e)?e.ownerDocument:e.document)||window.document)==null?void 0:t.documentElement}function Sk(e){return Y0()?e instanceof Node||e instanceof ls(e).Node:!1}function aa(e){return Y0()?e instanceof Element||e instanceof ls(e).Element:!1}function Da(e){return Y0()?e instanceof HTMLElement||e instanceof ls(e).HTMLElement:!1}function zb(e){return!Y0()||typeof ShadowRoot>"u"?!1:e instanceof ShadowRoot||e instanceof ls(e).ShadowRoot}const N6=new Set(["inline","contents"]);function Sf(e){const{overflow:t,overflowX:r,overflowY:n,display:s}=ia(e);return/auto|scroll|overlay|hidden|clip/.test(t+n+r)&&!N6.has(s)}const j6=new Set(["table","td","th"]);function E6(e){return j6.has(ru(e))}const k6=[":popover-open",":modal"];function K0(e){return k6.some(t=>{try{return e.matches(t)}catch{return!1}})}const C6=["transform","translate","scale","rotate","perspective"],T6=["transform","translate","scale","rotate","perspective","filter"],A6=["paint","layout","strict","content"];function _1(e){const t=b1(),r=aa(e)?ia(e):e;return C6.some(n=>r[n]?r[n]!=="none":!1)||(r.containerType?r.containerType!=="normal":!1)||!t&&(r.backdropFilter?r.backdropFilter!=="none":!1)||!t&&(r.filter?r.filter!=="none":!1)||T6.some(n=>(r.willChange||"").includes(n))||A6.some(n=>(r.contain||"").includes(n))}function P6(e){let t=uo(e);for(;Da(t)&&!Lc(t);){if(_1(t))return t;if(K0(t))return null;t=uo(t)}return null}function b1(){return typeof CSS>"u"||!CSS.supports?!1:CSS.supports("-webkit-backdrop-filter","none")}const D6=new Set(["html","body","#document"]);function Lc(e){return D6.has(ru(e))}function ia(e){return ls(e).getComputedStyle(e)}function X0(e){return aa(e)?{scrollLeft:e.scrollLeft,scrollTop:e.scrollTop}:{scrollLeft:e.scrollX,scrollTop:e.scrollY}}function uo(e){if(ru(e)==="html")return e;const t=e.assignedSlot||e.parentNode||zb(e)&&e.host||Oa(e);return zb(t)?t.host:t}function Nk(e){const t=uo(e);return Lc(t)?e.ownerDocument?e.ownerDocument.body:e.body:Da(t)&&Sf(t)?t:Nk(t)}function Bd(e,t,r){var n;t===void 0&&(t=[]),r===void 0&&(r=!0);const s=Nk(e),a=s===((n=e.ownerDocument)==null?void 0:n.body),o=ls(s);if(a){const l=Tv(o);return t.concat(o,o.visualViewport||[],Sf(s)?s:[],l&&r?Bd(l):[])}return t.concat(s,Bd(s,[],r))}function Tv(e){return e.parent&&Object.getPrototypeOf(e.parent)?e.frameElement:null}function jk(e){const t=ia(e);let r=parseFloat(t.width)||0,n=parseFloat(t.height)||0;const s=Da(e),a=s?e.offsetWidth:r,o=s?e.offsetHeight:n,l=Um(r)!==a||Um(n)!==o;return l&&(r=a,n=o),{width:r,height:n,$:l}}function S1(e){return aa(e)?e:e.contextElement}function mc(e){const t=S1(e);if(!Da(t))return Aa(1);const r=t.getBoundingClientRect(),{width:n,height:s,$:a}=jk(t);let o=(a?Um(r.width):r.width)/n,l=(a?Um(r.height):r.height)/s;return(!o||!Number.isFinite(o))&&(o=1),(!l||!Number.isFinite(l))&&(l=1),{x:o,y:l}}const R6=Aa(0);function Ek(e){const t=ls(e);return!b1()||!t.visualViewport?R6:{x:t.visualViewport.offsetLeft,y:t.visualViewport.offsetTop}}function M6(e,t,r){return t===void 0&&(t=!1),!r||t&&r!==ls(e)?!1:t}function al(e,t,r,n){t===void 0&&(t=!1),r===void 0&&(r=!1);const s=e.getBoundingClientRect(),a=S1(e);let o=Aa(1);t&&(n?aa(n)&&(o=mc(n)):o=mc(e));const l=M6(a,r,n)?Ek(a):Aa(0);let c=(s.left+l.x)/o.x,u=(s.top+l.y)/o.y,d=s.width/o.x,f=s.height/o.y;if(a){const p=ls(a),h=n&&aa(n)?ls(n):n;let g=p,m=Tv(g);for(;m&&n&&h!==g;){const x=mc(m),w=m.getBoundingClientRect(),v=ia(m),_=w.left+(m.clientLeft+parseFloat(v.paddingLeft))*x.x,b=w.top+(m.clientTop+parseFloat(v.paddingTop))*x.y;c*=x.x,u*=x.y,d*=x.x,f*=x.y,c+=_,u+=b,g=ls(m),m=Tv(g)}}return Vm({width:d,height:f,x:c,y:u})}function N1(e,t){const r=X0(e).scrollLeft;return t?t.left+r:al(Oa(e)).left+r}function kk(e,t,r){r===void 0&&(r=!1);const n=e.getBoundingClientRect(),s=n.left+t.scrollLeft-(r?0:N1(e,n)),a=n.top+t.scrollTop;return{x:s,y:a}}function O6(e){let{elements:t,rect:r,offsetParent:n,strategy:s}=e;const a=s==="fixed",o=Oa(n),l=t?K0(t.floating):!1;if(n===o||l&&a)return r;let c={scrollLeft:0,scrollTop:0},u=Aa(1);const d=Aa(0),f=Da(n);if((f||!f&&!a)&&((ru(n)!=="body"||Sf(o))&&(c=X0(n)),Da(n))){const h=al(n);u=mc(n),d.x=h.x+n.clientLeft,d.y=h.y+n.clientTop}const p=o&&!f&&!a?kk(o,c,!0):Aa(0);return{width:r.width*u.x,height:r.height*u.y,x:r.x*u.x-c.scrollLeft*u.x+d.x+p.x,y:r.y*u.y-c.scrollTop*u.y+d.y+p.y}}function F6(e){return Array.from(e.getClientRects())}function I6(e){const t=Oa(e),r=X0(e),n=e.ownerDocument.body,s=ts(t.scrollWidth,t.clientWidth,n.scrollWidth,n.clientWidth),a=ts(t.scrollHeight,t.clientHeight,n.scrollHeight,n.clientHeight);let o=-r.scrollLeft+N1(e);const l=-r.scrollTop;return ia(n).direction==="rtl"&&(o+=ts(t.clientWidth,n.clientWidth)-s),{width:s,height:a,x:o,y:l}}function L6(e,t){const r=ls(e),n=Oa(e),s=r.visualViewport;let a=n.clientWidth,o=n.clientHeight,l=0,c=0;if(s){a=s.width,o=s.height;const u=b1();(!u||u&&t==="fixed")&&(l=s.offsetLeft,c=s.offsetTop)}return{width:a,height:o,x:l,y:c}}const $6=new Set(["absolute","fixed"]);function B6(e,t){const r=al(e,!0,t==="fixed"),n=r.top+e.clientTop,s=r.left+e.clientLeft,a=Da(e)?mc(e):Aa(1),o=e.clientWidth*a.x,l=e.clientHeight*a.y,c=s*a.x,u=n*a.y;return{width:o,height:l,x:c,y:u}}function Vb(e,t,r){let n;if(t==="viewport")n=L6(e,r);else if(t==="document")n=I6(Oa(e));else if(aa(t))n=B6(t,r);else{const s=Ek(e);n={x:t.x-s.x,y:t.y-s.y,width:t.width,height:t.height}}return Vm(n)}function Ck(e,t){const r=uo(e);return r===t||!aa(r)||Lc(r)?!1:ia(r).position==="fixed"||Ck(r,t)}function U6(e,t){const r=t.get(e);if(r)return r;let n=Bd(e,[],!1).filter(l=>aa(l)&&ru(l)!=="body"),s=null;const a=ia(e).position==="fixed";let o=a?uo(e):e;for(;aa(o)&&!Lc(o);){const l=ia(o),c=_1(o);!c&&l.position==="fixed"&&(s=null),(a?!c&&!s:!c&&l.position==="static"&&!!s&&$6.has(s.position)||Sf(o)&&!c&&Ck(e,o))?n=n.filter(d=>d!==o):s=l,o=uo(o)}return t.set(e,n),n}function z6(e){let{element:t,boundary:r,rootBoundary:n,strategy:s}=e;const o=[...r==="clippingAncestors"?K0(t)?[]:U6(t,this._c):[].concat(r),n],l=o[0],c=o.reduce((u,d)=>{const f=Vb(t,d,s);return u.top=ts(f.top,u.top),u.right=co(f.right,u.right),u.bottom=co(f.bottom,u.bottom),u.left=ts(f.left,u.left),u},Vb(t,l,s));return{width:c.right-c.left,height:c.bottom-c.top,x:c.left,y:c.top}}function V6(e){const{width:t,height:r}=jk(e);return{width:t,height:r}}function W6(e,t,r){const n=Da(t),s=Oa(t),a=r==="fixed",o=al(e,!0,a,t);let l={scrollLeft:0,scrollTop:0};const c=Aa(0);function u(){c.x=N1(s)}if(n||!n&&!a)if((ru(t)!=="body"||Sf(s))&&(l=X0(t)),n){const h=al(t,!0,a,t);c.x=h.x+t.clientLeft,c.y=h.y+t.clientTop}else s&&u();a&&!n&&s&&u();const d=s&&!n&&!a?kk(s,l):Aa(0),f=o.left+l.scrollLeft-c.x-d.x,p=o.top+l.scrollTop-c.y-d.y;return{x:f,y:p,width:o.width,height:o.height}}function Mg(e){return ia(e).position==="static"}function Wb(e,t){if(!Da(e)||ia(e).position==="fixed")return null;if(t)return t(e);let r=e.offsetParent;return Oa(e)===r&&(r=r.ownerDocument.body),r}function Tk(e,t){const r=ls(e);if(K0(e))return r;if(!Da(e)){let s=uo(e);for(;s&&!Lc(s);){if(aa(s)&&!Mg(s))return s;s=uo(s)}return r}let n=Wb(e,t);for(;n&&E6(n)&&Mg(n);)n=Wb(n,t);return n&&Lc(n)&&Mg(n)&&!_1(n)?r:n||P6(e)||r}const H6=async function(e){const t=this.getOffsetParent||Tk,r=this.getDimensions,n=await r(e.floating);return{reference:W6(e.reference,await t(e.floating),e.strategy),floating:{x:0,y:0,width:n.width,height:n.height}}};function G6(e){return ia(e).direction==="rtl"}const q6={convertOffsetParentRelativeRectToViewportRelativeRect:O6,getDocumentElement:Oa,getClippingRect:z6,getOffsetParent:Tk,getElementRects:H6,getClientRects:F6,getDimensions:V6,getScale:mc,isElement:aa,isRTL:G6};function Ak(e,t){return e.x===t.x&&e.y===t.y&&e.width===t.width&&e.height===t.height}function Y6(e,t){let r=null,n;const s=Oa(e);function a(){var l;clearTimeout(n),(l=r)==null||l.disconnect(),r=null}function o(l,c){l===void 0&&(l=!1),c===void 0&&(c=1),a();const u=e.getBoundingClientRect(),{left:d,top:f,width:p,height:h}=u;if(l||t(),!p||!h)return;const g=_h(f),m=_h(s.clientWidth-(d+p)),x=_h(s.clientHeight-(f+h)),w=_h(d),_={rootMargin:-g+"px "+-m+"px "+-x+"px "+-w+"px",threshold:ts(0,co(1,c))||1};let b=!0;function S(T){const N=T[0].intersectionRatio;if(N!==c){if(!b)return o();N?o(!1,N):n=setTimeout(()=>{o(!1,1e-7)},1e3)}N===1&&!Ak(u,e.getBoundingClientRect())&&o(),b=!1}try{r=new IntersectionObserver(S,{..._,root:s.ownerDocument})}catch{r=new IntersectionObserver(S,_)}r.observe(e)}return o(!0),a}function K6(e,t,r,n){n===void 0&&(n={});const{ancestorScroll:s=!0,ancestorResize:a=!0,elementResize:o=typeof ResizeObserver=="function",layoutShift:l=typeof IntersectionObserver=="function",animationFrame:c=!1}=n,u=S1(e),d=s||a?[...u?Bd(u):[],...Bd(t)]:[];d.forEach(w=>{s&&w.addEventListener("scroll",r,{passive:!0}),a&&w.addEventListener("resize",r)});const f=u&&l?Y6(u,r):null;let p=-1,h=null;o&&(h=new ResizeObserver(w=>{let[v]=w;v&&v.target===u&&h&&(h.unobserve(t),cancelAnimationFrame(p),p=requestAnimationFrame(()=>{var _;(_=h)==null||_.observe(t)})),r()}),u&&!c&&h.observe(u),h.observe(t));let g,m=c?al(e):null;c&&x();function x(){const w=al(e);m&&!Ak(m,w)&&r(),m=w,g=requestAnimationFrame(x)}return r(),()=>{var w;d.forEach(v=>{s&&v.removeEventListener("scroll",r),a&&v.removeEventListener("resize",r)}),f==null||f(),(w=h)==null||w.disconnect(),h=null,c&&cancelAnimationFrame(g)}}const X6=w6,Q6=_6,J6=x6,Z6=S6,e8=v6,Hb=g6,t8=b6,r8=(e,t,r)=>{const n=new Map,s={platform:q6,...r},a={...s.platform,_c:n};return p6(e,t,{...s,platform:a})};var n8=typeof document<"u",s8=function(){},am=n8?y.useLayoutEffect:s8;function Wm(e,t){if(e===t)return!0;if(typeof e!=typeof t)return!1;if(typeof e=="function"&&e.toString()===t.toString())return!0;let r,n,s;if(e&&t&&typeof e=="object"){if(Array.isArray(e)){if(r=e.length,r!==t.length)return!1;for(n=r;n--!==0;)if(!Wm(e[n],t[n]))return!1;return!0}if(s=Object.keys(e),r=s.length,r!==Object.keys(t).length)return!1;for(n=r;n--!==0;)if(!{}.hasOwnProperty.call(t,s[n]))return!1;for(n=r;n--!==0;){const a=s[n];if(!(a==="_owner"&&e.$$typeof)&&!Wm(e[a],t[a]))return!1}return!0}return e!==e&&t!==t}function Pk(e){return typeof window>"u"?1:(e.ownerDocument.defaultView||window).devicePixelRatio||1}function Gb(e,t){const r=Pk(e);return Math.round(t*r)/r}function Og(e){const t=y.useRef(e);return am(()=>{t.current=e}),t}function a8(e){e===void 0&&(e={});const{placement:t="bottom",strategy:r="absolute",middleware:n=[],platform:s,elements:{reference:a,floating:o}={},transform:l=!0,whileElementsMounted:c,open:u}=e,[d,f]=y.useState({x:0,y:0,strategy:r,placement:t,middlewareData:{},isPositioned:!1}),[p,h]=y.useState(n);Wm(p,n)||h(n);const[g,m]=y.useState(null),[x,w]=y.useState(null),v=y.useCallback(z=>{z!==T.current&&(T.current=z,m(z))},[]),_=y.useCallback(z=>{z!==N.current&&(N.current=z,w(z))},[]),b=a||g,S=o||x,T=y.useRef(null),N=y.useRef(null),C=y.useRef(d),E=c!=null,P=Og(c),R=Og(s),j=Og(u),M=y.useCallback(()=>{if(!T.current||!N.current)return;const z={placement:t,strategy:r,middleware:p};R.current&&(z.platform=R.current),r8(T.current,N.current,z).then(U=>{const V={...U,isPositioned:j.current!==!1};A.current&&!Wm(C.current,V)&&(C.current=V,xl.flushSync(()=>{f(V)}))})},[p,t,r,R,j]);am(()=>{u===!1&&C.current.isPositioned&&(C.current.isPositioned=!1,f(z=>({...z,isPositioned:!1})))},[u]);const A=y.useRef(!1);am(()=>(A.current=!0,()=>{A.current=!1}),[]),am(()=>{if(b&&(T.current=b),S&&(N.current=S),b&&S){if(P.current)return P.current(b,S,M);M()}},[b,S,M,P,E]);const I=y.useMemo(()=>({reference:T,floating:N,setReference:v,setFloating:_}),[v,_]),X=y.useMemo(()=>({reference:b,floating:S}),[b,S]),Y=y.useMemo(()=>{const z={position:r,left:0,top:0};if(!X.floating)return z;const U=Gb(X.floating,d.x),V=Gb(X.floating,d.y);return l?{...z,transform:"translate("+U+"px, "+V+"px)",...Pk(X.floating)>=1.5&&{willChange:"transform"}}:{position:r,left:U,top:V}},[r,l,X.floating,d.x,d.y]);return y.useMemo(()=>({...d,update:M,refs:I,elements:X,floatingStyles:Y}),[d,M,I,X,Y])}const i8=e=>{function t(r){return{}.hasOwnProperty.call(r,"current")}return{name:"arrow",options:e,fn(r){const{element:n,padding:s}=typeof e=="function"?e(r):e;return n&&t(n)?n.current!=null?Hb({element:n.current,padding:s}).fn(r):{}:n?Hb({element:n,padding:s}).fn(r):{}}}},o8=(e,t)=>({...X6(e),options:[e,t]}),l8=(e,t)=>({...Q6(e),options:[e,t]}),c8=(e,t)=>({...t8(e),options:[e,t]}),u8=(e,t)=>({...J6(e),options:[e,t]}),d8=(e,t)=>({...Z6(e),options:[e,t]}),f8=(e,t)=>({...e8(e),options:[e,t]}),h8=(e,t)=>({...i8(e),options:[e,t]});var m8="Arrow",Dk=y.forwardRef((e,t)=>{const{children:r,width:n=10,height:s=5,...a}=e;return i.jsx(ze.svg,{...a,ref:t,width:n,height:s,viewBox:"0 0 30 10",preserveAspectRatio:"none",children:e.asChild?r:i.jsx("polygon",{points:"0,0 30,0 15,10"})})});Dk.displayName=m8;var p8=Dk;function j1(e){const[t,r]=y.useState(void 0);return gr(()=>{if(e){r({width:e.offsetWidth,height:e.offsetHeight});const n=new ResizeObserver(s=>{if(!Array.isArray(s)||!s.length)return;const a=s[0];let o,l;if("borderBoxSize"in a){const c=a.borderBoxSize,u=Array.isArray(c)?c[0]:c;o=u.inlineSize,l=u.blockSize}else o=e.offsetWidth,l=e.offsetHeight;r({width:o,height:l})});return n.observe(e,{box:"border-box"}),()=>n.unobserve(e)}else r(void 0)},[e]),t}var E1="Popper",[Rk,yo]=Fr(E1),[g8,Mk]=Rk(E1),Ok=e=>{const{__scopePopper:t,children:r}=e,[n,s]=y.useState(null);return i.jsx(g8,{scope:t,anchor:n,onAnchorChange:s,children:r})};Ok.displayName=E1;var Fk="PopperAnchor",Ik=y.forwardRef((e,t)=>{const{__scopePopper:r,virtualRef:n,...s}=e,a=Mk(Fk,r),o=y.useRef(null),l=st(t,o);return y.useEffect(()=>{a.onAnchorChange((n==null?void 0:n.current)||o.current)}),n?null:i.jsx(ze.div,{...s,ref:l})});Ik.displayName=Fk;var k1="PopperContent",[x8,v8]=Rk(k1),Lk=y.forwardRef((e,t)=>{var ne,me,pe,xe,Ae,ge;const{__scopePopper:r,side:n="bottom",sideOffset:s=0,align:a="center",alignOffset:o=0,arrowPadding:l=0,avoidCollisions:c=!0,collisionBoundary:u=[],collisionPadding:d=0,sticky:f="partial",hideWhenDetached:p=!1,updatePositionStrategy:h="optimized",onPlaced:g,...m}=e,x=Mk(k1,r),[w,v]=y.useState(null),_=st(t,je=>v(je)),[b,S]=y.useState(null),T=j1(b),N=(T==null?void 0:T.width)??0,C=(T==null?void 0:T.height)??0,E=n+(a!=="center"?"-"+a:""),P=typeof d=="number"?d:{top:0,right:0,bottom:0,left:0,...d},R=Array.isArray(u)?u:[u],j=R.length>0,M={padding:P,boundary:R.filter(w8),altBoundary:j},{refs:A,floatingStyles:I,placement:X,isPositioned:Y,middlewareData:z}=a8({strategy:"fixed",placement:E,whileElementsMounted:(...je)=>K6(...je,{animationFrame:h==="always"}),elements:{reference:x.anchor},middleware:[o8({mainAxis:s+C,alignmentAxis:o}),c&&l8({mainAxis:!0,crossAxis:!1,limiter:f==="partial"?c8():void 0,...M}),c&&u8({...M}),d8({...M,apply:({elements:je,rects:k,availableWidth:le,availableHeight:ce})=>{const{width:H,height:K}=k.reference,oe=je.floating.style;oe.setProperty("--radix-popper-available-width",`${le}px`),oe.setProperty("--radix-popper-available-height",`${ce}px`),oe.setProperty("--radix-popper-anchor-width",`${H}px`),oe.setProperty("--radix-popper-anchor-height",`${K}px`)}}),b&&h8({element:b,padding:l}),_8({arrowWidth:N,arrowHeight:C}),p&&f8({strategy:"referenceHidden",...M})]}),[U,V]=Uk(X),F=hr(g);gr(()=>{Y&&(F==null||F())},[Y,F]);const D=(ne=z.arrow)==null?void 0:ne.x,G=(me=z.arrow)==null?void 0:me.y,O=((pe=z.arrow)==null?void 0:pe.centerOffset)!==0,[L,ie]=y.useState();return gr(()=>{w&&ie(window.getComputedStyle(w).zIndex)},[w]),i.jsx("div",{ref:A.setFloating,"data-radix-popper-content-wrapper":"",style:{...I,transform:Y?I.transform:"translate(0, -200%)",minWidth:"max-content",zIndex:L,"--radix-popper-transform-origin":[(xe=z.transformOrigin)==null?void 0:xe.x,(Ae=z.transformOrigin)==null?void 0:Ae.y].join(" "),...((ge=z.hide)==null?void 0:ge.referenceHidden)&&{visibility:"hidden",pointerEvents:"none"}},dir:e.dir,children:i.jsx(x8,{scope:r,placedSide:U,onArrowChange:S,arrowX:D,arrowY:G,shouldHideArrow:O,children:i.jsx(ze.div,{"data-side":U,"data-align":V,...m,ref:_,style:{...m.style,animation:Y?void 0:"none"}})})})});Lk.displayName=k1;var $k="PopperArrow",y8={top:"bottom",right:"left",bottom:"top",left:"right"},Bk=y.forwardRef(function(t,r){const{__scopePopper:n,...s}=t,a=v8($k,n),o=y8[a.placedSide];return i.jsx("span",{ref:a.onArrowChange,style:{position:"absolute",left:a.arrowX,top:a.arrowY,[o]:0,transformOrigin:{top:"",right:"0 0",bottom:"center 0",left:"100% 0"}[a.placedSide],transform:{top:"translateY(100%)",right:"translateY(50%) rotate(90deg) translateX(-50%)",bottom:"rotate(180deg)",left:"translateY(50%) rotate(-90deg) translateX(50%)"}[a.placedSide],visibility:a.shouldHideArrow?"hidden":void 0},children:i.jsx(p8,{...s,ref:r,style:{...s.style,display:"block"}})})});Bk.displayName=$k;function w8(e){return e!==null}var _8=e=>({name:"transformOrigin",options:e,fn(t){var x,w,v;const{placement:r,rects:n,middlewareData:s}=t,o=((x=s.arrow)==null?void 0:x.centerOffset)!==0,l=o?0:e.arrowWidth,c=o?0:e.arrowHeight,[u,d]=Uk(r),f={start:"0%",center:"50%",end:"100%"}[d],p=(((w=s.arrow)==null?void 0:w.x)??0)+l/2,h=(((v=s.arrow)==null?void 0:v.y)??0)+c/2;let g="",m="";return u==="bottom"?(g=o?f:`${p}px`,m=`${-c}px`):u==="top"?(g=o?f:`${p}px`,m=`${n.floating.height+c}px`):u==="right"?(g=`${-c}px`,m=o?f:`${h}px`):u==="left"&&(g=`${n.floating.width+c}px`,m=o?f:`${h}px`),{data:{x:g,y:m}}}});function Uk(e){const[t,r="center"]=e.split("-");return[t,r]}var Q0=Ok,Nf=Ik,J0=Lk,Z0=Bk,[ep,qne]=Fr("Tooltip",[yo]),tp=yo(),zk="TooltipProvider",b8=700,Av="tooltip.open",[S8,C1]=ep(zk),Vk=e=>{const{__scopeTooltip:t,delayDuration:r=b8,skipDelayDuration:n=300,disableHoverableContent:s=!1,children:a}=e,o=y.useRef(!0),l=y.useRef(!1),c=y.useRef(0);return y.useEffect(()=>{const u=c.current;return()=>window.clearTimeout(u)},[]),i.jsx(S8,{scope:t,isOpenDelayedRef:o,delayDuration:r,onOpen:y.useCallback(()=>{window.clearTimeout(c.current),o.current=!1},[]),onClose:y.useCallback(()=>{window.clearTimeout(c.current),c.current=window.setTimeout(()=>o.current=!0,n)},[n]),isPointerInTransitRef:l,onPointerInTransitChange:y.useCallback(u=>{l.current=u},[]),disableHoverableContent:s,children:a})};Vk.displayName=zk;var Ud="Tooltip",[N8,rp]=ep(Ud),Wk=e=>{const{__scopeTooltip:t,children:r,open:n,defaultOpen:s,onOpenChange:a,disableHoverableContent:o,delayDuration:l}=e,c=C1(Ud,e.__scopeTooltip),u=tp(t),[d,f]=y.useState(null),p=Er(),h=y.useRef(0),g=o??c.disableHoverableContent,m=l??c.delayDuration,x=y.useRef(!1),[w,v]=Hn({prop:n,defaultProp:s??!1,onChange:N=>{N?(c.onOpen(),document.dispatchEvent(new CustomEvent(Av))):c.onClose(),a==null||a(N)},caller:Ud}),_=y.useMemo(()=>w?x.current?"delayed-open":"instant-open":"closed",[w]),b=y.useCallback(()=>{window.clearTimeout(h.current),h.current=0,x.current=!1,v(!0)},[v]),S=y.useCallback(()=>{window.clearTimeout(h.current),h.current=0,v(!1)},[v]),T=y.useCallback(()=>{window.clearTimeout(h.current),h.current=window.setTimeout(()=>{x.current=!0,v(!0),h.current=0},m)},[m,v]);return y.useEffect(()=>()=>{h.current&&(window.clearTimeout(h.current),h.current=0)},[]),i.jsx(Q0,{...u,children:i.jsx(N8,{scope:t,contentId:p,open:w,stateAttribute:_,trigger:d,onTriggerChange:f,onTriggerEnter:y.useCallback(()=>{c.isOpenDelayedRef.current?T():b()},[c.isOpenDelayedRef,T,b]),onTriggerLeave:y.useCallback(()=>{g?S():(window.clearTimeout(h.current),h.current=0)},[S,g]),onOpen:b,onClose:S,disableHoverableContent:g,children:r})})};Wk.displayName=Ud;var Pv="TooltipTrigger",Hk=y.forwardRef((e,t)=>{const{__scopeTooltip:r,...n}=e,s=rp(Pv,r),a=C1(Pv,r),o=tp(r),l=y.useRef(null),c=st(t,l,s.onTriggerChange),u=y.useRef(!1),d=y.useRef(!1),f=y.useCallback(()=>u.current=!1,[]);return y.useEffect(()=>()=>document.removeEventListener("pointerup",f),[f]),i.jsx(Nf,{asChild:!0,...o,children:i.jsx(ze.button,{"aria-describedby":s.open?s.contentId:void 0,"data-state":s.stateAttribute,...n,ref:c,onPointerMove:Oe(e.onPointerMove,p=>{p.pointerType!=="touch"&&!d.current&&!a.isPointerInTransitRef.current&&(s.onTriggerEnter(),d.current=!0)}),onPointerLeave:Oe(e.onPointerLeave,()=>{s.onTriggerLeave(),d.current=!1}),onPointerDown:Oe(e.onPointerDown,()=>{s.open&&s.onClose(),u.current=!0,document.addEventListener("pointerup",f,{once:!0})}),onFocus:Oe(e.onFocus,()=>{u.current||s.onOpen()}),onBlur:Oe(e.onBlur,s.onClose),onClick:Oe(e.onClick,s.onClose)})})});Hk.displayName=Pv;var j8="TooltipPortal",[Yne,E8]=ep(j8,{forceMount:void 0}),$c="TooltipContent",Gk=y.forwardRef((e,t)=>{const r=E8($c,e.__scopeTooltip),{forceMount:n=r.forceMount,side:s="top",...a}=e,o=rp($c,e.__scopeTooltip);return i.jsx(Ir,{present:n||o.open,children:o.disableHoverableContent?i.jsx(qk,{side:s,...a,ref:t}):i.jsx(k8,{side:s,...a,ref:t})})}),k8=y.forwardRef((e,t)=>{const r=rp($c,e.__scopeTooltip),n=C1($c,e.__scopeTooltip),s=y.useRef(null),a=st(t,s),[o,l]=y.useState(null),{trigger:c,onClose:u}=r,d=s.current,{onPointerInTransitChange:f}=n,p=y.useCallback(()=>{l(null),f(!1)},[f]),h=y.useCallback((g,m)=>{const x=g.currentTarget,w={x:g.clientX,y:g.clientY},v=D8(w,x.getBoundingClientRect()),_=R8(w,v),b=M8(m.getBoundingClientRect()),S=F8([..._,...b]);l(S),f(!0)},[f]);return y.useEffect(()=>()=>p(),[p]),y.useEffect(()=>{if(c&&d){const g=x=>h(x,d),m=x=>h(x,c);return c.addEventListener("pointerleave",g),d.addEventListener("pointerleave",m),()=>{c.removeEventListener("pointerleave",g),d.removeEventListener("pointerleave",m)}}},[c,d,h,p]),y.useEffect(()=>{if(o){const g=m=>{const x=m.target,w={x:m.clientX,y:m.clientY},v=(c==null?void 0:c.contains(x))||(d==null?void 0:d.contains(x)),_=!O8(w,o);v?p():_&&(p(),u())};return document.addEventListener("pointermove",g),()=>document.removeEventListener("pointermove",g)}},[c,d,o,u,p]),i.jsx(qk,{...e,ref:a})}),[C8,T8]=ep(Ud,{isInside:!1}),A8=OE("TooltipContent"),qk=y.forwardRef((e,t)=>{const{__scopeTooltip:r,children:n,"aria-label":s,onEscapeKeyDown:a,onPointerDownOutside:o,...l}=e,c=rp($c,r),u=tp(r),{onClose:d}=c;return y.useEffect(()=>(document.addEventListener(Av,d),()=>document.removeEventListener(Av,d)),[d]),y.useEffect(()=>{if(c.trigger){const f=p=>{const h=p.target;h!=null&&h.contains(c.trigger)&&d()};return window.addEventListener("scroll",f,{capture:!0}),()=>window.removeEventListener("scroll",f,{capture:!0})}},[c.trigger,d]),i.jsx(vl,{asChild:!0,disableOutsidePointerEvents:!1,onEscapeKeyDown:a,onPointerDownOutside:o,onFocusOutside:f=>f.preventDefault(),onDismiss:d,children:i.jsxs(J0,{"data-state":c.stateAttribute,...u,...l,ref:t,style:{...l.style,"--radix-tooltip-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-tooltip-content-available-width":"var(--radix-popper-available-width)","--radix-tooltip-content-available-height":"var(--radix-popper-available-height)","--radix-tooltip-trigger-width":"var(--radix-popper-anchor-width)","--radix-tooltip-trigger-height":"var(--radix-popper-anchor-height)"},children:[i.jsx(A8,{children:n}),i.jsx(C8,{scope:r,isInside:!0,children:i.jsx(Q5,{id:c.contentId,role:"tooltip",children:s||n})})]})})});Gk.displayName=$c;var Yk="TooltipArrow",P8=y.forwardRef((e,t)=>{const{__scopeTooltip:r,...n}=e,s=tp(r);return T8(Yk,r).isInside?null:i.jsx(Z0,{...s,...n,ref:t})});P8.displayName=Yk;function D8(e,t){const r=Math.abs(t.top-e.y),n=Math.abs(t.bottom-e.y),s=Math.abs(t.right-e.x),a=Math.abs(t.left-e.x);switch(Math.min(r,n,s,a)){case a:return"left";case s:return"right";case r:return"top";case n:return"bottom";default:throw new Error("unreachable")}}function R8(e,t,r=5){const n=[];switch(t){case"top":n.push({x:e.x-r,y:e.y+r},{x:e.x+r,y:e.y+r});break;case"bottom":n.push({x:e.x-r,y:e.y-r},{x:e.x+r,y:e.y-r});break;case"left":n.push({x:e.x+r,y:e.y-r},{x:e.x+r,y:e.y+r});break;case"right":n.push({x:e.x-r,y:e.y-r},{x:e.x-r,y:e.y+r});break}return n}function M8(e){const{top:t,right:r,bottom:n,left:s}=e;return[{x:s,y:t},{x:r,y:t},{x:r,y:n},{x:s,y:n}]}function O8(e,t){const{x:r,y:n}=e;let s=!1;for(let a=0,o=t.length-1;a<t.length;o=a++){const l=t[a],c=t[o],u=l.x,d=l.y,f=c.x,p=c.y;d>n!=p>n&&r<(f-u)*(n-d)/(p-d)+u&&(s=!s)}return s}function F8(e){const t=e.slice();return t.sort((r,n)=>r.x<n.x?-1:r.x>n.x?1:r.y<n.y?-1:r.y>n.y?1:0),I8(t)}function I8(e){if(e.length<=1)return e.slice();const t=[];for(let n=0;n<e.length;n++){const s=e[n];for(;t.length>=2;){const a=t[t.length-1],o=t[t.length-2];if((a.x-o.x)*(s.y-o.y)>=(a.y-o.y)*(s.x-o.x))t.pop();else break}t.push(s)}t.pop();const r=[];for(let n=e.length-1;n>=0;n--){const s=e[n];for(;r.length>=2;){const a=r[r.length-1],o=r[r.length-2];if((a.x-o.x)*(s.y-o.y)>=(a.y-o.y)*(s.x-o.x))r.pop();else break}r.push(s)}return r.pop(),t.length===1&&r.length===1&&t[0].x===r[0].x&&t[0].y===r[0].y?t:t.concat(r)}var L8=Vk,$8=Wk,B8=Hk,Kk=Gk;const nu=L8,jf=$8,Ef=B8,su=y.forwardRef(({className:e,sideOffset:t=4,...r},n)=>i.jsx(Kk,{ref:n,sideOffset:t,className:De("z-50 overflow-hidden rounded-md border bg-popover px-3 py-1.5 text-sm text-popover-foreground shadow-md animate-in fade-in-0 zoom-in-95 data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=closed]:zoom-out-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",e),...r}));su.displayName=Kk.displayName;var kf=class{constructor(){this.listeners=new Set,this.subscribe=this.subscribe.bind(this)}subscribe(e){return this.listeners.add(e),this.onSubscribe(),()=>{this.listeners.delete(e),this.onUnsubscribe()}}hasListeners(){return this.listeners.size>0}onSubscribe(){}onUnsubscribe(){}},np=typeof window>"u"||"Deno"in globalThis;function vs(){}function U8(e,t){return typeof e=="function"?e(t):e}function z8(e){return typeof e=="number"&&e>=0&&e!==1/0}function V8(e,t){return Math.max(e+(t||0)-Date.now(),0)}function Dv(e,t){return typeof e=="function"?e(t):e}function W8(e,t){return typeof e=="function"?e(t):e}function qb(e,t){const{type:r="all",exact:n,fetchStatus:s,predicate:a,queryKey:o,stale:l}=e;if(o){if(n){if(t.queryHash!==T1(o,t.options))return!1}else if(!zd(t.queryKey,o))return!1}if(r!=="all"){const c=t.isActive();if(r==="active"&&!c||r==="inactive"&&c)return!1}return!(typeof l=="boolean"&&t.isStale()!==l||s&&s!==t.state.fetchStatus||a&&!a(t))}function Yb(e,t){const{exact:r,status:n,predicate:s,mutationKey:a}=e;if(a){if(!t.options.mutationKey)return!1;if(r){if(il(t.options.mutationKey)!==il(a))return!1}else if(!zd(t.options.mutationKey,a))return!1}return!(n&&t.state.status!==n||s&&!s(t))}function T1(e,t){return((t==null?void 0:t.queryKeyHashFn)||il)(e)}function il(e){return JSON.stringify(e,(t,r)=>Rv(r)?Object.keys(r).sort().reduce((n,s)=>(n[s]=r[s],n),{}):r)}function zd(e,t){return e===t?!0:typeof e!=typeof t?!1:e&&t&&typeof e=="object"&&typeof t=="object"?Object.keys(t).every(r=>zd(e[r],t[r])):!1}function Xk(e,t){if(e===t)return e;const r=Kb(e)&&Kb(t);if(r||Rv(e)&&Rv(t)){const n=r?e:Object.keys(e),s=n.length,a=r?t:Object.keys(t),o=a.length,l=r?[]:{},c=new Set(n);let u=0;for(let d=0;d<o;d++){const f=r?d:a[d];(!r&&c.has(f)||r)&&e[f]===void 0&&t[f]===void 0?(l[f]=void 0,u++):(l[f]=Xk(e[f],t[f]),l[f]===e[f]&&e[f]!==void 0&&u++)}return s===o&&u===s?e:l}return t}function H8(e,t){if(!t||Object.keys(e).length!==Object.keys(t).length)return!1;for(const r in e)if(e[r]!==t[r])return!1;return!0}function Kb(e){return Array.isArray(e)&&e.length===Object.keys(e).length}function Rv(e){if(!Xb(e))return!1;const t=e.constructor;if(t===void 0)return!0;const r=t.prototype;return!(!Xb(r)||!r.hasOwnProperty("isPrototypeOf")||Object.getPrototypeOf(e)!==Object.prototype)}function Xb(e){return Object.prototype.toString.call(e)==="[object Object]"}function G8(e){return new Promise(t=>{setTimeout(t,e)})}function q8(e,t,r){return typeof r.structuralSharing=="function"?r.structuralSharing(e,t):r.structuralSharing!==!1?Xk(e,t):t}function Y8(e,t,r=0){const n=[...e,t];return r&&n.length>r?n.slice(1):n}function K8(e,t,r=0){const n=[t,...e];return r&&n.length>r?n.slice(0,-1):n}var A1=Symbol();function Qk(e,t){return!e.queryFn&&(t!=null&&t.initialPromise)?()=>t.initialPromise:!e.queryFn||e.queryFn===A1?()=>Promise.reject(new Error(`Missing queryFn: '${e.queryHash}'`)):e.queryFn}function X8(e,t){return typeof e=="function"?e(...t):!!e}var zo,Oi,bc,cN,Q8=(cN=class extends kf{constructor(){super();yt(this,zo);yt(this,Oi);yt(this,bc);rt(this,bc,t=>{if(!np&&window.addEventListener){const r=()=>t();return window.addEventListener("visibilitychange",r,!1),()=>{window.removeEventListener("visibilitychange",r)}}})}onSubscribe(){be(this,Oi)||this.setEventListener(be(this,bc))}onUnsubscribe(){var t;this.hasListeners()||((t=be(this,Oi))==null||t.call(this),rt(this,Oi,void 0))}setEventListener(t){var r;rt(this,bc,t),(r=be(this,Oi))==null||r.call(this),rt(this,Oi,t(n=>{typeof n=="boolean"?this.setFocused(n):this.onFocus()}))}setFocused(t){be(this,zo)!==t&&(rt(this,zo,t),this.onFocus())}onFocus(){const t=this.isFocused();this.listeners.forEach(r=>{r(t)})}isFocused(){var t;return typeof be(this,zo)=="boolean"?be(this,zo):((t=globalThis.document)==null?void 0:t.visibilityState)!=="hidden"}},zo=new WeakMap,Oi=new WeakMap,bc=new WeakMap,cN),Jk=new Q8,Sc,Fi,Nc,uN,J8=(uN=class extends kf{constructor(){super();yt(this,Sc,!0);yt(this,Fi);yt(this,Nc);rt(this,Nc,t=>{if(!np&&window.addEventListener){const r=()=>t(!0),n=()=>t(!1);return window.addEventListener("online",r,!1),window.addEventListener("offline",n,!1),()=>{window.removeEventListener("online",r),window.removeEventListener("offline",n)}}})}onSubscribe(){be(this,Fi)||this.setEventListener(be(this,Nc))}onUnsubscribe(){var t;this.hasListeners()||((t=be(this,Fi))==null||t.call(this),rt(this,Fi,void 0))}setEventListener(t){var r;rt(this,Nc,t),(r=be(this,Fi))==null||r.call(this),rt(this,Fi,t(this.setOnline.bind(this)))}setOnline(t){be(this,Sc)!==t&&(rt(this,Sc,t),this.listeners.forEach(n=>{n(t)}))}isOnline(){return be(this,Sc)}},Sc=new WeakMap,Fi=new WeakMap,Nc=new WeakMap,uN),Hm=new J8;function Z8(){let e,t;const r=new Promise((s,a)=>{e=s,t=a});r.status="pending",r.catch(()=>{});function n(s){Object.assign(r,s),delete r.resolve,delete r.reject}return r.resolve=s=>{n({status:"fulfilled",value:s}),e(s)},r.reject=s=>{n({status:"rejected",reason:s}),t(s)},r}function eL(e){return Math.min(1e3*2**e,3e4)}function Zk(e){return(e??"online")==="online"?Hm.isOnline():!0}var eC=class extends Error{constructor(e){super("CancelledError"),this.revert=e==null?void 0:e.revert,this.silent=e==null?void 0:e.silent}};function Fg(e){return e instanceof eC}function tC(e){let t=!1,r=0,n=!1,s;const a=Z8(),o=m=>{var x;n||(p(new eC(m)),(x=e.abort)==null||x.call(e))},l=()=>{t=!0},c=()=>{t=!1},u=()=>Jk.isFocused()&&(e.networkMode==="always"||Hm.isOnline())&&e.canRun(),d=()=>Zk(e.networkMode)&&e.canRun(),f=m=>{var x;n||(n=!0,(x=e.onSuccess)==null||x.call(e,m),s==null||s(),a.resolve(m))},p=m=>{var x;n||(n=!0,(x=e.onError)==null||x.call(e,m),s==null||s(),a.reject(m))},h=()=>new Promise(m=>{var x;s=w=>{(n||u())&&m(w)},(x=e.onPause)==null||x.call(e)}).then(()=>{var m;s=void 0,n||(m=e.onContinue)==null||m.call(e)}),g=()=>{if(n)return;let m;const x=r===0?e.initialPromise:void 0;try{m=x??e.fn()}catch(w){m=Promise.reject(w)}Promise.resolve(m).then(f).catch(w=>{var T;if(n)return;const v=e.retry??(np?0:3),_=e.retryDelay??eL,b=typeof _=="function"?_(r,w):_,S=v===!0||typeof v=="number"&&r<v||typeof v=="function"&&v(r,w);if(t||!S){p(w);return}r++,(T=e.onFail)==null||T.call(e,r,w),G8(b).then(()=>u()?void 0:h()).then(()=>{t?p(w):g()})})};return{promise:a,cancel:o,continue:()=>(s==null||s(),a),cancelRetry:l,continueRetry:c,canStart:d,start:()=>(d()?g():h().then(g),a)}}var tL=e=>setTimeout(e,0);function rL(){let e=[],t=0,r=l=>{l()},n=l=>{l()},s=tL;const a=l=>{t?e.push(l):s(()=>{r(l)})},o=()=>{const l=e;e=[],l.length&&s(()=>{n(()=>{l.forEach(c=>{r(c)})})})};return{batch:l=>{let c;t++;try{c=l()}finally{t--,t||o()}return c},batchCalls:l=>(...c)=>{a(()=>{l(...c)})},schedule:a,setNotifyFunction:l=>{r=l},setBatchNotifyFunction:l=>{n=l},setScheduler:l=>{s=l}}}var Qr=rL(),Vo,dN,rC=(dN=class{constructor(){yt(this,Vo)}destroy(){this.clearGcTimeout()}scheduleGc(){this.clearGcTimeout(),z8(this.gcTime)&&rt(this,Vo,setTimeout(()=>{this.optionalRemove()},this.gcTime))}updateGcTime(e){this.gcTime=Math.max(this.gcTime||0,e??(np?1/0:5*60*1e3))}clearGcTimeout(){be(this,Vo)&&(clearTimeout(be(this,Vo)),rt(this,Vo,void 0))}},Vo=new WeakMap,dN),jc,Wo,xs,Ho,fn,uf,Go,Us,Ua,fN,nL=(fN=class extends rC{constructor(t){super();yt(this,Us);yt(this,jc);yt(this,Wo);yt(this,xs);yt(this,Ho);yt(this,fn);yt(this,uf);yt(this,Go);rt(this,Go,!1),rt(this,uf,t.defaultOptions),this.setOptions(t.options),this.observers=[],rt(this,Ho,t.client),rt(this,xs,be(this,Ho).getQueryCache()),this.queryKey=t.queryKey,this.queryHash=t.queryHash,rt(this,jc,aL(this.options)),this.state=t.state??be(this,jc),this.scheduleGc()}get meta(){return this.options.meta}get promise(){var t;return(t=be(this,fn))==null?void 0:t.promise}setOptions(t){this.options={...be(this,uf),...t},this.updateGcTime(this.options.gcTime)}optionalRemove(){!this.observers.length&&this.state.fetchStatus==="idle"&&be(this,xs).remove(this)}setData(t,r){const n=q8(this.state.data,t,this.options);return xr(this,Us,Ua).call(this,{data:n,type:"success",dataUpdatedAt:r==null?void 0:r.updatedAt,manual:r==null?void 0:r.manual}),n}setState(t,r){xr(this,Us,Ua).call(this,{type:"setState",state:t,setStateOptions:r})}cancel(t){var n,s;const r=(n=be(this,fn))==null?void 0:n.promise;return(s=be(this,fn))==null||s.cancel(t),r?r.then(vs).catch(vs):Promise.resolve()}destroy(){super.destroy(),this.cancel({silent:!0})}reset(){this.destroy(),this.setState(be(this,jc))}isActive(){return this.observers.some(t=>W8(t.options.enabled,this)!==!1)}isDisabled(){return this.getObserversCount()>0?!this.isActive():this.options.queryFn===A1||this.state.dataUpdateCount+this.state.errorUpdateCount===0}isStatic(){return this.getObserversCount()>0?this.observers.some(t=>Dv(t.options.staleTime,this)==="static"):!1}isStale(){return this.getObserversCount()>0?this.observers.some(t=>t.getCurrentResult().isStale):this.state.data===void 0||this.state.isInvalidated}isStaleByTime(t=0){return this.state.data===void 0?!0:t==="static"?!1:this.state.isInvalidated?!0:!V8(this.state.dataUpdatedAt,t)}onFocus(){var r;const t=this.observers.find(n=>n.shouldFetchOnWindowFocus());t==null||t.refetch({cancelRefetch:!1}),(r=be(this,fn))==null||r.continue()}onOnline(){var r;const t=this.observers.find(n=>n.shouldFetchOnReconnect());t==null||t.refetch({cancelRefetch:!1}),(r=be(this,fn))==null||r.continue()}addObserver(t){this.observers.includes(t)||(this.observers.push(t),this.clearGcTimeout(),be(this,xs).notify({type:"observerAdded",query:this,observer:t}))}removeObserver(t){this.observers.includes(t)&&(this.observers=this.observers.filter(r=>r!==t),this.observers.length||(be(this,fn)&&(be(this,Go)?be(this,fn).cancel({revert:!0}):be(this,fn).cancelRetry()),this.scheduleGc()),be(this,xs).notify({type:"observerRemoved",query:this,observer:t}))}getObserversCount(){return this.observers.length}invalidate(){this.state.isInvalidated||xr(this,Us,Ua).call(this,{type:"invalidate"})}fetch(t,r){var u,d,f;if(this.state.fetchStatus!=="idle"){if(this.state.data!==void 0&&(r!=null&&r.cancelRefetch))this.cancel({silent:!0});else if(be(this,fn))return be(this,fn).continueRetry(),be(this,fn).promise}if(t&&this.setOptions(t),!this.options.queryFn){const p=this.observers.find(h=>h.options.queryFn);p&&this.setOptions(p.options)}const n=new AbortController,s=p=>{Object.defineProperty(p,"signal",{enumerable:!0,get:()=>(rt(this,Go,!0),n.signal)})},a=()=>{const p=Qk(this.options,r),g=(()=>{const m={client:be(this,Ho),queryKey:this.queryKey,meta:this.meta};return s(m),m})();return rt(this,Go,!1),this.options.persister?this.options.persister(p,g,this):p(g)},l=(()=>{const p={fetchOptions:r,options:this.options,queryKey:this.queryKey,client:be(this,Ho),state:this.state,fetchFn:a};return s(p),p})();(u=this.options.behavior)==null||u.onFetch(l,this),rt(this,Wo,this.state),(this.state.fetchStatus==="idle"||this.state.fetchMeta!==((d=l.fetchOptions)==null?void 0:d.meta))&&xr(this,Us,Ua).call(this,{type:"fetch",meta:(f=l.fetchOptions)==null?void 0:f.meta});const c=p=>{var h,g,m,x;Fg(p)&&p.silent||xr(this,Us,Ua).call(this,{type:"error",error:p}),Fg(p)||((g=(h=be(this,xs).config).onError)==null||g.call(h,p,this),(x=(m=be(this,xs).config).onSettled)==null||x.call(m,this.state.data,p,this)),this.scheduleGc()};return rt(this,fn,tC({initialPromise:r==null?void 0:r.initialPromise,fn:l.fetchFn,abort:n.abort.bind(n),onSuccess:p=>{var h,g,m,x;if(p===void 0){c(new Error(`${this.queryHash} data is undefined`));return}try{this.setData(p)}catch(w){c(w);return}(g=(h=be(this,xs).config).onSuccess)==null||g.call(h,p,this),(x=(m=be(this,xs).config).onSettled)==null||x.call(m,p,this.state.error,this),this.scheduleGc()},onError:c,onFail:(p,h)=>{xr(this,Us,Ua).call(this,{type:"failed",failureCount:p,error:h})},onPause:()=>{xr(this,Us,Ua).call(this,{type:"pause"})},onContinue:()=>{xr(this,Us,Ua).call(this,{type:"continue"})},retry:l.options.retry,retryDelay:l.options.retryDelay,networkMode:l.options.networkMode,canRun:()=>!0})),be(this,fn).start()}},jc=new WeakMap,Wo=new WeakMap,xs=new WeakMap,Ho=new WeakMap,fn=new WeakMap,uf=new WeakMap,Go=new WeakMap,Us=new WeakSet,Ua=function(t){const r=n=>{switch(t.type){case"failed":return{...n,fetchFailureCount:t.failureCount,fetchFailureReason:t.error};case"pause":return{...n,fetchStatus:"paused"};case"continue":return{...n,fetchStatus:"fetching"};case"fetch":return{...n,...sL(n.data,this.options),fetchMeta:t.meta??null};case"success":return rt(this,Wo,void 0),{...n,data:t.data,dataUpdateCount:n.dataUpdateCount+1,dataUpdatedAt:t.dataUpdatedAt??Date.now(),error:null,isInvalidated:!1,status:"success",...!t.manual&&{fetchStatus:"idle",fetchFailureCount:0,fetchFailureReason:null}};case"error":const s=t.error;return Fg(s)&&s.revert&&be(this,Wo)?{...be(this,Wo),fetchStatus:"idle"}:{...n,error:s,errorUpdateCount:n.errorUpdateCount+1,errorUpdatedAt:Date.now(),fetchFailureCount:n.fetchFailureCount+1,fetchFailureReason:s,fetchStatus:"idle",status:"error"};case"invalidate":return{...n,isInvalidated:!0};case"setState":return{...n,...t.state}}};this.state=r(this.state),Qr.batch(()=>{this.observers.forEach(n=>{n.onQueryUpdate()}),be(this,xs).notify({query:this,type:"updated",action:t})})},fN);function sL(e,t){return{fetchFailureCount:0,fetchFailureReason:null,fetchStatus:Zk(t.networkMode)?"fetching":"paused",...e===void 0&&{error:null,status:"pending"}}}function aL(e){const t=typeof e.initialData=="function"?e.initialData():e.initialData,r=t!==void 0,n=r?typeof e.initialDataUpdatedAt=="function"?e.initialDataUpdatedAt():e.initialDataUpdatedAt:0;return{data:t,dataUpdateCount:0,dataUpdatedAt:r?n??Date.now():0,error:null,errorUpdateCount:0,errorUpdatedAt:0,fetchFailureCount:0,fetchFailureReason:null,fetchMeta:null,isInvalidated:!1,status:r?"success":"pending",fetchStatus:"idle"}}var wa,hN,iL=(hN=class extends kf{constructor(t={}){super();yt(this,wa);this.config=t,rt(this,wa,new Map)}build(t,r,n){const s=r.queryKey,a=r.queryHash??T1(s,r);let o=this.get(a);return o||(o=new nL({client:t,queryKey:s,queryHash:a,options:t.defaultQueryOptions(r),state:n,defaultOptions:t.getQueryDefaults(s)}),this.add(o)),o}add(t){be(this,wa).has(t.queryHash)||(be(this,wa).set(t.queryHash,t),this.notify({type:"added",query:t}))}remove(t){const r=be(this,wa).get(t.queryHash);r&&(t.destroy(),r===t&&be(this,wa).delete(t.queryHash),this.notify({type:"removed",query:t}))}clear(){Qr.batch(()=>{this.getAll().forEach(t=>{this.remove(t)})})}get(t){return be(this,wa).get(t)}getAll(){return[...be(this,wa).values()]}find(t){const r={exact:!0,...t};return this.getAll().find(n=>qb(r,n))}findAll(t={}){const r=this.getAll();return Object.keys(t).length>0?r.filter(n=>qb(t,n)):r}notify(t){Qr.batch(()=>{this.listeners.forEach(r=>{r(t)})})}onFocus(){Qr.batch(()=>{this.getAll().forEach(t=>{t.onFocus()})})}onOnline(){Qr.batch(()=>{this.getAll().forEach(t=>{t.onOnline()})})}},wa=new WeakMap,hN),_a,_n,qo,ba,ji,mN,oL=(mN=class extends rC{constructor(t){super();yt(this,ba);yt(this,_a);yt(this,_n);yt(this,qo);this.mutationId=t.mutationId,rt(this,_n,t.mutationCache),rt(this,_a,[]),this.state=t.state||nC(),this.setOptions(t.options),this.scheduleGc()}setOptions(t){this.options=t,this.updateGcTime(this.options.gcTime)}get meta(){return this.options.meta}addObserver(t){be(this,_a).includes(t)||(be(this,_a).push(t),this.clearGcTimeout(),be(this,_n).notify({type:"observerAdded",mutation:this,observer:t}))}removeObserver(t){rt(this,_a,be(this,_a).filter(r=>r!==t)),this.scheduleGc(),be(this,_n).notify({type:"observerRemoved",mutation:this,observer:t})}optionalRemove(){be(this,_a).length||(this.state.status==="pending"?this.scheduleGc():be(this,_n).remove(this))}continue(){var t;return((t=be(this,qo))==null?void 0:t.continue())??this.execute(this.state.variables)}async execute(t){var a,o,l,c,u,d,f,p,h,g,m,x,w,v,_,b,S,T,N,C;const r=()=>{xr(this,ba,ji).call(this,{type:"continue"})};rt(this,qo,tC({fn:()=>this.options.mutationFn?this.options.mutationFn(t):Promise.reject(new Error("No mutationFn found")),onFail:(E,P)=>{xr(this,ba,ji).call(this,{type:"failed",failureCount:E,error:P})},onPause:()=>{xr(this,ba,ji).call(this,{type:"pause"})},onContinue:r,retry:this.options.retry??0,retryDelay:this.options.retryDelay,networkMode:this.options.networkMode,canRun:()=>be(this,_n).canRun(this)}));const n=this.state.status==="pending",s=!be(this,qo).canStart();try{if(n)r();else{xr(this,ba,ji).call(this,{type:"pending",variables:t,isPaused:s}),await((o=(a=be(this,_n).config).onMutate)==null?void 0:o.call(a,t,this));const P=await((c=(l=this.options).onMutate)==null?void 0:c.call(l,t));P!==this.state.context&&xr(this,ba,ji).call(this,{type:"pending",context:P,variables:t,isPaused:s})}const E=await be(this,qo).start();return await((d=(u=be(this,_n).config).onSuccess)==null?void 0:d.call(u,E,t,this.state.context,this)),await((p=(f=this.options).onSuccess)==null?void 0:p.call(f,E,t,this.state.context)),await((g=(h=be(this,_n).config).onSettled)==null?void 0:g.call(h,E,null,this.state.variables,this.state.context,this)),await((x=(m=this.options).onSettled)==null?void 0:x.call(m,E,null,t,this.state.context)),xr(this,ba,ji).call(this,{type:"success",data:E}),E}catch(E){try{throw await((v=(w=be(this,_n).config).onError)==null?void 0:v.call(w,E,t,this.state.context,this)),await((b=(_=this.options).onError)==null?void 0:b.call(_,E,t,this.state.context)),await((T=(S=be(this,_n).config).onSettled)==null?void 0:T.call(S,void 0,E,this.state.variables,this.state.context,this)),await((C=(N=this.options).onSettled)==null?void 0:C.call(N,void 0,E,t,this.state.context)),E}finally{xr(this,ba,ji).call(this,{type:"error",error:E})}}finally{be(this,_n).runNext(this)}}},_a=new WeakMap,_n=new WeakMap,qo=new WeakMap,ba=new WeakSet,ji=function(t){const r=n=>{switch(t.type){case"failed":return{...n,failureCount:t.failureCount,failureReason:t.error};case"pause":return{...n,isPaused:!0};case"continue":return{...n,isPaused:!1};case"pending":return{...n,context:t.context,data:void 0,failureCount:0,failureReason:null,error:null,isPaused:t.isPaused,status:"pending",variables:t.variables,submittedAt:Date.now()};case"success":return{...n,data:t.data,failureCount:0,failureReason:null,error:null,status:"success",isPaused:!1};case"error":return{...n,data:void 0,error:t.error,failureCount:n.failureCount+1,failureReason:t.error,isPaused:!1,status:"error"}}};this.state=r(this.state),Qr.batch(()=>{be(this,_a).forEach(n=>{n.onMutationUpdate(t)}),be(this,_n).notify({mutation:this,type:"updated",action:t})})},mN);function nC(){return{context:void 0,data:void 0,error:null,failureCount:0,failureReason:null,isPaused:!1,status:"idle",variables:void 0,submittedAt:0}}var qa,zs,df,pN,lL=(pN=class extends kf{constructor(t={}){super();yt(this,qa);yt(this,zs);yt(this,df);this.config=t,rt(this,qa,new Set),rt(this,zs,new Map),rt(this,df,0)}build(t,r,n){const s=new oL({mutationCache:this,mutationId:++eh(this,df)._,options:t.defaultMutationOptions(r),state:n});return this.add(s),s}add(t){be(this,qa).add(t);const r=bh(t);if(typeof r=="string"){const n=be(this,zs).get(r);n?n.push(t):be(this,zs).set(r,[t])}this.notify({type:"added",mutation:t})}remove(t){if(be(this,qa).delete(t)){const r=bh(t);if(typeof r=="string"){const n=be(this,zs).get(r);if(n)if(n.length>1){const s=n.indexOf(t);s!==-1&&n.splice(s,1)}else n[0]===t&&be(this,zs).delete(r)}}this.notify({type:"removed",mutation:t})}canRun(t){const r=bh(t);if(typeof r=="string"){const n=be(this,zs).get(r),s=n==null?void 0:n.find(a=>a.state.status==="pending");return!s||s===t}else return!0}runNext(t){var n;const r=bh(t);if(typeof r=="string"){const s=(n=be(this,zs).get(r))==null?void 0:n.find(a=>a!==t&&a.state.isPaused);return(s==null?void 0:s.continue())??Promise.resolve()}else return Promise.resolve()}clear(){Qr.batch(()=>{be(this,qa).forEach(t=>{this.notify({type:"removed",mutation:t})}),be(this,qa).clear(),be(this,zs).clear()})}getAll(){return Array.from(be(this,qa))}find(t){const r={exact:!0,...t};return this.getAll().find(n=>Yb(r,n))}findAll(t={}){return this.getAll().filter(r=>Yb(t,r))}notify(t){Qr.batch(()=>{this.listeners.forEach(r=>{r(t)})})}resumePausedMutations(){const t=this.getAll().filter(r=>r.state.isPaused);return Qr.batch(()=>Promise.all(t.map(r=>r.continue().catch(vs))))}},qa=new WeakMap,zs=new WeakMap,df=new WeakMap,pN);function bh(e){var t;return(t=e.options.scope)==null?void 0:t.id}function Qb(e){return{onFetch:(t,r)=>{var d,f,p,h,g;const n=t.options,s=(p=(f=(d=t.fetchOptions)==null?void 0:d.meta)==null?void 0:f.fetchMore)==null?void 0:p.direction,a=((h=t.state.data)==null?void 0:h.pages)||[],o=((g=t.state.data)==null?void 0:g.pageParams)||[];let l={pages:[],pageParams:[]},c=0;const u=async()=>{let m=!1;const x=_=>{Object.defineProperty(_,"signal",{enumerable:!0,get:()=>(t.signal.aborted?m=!0:t.signal.addEventListener("abort",()=>{m=!0}),t.signal)})},w=Qk(t.options,t.fetchOptions),v=async(_,b,S)=>{if(m)return Promise.reject();if(b==null&&_.pages.length)return Promise.resolve(_);const N=(()=>{const R={client:t.client,queryKey:t.queryKey,pageParam:b,direction:S?"backward":"forward",meta:t.options.meta};return x(R),R})(),C=await w(N),{maxPages:E}=t.options,P=S?K8:Y8;return{pages:P(_.pages,C,E),pageParams:P(_.pageParams,b,E)}};if(s&&a.length){const _=s==="backward",b=_?cL:Jb,S={pages:a,pageParams:o},T=b(n,S);l=await v(S,T,_)}else{const _=e??a.length;do{const b=c===0?o[0]??n.initialPageParam:Jb(n,l);if(c>0&&b==null)break;l=await v(l,b),c++}while(c<_)}return l};t.options.persister?t.fetchFn=()=>{var m,x;return(x=(m=t.options).persister)==null?void 0:x.call(m,u,{client:t.client,queryKey:t.queryKey,meta:t.options.meta,signal:t.signal},r)}:t.fetchFn=u}}}function Jb(e,{pages:t,pageParams:r}){const n=t.length-1;return t.length>0?e.getNextPageParam(t[n],t,r[n],r):void 0}function cL(e,{pages:t,pageParams:r}){var n;return t.length>0?(n=e.getPreviousPageParam)==null?void 0:n.call(e,t[0],t,r[0],r):void 0}var lr,Ii,Li,Ec,kc,$i,Cc,Tc,gN,uL=(gN=class{constructor(e={}){yt(this,lr);yt(this,Ii);yt(this,Li);yt(this,Ec);yt(this,kc);yt(this,$i);yt(this,Cc);yt(this,Tc);rt(this,lr,e.queryCache||new iL),rt(this,Ii,e.mutationCache||new lL),rt(this,Li,e.defaultOptions||{}),rt(this,Ec,new Map),rt(this,kc,new Map),rt(this,$i,0)}mount(){eh(this,$i)._++,be(this,$i)===1&&(rt(this,Cc,Jk.subscribe(async e=>{e&&(await this.resumePausedMutations(),be(this,lr).onFocus())})),rt(this,Tc,Hm.subscribe(async e=>{e&&(await this.resumePausedMutations(),be(this,lr).onOnline())})))}unmount(){var e,t;eh(this,$i)._--,be(this,$i)===0&&((e=be(this,Cc))==null||e.call(this),rt(this,Cc,void 0),(t=be(this,Tc))==null||t.call(this),rt(this,Tc,void 0))}isFetching(e){return be(this,lr).findAll({...e,fetchStatus:"fetching"}).length}isMutating(e){return be(this,Ii).findAll({...e,status:"pending"}).length}getQueryData(e){var r;const t=this.defaultQueryOptions({queryKey:e});return(r=be(this,lr).get(t.queryHash))==null?void 0:r.state.data}ensureQueryData(e){const t=this.defaultQueryOptions(e),r=be(this,lr).build(this,t),n=r.state.data;return n===void 0?this.fetchQuery(e):(e.revalidateIfStale&&r.isStaleByTime(Dv(t.staleTime,r))&&this.prefetchQuery(t),Promise.resolve(n))}getQueriesData(e){return be(this,lr).findAll(e).map(({queryKey:t,state:r})=>{const n=r.data;return[t,n]})}setQueryData(e,t,r){const n=this.defaultQueryOptions({queryKey:e}),s=be(this,lr).get(n.queryHash),a=s==null?void 0:s.state.data,o=U8(t,a);if(o!==void 0)return be(this,lr).build(this,n).setData(o,{...r,manual:!0})}setQueriesData(e,t,r){return Qr.batch(()=>be(this,lr).findAll(e).map(({queryKey:n})=>[n,this.setQueryData(n,t,r)]))}getQueryState(e){var r;const t=this.defaultQueryOptions({queryKey:e});return(r=be(this,lr).get(t.queryHash))==null?void 0:r.state}removeQueries(e){const t=be(this,lr);Qr.batch(()=>{t.findAll(e).forEach(r=>{t.remove(r)})})}resetQueries(e,t){const r=be(this,lr);return Qr.batch(()=>(r.findAll(e).forEach(n=>{n.reset()}),this.refetchQueries({type:"active",...e},t)))}cancelQueries(e,t={}){const r={revert:!0,...t},n=Qr.batch(()=>be(this,lr).findAll(e).map(s=>s.cancel(r)));return Promise.all(n).then(vs).catch(vs)}invalidateQueries(e,t={}){return Qr.batch(()=>(be(this,lr).findAll(e).forEach(r=>{r.invalidate()}),(e==null?void 0:e.refetchType)==="none"?Promise.resolve():this.refetchQueries({...e,type:(e==null?void 0:e.refetchType)??(e==null?void 0:e.type)??"active"},t)))}refetchQueries(e,t={}){const r={...t,cancelRefetch:t.cancelRefetch??!0},n=Qr.batch(()=>be(this,lr).findAll(e).filter(s=>!s.isDisabled()&&!s.isStatic()).map(s=>{let a=s.fetch(void 0,r);return r.throwOnError||(a=a.catch(vs)),s.state.fetchStatus==="paused"?Promise.resolve():a}));return Promise.all(n).then(vs)}fetchQuery(e){const t=this.defaultQueryOptions(e);t.retry===void 0&&(t.retry=!1);const r=be(this,lr).build(this,t);return r.isStaleByTime(Dv(t.staleTime,r))?r.fetch(t):Promise.resolve(r.state.data)}prefetchQuery(e){return this.fetchQuery(e).then(vs).catch(vs)}fetchInfiniteQuery(e){return e.behavior=Qb(e.pages),this.fetchQuery(e)}prefetchInfiniteQuery(e){return this.fetchInfiniteQuery(e).then(vs).catch(vs)}ensureInfiniteQueryData(e){return e.behavior=Qb(e.pages),this.ensureQueryData(e)}resumePausedMutations(){return Hm.isOnline()?be(this,Ii).resumePausedMutations():Promise.resolve()}getQueryCache(){return be(this,lr)}getMutationCache(){return be(this,Ii)}getDefaultOptions(){return be(this,Li)}setDefaultOptions(e){rt(this,Li,e)}setQueryDefaults(e,t){be(this,Ec).set(il(e),{queryKey:e,defaultOptions:t})}getQueryDefaults(e){const t=[...be(this,Ec).values()],r={};return t.forEach(n=>{zd(e,n.queryKey)&&Object.assign(r,n.defaultOptions)}),r}setMutationDefaults(e,t){be(this,kc).set(il(e),{mutationKey:e,defaultOptions:t})}getMutationDefaults(e){const t=[...be(this,kc).values()],r={};return t.forEach(n=>{zd(e,n.mutationKey)&&Object.assign(r,n.defaultOptions)}),r}defaultQueryOptions(e){if(e._defaulted)return e;const t={...be(this,Li).queries,...this.getQueryDefaults(e.queryKey),...e,_defaulted:!0};return t.queryHash||(t.queryHash=T1(t.queryKey,t)),t.refetchOnReconnect===void 0&&(t.refetchOnReconnect=t.networkMode!=="always"),t.throwOnError===void 0&&(t.throwOnError=!!t.suspense),!t.networkMode&&t.persister&&(t.networkMode="offlineFirst"),t.queryFn===A1&&(t.enabled=!1),t}defaultMutationOptions(e){return e!=null&&e._defaulted?e:{...be(this,Li).mutations,...(e==null?void 0:e.mutationKey)&&this.getMutationDefaults(e.mutationKey),...e,_defaulted:!0}}clear(){be(this,lr).clear(),be(this,Ii).clear()}},lr=new WeakMap,Ii=new WeakMap,Li=new WeakMap,Ec=new WeakMap,kc=new WeakMap,$i=new WeakMap,Cc=new WeakMap,Tc=new WeakMap,gN),Bi,Ui,Rn,Ya,ii,im,Mv,xN,dL=(xN=class extends kf{constructor(r,n){super();yt(this,ii);yt(this,Bi);yt(this,Ui);yt(this,Rn);yt(this,Ya);rt(this,Bi,r),this.setOptions(n),this.bindMethods(),xr(this,ii,im).call(this)}bindMethods(){this.mutate=this.mutate.bind(this),this.reset=this.reset.bind(this)}setOptions(r){var s;const n=this.options;this.options=be(this,Bi).defaultMutationOptions(r),H8(this.options,n)||be(this,Bi).getMutationCache().notify({type:"observerOptionsUpdated",mutation:be(this,Rn),observer:this}),n!=null&&n.mutationKey&&this.options.mutationKey&&il(n.mutationKey)!==il(this.options.mutationKey)?this.reset():((s=be(this,Rn))==null?void 0:s.state.status)==="pending"&&be(this,Rn).setOptions(this.options)}onUnsubscribe(){var r;this.hasListeners()||(r=be(this,Rn))==null||r.removeObserver(this)}onMutationUpdate(r){xr(this,ii,im).call(this),xr(this,ii,Mv).call(this,r)}getCurrentResult(){return be(this,Ui)}reset(){var r;(r=be(this,Rn))==null||r.removeObserver(this),rt(this,Rn,void 0),xr(this,ii,im).call(this),xr(this,ii,Mv).call(this)}mutate(r,n){var s;return rt(this,Ya,n),(s=be(this,Rn))==null||s.removeObserver(this),rt(this,Rn,be(this,Bi).getMutationCache().build(be(this,Bi),this.options)),be(this,Rn).addObserver(this),be(this,Rn).execute(r)}},Bi=new WeakMap,Ui=new WeakMap,Rn=new WeakMap,Ya=new WeakMap,ii=new WeakSet,im=function(){var n;const r=((n=be(this,Rn))==null?void 0:n.state)??nC();rt(this,Ui,{...r,isPending:r.status==="pending",isSuccess:r.status==="success",isError:r.status==="error",isIdle:r.status==="idle",mutate:this.mutate,reset:this.reset})},Mv=function(r){Qr.batch(()=>{var n,s,a,o,l,c,u,d;if(be(this,Ya)&&this.hasListeners()){const f=be(this,Ui).variables,p=be(this,Ui).context;(r==null?void 0:r.type)==="success"?((s=(n=be(this,Ya)).onSuccess)==null||s.call(n,r.data,f,p),(o=(a=be(this,Ya)).onSettled)==null||o.call(a,r.data,null,f,p)):(r==null?void 0:r.type)==="error"&&((c=(l=be(this,Ya)).onError)==null||c.call(l,r.error,f,p),(d=(u=be(this,Ya)).onSettled)==null||d.call(u,void 0,r.error,f,p))}this.listeners.forEach(f=>{f(be(this,Ui))})})},xN),sC=y.createContext(void 0),aC=e=>{const t=y.useContext(sC);if(!t)throw new Error("No QueryClient set, use QueryClientProvider to set one");return t},fL=({client:e,children:t})=>(y.useEffect(()=>(e.mount(),()=>{e.unmount()}),[e]),i.jsx(sC.Provider,{value:e,children:t}));function pa(e,t){const r=aC(),[n]=y.useState(()=>new dL(r,e));y.useEffect(()=>{n.setOptions(e)},[n,e]);const s=y.useSyncExternalStore(y.useCallback(o=>n.subscribe(Qr.batchCalls(o)),[n]),()=>n.getCurrentResult(),()=>n.getCurrentResult()),a=y.useCallback((o,l)=>{n.mutate(o,l).catch(vs)},[n]);if(s.error&&X8(n.options.throwOnError,[s.error]))throw s.error;return{...s,mutate:a,mutateAsync:s.mutate}}/**
 * @remix-run/router v1.23.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function Vd(){return Vd=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Vd.apply(this,arguments)}var Hi;(function(e){e.Pop="POP",e.Push="PUSH",e.Replace="REPLACE"})(Hi||(Hi={}));const Zb="popstate";function hL(e){e===void 0&&(e={});function t(n,s){let{pathname:a,search:o,hash:l}=n.location;return Ov("",{pathname:a,search:o,hash:l},s.state&&s.state.usr||null,s.state&&s.state.key||"default")}function r(n,s){return typeof s=="string"?s:oC(s)}return pL(t,r,null,e)}function kr(e,t){if(e===!1||e===null||typeof e>"u")throw new Error(t)}function iC(e,t){if(!e){typeof console<"u"&&console.warn(t);try{throw new Error(t)}catch{}}}function mL(){return Math.random().toString(36).substr(2,8)}function e2(e,t){return{usr:e.state,key:e.key,idx:t}}function Ov(e,t,r,n){return r===void 0&&(r=null),Vd({pathname:typeof e=="string"?e:e.pathname,search:"",hash:""},typeof t=="string"?au(t):t,{state:r,key:t&&t.key||n||mL()})}function oC(e){let{pathname:t="/",search:r="",hash:n=""}=e;return r&&r!=="?"&&(t+=r.charAt(0)==="?"?r:"?"+r),n&&n!=="#"&&(t+=n.charAt(0)==="#"?n:"#"+n),t}function au(e){let t={};if(e){let r=e.indexOf("#");r>=0&&(t.hash=e.substr(r),e=e.substr(0,r));let n=e.indexOf("?");n>=0&&(t.search=e.substr(n),e=e.substr(0,n)),e&&(t.pathname=e)}return t}function pL(e,t,r,n){n===void 0&&(n={});let{window:s=document.defaultView,v5Compat:a=!1}=n,o=s.history,l=Hi.Pop,c=null,u=d();u==null&&(u=0,o.replaceState(Vd({},o.state,{idx:u}),""));function d(){return(o.state||{idx:null}).idx}function f(){l=Hi.Pop;let x=d(),w=x==null?null:x-u;u=x,c&&c({action:l,location:m.location,delta:w})}function p(x,w){l=Hi.Push;let v=Ov(m.location,x,w);u=d()+1;let _=e2(v,u),b=m.createHref(v);try{o.pushState(_,"",b)}catch(S){if(S instanceof DOMException&&S.name==="DataCloneError")throw S;s.location.assign(b)}a&&c&&c({action:l,location:m.location,delta:1})}function h(x,w){l=Hi.Replace;let v=Ov(m.location,x,w);u=d();let _=e2(v,u),b=m.createHref(v);o.replaceState(_,"",b),a&&c&&c({action:l,location:m.location,delta:0})}function g(x){let w=s.location.origin!=="null"?s.location.origin:s.location.href,v=typeof x=="string"?x:oC(x);return v=v.replace(/ $/,"%20"),kr(w,"No window.location.(origin|href) available to create URL for href: "+v),new URL(v,w)}let m={get action(){return l},get location(){return e(s,o)},listen(x){if(c)throw new Error("A history only accepts one active listener");return s.addEventListener(Zb,f),c=x,()=>{s.removeEventListener(Zb,f),c=null}},createHref(x){return t(s,x)},createURL:g,encodeLocation(x){let w=g(x);return{pathname:w.pathname,search:w.search,hash:w.hash}},push:p,replace:h,go(x){return o.go(x)}};return m}var t2;(function(e){e.data="data",e.deferred="deferred",e.redirect="redirect",e.error="error"})(t2||(t2={}));function gL(e,t,r){return r===void 0&&(r="/"),xL(e,t,r)}function xL(e,t,r,n){let s=typeof t=="string"?au(t):t,a=uC(s.pathname||"/",r);if(a==null)return null;let o=lC(e);vL(o);let l=null;for(let c=0;l==null&&c<o.length;++c){let u=AL(a);l=kL(o[c],u)}return l}function lC(e,t,r,n){t===void 0&&(t=[]),r===void 0&&(r=[]),n===void 0&&(n="");let s=(a,o,l)=>{let c={relativePath:l===void 0?a.path||"":l,caseSensitive:a.caseSensitive===!0,childrenIndex:o,route:a};c.relativePath.startsWith("/")&&(kr(c.relativePath.startsWith(n),'Absolute route path "'+c.relativePath+'" nested under path '+('"'+n+'" is not valid. An absolute child route path ')+"must start with the combined path of all its parent routes."),c.relativePath=c.relativePath.slice(n.length));let u=Xo([n,c.relativePath]),d=r.concat(c);a.children&&a.children.length>0&&(kr(a.index!==!0,"Index routes must not have child routes. Please remove "+('all child routes from route path "'+u+'".')),lC(a.children,t,d,u)),!(a.path==null&&!a.index)&&t.push({path:u,score:jL(u,a.index),routesMeta:d})};return e.forEach((a,o)=>{var l;if(a.path===""||!((l=a.path)!=null&&l.includes("?")))s(a,o);else for(let c of cC(a.path))s(a,o,c)}),t}function cC(e){let t=e.split("/");if(t.length===0)return[];let[r,...n]=t,s=r.endsWith("?"),a=r.replace(/\?$/,"");if(n.length===0)return s?[a,""]:[a];let o=cC(n.join("/")),l=[];return l.push(...o.map(c=>c===""?a:[a,c].join("/"))),s&&l.push(...o),l.map(c=>e.startsWith("/")&&c===""?"/":c)}function vL(e){e.sort((t,r)=>t.score!==r.score?r.score-t.score:EL(t.routesMeta.map(n=>n.childrenIndex),r.routesMeta.map(n=>n.childrenIndex)))}const yL=/^:[\w-]+$/,wL=3,_L=2,bL=1,SL=10,NL=-2,r2=e=>e==="*";function jL(e,t){let r=e.split("/"),n=r.length;return r.some(r2)&&(n+=NL),t&&(n+=_L),r.filter(s=>!r2(s)).reduce((s,a)=>s+(yL.test(a)?wL:a===""?bL:SL),n)}function EL(e,t){return e.length===t.length&&e.slice(0,-1).every((n,s)=>n===t[s])?e[e.length-1]-t[t.length-1]:0}function kL(e,t,r){let{routesMeta:n}=e,s={},a="/",o=[];for(let l=0;l<n.length;++l){let c=n[l],u=l===n.length-1,d=a==="/"?t:t.slice(a.length)||"/",f=CL({path:c.relativePath,caseSensitive:c.caseSensitive,end:u},d),p=c.route;if(!f)return null;Object.assign(s,f.params),o.push({params:s,pathname:Xo([a,f.pathname]),pathnameBase:ML(Xo([a,f.pathnameBase])),route:p}),f.pathnameBase!=="/"&&(a=Xo([a,f.pathnameBase]))}return o}function CL(e,t){typeof e=="string"&&(e={path:e,caseSensitive:!1,end:!0});let[r,n]=TL(e.path,e.caseSensitive,e.end),s=t.match(r);if(!s)return null;let a=s[0],o=a.replace(/(.)\/+$/,"$1"),l=s.slice(1);return{params:n.reduce((u,d,f)=>{let{paramName:p,isOptional:h}=d;if(p==="*"){let m=l[f]||"";o=a.slice(0,a.length-m.length).replace(/(.)\/+$/,"$1")}const g=l[f];return h&&!g?u[p]=void 0:u[p]=(g||"").replace(/%2F/g,"/"),u},{}),pathname:a,pathnameBase:o,pattern:e}}function TL(e,t,r){t===void 0&&(t=!1),r===void 0&&(r=!0),iC(e==="*"||!e.endsWith("*")||e.endsWith("/*"),'Route path "'+e+'" will be treated as if it were '+('"'+e.replace(/\*$/,"/*")+'" because the `*` character must ')+"always follow a `/` in the pattern. To get rid of this warning, "+('please change the route path to "'+e.replace(/\*$/,"/*")+'".'));let n=[],s="^"+e.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(o,l,c)=>(n.push({paramName:l,isOptional:c!=null}),c?"/?([^\\/]+)?":"/([^\\/]+)"));return e.endsWith("*")?(n.push({paramName:"*"}),s+=e==="*"||e==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):r?s+="\\/*$":e!==""&&e!=="/"&&(s+="(?:(?=\\/|$))"),[new RegExp(s,t?void 0:"i"),n]}function AL(e){try{return e.split("/").map(t=>decodeURIComponent(t).replace(/\//g,"%2F")).join("/")}catch(t){return iC(!1,'The URL path "'+e+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent '+("encoding ("+t+").")),e}}function uC(e,t){if(t==="/")return e;if(!e.toLowerCase().startsWith(t.toLowerCase()))return null;let r=t.endsWith("/")?t.length-1:t.length,n=e.charAt(r);return n&&n!=="/"?null:e.slice(r)||"/"}function PL(e,t){t===void 0&&(t="/");let{pathname:r,search:n="",hash:s=""}=typeof e=="string"?au(e):e;return{pathname:r?r.startsWith("/")?r:DL(r,t):t,search:OL(n),hash:FL(s)}}function DL(e,t){let r=t.replace(/\/+$/,"").split("/");return e.split("/").forEach(s=>{s===".."?r.length>1&&r.pop():s!=="."&&r.push(s)}),r.length>1?r.join("/"):"/"}function Ig(e,t,r,n){return"Cannot include a '"+e+"' character in a manually specified "+("`to."+t+"` field ["+JSON.stringify(n)+"].  Please separate it out to the ")+("`to."+r+"` field. Alternatively you may provide the full path as ")+'a string in <Link to="..."> and the router will parse it for you.'}function RL(e){return e.filter((t,r)=>r===0||t.route.path&&t.route.path.length>0)}function dC(e,t){let r=RL(e);return t?r.map((n,s)=>s===r.length-1?n.pathname:n.pathnameBase):r.map(n=>n.pathnameBase)}function fC(e,t,r,n){n===void 0&&(n=!1);let s;typeof e=="string"?s=au(e):(s=Vd({},e),kr(!s.pathname||!s.pathname.includes("?"),Ig("?","pathname","search",s)),kr(!s.pathname||!s.pathname.includes("#"),Ig("#","pathname","hash",s)),kr(!s.search||!s.search.includes("#"),Ig("#","search","hash",s)));let a=e===""||s.pathname==="",o=a?"/":s.pathname,l;if(o==null)l=r;else{let f=t.length-1;if(!n&&o.startsWith("..")){let p=o.split("/");for(;p[0]==="..";)p.shift(),f-=1;s.pathname=p.join("/")}l=f>=0?t[f]:"/"}let c=PL(s,l),u=o&&o!=="/"&&o.endsWith("/"),d=(a||o===".")&&r.endsWith("/");return!c.pathname.endsWith("/")&&(u||d)&&(c.pathname+="/"),c}const Xo=e=>e.join("/").replace(/\/\/+/g,"/"),ML=e=>e.replace(/\/+$/,"").replace(/^\/*/,"/"),OL=e=>!e||e==="?"?"":e.startsWith("?")?e:"?"+e,FL=e=>!e||e==="#"?"":e.startsWith("#")?e:"#"+e;function IL(e){return e!=null&&typeof e.status=="number"&&typeof e.statusText=="string"&&typeof e.internal=="boolean"&&"data"in e}const hC=["post","put","patch","delete"];new Set(hC);const LL=["get",...hC];new Set(LL);/**
 * React Router v6.30.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function Wd(){return Wd=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Wd.apply(this,arguments)}const P1=y.createContext(null),$L=y.createContext(null),Cf=y.createContext(null),sp=y.createContext(null),wo=y.createContext({outlet:null,matches:[],isDataRoute:!1}),mC=y.createContext(null);function Tf(){return y.useContext(sp)!=null}function yl(){return Tf()||kr(!1),y.useContext(sp).location}function pC(e){y.useContext(Cf).static||y.useLayoutEffect(e)}function _o(){let{isDataRoute:e}=y.useContext(wo);return e?ZL():BL()}function BL(){Tf()||kr(!1);let e=y.useContext(P1),{basename:t,future:r,navigator:n}=y.useContext(Cf),{matches:s}=y.useContext(wo),{pathname:a}=yl(),o=JSON.stringify(dC(s,r.v7_relativeSplatPath)),l=y.useRef(!1);return pC(()=>{l.current=!0}),y.useCallback(function(u,d){if(d===void 0&&(d={}),!l.current)return;if(typeof u=="number"){n.go(u);return}let f=fC(u,JSON.parse(o),a,d.relative==="path");e==null&&t!=="/"&&(f.pathname=f.pathname==="/"?t:Xo([t,f.pathname])),(d.replace?n.replace:n.push)(f,d.state,d)},[t,n,o,a,e])}function UL(){let{matches:e}=y.useContext(wo),t=e[e.length-1];return t?t.params:{}}function zL(e,t){return VL(e,t)}function VL(e,t,r,n){Tf()||kr(!1);let{navigator:s}=y.useContext(Cf),{matches:a}=y.useContext(wo),o=a[a.length-1],l=o?o.params:{};o&&o.pathname;let c=o?o.pathnameBase:"/";o&&o.route;let u=yl(),d;if(t){var f;let x=typeof t=="string"?au(t):t;c==="/"||(f=x.pathname)!=null&&f.startsWith(c)||kr(!1),d=x}else d=u;let p=d.pathname||"/",h=p;if(c!=="/"){let x=c.replace(/^\//,"").split("/");h="/"+p.replace(/^\//,"").split("/").slice(x.length).join("/")}let g=gL(e,{pathname:h}),m=YL(g&&g.map(x=>Object.assign({},x,{params:Object.assign({},l,x.params),pathname:Xo([c,s.encodeLocation?s.encodeLocation(x.pathname).pathname:x.pathname]),pathnameBase:x.pathnameBase==="/"?c:Xo([c,s.encodeLocation?s.encodeLocation(x.pathnameBase).pathname:x.pathnameBase])})),a,r,n);return t&&m?y.createElement(sp.Provider,{value:{location:Wd({pathname:"/",search:"",hash:"",state:null,key:"default"},d),navigationType:Hi.Pop}},m):m}function WL(){let e=JL(),t=IL(e)?e.status+" "+e.statusText:e instanceof Error?e.message:JSON.stringify(e),r=e instanceof Error?e.stack:null,s={padding:"0.5rem",backgroundColor:"rgba(200,200,200, 0.5)"};return y.createElement(y.Fragment,null,y.createElement("h2",null,"Unexpected Application Error!"),y.createElement("h3",{style:{fontStyle:"italic"}},t),r?y.createElement("pre",{style:s},r):null,null)}const HL=y.createElement(WL,null);class GL extends y.Component{constructor(t){super(t),this.state={location:t.location,revalidation:t.revalidation,error:t.error}}static getDerivedStateFromError(t){return{error:t}}static getDerivedStateFromProps(t,r){return r.location!==t.location||r.revalidation!=="idle"&&t.revalidation==="idle"?{error:t.error,location:t.location,revalidation:t.revalidation}:{error:t.error!==void 0?t.error:r.error,location:r.location,revalidation:t.revalidation||r.revalidation}}componentDidCatch(t,r){console.error("React Router caught the following error during render",t,r)}render(){return this.state.error!==void 0?y.createElement(wo.Provider,{value:this.props.routeContext},y.createElement(mC.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}function qL(e){let{routeContext:t,match:r,children:n}=e,s=y.useContext(P1);return s&&s.static&&s.staticContext&&(r.route.errorElement||r.route.ErrorBoundary)&&(s.staticContext._deepestRenderedBoundaryId=r.route.id),y.createElement(wo.Provider,{value:t},n)}function YL(e,t,r,n){var s;if(t===void 0&&(t=[]),r===void 0&&(r=null),n===void 0&&(n=null),e==null){var a;if(!r)return null;if(r.errors)e=r.matches;else if((a=n)!=null&&a.v7_partialHydration&&t.length===0&&!r.initialized&&r.matches.length>0)e=r.matches;else return null}let o=e,l=(s=r)==null?void 0:s.errors;if(l!=null){let d=o.findIndex(f=>f.route.id&&(l==null?void 0:l[f.route.id])!==void 0);d>=0||kr(!1),o=o.slice(0,Math.min(o.length,d+1))}let c=!1,u=-1;if(r&&n&&n.v7_partialHydration)for(let d=0;d<o.length;d++){let f=o[d];if((f.route.HydrateFallback||f.route.hydrateFallbackElement)&&(u=d),f.route.id){let{loaderData:p,errors:h}=r,g=f.route.loader&&p[f.route.id]===void 0&&(!h||h[f.route.id]===void 0);if(f.route.lazy||g){c=!0,u>=0?o=o.slice(0,u+1):o=[o[0]];break}}}return o.reduceRight((d,f,p)=>{let h,g=!1,m=null,x=null;r&&(h=l&&f.route.id?l[f.route.id]:void 0,m=f.route.errorElement||HL,c&&(u<0&&p===0?(e$("route-fallback"),g=!0,x=null):u===p&&(g=!0,x=f.route.hydrateFallbackElement||null)));let w=t.concat(o.slice(0,p+1)),v=()=>{let _;return h?_=m:g?_=x:f.route.Component?_=y.createElement(f.route.Component,null):f.route.element?_=f.route.element:_=d,y.createElement(qL,{match:f,routeContext:{outlet:d,matches:w,isDataRoute:r!=null},children:_})};return r&&(f.route.ErrorBoundary||f.route.errorElement||p===0)?y.createElement(GL,{location:r.location,revalidation:r.revalidation,component:m,error:h,children:v(),routeContext:{outlet:null,matches:w,isDataRoute:!0}}):v()},null)}var gC=function(e){return e.UseBlocker="useBlocker",e.UseRevalidator="useRevalidator",e.UseNavigateStable="useNavigate",e}(gC||{}),xC=function(e){return e.UseBlocker="useBlocker",e.UseLoaderData="useLoaderData",e.UseActionData="useActionData",e.UseRouteError="useRouteError",e.UseNavigation="useNavigation",e.UseRouteLoaderData="useRouteLoaderData",e.UseMatches="useMatches",e.UseRevalidator="useRevalidator",e.UseNavigateStable="useNavigate",e.UseRouteId="useRouteId",e}(xC||{});function KL(e){let t=y.useContext(P1);return t||kr(!1),t}function XL(e){let t=y.useContext($L);return t||kr(!1),t}function QL(e){let t=y.useContext(wo);return t||kr(!1),t}function vC(e){let t=QL(),r=t.matches[t.matches.length-1];return r.route.id||kr(!1),r.route.id}function JL(){var e;let t=y.useContext(mC),r=XL(),n=vC();return t!==void 0?t:(e=r.errors)==null?void 0:e[n]}function ZL(){let{router:e}=KL(gC.UseNavigateStable),t=vC(xC.UseNavigateStable),r=y.useRef(!1);return pC(()=>{r.current=!0}),y.useCallback(function(s,a){a===void 0&&(a={}),r.current&&(typeof s=="number"?e.navigate(s):e.navigate(s,Wd({fromRouteId:t},a)))},[e,t])}const n2={};function e$(e,t,r){n2[e]||(n2[e]=!0)}function t$(e,t){e==null||e.v7_startTransition,e==null||e.v7_relativeSplatPath}function yC(e){let{to:t,replace:r,state:n,relative:s}=e;Tf()||kr(!1);let{future:a,static:o}=y.useContext(Cf),{matches:l}=y.useContext(wo),{pathname:c}=yl(),u=_o(),d=fC(t,dC(l,a.v7_relativeSplatPath),c,s==="path"),f=JSON.stringify(d);return y.useEffect(()=>u(JSON.parse(f),{replace:r,state:n,relative:s}),[u,f,s,r,n]),null}function Lr(e){kr(!1)}function r$(e){let{basename:t="/",children:r=null,location:n,navigationType:s=Hi.Pop,navigator:a,static:o=!1,future:l}=e;Tf()&&kr(!1);let c=t.replace(/^\/*/,"/"),u=y.useMemo(()=>({basename:c,navigator:a,static:o,future:Wd({v7_relativeSplatPath:!1},l)}),[c,l,a,o]);typeof n=="string"&&(n=au(n));let{pathname:d="/",search:f="",hash:p="",state:h=null,key:g="default"}=n,m=y.useMemo(()=>{let x=uC(d,c);return x==null?null:{location:{pathname:x,search:f,hash:p,state:h,key:g},navigationType:s}},[c,d,f,p,h,g,s]);return m==null?null:y.createElement(Cf.Provider,{value:u},y.createElement(sp.Provider,{children:r,value:m}))}function n$(e){let{children:t,location:r}=e;return zL(Fv(t),r)}new Promise(()=>{});function Fv(e,t){t===void 0&&(t=[]);let r=[];return y.Children.forEach(e,(n,s)=>{if(!y.isValidElement(n))return;let a=[...t,s];if(n.type===y.Fragment){r.push.apply(r,Fv(n.props.children,a));return}n.type!==Lr&&kr(!1),!n.props.index||!n.props.children||kr(!1);let o={id:n.props.id||a.join("-"),caseSensitive:n.props.caseSensitive,element:n.props.element,Component:n.props.Component,index:n.props.index,path:n.props.path,loader:n.props.loader,action:n.props.action,errorElement:n.props.errorElement,ErrorBoundary:n.props.ErrorBoundary,hasErrorBoundary:n.props.ErrorBoundary!=null||n.props.errorElement!=null,shouldRevalidate:n.props.shouldRevalidate,handle:n.props.handle,lazy:n.props.lazy};n.props.children&&(o.children=Fv(n.props.children,a)),r.push(o)}),r}/**
 * React Router DOM v6.30.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function Iv(e){return e===void 0&&(e=""),new URLSearchParams(typeof e=="string"||Array.isArray(e)||e instanceof URLSearchParams?e:Object.keys(e).reduce((t,r)=>{let n=e[r];return t.concat(Array.isArray(n)?n.map(s=>[r,s]):[[r,n]])},[]))}function s$(e,t){let r=Iv(e);return t&&t.forEach((n,s)=>{r.has(s)||t.getAll(s).forEach(a=>{r.append(s,a)})}),r}const a$="6";try{window.__reactRouterVersion=a$}catch{}const i$="startTransition",s2=xy[i$];function o$(e){let{basename:t,children:r,future:n,window:s}=e,a=y.useRef();a.current==null&&(a.current=hL({window:s,v5Compat:!0}));let o=a.current,[l,c]=y.useState({action:o.action,location:o.location}),{v7_startTransition:u}=n||{},d=y.useCallback(f=>{u&&s2?s2(()=>c(f)):c(f)},[c,u]);return y.useLayoutEffect(()=>o.listen(d),[o,d]),y.useEffect(()=>t$(n),[n]),y.createElement(r$,{basename:t,children:r,location:l.location,navigationType:l.action,navigator:o,future:n})}var a2;(function(e){e.UseScrollRestoration="useScrollRestoration",e.UseSubmit="useSubmit",e.UseSubmitFetcher="useSubmitFetcher",e.UseFetcher="useFetcher",e.useViewTransitionState="useViewTransitionState"})(a2||(a2={}));var i2;(function(e){e.UseFetcher="useFetcher",e.UseFetchers="useFetchers",e.UseScrollRestoration="useScrollRestoration"})(i2||(i2={}));function l$(e){let t=y.useRef(Iv(e)),r=y.useRef(!1),n=yl(),s=y.useMemo(()=>s$(n.search,r.current?null:t.current),[n.search]),a=_o(),o=y.useCallback((l,c)=>{const u=Iv(typeof l=="function"?l(s):l);r.current=!0,a("?"+u,c)},[a,s]);return[s,o]}const Hd=yf("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/90",outline:"border border-input bg-background hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-10 px-4 py-2",sm:"h-9 rounded-md px-3",lg:"h-11 rounded-md px-8",icon:"h-10 w-10"}},defaultVariants:{variant:"default",size:"default"}}),ue=y.forwardRef(({className:e,variant:t,size:r,asChild:n=!1,...s},a)=>{const o=n?RE:"button";return i.jsx(o,{className:De(Hd({variant:t,size:r,className:e})),ref:a,...s})});ue.displayName="Button";class c$ extends ke.Component{constructor(r){super(r);tg(this,"handleRefresh",()=>{window.location.reload()});tg(this,"handleGoHome",()=>{window.location.href="/"});this.state={hasError:!1}}static getDerivedStateFromError(r){return{hasError:!0,error:r}}componentDidCatch(r,n){}render(){return this.state.hasError?i.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center p-4",children:i.jsx("div",{className:"text-center max-w-md mx-auto",children:i.jsxs("div",{className:"bg-red-50 border border-red-200 rounded-lg p-6",children:[i.jsx("div",{className:"flex items-center justify-center mb-4",children:i.jsx(p1,{className:"h-8 w-8 text-red-600"})}),i.jsx("h2",{className:"text-lg font-semibold text-red-800 mb-2",children:"Something went wrong"}),i.jsx("p",{className:"text-red-600 mb-4",children:"We encountered an unexpected error. Please try refreshing the page or returning to the dashboard."}),!1,i.jsxs("div",{className:"flex flex-col sm:flex-row gap-2 justify-center",children:[i.jsxs(ue,{onClick:this.handleRefresh,className:"flex items-center gap-2",variant:"default",children:[i.jsx(os,{className:"h-4 w-4"}),"Refresh Page"]}),i.jsxs(ue,{onClick:this.handleGoHome,className:"flex items-center gap-2",variant:"outline",children:[i.jsx(wf,{className:"h-4 w-4"}),"Go to Dashboard"]})]})]})})}):this.props.children}}const wC=()=>i.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gray-50",role:"status","aria-label":"Loading",children:i.jsxs("div",{className:"text-center",children:[i.jsx("div",{className:"flex items-center justify-center mb-4",children:i.jsx(NF,{className:"h-8 w-8 animate-spin text-primary","aria-hidden":"true"})}),i.jsx("h2",{className:"text-lg font-semibold text-gray-900 mb-2",children:"Loading ISKCON Bureau Portal"}),i.jsx("p",{className:"text-gray-600 text-sm",children:"Please wait while we prepare your workspace..."}),i.jsx("div",{className:"mt-4 flex justify-center",children:i.jsxs("div",{className:"flex space-x-1",children:[i.jsx("div",{className:"w-2 h-2 bg-primary rounded-full animate-bounce",style:{animationDelay:"0ms"}}),i.jsx("div",{className:"w-2 h-2 bg-primary rounded-full animate-bounce",style:{animationDelay:"150ms"}}),i.jsx("div",{className:"w-2 h-2 bg-primary rounded-full animate-bounce",style:{animationDelay:"300ms"}})]})})]})}),u$="modulepreload",d$=function(e){return"/"+e},o2={},no=function(t,r,n){let s=Promise.resolve();if(r&&r.length>0){document.getElementsByTagName("link");const o=document.querySelector("meta[property=csp-nonce]"),l=(o==null?void 0:o.nonce)||(o==null?void 0:o.getAttribute("nonce"));s=Promise.allSettled(r.map(c=>{if(c=d$(c),c in o2)return;o2[c]=!0;const u=c.endsWith(".css"),d=u?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${c}"]${d}`))return;const f=document.createElement("link");if(f.rel=u?"stylesheet":u$,u||(f.as="script"),f.crossOrigin="",f.href=c,l&&f.setAttribute("nonce",l),document.head.appendChild(f),u)return new Promise((p,h)=>{f.addEventListener("load",p),f.addEventListener("error",()=>h(new Error(`Unable to preload CSS for ${c}`)))})}))}function a(o){const l=new Event("vite:preloadError",{cancelable:!0});if(l.payload=o,window.dispatchEvent(l),!l.defaultPrevented)throw o}return s.then(o=>{for(const l of o||[])l.status==="rejected"&&a(l.reason);return t().catch(a)})},f$=e=>{let t;return e?t=e:typeof fetch>"u"?t=(...r)=>no(async()=>{const{default:n}=await Promise.resolve().then(()=>iu);return{default:n}},void 0).then(({default:n})=>n(...r)):t=fetch,(...r)=>t(...r)};class D1 extends Error{constructor(t,r="FunctionsError",n){super(t),this.name=r,this.context=n}}class h$ extends D1{constructor(t){super("Failed to send a request to the Edge Function","FunctionsFetchError",t)}}class l2 extends D1{constructor(t){super("Relay Error invoking the Edge Function","FunctionsRelayError",t)}}class c2 extends D1{constructor(t){super("Edge Function returned a non-2xx status code","FunctionsHttpError",t)}}var Lv;(function(e){e.Any="any",e.ApNortheast1="ap-northeast-1",e.ApNortheast2="ap-northeast-2",e.ApSouth1="ap-south-1",e.ApSoutheast1="ap-southeast-1",e.ApSoutheast2="ap-southeast-2",e.CaCentral1="ca-central-1",e.EuCentral1="eu-central-1",e.EuWest1="eu-west-1",e.EuWest2="eu-west-2",e.EuWest3="eu-west-3",e.SaEast1="sa-east-1",e.UsEast1="us-east-1",e.UsWest1="us-west-1",e.UsWest2="us-west-2"})(Lv||(Lv={}));var m$=function(e,t,r,n){function s(a){return a instanceof r?a:new r(function(o){o(a)})}return new(r||(r=Promise))(function(a,o){function l(d){try{u(n.next(d))}catch(f){o(f)}}function c(d){try{u(n.throw(d))}catch(f){o(f)}}function u(d){d.done?a(d.value):s(d.value).then(l,c)}u((n=n.apply(e,t||[])).next())})};class p${constructor(t,{headers:r={},customFetch:n,region:s=Lv.Any}={}){this.url=t,this.headers=r,this.region=s,this.fetch=f$(n)}setAuth(t){this.headers.Authorization=`Bearer ${t}`}invoke(t,r={}){var n;return m$(this,void 0,void 0,function*(){try{const{headers:s,method:a,body:o}=r;let l={},{region:c}=r;c||(c=this.region);const u=new URL(`${this.url}/${t}`);c&&c!=="any"&&(l["x-region"]=c,u.searchParams.set("forceFunctionRegion",c));let d;o&&(s&&!Object.prototype.hasOwnProperty.call(s,"Content-Type")||!s)&&(typeof Blob<"u"&&o instanceof Blob||o instanceof ArrayBuffer?(l["Content-Type"]="application/octet-stream",d=o):typeof o=="string"?(l["Content-Type"]="text/plain",d=o):typeof FormData<"u"&&o instanceof FormData?d=o:(l["Content-Type"]="application/json",d=JSON.stringify(o)));const f=yield this.fetch(u.toString(),{method:a||"POST",headers:Object.assign(Object.assign(Object.assign({},l),this.headers),s),body:d}).catch(m=>{throw new h$(m)}),p=f.headers.get("x-relay-error");if(p&&p==="true")throw new l2(f);if(!f.ok)throw new c2(f);let h=((n=f.headers.get("Content-Type"))!==null&&n!==void 0?n:"text/plain").split(";")[0].trim(),g;return h==="application/json"?g=yield f.json():h==="application/octet-stream"?g=yield f.blob():h==="text/event-stream"?g=f:h==="multipart/form-data"?g=yield f.formData():g=yield f.text(),{data:g,error:null,response:f}}catch(s){return{data:null,error:s,response:s instanceof c2||s instanceof l2?s.context:void 0}}})}}var In={},R1={},ap={},Af={},ip={},op={},g$=function(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("unable to locate global object")},Bc=g$();const x$=Bc.fetch,_C=Bc.fetch.bind(Bc),bC=Bc.Headers,v$=Bc.Request,y$=Bc.Response,iu=Object.freeze(Object.defineProperty({__proto__:null,Headers:bC,Request:v$,Response:y$,default:_C,fetch:x$},Symbol.toStringTag,{value:"Module"})),w$=XR(iu);var lp={};Object.defineProperty(lp,"__esModule",{value:!0});let _$=class extends Error{constructor(t){super(t.message),this.name="PostgrestError",this.details=t.details,this.hint=t.hint,this.code=t.code}};lp.default=_$;var SC=pn&&pn.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(op,"__esModule",{value:!0});const b$=SC(w$),S$=SC(lp);let N$=class{constructor(t){this.shouldThrowOnError=!1,this.method=t.method,this.url=t.url,this.headers=t.headers,this.schema=t.schema,this.body=t.body,this.shouldThrowOnError=t.shouldThrowOnError,this.signal=t.signal,this.isMaybeSingle=t.isMaybeSingle,t.fetch?this.fetch=t.fetch:typeof fetch>"u"?this.fetch=b$.default:this.fetch=fetch}throwOnError(){return this.shouldThrowOnError=!0,this}setHeader(t,r){return this.headers=Object.assign({},this.headers),this.headers[t]=r,this}then(t,r){this.schema===void 0||(["GET","HEAD"].includes(this.method)?this.headers["Accept-Profile"]=this.schema:this.headers["Content-Profile"]=this.schema),this.method!=="GET"&&this.method!=="HEAD"&&(this.headers["Content-Type"]="application/json");const n=this.fetch;let s=n(this.url.toString(),{method:this.method,headers:this.headers,body:JSON.stringify(this.body),signal:this.signal}).then(async a=>{var o,l,c;let u=null,d=null,f=null,p=a.status,h=a.statusText;if(a.ok){if(this.method!=="HEAD"){const w=await a.text();w===""||(this.headers.Accept==="text/csv"||this.headers.Accept&&this.headers.Accept.includes("application/vnd.pgrst.plan+text")?d=w:d=JSON.parse(w))}const m=(o=this.headers.Prefer)===null||o===void 0?void 0:o.match(/count=(exact|planned|estimated)/),x=(l=a.headers.get("content-range"))===null||l===void 0?void 0:l.split("/");m&&x&&x.length>1&&(f=parseInt(x[1])),this.isMaybeSingle&&this.method==="GET"&&Array.isArray(d)&&(d.length>1?(u={code:"PGRST116",details:`Results contain ${d.length} rows, application/vnd.pgrst.object+json requires 1 row`,hint:null,message:"JSON object requested, multiple (or no) rows returned"},d=null,f=null,p=406,h="Not Acceptable"):d.length===1?d=d[0]:d=null)}else{const m=await a.text();try{u=JSON.parse(m),Array.isArray(u)&&a.status===404&&(d=[],u=null,p=200,h="OK")}catch{a.status===404&&m===""?(p=204,h="No Content"):u={message:m}}if(u&&this.isMaybeSingle&&(!((c=u==null?void 0:u.details)===null||c===void 0)&&c.includes("0 rows"))&&(u=null,p=200,h="OK"),u&&this.shouldThrowOnError)throw new S$.default(u)}return{error:u,data:d,count:f,status:p,statusText:h}});return this.shouldThrowOnError||(s=s.catch(a=>{var o,l,c;return{error:{message:`${(o=a==null?void 0:a.name)!==null&&o!==void 0?o:"FetchError"}: ${a==null?void 0:a.message}`,details:`${(l=a==null?void 0:a.stack)!==null&&l!==void 0?l:""}`,hint:"",code:`${(c=a==null?void 0:a.code)!==null&&c!==void 0?c:""}`},data:null,count:null,status:0,statusText:""}})),s.then(t,r)}returns(){return this}overrideTypes(){return this}};op.default=N$;var j$=pn&&pn.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(ip,"__esModule",{value:!0});const E$=j$(op);let k$=class extends E$.default{select(t){let r=!1;const n=(t??"*").split("").map(s=>/\s/.test(s)&&!r?"":(s==='"'&&(r=!r),s)).join("");return this.url.searchParams.set("select",n),this.headers.Prefer&&(this.headers.Prefer+=","),this.headers.Prefer+="return=representation",this}order(t,{ascending:r=!0,nullsFirst:n,foreignTable:s,referencedTable:a=s}={}){const o=a?`${a}.order`:"order",l=this.url.searchParams.get(o);return this.url.searchParams.set(o,`${l?`${l},`:""}${t}.${r?"asc":"desc"}${n===void 0?"":n?".nullsfirst":".nullslast"}`),this}limit(t,{foreignTable:r,referencedTable:n=r}={}){const s=typeof n>"u"?"limit":`${n}.limit`;return this.url.searchParams.set(s,`${t}`),this}range(t,r,{foreignTable:n,referencedTable:s=n}={}){const a=typeof s>"u"?"offset":`${s}.offset`,o=typeof s>"u"?"limit":`${s}.limit`;return this.url.searchParams.set(a,`${t}`),this.url.searchParams.set(o,`${r-t+1}`),this}abortSignal(t){return this.signal=t,this}single(){return this.headers.Accept="application/vnd.pgrst.object+json",this}maybeSingle(){return this.method==="GET"?this.headers.Accept="application/json":this.headers.Accept="application/vnd.pgrst.object+json",this.isMaybeSingle=!0,this}csv(){return this.headers.Accept="text/csv",this}geojson(){return this.headers.Accept="application/geo+json",this}explain({analyze:t=!1,verbose:r=!1,settings:n=!1,buffers:s=!1,wal:a=!1,format:o="text"}={}){var l;const c=[t?"analyze":null,r?"verbose":null,n?"settings":null,s?"buffers":null,a?"wal":null].filter(Boolean).join("|"),u=(l=this.headers.Accept)!==null&&l!==void 0?l:"application/json";return this.headers.Accept=`application/vnd.pgrst.plan+${o}; for="${u}"; options=${c};`,o==="json"?this:this}rollback(){var t;return((t=this.headers.Prefer)!==null&&t!==void 0?t:"").trim().length>0?this.headers.Prefer+=",tx=rollback":this.headers.Prefer="tx=rollback",this}returns(){return this}};ip.default=k$;var C$=pn&&pn.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(Af,"__esModule",{value:!0});const T$=C$(ip);let A$=class extends T$.default{eq(t,r){return this.url.searchParams.append(t,`eq.${r}`),this}neq(t,r){return this.url.searchParams.append(t,`neq.${r}`),this}gt(t,r){return this.url.searchParams.append(t,`gt.${r}`),this}gte(t,r){return this.url.searchParams.append(t,`gte.${r}`),this}lt(t,r){return this.url.searchParams.append(t,`lt.${r}`),this}lte(t,r){return this.url.searchParams.append(t,`lte.${r}`),this}like(t,r){return this.url.searchParams.append(t,`like.${r}`),this}likeAllOf(t,r){return this.url.searchParams.append(t,`like(all).{${r.join(",")}}`),this}likeAnyOf(t,r){return this.url.searchParams.append(t,`like(any).{${r.join(",")}}`),this}ilike(t,r){return this.url.searchParams.append(t,`ilike.${r}`),this}ilikeAllOf(t,r){return this.url.searchParams.append(t,`ilike(all).{${r.join(",")}}`),this}ilikeAnyOf(t,r){return this.url.searchParams.append(t,`ilike(any).{${r.join(",")}}`),this}is(t,r){return this.url.searchParams.append(t,`is.${r}`),this}in(t,r){const n=Array.from(new Set(r)).map(s=>typeof s=="string"&&new RegExp("[,()]").test(s)?`"${s}"`:`${s}`).join(",");return this.url.searchParams.append(t,`in.(${n})`),this}contains(t,r){return typeof r=="string"?this.url.searchParams.append(t,`cs.${r}`):Array.isArray(r)?this.url.searchParams.append(t,`cs.{${r.join(",")}}`):this.url.searchParams.append(t,`cs.${JSON.stringify(r)}`),this}containedBy(t,r){return typeof r=="string"?this.url.searchParams.append(t,`cd.${r}`):Array.isArray(r)?this.url.searchParams.append(t,`cd.{${r.join(",")}}`):this.url.searchParams.append(t,`cd.${JSON.stringify(r)}`),this}rangeGt(t,r){return this.url.searchParams.append(t,`sr.${r}`),this}rangeGte(t,r){return this.url.searchParams.append(t,`nxl.${r}`),this}rangeLt(t,r){return this.url.searchParams.append(t,`sl.${r}`),this}rangeLte(t,r){return this.url.searchParams.append(t,`nxr.${r}`),this}rangeAdjacent(t,r){return this.url.searchParams.append(t,`adj.${r}`),this}overlaps(t,r){return typeof r=="string"?this.url.searchParams.append(t,`ov.${r}`):this.url.searchParams.append(t,`ov.{${r.join(",")}}`),this}textSearch(t,r,{config:n,type:s}={}){let a="";s==="plain"?a="pl":s==="phrase"?a="ph":s==="websearch"&&(a="w");const o=n===void 0?"":`(${n})`;return this.url.searchParams.append(t,`${a}fts${o}.${r}`),this}match(t){return Object.entries(t).forEach(([r,n])=>{this.url.searchParams.append(r,`eq.${n}`)}),this}not(t,r,n){return this.url.searchParams.append(t,`not.${r}.${n}`),this}or(t,{foreignTable:r,referencedTable:n=r}={}){const s=n?`${n}.or`:"or";return this.url.searchParams.append(s,`(${t})`),this}filter(t,r,n){return this.url.searchParams.append(t,`${r}.${n}`),this}};Af.default=A$;var P$=pn&&pn.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(ap,"__esModule",{value:!0});const Pu=P$(Af);let D$=class{constructor(t,{headers:r={},schema:n,fetch:s}){this.url=t,this.headers=r,this.schema=n,this.fetch=s}select(t,{head:r=!1,count:n}={}){const s=r?"HEAD":"GET";let a=!1;const o=(t??"*").split("").map(l=>/\s/.test(l)&&!a?"":(l==='"'&&(a=!a),l)).join("");return this.url.searchParams.set("select",o),n&&(this.headers.Prefer=`count=${n}`),new Pu.default({method:s,url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch,allowEmpty:!1})}insert(t,{count:r,defaultToNull:n=!0}={}){const s="POST",a=[];if(this.headers.Prefer&&a.push(this.headers.Prefer),r&&a.push(`count=${r}`),n||a.push("missing=default"),this.headers.Prefer=a.join(","),Array.isArray(t)){const o=t.reduce((l,c)=>l.concat(Object.keys(c)),[]);if(o.length>0){const l=[...new Set(o)].map(c=>`"${c}"`);this.url.searchParams.set("columns",l.join(","))}}return new Pu.default({method:s,url:this.url,headers:this.headers,schema:this.schema,body:t,fetch:this.fetch,allowEmpty:!1})}upsert(t,{onConflict:r,ignoreDuplicates:n=!1,count:s,defaultToNull:a=!0}={}){const o="POST",l=[`resolution=${n?"ignore":"merge"}-duplicates`];if(r!==void 0&&this.url.searchParams.set("on_conflict",r),this.headers.Prefer&&l.push(this.headers.Prefer),s&&l.push(`count=${s}`),a||l.push("missing=default"),this.headers.Prefer=l.join(","),Array.isArray(t)){const c=t.reduce((u,d)=>u.concat(Object.keys(d)),[]);if(c.length>0){const u=[...new Set(c)].map(d=>`"${d}"`);this.url.searchParams.set("columns",u.join(","))}}return new Pu.default({method:o,url:this.url,headers:this.headers,schema:this.schema,body:t,fetch:this.fetch,allowEmpty:!1})}update(t,{count:r}={}){const n="PATCH",s=[];return this.headers.Prefer&&s.push(this.headers.Prefer),r&&s.push(`count=${r}`),this.headers.Prefer=s.join(","),new Pu.default({method:n,url:this.url,headers:this.headers,schema:this.schema,body:t,fetch:this.fetch,allowEmpty:!1})}delete({count:t}={}){const r="DELETE",n=[];return t&&n.push(`count=${t}`),this.headers.Prefer&&n.unshift(this.headers.Prefer),this.headers.Prefer=n.join(","),new Pu.default({method:r,url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch,allowEmpty:!1})}};ap.default=D$;var cp={},up={};Object.defineProperty(up,"__esModule",{value:!0});up.version=void 0;up.version="0.0.0-automated";Object.defineProperty(cp,"__esModule",{value:!0});cp.DEFAULT_HEADERS=void 0;const R$=up;cp.DEFAULT_HEADERS={"X-Client-Info":`postgrest-js/${R$.version}`};var NC=pn&&pn.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(R1,"__esModule",{value:!0});const M$=NC(ap),O$=NC(Af),F$=cp;let I$=class jC{constructor(t,{headers:r={},schema:n,fetch:s}={}){this.url=t,this.headers=Object.assign(Object.assign({},F$.DEFAULT_HEADERS),r),this.schemaName=n,this.fetch=s}from(t){const r=new URL(`${this.url}/${t}`);return new M$.default(r,{headers:Object.assign({},this.headers),schema:this.schemaName,fetch:this.fetch})}schema(t){return new jC(this.url,{headers:this.headers,schema:t,fetch:this.fetch})}rpc(t,r={},{head:n=!1,get:s=!1,count:a}={}){let o;const l=new URL(`${this.url}/rpc/${t}`);let c;n||s?(o=n?"HEAD":"GET",Object.entries(r).filter(([d,f])=>f!==void 0).map(([d,f])=>[d,Array.isArray(f)?`{${f.join(",")}}`:`${f}`]).forEach(([d,f])=>{l.searchParams.append(d,f)})):(o="POST",c=r);const u=Object.assign({},this.headers);return a&&(u.Prefer=`count=${a}`),new O$.default({method:o,url:l,headers:u,schema:this.schemaName,body:c,fetch:this.fetch,allowEmpty:!1})}};R1.default=I$;var ou=pn&&pn.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(In,"__esModule",{value:!0});In.PostgrestError=In.PostgrestBuilder=In.PostgrestTransformBuilder=In.PostgrestFilterBuilder=In.PostgrestQueryBuilder=In.PostgrestClient=void 0;const EC=ou(R1);In.PostgrestClient=EC.default;const kC=ou(ap);In.PostgrestQueryBuilder=kC.default;const CC=ou(Af);In.PostgrestFilterBuilder=CC.default;const TC=ou(ip);In.PostgrestTransformBuilder=TC.default;const AC=ou(op);In.PostgrestBuilder=AC.default;const PC=ou(lp);In.PostgrestError=PC.default;var L$=In.default={PostgrestClient:EC.default,PostgrestQueryBuilder:kC.default,PostgrestFilterBuilder:CC.default,PostgrestTransformBuilder:TC.default,PostgrestBuilder:AC.default,PostgrestError:PC.default};const{PostgrestClient:$$,PostgrestQueryBuilder:tse,PostgrestFilterBuilder:rse,PostgrestTransformBuilder:nse,PostgrestBuilder:sse,PostgrestError:ase}=L$;function B$(){if(typeof WebSocket<"u")return WebSocket;if(typeof global.WebSocket<"u")return global.WebSocket;if(typeof window.WebSocket<"u")return window.WebSocket;if(typeof self.WebSocket<"u")return self.WebSocket;throw new Error("`WebSocket` is not supported in this environment")}const U$=B$(),z$="2.11.15",V$=`realtime-js/${z$}`,W$="1.0.0",DC=1e4,H$=1e3;var ld;(function(e){e[e.connecting=0]="connecting",e[e.open=1]="open",e[e.closing=2]="closing",e[e.closed=3]="closed"})(ld||(ld={}));var dn;(function(e){e.closed="closed",e.errored="errored",e.joined="joined",e.joining="joining",e.leaving="leaving"})(dn||(dn={}));var Ws;(function(e){e.close="phx_close",e.error="phx_error",e.join="phx_join",e.reply="phx_reply",e.leave="phx_leave",e.access_token="access_token"})(Ws||(Ws={}));var $v;(function(e){e.websocket="websocket"})($v||($v={}));var Oo;(function(e){e.Connecting="connecting",e.Open="open",e.Closing="closing",e.Closed="closed"})(Oo||(Oo={}));class G${constructor(){this.HEADER_LENGTH=1}decode(t,r){return t.constructor===ArrayBuffer?r(this._binaryDecode(t)):r(typeof t=="string"?JSON.parse(t):{})}_binaryDecode(t){const r=new DataView(t),n=new TextDecoder;return this._decodeBroadcast(t,r,n)}_decodeBroadcast(t,r,n){const s=r.getUint8(1),a=r.getUint8(2);let o=this.HEADER_LENGTH+2;const l=n.decode(t.slice(o,o+s));o=o+s;const c=n.decode(t.slice(o,o+a));o=o+a;const u=JSON.parse(n.decode(t.slice(o,t.byteLength)));return{ref:null,topic:l,event:c,payload:u}}}class RC{constructor(t,r){this.callback=t,this.timerCalc=r,this.timer=void 0,this.tries=0,this.callback=t,this.timerCalc=r}reset(){this.tries=0,clearTimeout(this.timer)}scheduleTimeout(){clearTimeout(this.timer),this.timer=setTimeout(()=>{this.tries=this.tries+1,this.callback()},this.timerCalc(this.tries+1))}}var Vt;(function(e){e.abstime="abstime",e.bool="bool",e.date="date",e.daterange="daterange",e.float4="float4",e.float8="float8",e.int2="int2",e.int4="int4",e.int4range="int4range",e.int8="int8",e.int8range="int8range",e.json="json",e.jsonb="jsonb",e.money="money",e.numeric="numeric",e.oid="oid",e.reltime="reltime",e.text="text",e.time="time",e.timestamp="timestamp",e.timestamptz="timestamptz",e.timetz="timetz",e.tsrange="tsrange",e.tstzrange="tstzrange"})(Vt||(Vt={}));const u2=(e,t,r={})=>{var n;const s=(n=r.skipTypes)!==null&&n!==void 0?n:[];return Object.keys(t).reduce((a,o)=>(a[o]=q$(o,e,t,s),a),{})},q$=(e,t,r,n)=>{const s=t.find(l=>l.name===e),a=s==null?void 0:s.type,o=r[e];return a&&!n.includes(a)?MC(a,o):Bv(o)},MC=(e,t)=>{if(e.charAt(0)==="_"){const r=e.slice(1,e.length);return Q$(t,r)}switch(e){case Vt.bool:return Y$(t);case Vt.float4:case Vt.float8:case Vt.int2:case Vt.int4:case Vt.int8:case Vt.numeric:case Vt.oid:return K$(t);case Vt.json:case Vt.jsonb:return X$(t);case Vt.timestamp:return J$(t);case Vt.abstime:case Vt.date:case Vt.daterange:case Vt.int4range:case Vt.int8range:case Vt.money:case Vt.reltime:case Vt.text:case Vt.time:case Vt.timestamptz:case Vt.timetz:case Vt.tsrange:case Vt.tstzrange:return Bv(t);default:return Bv(t)}},Bv=e=>e,Y$=e=>{switch(e){case"t":return!0;case"f":return!1;default:return e}},K$=e=>{if(typeof e=="string"){const t=parseFloat(e);if(!Number.isNaN(t))return t}return e},X$=e=>{if(typeof e=="string")try{return JSON.parse(e)}catch(t){return console.log(`JSON parse error: ${t}`),e}return e},Q$=(e,t)=>{if(typeof e!="string")return e;const r=e.length-1,n=e[r];if(e[0]==="{"&&n==="}"){let a;const o=e.slice(1,r);try{a=JSON.parse("["+o+"]")}catch{a=o?o.split(","):[]}return a.map(l=>MC(t,l))}return e},J$=e=>typeof e=="string"?e.replace(" ","T"):e,OC=e=>{let t=e;return t=t.replace(/^ws/i,"http"),t=t.replace(/(\/socket\/websocket|\/socket|\/websocket)\/?$/i,""),t.replace(/\/+$/,"")};class Lg{constructor(t,r,n={},s=DC){this.channel=t,this.event=r,this.payload=n,this.timeout=s,this.sent=!1,this.timeoutTimer=void 0,this.ref="",this.receivedResp=null,this.recHooks=[],this.refEvent=null}resend(t){this.timeout=t,this._cancelRefEvent(),this.ref="",this.refEvent=null,this.receivedResp=null,this.sent=!1,this.send()}send(){this._hasReceived("timeout")||(this.startTimeout(),this.sent=!0,this.channel.socket.push({topic:this.channel.topic,event:this.event,payload:this.payload,ref:this.ref,join_ref:this.channel._joinRef()}))}updatePayload(t){this.payload=Object.assign(Object.assign({},this.payload),t)}receive(t,r){var n;return this._hasReceived(t)&&r((n=this.receivedResp)===null||n===void 0?void 0:n.response),this.recHooks.push({status:t,callback:r}),this}startTimeout(){if(this.timeoutTimer)return;this.ref=this.channel.socket._makeRef(),this.refEvent=this.channel._replyEventName(this.ref);const t=r=>{this._cancelRefEvent(),this._cancelTimeout(),this.receivedResp=r,this._matchReceive(r)};this.channel._on(this.refEvent,{},t),this.timeoutTimer=setTimeout(()=>{this.trigger("timeout",{})},this.timeout)}trigger(t,r){this.refEvent&&this.channel._trigger(this.refEvent,{status:t,response:r})}destroy(){this._cancelRefEvent(),this._cancelTimeout()}_cancelRefEvent(){this.refEvent&&this.channel._off(this.refEvent,{})}_cancelTimeout(){clearTimeout(this.timeoutTimer),this.timeoutTimer=void 0}_matchReceive({status:t,response:r}){this.recHooks.filter(n=>n.status===t).forEach(n=>n.callback(r))}_hasReceived(t){return this.receivedResp&&this.receivedResp.status===t}}var d2;(function(e){e.SYNC="sync",e.JOIN="join",e.LEAVE="leave"})(d2||(d2={}));class cd{constructor(t,r){this.channel=t,this.state={},this.pendingDiffs=[],this.joinRef=null,this.caller={onJoin:()=>{},onLeave:()=>{},onSync:()=>{}};const n=(r==null?void 0:r.events)||{state:"presence_state",diff:"presence_diff"};this.channel._on(n.state,{},s=>{const{onJoin:a,onLeave:o,onSync:l}=this.caller;this.joinRef=this.channel._joinRef(),this.state=cd.syncState(this.state,s,a,o),this.pendingDiffs.forEach(c=>{this.state=cd.syncDiff(this.state,c,a,o)}),this.pendingDiffs=[],l()}),this.channel._on(n.diff,{},s=>{const{onJoin:a,onLeave:o,onSync:l}=this.caller;this.inPendingSyncState()?this.pendingDiffs.push(s):(this.state=cd.syncDiff(this.state,s,a,o),l())}),this.onJoin((s,a,o)=>{this.channel._trigger("presence",{event:"join",key:s,currentPresences:a,newPresences:o})}),this.onLeave((s,a,o)=>{this.channel._trigger("presence",{event:"leave",key:s,currentPresences:a,leftPresences:o})}),this.onSync(()=>{this.channel._trigger("presence",{event:"sync"})})}static syncState(t,r,n,s){const a=this.cloneDeep(t),o=this.transformState(r),l={},c={};return this.map(a,(u,d)=>{o[u]||(c[u]=d)}),this.map(o,(u,d)=>{const f=a[u];if(f){const p=d.map(x=>x.presence_ref),h=f.map(x=>x.presence_ref),g=d.filter(x=>h.indexOf(x.presence_ref)<0),m=f.filter(x=>p.indexOf(x.presence_ref)<0);g.length>0&&(l[u]=g),m.length>0&&(c[u]=m)}else l[u]=d}),this.syncDiff(a,{joins:l,leaves:c},n,s)}static syncDiff(t,r,n,s){const{joins:a,leaves:o}={joins:this.transformState(r.joins),leaves:this.transformState(r.leaves)};return n||(n=()=>{}),s||(s=()=>{}),this.map(a,(l,c)=>{var u;const d=(u=t[l])!==null&&u!==void 0?u:[];if(t[l]=this.cloneDeep(c),d.length>0){const f=t[l].map(h=>h.presence_ref),p=d.filter(h=>f.indexOf(h.presence_ref)<0);t[l].unshift(...p)}n(l,d,c)}),this.map(o,(l,c)=>{let u=t[l];if(!u)return;const d=c.map(f=>f.presence_ref);u=u.filter(f=>d.indexOf(f.presence_ref)<0),t[l]=u,s(l,u,c),u.length===0&&delete t[l]}),t}static map(t,r){return Object.getOwnPropertyNames(t).map(n=>r(n,t[n]))}static transformState(t){return t=this.cloneDeep(t),Object.getOwnPropertyNames(t).reduce((r,n)=>{const s=t[n];return"metas"in s?r[n]=s.metas.map(a=>(a.presence_ref=a.phx_ref,delete a.phx_ref,delete a.phx_ref_prev,a)):r[n]=s,r},{})}static cloneDeep(t){return JSON.parse(JSON.stringify(t))}onJoin(t){this.caller.onJoin=t}onLeave(t){this.caller.onLeave=t}onSync(t){this.caller.onSync=t}inPendingSyncState(){return!this.joinRef||this.joinRef!==this.channel._joinRef()}}var f2;(function(e){e.ALL="*",e.INSERT="INSERT",e.UPDATE="UPDATE",e.DELETE="DELETE"})(f2||(f2={}));var h2;(function(e){e.BROADCAST="broadcast",e.PRESENCE="presence",e.POSTGRES_CHANGES="postgres_changes",e.SYSTEM="system"})(h2||(h2={}));var Wa;(function(e){e.SUBSCRIBED="SUBSCRIBED",e.TIMED_OUT="TIMED_OUT",e.CLOSED="CLOSED",e.CHANNEL_ERROR="CHANNEL_ERROR"})(Wa||(Wa={}));class M1{constructor(t,r={config:{}},n){this.topic=t,this.params=r,this.socket=n,this.bindings={},this.state=dn.closed,this.joinedOnce=!1,this.pushBuffer=[],this.subTopic=t.replace(/^realtime:/i,""),this.params.config=Object.assign({broadcast:{ack:!1,self:!1},presence:{key:""},private:!1},r.config),this.timeout=this.socket.timeout,this.joinPush=new Lg(this,Ws.join,this.params,this.timeout),this.rejoinTimer=new RC(()=>this._rejoinUntilConnected(),this.socket.reconnectAfterMs),this.joinPush.receive("ok",()=>{this.state=dn.joined,this.rejoinTimer.reset(),this.pushBuffer.forEach(s=>s.send()),this.pushBuffer=[]}),this._onClose(()=>{this.rejoinTimer.reset(),this.socket.log("channel",`close ${this.topic} ${this._joinRef()}`),this.state=dn.closed,this.socket._remove(this)}),this._onError(s=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,s),this.state=dn.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("timeout",()=>{this._isJoining()&&(this.socket.log("channel",`timeout ${this.topic}`,this.joinPush.timeout),this.state=dn.errored,this.rejoinTimer.scheduleTimeout())}),this._on(Ws.reply,{},(s,a)=>{this._trigger(this._replyEventName(a),s)}),this.presence=new cd(this),this.broadcastEndpointURL=OC(this.socket.endPoint)+"/api/broadcast",this.private=this.params.config.private||!1}subscribe(t,r=this.timeout){var n,s;if(this.socket.isConnected()||this.socket.connect(),this.state==dn.closed){const{config:{broadcast:a,presence:o,private:l}}=this.params;this._onError(d=>t==null?void 0:t(Wa.CHANNEL_ERROR,d)),this._onClose(()=>t==null?void 0:t(Wa.CLOSED));const c={},u={broadcast:a,presence:o,postgres_changes:(s=(n=this.bindings.postgres_changes)===null||n===void 0?void 0:n.map(d=>d.filter))!==null&&s!==void 0?s:[],private:l};this.socket.accessTokenValue&&(c.access_token=this.socket.accessTokenValue),this.updateJoinPayload(Object.assign({config:u},c)),this.joinedOnce=!0,this._rejoin(r),this.joinPush.receive("ok",async({postgres_changes:d})=>{var f;if(this.socket.setAuth(),d===void 0){t==null||t(Wa.SUBSCRIBED);return}else{const p=this.bindings.postgres_changes,h=(f=p==null?void 0:p.length)!==null&&f!==void 0?f:0,g=[];for(let m=0;m<h;m++){const x=p[m],{filter:{event:w,schema:v,table:_,filter:b}}=x,S=d&&d[m];if(S&&S.event===w&&S.schema===v&&S.table===_&&S.filter===b)g.push(Object.assign(Object.assign({},x),{id:S.id}));else{this.unsubscribe(),this.state=dn.errored,t==null||t(Wa.CHANNEL_ERROR,new Error("mismatch between server and client bindings for postgres changes"));return}}this.bindings.postgres_changes=g,t&&t(Wa.SUBSCRIBED);return}}).receive("error",d=>{this.state=dn.errored,t==null||t(Wa.CHANNEL_ERROR,new Error(JSON.stringify(Object.values(d).join(", ")||"error")))}).receive("timeout",()=>{t==null||t(Wa.TIMED_OUT)})}return this}presenceState(){return this.presence.state}async track(t,r={}){return await this.send({type:"presence",event:"track",payload:t},r.timeout||this.timeout)}async untrack(t={}){return await this.send({type:"presence",event:"untrack"},t)}on(t,r,n){return this._on(t,r,n)}async send(t,r={}){var n,s;if(!this._canPush()&&t.type==="broadcast"){const{event:a,payload:o}=t,c={method:"POST",headers:{Authorization:this.socket.accessTokenValue?`Bearer ${this.socket.accessTokenValue}`:"",apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"},body:JSON.stringify({messages:[{topic:this.subTopic,event:a,payload:o,private:this.private}]})};try{const u=await this._fetchWithTimeout(this.broadcastEndpointURL,c,(n=r.timeout)!==null&&n!==void 0?n:this.timeout);return await((s=u.body)===null||s===void 0?void 0:s.cancel()),u.ok?"ok":"error"}catch(u){return u.name==="AbortError"?"timed out":"error"}}else return new Promise(a=>{var o,l,c;const u=this._push(t.type,t,r.timeout||this.timeout);t.type==="broadcast"&&!(!((c=(l=(o=this.params)===null||o===void 0?void 0:o.config)===null||l===void 0?void 0:l.broadcast)===null||c===void 0)&&c.ack)&&a("ok"),u.receive("ok",()=>a("ok")),u.receive("error",()=>a("error")),u.receive("timeout",()=>a("timed out"))})}updateJoinPayload(t){this.joinPush.updatePayload(t)}unsubscribe(t=this.timeout){this.state=dn.leaving;const r=()=>{this.socket.log("channel",`leave ${this.topic}`),this._trigger(Ws.close,"leave",this._joinRef())};this.joinPush.destroy();let n=null;return new Promise(s=>{n=new Lg(this,Ws.leave,{},t),n.receive("ok",()=>{r(),s("ok")}).receive("timeout",()=>{r(),s("timed out")}).receive("error",()=>{s("error")}),n.send(),this._canPush()||n.trigger("ok",{})}).finally(()=>{n==null||n.destroy()})}teardown(){this.pushBuffer.forEach(t=>t.destroy()),this.rejoinTimer&&clearTimeout(this.rejoinTimer.timer),this.joinPush.destroy()}async _fetchWithTimeout(t,r,n){const s=new AbortController,a=setTimeout(()=>s.abort(),n),o=await this.socket.fetch(t,Object.assign(Object.assign({},r),{signal:s.signal}));return clearTimeout(a),o}_push(t,r,n=this.timeout){if(!this.joinedOnce)throw`tried to push '${t}' to '${this.topic}' before joining. Use channel.subscribe() before pushing events`;let s=new Lg(this,t,r,n);return this._canPush()?s.send():(s.startTimeout(),this.pushBuffer.push(s)),s}_onMessage(t,r,n){return r}_isMember(t){return this.topic===t}_joinRef(){return this.joinPush.ref}_trigger(t,r,n){var s,a;const o=t.toLocaleLowerCase(),{close:l,error:c,leave:u,join:d}=Ws;if(n&&[l,c,u,d].indexOf(o)>=0&&n!==this._joinRef())return;let p=this._onMessage(o,r,n);if(r&&!p)throw"channel onMessage callbacks must return the payload, modified or unmodified";["insert","update","delete"].includes(o)?(s=this.bindings.postgres_changes)===null||s===void 0||s.filter(h=>{var g,m,x;return((g=h.filter)===null||g===void 0?void 0:g.event)==="*"||((x=(m=h.filter)===null||m===void 0?void 0:m.event)===null||x===void 0?void 0:x.toLocaleLowerCase())===o}).map(h=>h.callback(p,n)):(a=this.bindings[o])===null||a===void 0||a.filter(h=>{var g,m,x,w,v,_;if(["broadcast","presence","postgres_changes"].includes(o))if("id"in h){const b=h.id,S=(g=h.filter)===null||g===void 0?void 0:g.event;return b&&((m=r.ids)===null||m===void 0?void 0:m.includes(b))&&(S==="*"||(S==null?void 0:S.toLocaleLowerCase())===((x=r.data)===null||x===void 0?void 0:x.type.toLocaleLowerCase()))}else{const b=(v=(w=h==null?void 0:h.filter)===null||w===void 0?void 0:w.event)===null||v===void 0?void 0:v.toLocaleLowerCase();return b==="*"||b===((_=r==null?void 0:r.event)===null||_===void 0?void 0:_.toLocaleLowerCase())}else return h.type.toLocaleLowerCase()===o}).map(h=>{if(typeof p=="object"&&"ids"in p){const g=p.data,{schema:m,table:x,commit_timestamp:w,type:v,errors:_}=g;p=Object.assign(Object.assign({},{schema:m,table:x,commit_timestamp:w,eventType:v,new:{},old:{},errors:_}),this._getPayloadRecords(g))}h.callback(p,n)})}_isClosed(){return this.state===dn.closed}_isJoined(){return this.state===dn.joined}_isJoining(){return this.state===dn.joining}_isLeaving(){return this.state===dn.leaving}_replyEventName(t){return`chan_reply_${t}`}_on(t,r,n){const s=t.toLocaleLowerCase(),a={type:s,filter:r,callback:n};return this.bindings[s]?this.bindings[s].push(a):this.bindings[s]=[a],this}_off(t,r){const n=t.toLocaleLowerCase();return this.bindings[n]=this.bindings[n].filter(s=>{var a;return!(((a=s.type)===null||a===void 0?void 0:a.toLocaleLowerCase())===n&&M1.isEqual(s.filter,r))}),this}static isEqual(t,r){if(Object.keys(t).length!==Object.keys(r).length)return!1;for(const n in t)if(t[n]!==r[n])return!1;return!0}_rejoinUntilConnected(){this.rejoinTimer.scheduleTimeout(),this.socket.isConnected()&&this._rejoin()}_onClose(t){this._on(Ws.close,{},t)}_onError(t){this._on(Ws.error,{},r=>t(r))}_canPush(){return this.socket.isConnected()&&this._isJoined()}_rejoin(t=this.timeout){this._isLeaving()||(this.socket._leaveOpenTopic(this.topic),this.state=dn.joining,this.joinPush.resend(t))}_getPayloadRecords(t){const r={new:{},old:{}};return(t.type==="INSERT"||t.type==="UPDATE")&&(r.new=u2(t.columns,t.record)),(t.type==="UPDATE"||t.type==="DELETE")&&(r.old=u2(t.columns,t.old_record)),r}}const m2=()=>{},Z$=`
  addEventListener("message", (e) => {
    if (e.data.event === "start") {
      setInterval(() => postMessage({ event: "keepAlive" }), e.data.interval);
    }
  });`;class eB{constructor(t,r){var n;this.accessTokenValue=null,this.apiKey=null,this.channels=new Array,this.endPoint="",this.httpEndpoint="",this.headers={},this.params={},this.timeout=DC,this.heartbeatIntervalMs=25e3,this.heartbeatTimer=void 0,this.pendingHeartbeatRef=null,this.heartbeatCallback=m2,this.ref=0,this.logger=m2,this.conn=null,this.sendBuffer=[],this.serializer=new G$,this.stateChangeCallbacks={open:[],close:[],error:[],message:[]},this.accessToken=null,this._resolveFetch=a=>{let o;return a?o=a:typeof fetch>"u"?o=(...l)=>no(async()=>{const{default:c}=await Promise.resolve().then(()=>iu);return{default:c}},void 0).then(({default:c})=>c(...l)):o=fetch,(...l)=>o(...l)},this.endPoint=`${t}/${$v.websocket}`,this.httpEndpoint=OC(t),r!=null&&r.transport?this.transport=r.transport:this.transport=null,r!=null&&r.params&&(this.params=r.params),r!=null&&r.timeout&&(this.timeout=r.timeout),r!=null&&r.logger&&(this.logger=r.logger),(r!=null&&r.logLevel||r!=null&&r.log_level)&&(this.logLevel=r.logLevel||r.log_level,this.params=Object.assign(Object.assign({},this.params),{log_level:this.logLevel})),r!=null&&r.heartbeatIntervalMs&&(this.heartbeatIntervalMs=r.heartbeatIntervalMs);const s=(n=r==null?void 0:r.params)===null||n===void 0?void 0:n.apikey;if(s&&(this.accessTokenValue=s,this.apiKey=s),this.reconnectAfterMs=r!=null&&r.reconnectAfterMs?r.reconnectAfterMs:a=>[1e3,2e3,5e3,1e4][a-1]||1e4,this.encode=r!=null&&r.encode?r.encode:(a,o)=>o(JSON.stringify(a)),this.decode=r!=null&&r.decode?r.decode:this.serializer.decode.bind(this.serializer),this.reconnectTimer=new RC(async()=>{this.disconnect(),this.connect()},this.reconnectAfterMs),this.fetch=this._resolveFetch(r==null?void 0:r.fetch),r!=null&&r.worker){if(typeof window<"u"&&!window.Worker)throw new Error("Web Worker is not supported");this.worker=(r==null?void 0:r.worker)||!1,this.workerUrl=r==null?void 0:r.workerUrl}this.accessToken=(r==null?void 0:r.accessToken)||null}connect(){if(!this.conn){if(this.transport||(this.transport=U$),!this.transport)throw new Error("No transport provided");this.conn=new this.transport(this.endpointURL()),this.setupConnection()}}endpointURL(){return this._appendParams(this.endPoint,Object.assign({},this.params,{vsn:W$}))}disconnect(t,r){this.conn&&(this.conn.onclose=function(){},t?this.conn.close(t,r??""):this.conn.close(),this.conn=null,this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.reconnectTimer.reset(),this.channels.forEach(n=>n.teardown()))}getChannels(){return this.channels}async removeChannel(t){const r=await t.unsubscribe();return this.channels.length===0&&this.disconnect(),r}async removeAllChannels(){const t=await Promise.all(this.channels.map(r=>r.unsubscribe()));return this.channels=[],this.disconnect(),t}log(t,r,n){this.logger(t,r,n)}connectionState(){switch(this.conn&&this.conn.readyState){case ld.connecting:return Oo.Connecting;case ld.open:return Oo.Open;case ld.closing:return Oo.Closing;default:return Oo.Closed}}isConnected(){return this.connectionState()===Oo.Open}channel(t,r={config:{}}){const n=`realtime:${t}`,s=this.getChannels().find(a=>a.topic===n);if(s)return s;{const a=new M1(`realtime:${t}`,r,this);return this.channels.push(a),a}}push(t){const{topic:r,event:n,payload:s,ref:a}=t,o=()=>{this.encode(t,l=>{var c;(c=this.conn)===null||c===void 0||c.send(l)})};this.log("push",`${r} ${n} (${a})`,s),this.isConnected()?o():this.sendBuffer.push(o)}async setAuth(t=null){let r=t||this.accessToken&&await this.accessToken()||this.accessTokenValue;this.accessTokenValue!=r&&(this.accessTokenValue=r,this.channels.forEach(n=>{const s={access_token:r,version:V$};r&&n.updateJoinPayload(s),n.joinedOnce&&n._isJoined()&&n._push(Ws.access_token,{access_token:r})}))}async sendHeartbeat(){var t;if(!this.isConnected()){this.heartbeatCallback("disconnected");return}if(this.pendingHeartbeatRef){this.pendingHeartbeatRef=null,this.log("transport","heartbeat timeout. Attempting to re-establish connection"),this.heartbeatCallback("timeout"),(t=this.conn)===null||t===void 0||t.close(H$,"hearbeat timeout");return}this.pendingHeartbeatRef=this._makeRef(),this.push({topic:"phoenix",event:"heartbeat",payload:{},ref:this.pendingHeartbeatRef}),this.heartbeatCallback("sent"),await this.setAuth()}onHeartbeat(t){this.heartbeatCallback=t}flushSendBuffer(){this.isConnected()&&this.sendBuffer.length>0&&(this.sendBuffer.forEach(t=>t()),this.sendBuffer=[])}_makeRef(){let t=this.ref+1;return t===this.ref?this.ref=0:this.ref=t,this.ref.toString()}_leaveOpenTopic(t){let r=this.channels.find(n=>n.topic===t&&(n._isJoined()||n._isJoining()));r&&(this.log("transport",`leaving duplicate topic "${t}"`),r.unsubscribe())}_remove(t){this.channels=this.channels.filter(r=>r.topic!==t.topic)}setupConnection(){this.conn&&(this.conn.binaryType="arraybuffer",this.conn.onopen=()=>this._onConnOpen(),this.conn.onerror=t=>this._onConnError(t),this.conn.onmessage=t=>this._onConnMessage(t),this.conn.onclose=t=>this._onConnClose(t))}_onConnMessage(t){this.decode(t.data,r=>{let{topic:n,event:s,payload:a,ref:o}=r;n==="phoenix"&&s==="phx_reply"&&this.heartbeatCallback(r.payload.status=="ok"?"ok":"error"),o&&o===this.pendingHeartbeatRef&&(this.pendingHeartbeatRef=null),this.log("receive",`${a.status||""} ${n} ${s} ${o&&"("+o+")"||""}`,a),Array.from(this.channels).filter(l=>l._isMember(n)).forEach(l=>l._trigger(s,a,o)),this.stateChangeCallbacks.message.forEach(l=>l(r))})}_onConnOpen(){this.log("transport",`connected to ${this.endpointURL()}`),this.flushSendBuffer(),this.reconnectTimer.reset(),this.worker?this.workerRef||this._startWorkerHeartbeat():this._startHeartbeat(),this.stateChangeCallbacks.open.forEach(t=>t())}_startHeartbeat(){this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.heartbeatTimer=setInterval(()=>this.sendHeartbeat(),this.heartbeatIntervalMs)}_startWorkerHeartbeat(){this.workerUrl?this.log("worker",`starting worker for from ${this.workerUrl}`):this.log("worker","starting default worker");const t=this._workerObjectUrl(this.workerUrl);this.workerRef=new Worker(t),this.workerRef.onerror=r=>{this.log("worker","worker error",r.message),this.workerRef.terminate()},this.workerRef.onmessage=r=>{r.data.event==="keepAlive"&&this.sendHeartbeat()},this.workerRef.postMessage({event:"start",interval:this.heartbeatIntervalMs})}_onConnClose(t){this.log("transport","close",t),this._triggerChanError(),this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.reconnectTimer.scheduleTimeout(),this.stateChangeCallbacks.close.forEach(r=>r(t))}_onConnError(t){this.log("transport",`${t}`),this._triggerChanError(),this.stateChangeCallbacks.error.forEach(r=>r(t))}_triggerChanError(){this.channels.forEach(t=>t._trigger(Ws.error))}_appendParams(t,r){if(Object.keys(r).length===0)return t;const n=t.match(/\?/)?"&":"?",s=new URLSearchParams(r);return`${t}${n}${s}`}_workerObjectUrl(t){let r;if(t)r=t;else{const n=new Blob([Z$],{type:"application/javascript"});r=URL.createObjectURL(n)}return r}}class O1 extends Error{constructor(t){super(t),this.__isStorageError=!0,this.name="StorageError"}}function Br(e){return typeof e=="object"&&e!==null&&"__isStorageError"in e}class tB extends O1{constructor(t,r){super(t),this.name="StorageApiError",this.status=r}toJSON(){return{name:this.name,message:this.message,status:this.status}}}class Uv extends O1{constructor(t,r){super(t),this.name="StorageUnknownError",this.originalError=r}}var rB=function(e,t,r,n){function s(a){return a instanceof r?a:new r(function(o){o(a)})}return new(r||(r=Promise))(function(a,o){function l(d){try{u(n.next(d))}catch(f){o(f)}}function c(d){try{u(n.throw(d))}catch(f){o(f)}}function u(d){d.done?a(d.value):s(d.value).then(l,c)}u((n=n.apply(e,t||[])).next())})};const FC=e=>{let t;return e?t=e:typeof fetch>"u"?t=(...r)=>no(async()=>{const{default:n}=await Promise.resolve().then(()=>iu);return{default:n}},void 0).then(({default:n})=>n(...r)):t=fetch,(...r)=>t(...r)},nB=()=>rB(void 0,void 0,void 0,function*(){return typeof Response>"u"?(yield no(()=>Promise.resolve().then(()=>iu),void 0)).Response:Response}),zv=e=>{if(Array.isArray(e))return e.map(r=>zv(r));if(typeof e=="function"||e!==Object(e))return e;const t={};return Object.entries(e).forEach(([r,n])=>{const s=r.replace(/([-_][a-z])/gi,a=>a.toUpperCase().replace(/[-_]/g,""));t[s]=zv(n)}),t};var wl=function(e,t,r,n){function s(a){return a instanceof r?a:new r(function(o){o(a)})}return new(r||(r=Promise))(function(a,o){function l(d){try{u(n.next(d))}catch(f){o(f)}}function c(d){try{u(n.throw(d))}catch(f){o(f)}}function u(d){d.done?a(d.value):s(d.value).then(l,c)}u((n=n.apply(e,t||[])).next())})};const $g=e=>e.msg||e.message||e.error_description||e.error||JSON.stringify(e),sB=(e,t,r)=>wl(void 0,void 0,void 0,function*(){const n=yield nB();e instanceof n&&!(r!=null&&r.noResolveJson)?e.json().then(s=>{t(new tB($g(s),e.status||500))}).catch(s=>{t(new Uv($g(s),s))}):t(new Uv($g(e),e))}),aB=(e,t,r,n)=>{const s={method:e,headers:(t==null?void 0:t.headers)||{}};return e==="GET"?s:(s.headers=Object.assign({"Content-Type":"application/json"},t==null?void 0:t.headers),n&&(s.body=JSON.stringify(n)),Object.assign(Object.assign({},s),r))};function Pf(e,t,r,n,s,a){return wl(this,void 0,void 0,function*(){return new Promise((o,l)=>{e(r,aB(t,n,s,a)).then(c=>{if(!c.ok)throw c;return n!=null&&n.noResolveJson?c:c.json()}).then(c=>o(c)).catch(c=>sB(c,l,n))})})}function Gm(e,t,r,n){return wl(this,void 0,void 0,function*(){return Pf(e,"GET",t,r,n)})}function Ai(e,t,r,n,s){return wl(this,void 0,void 0,function*(){return Pf(e,"POST",t,n,s,r)})}function iB(e,t,r,n,s){return wl(this,void 0,void 0,function*(){return Pf(e,"PUT",t,n,s,r)})}function oB(e,t,r,n){return wl(this,void 0,void 0,function*(){return Pf(e,"HEAD",t,Object.assign(Object.assign({},r),{noResolveJson:!0}),n)})}function IC(e,t,r,n,s){return wl(this,void 0,void 0,function*(){return Pf(e,"DELETE",t,n,s,r)})}var Dn=function(e,t,r,n){function s(a){return a instanceof r?a:new r(function(o){o(a)})}return new(r||(r=Promise))(function(a,o){function l(d){try{u(n.next(d))}catch(f){o(f)}}function c(d){try{u(n.throw(d))}catch(f){o(f)}}function u(d){d.done?a(d.value):s(d.value).then(l,c)}u((n=n.apply(e,t||[])).next())})};const lB={limit:100,offset:0,sortBy:{column:"name",order:"asc"}},p2={cacheControl:"3600",contentType:"text/plain;charset=UTF-8",upsert:!1};class cB{constructor(t,r={},n,s){this.url=t,this.headers=r,this.bucketId=n,this.fetch=FC(s)}uploadOrUpdate(t,r,n,s){return Dn(this,void 0,void 0,function*(){try{let a;const o=Object.assign(Object.assign({},p2),s);let l=Object.assign(Object.assign({},this.headers),t==="POST"&&{"x-upsert":String(o.upsert)});const c=o.metadata;typeof Blob<"u"&&n instanceof Blob?(a=new FormData,a.append("cacheControl",o.cacheControl),c&&a.append("metadata",this.encodeMetadata(c)),a.append("",n)):typeof FormData<"u"&&n instanceof FormData?(a=n,a.append("cacheControl",o.cacheControl),c&&a.append("metadata",this.encodeMetadata(c))):(a=n,l["cache-control"]=`max-age=${o.cacheControl}`,l["content-type"]=o.contentType,c&&(l["x-metadata"]=this.toBase64(this.encodeMetadata(c)))),s!=null&&s.headers&&(l=Object.assign(Object.assign({},l),s.headers));const u=this._removeEmptyFolders(r),d=this._getFinalPath(u),f=yield this.fetch(`${this.url}/object/${d}`,Object.assign({method:t,body:a,headers:l},o!=null&&o.duplex?{duplex:o.duplex}:{})),p=yield f.json();return f.ok?{data:{path:u,id:p.Id,fullPath:p.Key},error:null}:{data:null,error:p}}catch(a){if(Br(a))return{data:null,error:a};throw a}})}upload(t,r,n){return Dn(this,void 0,void 0,function*(){return this.uploadOrUpdate("POST",t,r,n)})}uploadToSignedUrl(t,r,n,s){return Dn(this,void 0,void 0,function*(){const a=this._removeEmptyFolders(t),o=this._getFinalPath(a),l=new URL(this.url+`/object/upload/sign/${o}`);l.searchParams.set("token",r);try{let c;const u=Object.assign({upsert:p2.upsert},s),d=Object.assign(Object.assign({},this.headers),{"x-upsert":String(u.upsert)});typeof Blob<"u"&&n instanceof Blob?(c=new FormData,c.append("cacheControl",u.cacheControl),c.append("",n)):typeof FormData<"u"&&n instanceof FormData?(c=n,c.append("cacheControl",u.cacheControl)):(c=n,d["cache-control"]=`max-age=${u.cacheControl}`,d["content-type"]=u.contentType);const f=yield this.fetch(l.toString(),{method:"PUT",body:c,headers:d}),p=yield f.json();return f.ok?{data:{path:a,fullPath:p.Key},error:null}:{data:null,error:p}}catch(c){if(Br(c))return{data:null,error:c};throw c}})}createSignedUploadUrl(t,r){return Dn(this,void 0,void 0,function*(){try{let n=this._getFinalPath(t);const s=Object.assign({},this.headers);r!=null&&r.upsert&&(s["x-upsert"]="true");const a=yield Ai(this.fetch,`${this.url}/object/upload/sign/${n}`,{},{headers:s}),o=new URL(this.url+a.url),l=o.searchParams.get("token");if(!l)throw new O1("No token returned by API");return{data:{signedUrl:o.toString(),path:t,token:l},error:null}}catch(n){if(Br(n))return{data:null,error:n};throw n}})}update(t,r,n){return Dn(this,void 0,void 0,function*(){return this.uploadOrUpdate("PUT",t,r,n)})}move(t,r,n){return Dn(this,void 0,void 0,function*(){try{return{data:yield Ai(this.fetch,`${this.url}/object/move`,{bucketId:this.bucketId,sourceKey:t,destinationKey:r,destinationBucket:n==null?void 0:n.destinationBucket},{headers:this.headers}),error:null}}catch(s){if(Br(s))return{data:null,error:s};throw s}})}copy(t,r,n){return Dn(this,void 0,void 0,function*(){try{return{data:{path:(yield Ai(this.fetch,`${this.url}/object/copy`,{bucketId:this.bucketId,sourceKey:t,destinationKey:r,destinationBucket:n==null?void 0:n.destinationBucket},{headers:this.headers})).Key},error:null}}catch(s){if(Br(s))return{data:null,error:s};throw s}})}createSignedUrl(t,r,n){return Dn(this,void 0,void 0,function*(){try{let s=this._getFinalPath(t),a=yield Ai(this.fetch,`${this.url}/object/sign/${s}`,Object.assign({expiresIn:r},n!=null&&n.transform?{transform:n.transform}:{}),{headers:this.headers});const o=n!=null&&n.download?`&download=${n.download===!0?"":n.download}`:"";return a={signedUrl:encodeURI(`${this.url}${a.signedURL}${o}`)},{data:a,error:null}}catch(s){if(Br(s))return{data:null,error:s};throw s}})}createSignedUrls(t,r,n){return Dn(this,void 0,void 0,function*(){try{const s=yield Ai(this.fetch,`${this.url}/object/sign/${this.bucketId}`,{expiresIn:r,paths:t},{headers:this.headers}),a=n!=null&&n.download?`&download=${n.download===!0?"":n.download}`:"";return{data:s.map(o=>Object.assign(Object.assign({},o),{signedUrl:o.signedURL?encodeURI(`${this.url}${o.signedURL}${a}`):null})),error:null}}catch(s){if(Br(s))return{data:null,error:s};throw s}})}download(t,r){return Dn(this,void 0,void 0,function*(){const s=typeof(r==null?void 0:r.transform)<"u"?"render/image/authenticated":"object",a=this.transformOptsToQueryString((r==null?void 0:r.transform)||{}),o=a?`?${a}`:"";try{const l=this._getFinalPath(t);return{data:yield(yield Gm(this.fetch,`${this.url}/${s}/${l}${o}`,{headers:this.headers,noResolveJson:!0})).blob(),error:null}}catch(l){if(Br(l))return{data:null,error:l};throw l}})}info(t){return Dn(this,void 0,void 0,function*(){const r=this._getFinalPath(t);try{const n=yield Gm(this.fetch,`${this.url}/object/info/${r}`,{headers:this.headers});return{data:zv(n),error:null}}catch(n){if(Br(n))return{data:null,error:n};throw n}})}exists(t){return Dn(this,void 0,void 0,function*(){const r=this._getFinalPath(t);try{return yield oB(this.fetch,`${this.url}/object/${r}`,{headers:this.headers}),{data:!0,error:null}}catch(n){if(Br(n)&&n instanceof Uv){const s=n.originalError;if([400,404].includes(s==null?void 0:s.status))return{data:!1,error:n}}throw n}})}getPublicUrl(t,r){const n=this._getFinalPath(t),s=[],a=r!=null&&r.download?`download=${r.download===!0?"":r.download}`:"";a!==""&&s.push(a);const l=typeof(r==null?void 0:r.transform)<"u"?"render/image":"object",c=this.transformOptsToQueryString((r==null?void 0:r.transform)||{});c!==""&&s.push(c);let u=s.join("&");return u!==""&&(u=`?${u}`),{data:{publicUrl:encodeURI(`${this.url}/${l}/public/${n}${u}`)}}}remove(t){return Dn(this,void 0,void 0,function*(){try{return{data:yield IC(this.fetch,`${this.url}/object/${this.bucketId}`,{prefixes:t},{headers:this.headers}),error:null}}catch(r){if(Br(r))return{data:null,error:r};throw r}})}list(t,r,n){return Dn(this,void 0,void 0,function*(){try{const s=Object.assign(Object.assign(Object.assign({},lB),r),{prefix:t||""});return{data:yield Ai(this.fetch,`${this.url}/object/list/${this.bucketId}`,s,{headers:this.headers},n),error:null}}catch(s){if(Br(s))return{data:null,error:s};throw s}})}encodeMetadata(t){return JSON.stringify(t)}toBase64(t){return typeof Buffer<"u"?Buffer.from(t).toString("base64"):btoa(t)}_getFinalPath(t){return`${this.bucketId}/${t}`}_removeEmptyFolders(t){return t.replace(/^\/|\/$/g,"").replace(/\/+/g,"/")}transformOptsToQueryString(t){const r=[];return t.width&&r.push(`width=${t.width}`),t.height&&r.push(`height=${t.height}`),t.resize&&r.push(`resize=${t.resize}`),t.format&&r.push(`format=${t.format}`),t.quality&&r.push(`quality=${t.quality}`),r.join("&")}}const uB="2.7.1",dB={"X-Client-Info":`storage-js/${uB}`};var Pl=function(e,t,r,n){function s(a){return a instanceof r?a:new r(function(o){o(a)})}return new(r||(r=Promise))(function(a,o){function l(d){try{u(n.next(d))}catch(f){o(f)}}function c(d){try{u(n.throw(d))}catch(f){o(f)}}function u(d){d.done?a(d.value):s(d.value).then(l,c)}u((n=n.apply(e,t||[])).next())})};class fB{constructor(t,r={},n){this.url=t,this.headers=Object.assign(Object.assign({},dB),r),this.fetch=FC(n)}listBuckets(){return Pl(this,void 0,void 0,function*(){try{return{data:yield Gm(this.fetch,`${this.url}/bucket`,{headers:this.headers}),error:null}}catch(t){if(Br(t))return{data:null,error:t};throw t}})}getBucket(t){return Pl(this,void 0,void 0,function*(){try{return{data:yield Gm(this.fetch,`${this.url}/bucket/${t}`,{headers:this.headers}),error:null}}catch(r){if(Br(r))return{data:null,error:r};throw r}})}createBucket(t,r={public:!1}){return Pl(this,void 0,void 0,function*(){try{return{data:yield Ai(this.fetch,`${this.url}/bucket`,{id:t,name:t,public:r.public,file_size_limit:r.fileSizeLimit,allowed_mime_types:r.allowedMimeTypes},{headers:this.headers}),error:null}}catch(n){if(Br(n))return{data:null,error:n};throw n}})}updateBucket(t,r){return Pl(this,void 0,void 0,function*(){try{return{data:yield iB(this.fetch,`${this.url}/bucket/${t}`,{id:t,name:t,public:r.public,file_size_limit:r.fileSizeLimit,allowed_mime_types:r.allowedMimeTypes},{headers:this.headers}),error:null}}catch(n){if(Br(n))return{data:null,error:n};throw n}})}emptyBucket(t){return Pl(this,void 0,void 0,function*(){try{return{data:yield Ai(this.fetch,`${this.url}/bucket/${t}/empty`,{},{headers:this.headers}),error:null}}catch(r){if(Br(r))return{data:null,error:r};throw r}})}deleteBucket(t){return Pl(this,void 0,void 0,function*(){try{return{data:yield IC(this.fetch,`${this.url}/bucket/${t}`,{},{headers:this.headers}),error:null}}catch(r){if(Br(r))return{data:null,error:r};throw r}})}}class hB extends fB{constructor(t,r={},n){super(t,r,n)}from(t){return new cB(this.url,this.headers,t,this.fetch)}}const mB="2.50.3";let Gu="";typeof Deno<"u"?Gu="deno":typeof document<"u"?Gu="web":typeof navigator<"u"&&navigator.product==="ReactNative"?Gu="react-native":Gu="node";const pB={"X-Client-Info":`supabase-js-${Gu}/${mB}`},gB={headers:pB},xB={schema:"public"},vB={autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,flowType:"implicit"},yB={};var wB=function(e,t,r,n){function s(a){return a instanceof r?a:new r(function(o){o(a)})}return new(r||(r=Promise))(function(a,o){function l(d){try{u(n.next(d))}catch(f){o(f)}}function c(d){try{u(n.throw(d))}catch(f){o(f)}}function u(d){d.done?a(d.value):s(d.value).then(l,c)}u((n=n.apply(e,t||[])).next())})};const _B=e=>{let t;return e?t=e:typeof fetch>"u"?t=_C:t=fetch,(...r)=>t(...r)},bB=()=>typeof Headers>"u"?bC:Headers,SB=(e,t,r)=>{const n=_B(r),s=bB();return(a,o)=>wB(void 0,void 0,void 0,function*(){var l;const c=(l=yield t())!==null&&l!==void 0?l:e;let u=new s(o==null?void 0:o.headers);return u.has("apikey")||u.set("apikey",e),u.has("Authorization")||u.set("Authorization",`Bearer ${c}`),n(a,Object.assign(Object.assign({},o),{headers:u}))})};var NB=function(e,t,r,n){function s(a){return a instanceof r?a:new r(function(o){o(a)})}return new(r||(r=Promise))(function(a,o){function l(d){try{u(n.next(d))}catch(f){o(f)}}function c(d){try{u(n.throw(d))}catch(f){o(f)}}function u(d){d.done?a(d.value):s(d.value).then(l,c)}u((n=n.apply(e,t||[])).next())})};function jB(e){return e.endsWith("/")?e:e+"/"}function EB(e,t){var r,n;const{db:s,auth:a,realtime:o,global:l}=e,{db:c,auth:u,realtime:d,global:f}=t,p={db:Object.assign(Object.assign({},c),s),auth:Object.assign(Object.assign({},u),a),realtime:Object.assign(Object.assign({},d),o),global:Object.assign(Object.assign(Object.assign({},f),l),{headers:Object.assign(Object.assign({},(r=f==null?void 0:f.headers)!==null&&r!==void 0?r:{}),(n=l==null?void 0:l.headers)!==null&&n!==void 0?n:{})}),accessToken:()=>NB(this,void 0,void 0,function*(){return""})};return e.accessToken?p.accessToken=e.accessToken:delete p.accessToken,p}const LC="2.70.0",Vl=30*1e3,Vv=3,Bg=Vv*Vl,kB="http://localhost:9999",CB="supabase.auth.token",TB={"X-Client-Info":`gotrue-js/${LC}`},Wv="X-Supabase-Api-Version",$C={"2024-01-01":{timestamp:Date.parse("2024-01-01T00:00:00.0Z"),name:"2024-01-01"}},AB=/^([a-z0-9_-]{4})*($|[a-z0-9_-]{3}$|[a-z0-9_-]{2}$)$/i,PB=6e5;class F1 extends Error{constructor(t,r,n){super(t),this.__isAuthError=!0,this.name="AuthError",this.status=r,this.code=n}}function lt(e){return typeof e=="object"&&e!==null&&"__isAuthError"in e}class DB extends F1{constructor(t,r,n){super(t,r,n),this.name="AuthApiError",this.status=r,this.code=n}}function RB(e){return lt(e)&&e.name==="AuthApiError"}class BC extends F1{constructor(t,r){super(t),this.name="AuthUnknownError",this.originalError=r}}class bo extends F1{constructor(t,r,n,s){super(t,n,s),this.name=r,this.status=n}}class Ei extends bo{constructor(){super("Auth session missing!","AuthSessionMissingError",400,void 0)}}function MB(e){return lt(e)&&e.name==="AuthSessionMissingError"}class Sh extends bo{constructor(){super("Auth session or user missing","AuthInvalidTokenResponseError",500,void 0)}}class Nh extends bo{constructor(t){super(t,"AuthInvalidCredentialsError",400,void 0)}}class jh extends bo{constructor(t,r=null){super(t,"AuthImplicitGrantRedirectError",500,void 0),this.details=null,this.details=r}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}function OB(e){return lt(e)&&e.name==="AuthImplicitGrantRedirectError"}class g2 extends bo{constructor(t,r=null){super(t,"AuthPKCEGrantCodeExchangeError",500,void 0),this.details=null,this.details=r}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}class Hv extends bo{constructor(t,r){super(t,"AuthRetryableFetchError",r,void 0)}}function Ug(e){return lt(e)&&e.name==="AuthRetryableFetchError"}class x2 extends bo{constructor(t,r,n){super(t,"AuthWeakPasswordError",r,"weak_password"),this.reasons=n}}class ud extends bo{constructor(t){super(t,"AuthInvalidJwtError",400,"invalid_jwt")}}const qm="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_".split(""),v2=` 	
\r=`.split(""),FB=(()=>{const e=new Array(128);for(let t=0;t<e.length;t+=1)e[t]=-1;for(let t=0;t<v2.length;t+=1)e[v2[t].charCodeAt(0)]=-2;for(let t=0;t<qm.length;t+=1)e[qm[t].charCodeAt(0)]=t;return e})();function y2(e,t,r){if(e!==null)for(t.queue=t.queue<<8|e,t.queuedBits+=8;t.queuedBits>=6;){const n=t.queue>>t.queuedBits-6&63;r(qm[n]),t.queuedBits-=6}else if(t.queuedBits>0)for(t.queue=t.queue<<6-t.queuedBits,t.queuedBits=6;t.queuedBits>=6;){const n=t.queue>>t.queuedBits-6&63;r(qm[n]),t.queuedBits-=6}}function UC(e,t,r){const n=FB[e];if(n>-1)for(t.queue=t.queue<<6|n,t.queuedBits+=6;t.queuedBits>=8;)r(t.queue>>t.queuedBits-8&255),t.queuedBits-=8;else{if(n===-2)return;throw new Error(`Invalid Base64-URL character "${String.fromCharCode(e)}"`)}}function w2(e){const t=[],r=o=>{t.push(String.fromCodePoint(o))},n={utf8seq:0,codepoint:0},s={queue:0,queuedBits:0},a=o=>{$B(o,n,r)};for(let o=0;o<e.length;o+=1)UC(e.charCodeAt(o),s,a);return t.join("")}function IB(e,t){if(e<=127){t(e);return}else if(e<=2047){t(192|e>>6),t(128|e&63);return}else if(e<=65535){t(224|e>>12),t(128|e>>6&63),t(128|e&63);return}else if(e<=1114111){t(240|e>>18),t(128|e>>12&63),t(128|e>>6&63),t(128|e&63);return}throw new Error(`Unrecognized Unicode codepoint: ${e.toString(16)}`)}function LB(e,t){for(let r=0;r<e.length;r+=1){let n=e.charCodeAt(r);if(n>55295&&n<=56319){const s=(n-55296)*1024&65535;n=(e.charCodeAt(r+1)-56320&65535|s)+65536,r+=1}IB(n,t)}}function $B(e,t,r){if(t.utf8seq===0){if(e<=127){r(e);return}for(let n=1;n<6;n+=1)if(!(e>>7-n&1)){t.utf8seq=n;break}if(t.utf8seq===2)t.codepoint=e&31;else if(t.utf8seq===3)t.codepoint=e&15;else if(t.utf8seq===4)t.codepoint=e&7;else throw new Error("Invalid UTF-8 sequence");t.utf8seq-=1}else if(t.utf8seq>0){if(e<=127)throw new Error("Invalid UTF-8 sequence");t.codepoint=t.codepoint<<6|e&63,t.utf8seq-=1,t.utf8seq===0&&r(t.codepoint)}}function BB(e){const t=[],r={queue:0,queuedBits:0},n=s=>{t.push(s)};for(let s=0;s<e.length;s+=1)UC(e.charCodeAt(s),r,n);return new Uint8Array(t)}function UB(e){const t=[];return LB(e,r=>t.push(r)),new Uint8Array(t)}function zB(e){const t=[],r={queue:0,queuedBits:0},n=s=>{t.push(s)};return e.forEach(s=>y2(s,r,n)),y2(null,r,n),t.join("")}function VB(e){return Math.round(Date.now()/1e3)+e}function WB(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(e){const t=Math.random()*16|0;return(e=="x"?t:t&3|8).toString(16)})}const Ls=()=>typeof window<"u"&&typeof document<"u",To={tested:!1,writable:!1},dd=()=>{if(!Ls())return!1;try{if(typeof globalThis.localStorage!="object")return!1}catch{return!1}if(To.tested)return To.writable;const e=`lswt-${Math.random()}${Math.random()}`;try{globalThis.localStorage.setItem(e,e),globalThis.localStorage.removeItem(e),To.tested=!0,To.writable=!0}catch{To.tested=!0,To.writable=!1}return To.writable};function HB(e){const t={},r=new URL(e);if(r.hash&&r.hash[0]==="#")try{new URLSearchParams(r.hash.substring(1)).forEach((s,a)=>{t[a]=s})}catch{}return r.searchParams.forEach((n,s)=>{t[s]=n}),t}const zC=e=>{let t;return e?t=e:typeof fetch>"u"?t=(...r)=>no(async()=>{const{default:n}=await Promise.resolve().then(()=>iu);return{default:n}},void 0).then(({default:n})=>n(...r)):t=fetch,(...r)=>t(...r)},GB=e=>typeof e=="object"&&e!==null&&"status"in e&&"ok"in e&&"json"in e&&typeof e.json=="function",VC=async(e,t,r)=>{await e.setItem(t,JSON.stringify(r))},Eh=async(e,t)=>{const r=await e.getItem(t);if(!r)return null;try{return JSON.parse(r)}catch{return r}},kh=async(e,t)=>{await e.removeItem(t)};class dp{constructor(){this.promise=new dp.promiseConstructor((t,r)=>{this.resolve=t,this.reject=r})}}dp.promiseConstructor=Promise;function zg(e){const t=e.split(".");if(t.length!==3)throw new ud("Invalid JWT structure");for(let n=0;n<t.length;n++)if(!AB.test(t[n]))throw new ud("JWT not in base64url format");return{header:JSON.parse(w2(t[0])),payload:JSON.parse(w2(t[1])),signature:BB(t[2]),raw:{header:t[0],payload:t[1]}}}async function qB(e){return await new Promise(t=>{setTimeout(()=>t(null),e)})}function YB(e,t){return new Promise((n,s)=>{(async()=>{for(let a=0;a<1/0;a++)try{const o=await e(a);if(!t(a,null,o)){n(o);return}}catch(o){if(!t(a,o)){s(o);return}}})()})}function KB(e){return("0"+e.toString(16)).substr(-2)}function XB(){const t=new Uint32Array(56);if(typeof crypto>"u"){const r="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-._~",n=r.length;let s="";for(let a=0;a<56;a++)s+=r.charAt(Math.floor(Math.random()*n));return s}return crypto.getRandomValues(t),Array.from(t,KB).join("")}async function QB(e){const r=new TextEncoder().encode(e),n=await crypto.subtle.digest("SHA-256",r),s=new Uint8Array(n);return Array.from(s).map(a=>String.fromCharCode(a)).join("")}async function JB(e){if(!(typeof crypto<"u"&&typeof crypto.subtle<"u"&&typeof TextEncoder<"u"))return console.warn("WebCrypto API is not supported. Code challenge method will default to use plain instead of sha256."),e;const r=await QB(e);return btoa(r).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}async function Dl(e,t,r=!1){const n=XB();let s=n;r&&(s+="/PASSWORD_RECOVERY"),await VC(e,`${t}-code-verifier`,s);const a=await JB(n);return[a,n===a?"plain":"s256"]}const ZB=/^2[0-9]{3}-(0[1-9]|1[0-2])-(0[1-9]|1[0-9]|2[0-9]|3[0-1])$/i;function e7(e){const t=e.headers.get(Wv);if(!t||!t.match(ZB))return null;try{return new Date(`${t}T00:00:00.0Z`)}catch{return null}}function t7(e){if(!e)throw new Error("Missing exp claim");const t=Math.floor(Date.now()/1e3);if(e<=t)throw new Error("JWT has expired")}function r7(e){switch(e){case"RS256":return{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}};case"ES256":return{name:"ECDSA",namedCurve:"P-256",hash:{name:"SHA-256"}};default:throw new Error("Invalid alg claim")}}const n7=/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/;function Rl(e){if(!n7.test(e))throw new Error("@supabase/auth-js: Expected parameter to be UUID but is not")}var s7=function(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,n=Object.getOwnPropertySymbols(e);s<n.length;s++)t.indexOf(n[s])<0&&Object.prototype.propertyIsEnumerable.call(e,n[s])&&(r[n[s]]=e[n[s]]);return r};const Do=e=>e.msg||e.message||e.error_description||e.error||JSON.stringify(e),a7=[502,503,504];async function _2(e){var t;if(!GB(e))throw new Hv(Do(e),0);if(a7.includes(e.status))throw new Hv(Do(e),e.status);let r;try{r=await e.json()}catch(a){throw new BC(Do(a),a)}let n;const s=e7(e);if(s&&s.getTime()>=$C["2024-01-01"].timestamp&&typeof r=="object"&&r&&typeof r.code=="string"?n=r.code:typeof r=="object"&&r&&typeof r.error_code=="string"&&(n=r.error_code),n){if(n==="weak_password")throw new x2(Do(r),e.status,((t=r.weak_password)===null||t===void 0?void 0:t.reasons)||[]);if(n==="session_not_found")throw new Ei}else if(typeof r=="object"&&r&&typeof r.weak_password=="object"&&r.weak_password&&Array.isArray(r.weak_password.reasons)&&r.weak_password.reasons.length&&r.weak_password.reasons.reduce((a,o)=>a&&typeof o=="string",!0))throw new x2(Do(r),e.status,r.weak_password.reasons);throw new DB(Do(r),e.status||500,n)}const i7=(e,t,r,n)=>{const s={method:e,headers:(t==null?void 0:t.headers)||{}};return e==="GET"?s:(s.headers=Object.assign({"Content-Type":"application/json;charset=UTF-8"},t==null?void 0:t.headers),s.body=JSON.stringify(n),Object.assign(Object.assign({},s),r))};async function wt(e,t,r,n){var s;const a=Object.assign({},n==null?void 0:n.headers);a[Wv]||(a[Wv]=$C["2024-01-01"].name),n!=null&&n.jwt&&(a.Authorization=`Bearer ${n.jwt}`);const o=(s=n==null?void 0:n.query)!==null&&s!==void 0?s:{};n!=null&&n.redirectTo&&(o.redirect_to=n.redirectTo);const l=Object.keys(o).length?"?"+new URLSearchParams(o).toString():"",c=await o7(e,t,r+l,{headers:a,noResolveJson:n==null?void 0:n.noResolveJson},{},n==null?void 0:n.body);return n!=null&&n.xform?n==null?void 0:n.xform(c):{data:Object.assign({},c),error:null}}async function o7(e,t,r,n,s,a){const o=i7(t,n,s,a);let l;try{l=await e(r,Object.assign({},o))}catch(c){throw console.error(c),new Hv(Do(c),0)}if(l.ok||await _2(l),n!=null&&n.noResolveJson)return l;try{return await l.json()}catch(c){await _2(c)}}function za(e){var t;let r=null;d7(e)&&(r=Object.assign({},e),e.expires_at||(r.expires_at=VB(e.expires_in)));const n=(t=e.user)!==null&&t!==void 0?t:e;return{data:{session:r,user:n},error:null}}function b2(e){const t=za(e);return!t.error&&e.weak_password&&typeof e.weak_password=="object"&&Array.isArray(e.weak_password.reasons)&&e.weak_password.reasons.length&&e.weak_password.message&&typeof e.weak_password.message=="string"&&e.weak_password.reasons.reduce((r,n)=>r&&typeof n=="string",!0)&&(t.data.weak_password=e.weak_password),t}function Ri(e){var t;return{data:{user:(t=e.user)!==null&&t!==void 0?t:e},error:null}}function l7(e){return{data:e,error:null}}function c7(e){const{action_link:t,email_otp:r,hashed_token:n,redirect_to:s,verification_type:a}=e,o=s7(e,["action_link","email_otp","hashed_token","redirect_to","verification_type"]),l={action_link:t,email_otp:r,hashed_token:n,redirect_to:s,verification_type:a},c=Object.assign({},o);return{data:{properties:l,user:c},error:null}}function u7(e){return e}function d7(e){return e.access_token&&e.refresh_token&&e.expires_in}const Vg=["global","local","others"];var f7=function(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,n=Object.getOwnPropertySymbols(e);s<n.length;s++)t.indexOf(n[s])<0&&Object.prototype.propertyIsEnumerable.call(e,n[s])&&(r[n[s]]=e[n[s]]);return r};class h7{constructor({url:t="",headers:r={},fetch:n}){this.url=t,this.headers=r,this.fetch=zC(n),this.mfa={listFactors:this._listFactors.bind(this),deleteFactor:this._deleteFactor.bind(this)}}async signOut(t,r=Vg[0]){if(Vg.indexOf(r)<0)throw new Error(`@supabase/auth-js: Parameter scope must be one of ${Vg.join(", ")}`);try{return await wt(this.fetch,"POST",`${this.url}/logout?scope=${r}`,{headers:this.headers,jwt:t,noResolveJson:!0}),{data:null,error:null}}catch(n){if(lt(n))return{data:null,error:n};throw n}}async inviteUserByEmail(t,r={}){try{return await wt(this.fetch,"POST",`${this.url}/invite`,{body:{email:t,data:r.data},headers:this.headers,redirectTo:r.redirectTo,xform:Ri})}catch(n){if(lt(n))return{data:{user:null},error:n};throw n}}async generateLink(t){try{const{options:r}=t,n=f7(t,["options"]),s=Object.assign(Object.assign({},n),r);return"newEmail"in n&&(s.new_email=n==null?void 0:n.newEmail,delete s.newEmail),await wt(this.fetch,"POST",`${this.url}/admin/generate_link`,{body:s,headers:this.headers,xform:c7,redirectTo:r==null?void 0:r.redirectTo})}catch(r){if(lt(r))return{data:{properties:null,user:null},error:r};throw r}}async createUser(t){try{return await wt(this.fetch,"POST",`${this.url}/admin/users`,{body:t,headers:this.headers,xform:Ri})}catch(r){if(lt(r))return{data:{user:null},error:r};throw r}}async listUsers(t){var r,n,s,a,o,l,c;try{const u={nextPage:null,lastPage:0,total:0},d=await wt(this.fetch,"GET",`${this.url}/admin/users`,{headers:this.headers,noResolveJson:!0,query:{page:(n=(r=t==null?void 0:t.page)===null||r===void 0?void 0:r.toString())!==null&&n!==void 0?n:"",per_page:(a=(s=t==null?void 0:t.perPage)===null||s===void 0?void 0:s.toString())!==null&&a!==void 0?a:""},xform:u7});if(d.error)throw d.error;const f=await d.json(),p=(o=d.headers.get("x-total-count"))!==null&&o!==void 0?o:0,h=(c=(l=d.headers.get("link"))===null||l===void 0?void 0:l.split(","))!==null&&c!==void 0?c:[];return h.length>0&&(h.forEach(g=>{const m=parseInt(g.split(";")[0].split("=")[1].substring(0,1)),x=JSON.parse(g.split(";")[1].split("=")[1]);u[`${x}Page`]=m}),u.total=parseInt(p)),{data:Object.assign(Object.assign({},f),u),error:null}}catch(u){if(lt(u))return{data:{users:[]},error:u};throw u}}async getUserById(t){Rl(t);try{return await wt(this.fetch,"GET",`${this.url}/admin/users/${t}`,{headers:this.headers,xform:Ri})}catch(r){if(lt(r))return{data:{user:null},error:r};throw r}}async updateUserById(t,r){Rl(t);try{return await wt(this.fetch,"PUT",`${this.url}/admin/users/${t}`,{body:r,headers:this.headers,xform:Ri})}catch(n){if(lt(n))return{data:{user:null},error:n};throw n}}async deleteUser(t,r=!1){Rl(t);try{return await wt(this.fetch,"DELETE",`${this.url}/admin/users/${t}`,{headers:this.headers,body:{should_soft_delete:r},xform:Ri})}catch(n){if(lt(n))return{data:{user:null},error:n};throw n}}async _listFactors(t){Rl(t.userId);try{const{data:r,error:n}=await wt(this.fetch,"GET",`${this.url}/admin/users/${t.userId}/factors`,{headers:this.headers,xform:s=>({data:{factors:s},error:null})});return{data:r,error:n}}catch(r){if(lt(r))return{data:null,error:r};throw r}}async _deleteFactor(t){Rl(t.userId),Rl(t.id);try{return{data:await wt(this.fetch,"DELETE",`${this.url}/admin/users/${t.userId}/factors/${t.id}`,{headers:this.headers}),error:null}}catch(r){if(lt(r))return{data:null,error:r};throw r}}}const m7={getItem:e=>dd()?globalThis.localStorage.getItem(e):null,setItem:(e,t)=>{dd()&&globalThis.localStorage.setItem(e,t)},removeItem:e=>{dd()&&globalThis.localStorage.removeItem(e)}};function S2(e={}){return{getItem:t=>e[t]||null,setItem:(t,r)=>{e[t]=r},removeItem:t=>{delete e[t]}}}function p7(){if(typeof globalThis!="object")try{Object.defineProperty(Object.prototype,"__magic__",{get:function(){return this},configurable:!0}),__magic__.globalThis=__magic__,delete Object.prototype.__magic__}catch{typeof self<"u"&&(self.globalThis=self)}}const Ml={debug:!!(globalThis&&dd()&&globalThis.localStorage&&globalThis.localStorage.getItem("supabase.gotrue-js.locks.debug")==="true")};class WC extends Error{constructor(t){super(t),this.isAcquireTimeout=!0}}class g7 extends WC{}async function x7(e,t,r){Ml.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquire lock",e,t);const n=new globalThis.AbortController;return t>0&&setTimeout(()=>{n.abort(),Ml.debug&&console.log("@supabase/gotrue-js: navigatorLock acquire timed out",e)},t),await Promise.resolve().then(()=>globalThis.navigator.locks.request(e,t===0?{mode:"exclusive",ifAvailable:!0}:{mode:"exclusive",signal:n.signal},async s=>{if(s){Ml.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquired",e,s.name);try{return await r()}finally{Ml.debug&&console.log("@supabase/gotrue-js: navigatorLock: released",e,s.name)}}else{if(t===0)throw Ml.debug&&console.log("@supabase/gotrue-js: navigatorLock: not immediately available",e),new g7(`Acquiring an exclusive Navigator LockManager lock "${e}" immediately failed`);if(Ml.debug)try{const a=await globalThis.navigator.locks.query();console.log("@supabase/gotrue-js: Navigator LockManager state",JSON.stringify(a,null,"  "))}catch(a){console.warn("@supabase/gotrue-js: Error when querying Navigator LockManager state",a)}return console.warn("@supabase/gotrue-js: Navigator LockManager returned a null lock when using #request without ifAvailable set to true, it appears this browser is not following the LockManager spec https://developer.mozilla.org/en-US/docs/Web/API/LockManager/request"),await r()}}))}p7();const v7={url:kB,storageKey:CB,autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,headers:TB,flowType:"implicit",debug:!1,hasCustomAuthorizationHeader:!1};async function N2(e,t,r){return await r()}class Gd{constructor(t){var r,n;this.memoryStorage=null,this.stateChangeEmitters=new Map,this.autoRefreshTicker=null,this.visibilityChangedCallback=null,this.refreshingDeferred=null,this.initializePromise=null,this.detectSessionInUrl=!0,this.hasCustomAuthorizationHeader=!1,this.suppressGetSessionWarning=!1,this.lockAcquired=!1,this.pendingInLock=[],this.broadcastChannel=null,this.logger=console.log,this.instanceID=Gd.nextInstanceID,Gd.nextInstanceID+=1,this.instanceID>0&&Ls()&&console.warn("Multiple GoTrueClient instances detected in the same browser context. It is not an error, but this should be avoided as it may produce undefined behavior when used concurrently under the same storage key.");const s=Object.assign(Object.assign({},v7),t);if(this.logDebugMessages=!!s.debug,typeof s.debug=="function"&&(this.logger=s.debug),this.persistSession=s.persistSession,this.storageKey=s.storageKey,this.autoRefreshToken=s.autoRefreshToken,this.admin=new h7({url:s.url,headers:s.headers,fetch:s.fetch}),this.url=s.url,this.headers=s.headers,this.fetch=zC(s.fetch),this.lock=s.lock||N2,this.detectSessionInUrl=s.detectSessionInUrl,this.flowType=s.flowType,this.hasCustomAuthorizationHeader=s.hasCustomAuthorizationHeader,s.lock?this.lock=s.lock:Ls()&&(!((r=globalThis==null?void 0:globalThis.navigator)===null||r===void 0)&&r.locks)?this.lock=x7:this.lock=N2,this.jwks={keys:[]},this.jwks_cached_at=Number.MIN_SAFE_INTEGER,this.mfa={verify:this._verify.bind(this),enroll:this._enroll.bind(this),unenroll:this._unenroll.bind(this),challenge:this._challenge.bind(this),listFactors:this._listFactors.bind(this),challengeAndVerify:this._challengeAndVerify.bind(this),getAuthenticatorAssuranceLevel:this._getAuthenticatorAssuranceLevel.bind(this)},this.persistSession?s.storage?this.storage=s.storage:dd()?this.storage=m7:(this.memoryStorage={},this.storage=S2(this.memoryStorage)):(this.memoryStorage={},this.storage=S2(this.memoryStorage)),Ls()&&globalThis.BroadcastChannel&&this.persistSession&&this.storageKey){try{this.broadcastChannel=new globalThis.BroadcastChannel(this.storageKey)}catch(a){console.error("Failed to create a new BroadcastChannel, multi-tab state changes will not be available",a)}(n=this.broadcastChannel)===null||n===void 0||n.addEventListener("message",async a=>{this._debug("received broadcast notification from other tab or client",a),await this._notifyAllSubscribers(a.data.event,a.data.session,!1)})}this.initialize()}_debug(...t){return this.logDebugMessages&&this.logger(`GoTrueClient@${this.instanceID} (${LC}) ${new Date().toISOString()}`,...t),this}async initialize(){return this.initializePromise?await this.initializePromise:(this.initializePromise=(async()=>await this._acquireLock(-1,async()=>await this._initialize()))(),await this.initializePromise)}async _initialize(){var t;try{const r=HB(window.location.href);let n="none";if(this._isImplicitGrantCallback(r)?n="implicit":await this._isPKCECallback(r)&&(n="pkce"),Ls()&&this.detectSessionInUrl&&n!=="none"){const{data:s,error:a}=await this._getSessionFromURL(r,n);if(a){if(this._debug("#_initialize()","error detecting session from URL",a),OB(a)){const c=(t=a.details)===null||t===void 0?void 0:t.code;if(c==="identity_already_exists"||c==="identity_not_found"||c==="single_identity_not_deletable")return{error:a}}return await this._removeSession(),{error:a}}const{session:o,redirectType:l}=s;return this._debug("#_initialize()","detected session in URL",o,"redirect type",l),await this._saveSession(o),setTimeout(async()=>{l==="recovery"?await this._notifyAllSubscribers("PASSWORD_RECOVERY",o):await this._notifyAllSubscribers("SIGNED_IN",o)},0),{error:null}}return await this._recoverAndRefresh(),{error:null}}catch(r){return lt(r)?{error:r}:{error:new BC("Unexpected error during initialization",r)}}finally{await this._handleVisibilityChange(),this._debug("#_initialize()","end")}}async signInAnonymously(t){var r,n,s;try{const a=await wt(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{data:(n=(r=t==null?void 0:t.options)===null||r===void 0?void 0:r.data)!==null&&n!==void 0?n:{},gotrue_meta_security:{captcha_token:(s=t==null?void 0:t.options)===null||s===void 0?void 0:s.captchaToken}},xform:za}),{data:o,error:l}=a;if(l||!o)return{data:{user:null,session:null},error:l};const c=o.session,u=o.user;return o.session&&(await this._saveSession(o.session),await this._notifyAllSubscribers("SIGNED_IN",c)),{data:{user:u,session:c},error:null}}catch(a){if(lt(a))return{data:{user:null,session:null},error:a};throw a}}async signUp(t){var r,n,s;try{let a;if("email"in t){const{email:d,password:f,options:p}=t;let h=null,g=null;this.flowType==="pkce"&&([h,g]=await Dl(this.storage,this.storageKey)),a=await wt(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,redirectTo:p==null?void 0:p.emailRedirectTo,body:{email:d,password:f,data:(r=p==null?void 0:p.data)!==null&&r!==void 0?r:{},gotrue_meta_security:{captcha_token:p==null?void 0:p.captchaToken},code_challenge:h,code_challenge_method:g},xform:za})}else if("phone"in t){const{phone:d,password:f,options:p}=t;a=await wt(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{phone:d,password:f,data:(n=p==null?void 0:p.data)!==null&&n!==void 0?n:{},channel:(s=p==null?void 0:p.channel)!==null&&s!==void 0?s:"sms",gotrue_meta_security:{captcha_token:p==null?void 0:p.captchaToken}},xform:za})}else throw new Nh("You must provide either an email or phone number and a password");const{data:o,error:l}=a;if(l||!o)return{data:{user:null,session:null},error:l};const c=o.session,u=o.user;return o.session&&(await this._saveSession(o.session),await this._notifyAllSubscribers("SIGNED_IN",c)),{data:{user:u,session:c},error:null}}catch(a){if(lt(a))return{data:{user:null,session:null},error:a};throw a}}async signInWithPassword(t){try{let r;if("email"in t){const{email:a,password:o,options:l}=t;r=await wt(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{email:a,password:o,gotrue_meta_security:{captcha_token:l==null?void 0:l.captchaToken}},xform:b2})}else if("phone"in t){const{phone:a,password:o,options:l}=t;r=await wt(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{phone:a,password:o,gotrue_meta_security:{captcha_token:l==null?void 0:l.captchaToken}},xform:b2})}else throw new Nh("You must provide either an email or phone number and a password");const{data:n,error:s}=r;return s?{data:{user:null,session:null},error:s}:!n||!n.session||!n.user?{data:{user:null,session:null},error:new Sh}:(n.session&&(await this._saveSession(n.session),await this._notifyAllSubscribers("SIGNED_IN",n.session)),{data:Object.assign({user:n.user,session:n.session},n.weak_password?{weakPassword:n.weak_password}:null),error:s})}catch(r){if(lt(r))return{data:{user:null,session:null},error:r};throw r}}async signInWithOAuth(t){var r,n,s,a;return await this._handleProviderSignIn(t.provider,{redirectTo:(r=t.options)===null||r===void 0?void 0:r.redirectTo,scopes:(n=t.options)===null||n===void 0?void 0:n.scopes,queryParams:(s=t.options)===null||s===void 0?void 0:s.queryParams,skipBrowserRedirect:(a=t.options)===null||a===void 0?void 0:a.skipBrowserRedirect})}async exchangeCodeForSession(t){return await this.initializePromise,this._acquireLock(-1,async()=>this._exchangeCodeForSession(t))}async signInWithWeb3(t){const{chain:r}=t;if(r==="solana")return await this.signInWithSolana(t);throw new Error(`@supabase/auth-js: Unsupported chain "${r}"`)}async signInWithSolana(t){var r,n,s,a,o,l,c,u,d,f,p,h;let g,m;if("message"in t)g=t.message,m=t.signature;else{const{chain:x,wallet:w,statement:v,options:_}=t;let b;if(Ls())if(typeof w=="object")b=w;else{const T=window;if("solana"in T&&typeof T.solana=="object"&&("signIn"in T.solana&&typeof T.solana.signIn=="function"||"signMessage"in T.solana&&typeof T.solana.signMessage=="function"))b=T.solana;else throw new Error("@supabase/auth-js: No compatible Solana wallet interface on the window object (window.solana) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'solana', wallet: resolvedUserWallet }) instead.")}else{if(typeof w!="object"||!(_!=null&&_.url))throw new Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");b=w}const S=new URL((r=_==null?void 0:_.url)!==null&&r!==void 0?r:window.location.href);if("signIn"in b&&b.signIn){const T=await b.signIn(Object.assign(Object.assign(Object.assign({issuedAt:new Date().toISOString()},_==null?void 0:_.signInWithSolana),{version:"1",domain:S.host,uri:S.href}),v?{statement:v}:null));let N;if(Array.isArray(T)&&T[0]&&typeof T[0]=="object")N=T[0];else if(T&&typeof T=="object"&&"signedMessage"in T&&"signature"in T)N=T;else throw new Error("@supabase/auth-js: Wallet method signIn() returned unrecognized value");if("signedMessage"in N&&"signature"in N&&(typeof N.signedMessage=="string"||N.signedMessage instanceof Uint8Array)&&N.signature instanceof Uint8Array)g=typeof N.signedMessage=="string"?N.signedMessage:new TextDecoder().decode(N.signedMessage),m=N.signature;else throw new Error("@supabase/auth-js: Wallet method signIn() API returned object without signedMessage and signature fields")}else{if(!("signMessage"in b)||typeof b.signMessage!="function"||!("publicKey"in b)||typeof b!="object"||!b.publicKey||!("toBase58"in b.publicKey)||typeof b.publicKey.toBase58!="function")throw new Error("@supabase/auth-js: Wallet does not have a compatible signMessage() and publicKey.toBase58() API");g=[`${S.host} wants you to sign in with your Solana account:`,b.publicKey.toBase58(),...v?["",v,""]:[""],"Version: 1",`URI: ${S.href}`,`Issued At: ${(s=(n=_==null?void 0:_.signInWithSolana)===null||n===void 0?void 0:n.issuedAt)!==null&&s!==void 0?s:new Date().toISOString()}`,...!((a=_==null?void 0:_.signInWithSolana)===null||a===void 0)&&a.notBefore?[`Not Before: ${_.signInWithSolana.notBefore}`]:[],...!((o=_==null?void 0:_.signInWithSolana)===null||o===void 0)&&o.expirationTime?[`Expiration Time: ${_.signInWithSolana.expirationTime}`]:[],...!((l=_==null?void 0:_.signInWithSolana)===null||l===void 0)&&l.chainId?[`Chain ID: ${_.signInWithSolana.chainId}`]:[],...!((c=_==null?void 0:_.signInWithSolana)===null||c===void 0)&&c.nonce?[`Nonce: ${_.signInWithSolana.nonce}`]:[],...!((u=_==null?void 0:_.signInWithSolana)===null||u===void 0)&&u.requestId?[`Request ID: ${_.signInWithSolana.requestId}`]:[],...!((f=(d=_==null?void 0:_.signInWithSolana)===null||d===void 0?void 0:d.resources)===null||f===void 0)&&f.length?["Resources",..._.signInWithSolana.resources.map(N=>`- ${N}`)]:[]].join(`
`);const T=await b.signMessage(new TextEncoder().encode(g),"utf8");if(!T||!(T instanceof Uint8Array))throw new Error("@supabase/auth-js: Wallet signMessage() API returned an recognized value");m=T}}try{const{data:x,error:w}=await wt(this.fetch,"POST",`${this.url}/token?grant_type=web3`,{headers:this.headers,body:Object.assign({chain:"solana",message:g,signature:zB(m)},!((p=t.options)===null||p===void 0)&&p.captchaToken?{gotrue_meta_security:{captcha_token:(h=t.options)===null||h===void 0?void 0:h.captchaToken}}:null),xform:za});if(w)throw w;return!x||!x.session||!x.user?{data:{user:null,session:null},error:new Sh}:(x.session&&(await this._saveSession(x.session),await this._notifyAllSubscribers("SIGNED_IN",x.session)),{data:Object.assign({},x),error:w})}catch(x){if(lt(x))return{data:{user:null,session:null},error:x};throw x}}async _exchangeCodeForSession(t){const r=await Eh(this.storage,`${this.storageKey}-code-verifier`),[n,s]=(r??"").split("/");try{const{data:a,error:o}=await wt(this.fetch,"POST",`${this.url}/token?grant_type=pkce`,{headers:this.headers,body:{auth_code:t,code_verifier:n},xform:za});if(await kh(this.storage,`${this.storageKey}-code-verifier`),o)throw o;return!a||!a.session||!a.user?{data:{user:null,session:null,redirectType:null},error:new Sh}:(a.session&&(await this._saveSession(a.session),await this._notifyAllSubscribers("SIGNED_IN",a.session)),{data:Object.assign(Object.assign({},a),{redirectType:s??null}),error:o})}catch(a){if(lt(a))return{data:{user:null,session:null,redirectType:null},error:a};throw a}}async signInWithIdToken(t){try{const{options:r,provider:n,token:s,access_token:a,nonce:o}=t,l=await wt(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,body:{provider:n,id_token:s,access_token:a,nonce:o,gotrue_meta_security:{captcha_token:r==null?void 0:r.captchaToken}},xform:za}),{data:c,error:u}=l;return u?{data:{user:null,session:null},error:u}:!c||!c.session||!c.user?{data:{user:null,session:null},error:new Sh}:(c.session&&(await this._saveSession(c.session),await this._notifyAllSubscribers("SIGNED_IN",c.session)),{data:c,error:u})}catch(r){if(lt(r))return{data:{user:null,session:null},error:r};throw r}}async signInWithOtp(t){var r,n,s,a,o;try{if("email"in t){const{email:l,options:c}=t;let u=null,d=null;this.flowType==="pkce"&&([u,d]=await Dl(this.storage,this.storageKey));const{error:f}=await wt(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{email:l,data:(r=c==null?void 0:c.data)!==null&&r!==void 0?r:{},create_user:(n=c==null?void 0:c.shouldCreateUser)!==null&&n!==void 0?n:!0,gotrue_meta_security:{captcha_token:c==null?void 0:c.captchaToken},code_challenge:u,code_challenge_method:d},redirectTo:c==null?void 0:c.emailRedirectTo});return{data:{user:null,session:null},error:f}}if("phone"in t){const{phone:l,options:c}=t,{data:u,error:d}=await wt(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{phone:l,data:(s=c==null?void 0:c.data)!==null&&s!==void 0?s:{},create_user:(a=c==null?void 0:c.shouldCreateUser)!==null&&a!==void 0?a:!0,gotrue_meta_security:{captcha_token:c==null?void 0:c.captchaToken},channel:(o=c==null?void 0:c.channel)!==null&&o!==void 0?o:"sms"}});return{data:{user:null,session:null,messageId:u==null?void 0:u.message_id},error:d}}throw new Nh("You must provide either an email or phone number.")}catch(l){if(lt(l))return{data:{user:null,session:null},error:l};throw l}}async verifyOtp(t){var r,n;try{let s,a;"options"in t&&(s=(r=t.options)===null||r===void 0?void 0:r.redirectTo,a=(n=t.options)===null||n===void 0?void 0:n.captchaToken);const{data:o,error:l}=await wt(this.fetch,"POST",`${this.url}/verify`,{headers:this.headers,body:Object.assign(Object.assign({},t),{gotrue_meta_security:{captcha_token:a}}),redirectTo:s,xform:za});if(l)throw l;if(!o)throw new Error("An error occurred on token verification.");const c=o.session,u=o.user;return c!=null&&c.access_token&&(await this._saveSession(c),await this._notifyAllSubscribers(t.type=="recovery"?"PASSWORD_RECOVERY":"SIGNED_IN",c)),{data:{user:u,session:c},error:null}}catch(s){if(lt(s))return{data:{user:null,session:null},error:s};throw s}}async signInWithSSO(t){var r,n,s;try{let a=null,o=null;return this.flowType==="pkce"&&([a,o]=await Dl(this.storage,this.storageKey)),await wt(this.fetch,"POST",`${this.url}/sso`,{body:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},"providerId"in t?{provider_id:t.providerId}:null),"domain"in t?{domain:t.domain}:null),{redirect_to:(n=(r=t.options)===null||r===void 0?void 0:r.redirectTo)!==null&&n!==void 0?n:void 0}),!((s=t==null?void 0:t.options)===null||s===void 0)&&s.captchaToken?{gotrue_meta_security:{captcha_token:t.options.captchaToken}}:null),{skip_http_redirect:!0,code_challenge:a,code_challenge_method:o}),headers:this.headers,xform:l7})}catch(a){if(lt(a))return{data:null,error:a};throw a}}async reauthenticate(){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._reauthenticate())}async _reauthenticate(){try{return await this._useSession(async t=>{const{data:{session:r},error:n}=t;if(n)throw n;if(!r)throw new Ei;const{error:s}=await wt(this.fetch,"GET",`${this.url}/reauthenticate`,{headers:this.headers,jwt:r.access_token});return{data:{user:null,session:null},error:s}})}catch(t){if(lt(t))return{data:{user:null,session:null},error:t};throw t}}async resend(t){try{const r=`${this.url}/resend`;if("email"in t){const{email:n,type:s,options:a}=t,{error:o}=await wt(this.fetch,"POST",r,{headers:this.headers,body:{email:n,type:s,gotrue_meta_security:{captcha_token:a==null?void 0:a.captchaToken}},redirectTo:a==null?void 0:a.emailRedirectTo});return{data:{user:null,session:null},error:o}}else if("phone"in t){const{phone:n,type:s,options:a}=t,{data:o,error:l}=await wt(this.fetch,"POST",r,{headers:this.headers,body:{phone:n,type:s,gotrue_meta_security:{captcha_token:a==null?void 0:a.captchaToken}}});return{data:{user:null,session:null,messageId:o==null?void 0:o.message_id},error:l}}throw new Nh("You must provide either an email or phone number and a type")}catch(r){if(lt(r))return{data:{user:null,session:null},error:r};throw r}}async getSession(){return await this.initializePromise,await this._acquireLock(-1,async()=>this._useSession(async r=>r))}async _acquireLock(t,r){this._debug("#_acquireLock","begin",t);try{if(this.lockAcquired){const n=this.pendingInLock.length?this.pendingInLock[this.pendingInLock.length-1]:Promise.resolve(),s=(async()=>(await n,await r()))();return this.pendingInLock.push((async()=>{try{await s}catch{}})()),s}return await this.lock(`lock:${this.storageKey}`,t,async()=>{this._debug("#_acquireLock","lock acquired for storage key",this.storageKey);try{this.lockAcquired=!0;const n=r();for(this.pendingInLock.push((async()=>{try{await n}catch{}})()),await n;this.pendingInLock.length;){const s=[...this.pendingInLock];await Promise.all(s),this.pendingInLock.splice(0,s.length)}return await n}finally{this._debug("#_acquireLock","lock released for storage key",this.storageKey),this.lockAcquired=!1}})}finally{this._debug("#_acquireLock","end")}}async _useSession(t){this._debug("#_useSession","begin");try{const r=await this.__loadSession();return await t(r)}finally{this._debug("#_useSession","end")}}async __loadSession(){this._debug("#__loadSession()","begin"),this.lockAcquired||this._debug("#__loadSession()","used outside of an acquired lock!",new Error().stack);try{let t=null;const r=await Eh(this.storage,this.storageKey);if(this._debug("#getSession()","session from storage",r),r!==null&&(this._isValidSession(r)?t=r:(this._debug("#getSession()","session from storage is not valid"),await this._removeSession())),!t)return{data:{session:null},error:null};const n=t.expires_at?t.expires_at*1e3-Date.now()<Bg:!1;if(this._debug("#__loadSession()",`session has${n?"":" not"} expired`,"expires_at",t.expires_at),!n){if(this.storage.isServer){let o=this.suppressGetSessionWarning;t=new Proxy(t,{get:(c,u,d)=>(!o&&u==="user"&&(console.warn("Using the user object as returned from supabase.auth.getSession() or from some supabase.auth.onAuthStateChange() events could be insecure! This value comes directly from the storage medium (usually cookies on the server) and may not be authentic. Use supabase.auth.getUser() instead which authenticates the data by contacting the Supabase Auth server."),o=!0,this.suppressGetSessionWarning=!0),Reflect.get(c,u,d))})}return{data:{session:t},error:null}}const{session:s,error:a}=await this._callRefreshToken(t.refresh_token);return a?{data:{session:null},error:a}:{data:{session:s},error:null}}finally{this._debug("#__loadSession()","end")}}async getUser(t){return t?await this._getUser(t):(await this.initializePromise,await this._acquireLock(-1,async()=>await this._getUser()))}async _getUser(t){try{return t?await wt(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:t,xform:Ri}):await this._useSession(async r=>{var n,s,a;const{data:o,error:l}=r;if(l)throw l;return!(!((n=o.session)===null||n===void 0)&&n.access_token)&&!this.hasCustomAuthorizationHeader?{data:{user:null},error:new Ei}:await wt(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:(a=(s=o.session)===null||s===void 0?void 0:s.access_token)!==null&&a!==void 0?a:void 0,xform:Ri})})}catch(r){if(lt(r))return MB(r)&&(await this._removeSession(),await kh(this.storage,`${this.storageKey}-code-verifier`)),{data:{user:null},error:r};throw r}}async updateUser(t,r={}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._updateUser(t,r))}async _updateUser(t,r={}){try{return await this._useSession(async n=>{const{data:s,error:a}=n;if(a)throw a;if(!s.session)throw new Ei;const o=s.session;let l=null,c=null;this.flowType==="pkce"&&t.email!=null&&([l,c]=await Dl(this.storage,this.storageKey));const{data:u,error:d}=await wt(this.fetch,"PUT",`${this.url}/user`,{headers:this.headers,redirectTo:r==null?void 0:r.emailRedirectTo,body:Object.assign(Object.assign({},t),{code_challenge:l,code_challenge_method:c}),jwt:o.access_token,xform:Ri});if(d)throw d;return o.user=u.user,await this._saveSession(o),await this._notifyAllSubscribers("USER_UPDATED",o),{data:{user:o.user},error:null}})}catch(n){if(lt(n))return{data:{user:null},error:n};throw n}}async setSession(t){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._setSession(t))}async _setSession(t){try{if(!t.access_token||!t.refresh_token)throw new Ei;const r=Date.now()/1e3;let n=r,s=!0,a=null;const{payload:o}=zg(t.access_token);if(o.exp&&(n=o.exp,s=n<=r),s){const{session:l,error:c}=await this._callRefreshToken(t.refresh_token);if(c)return{data:{user:null,session:null},error:c};if(!l)return{data:{user:null,session:null},error:null};a=l}else{const{data:l,error:c}=await this._getUser(t.access_token);if(c)throw c;a={access_token:t.access_token,refresh_token:t.refresh_token,user:l.user,token_type:"bearer",expires_in:n-r,expires_at:n},await this._saveSession(a),await this._notifyAllSubscribers("SIGNED_IN",a)}return{data:{user:a.user,session:a},error:null}}catch(r){if(lt(r))return{data:{session:null,user:null},error:r};throw r}}async refreshSession(t){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._refreshSession(t))}async _refreshSession(t){try{return await this._useSession(async r=>{var n;if(!t){const{data:o,error:l}=r;if(l)throw l;t=(n=o.session)!==null&&n!==void 0?n:void 0}if(!(t!=null&&t.refresh_token))throw new Ei;const{session:s,error:a}=await this._callRefreshToken(t.refresh_token);return a?{data:{user:null,session:null},error:a}:s?{data:{user:s.user,session:s},error:null}:{data:{user:null,session:null},error:null}})}catch(r){if(lt(r))return{data:{user:null,session:null},error:r};throw r}}async _getSessionFromURL(t,r){try{if(!Ls())throw new jh("No browser detected.");if(t.error||t.error_description||t.error_code)throw new jh(t.error_description||"Error in URL with unspecified error_description",{error:t.error||"unspecified_error",code:t.error_code||"unspecified_code"});switch(r){case"implicit":if(this.flowType==="pkce")throw new g2("Not a valid PKCE flow url.");break;case"pkce":if(this.flowType==="implicit")throw new jh("Not a valid implicit grant flow url.");break;default:}if(r==="pkce"){if(this._debug("#_initialize()","begin","is PKCE flow",!0),!t.code)throw new g2("No code detected.");const{data:v,error:_}=await this._exchangeCodeForSession(t.code);if(_)throw _;const b=new URL(window.location.href);return b.searchParams.delete("code"),window.history.replaceState(window.history.state,"",b.toString()),{data:{session:v.session,redirectType:null},error:null}}const{provider_token:n,provider_refresh_token:s,access_token:a,refresh_token:o,expires_in:l,expires_at:c,token_type:u}=t;if(!a||!l||!o||!u)throw new jh("No session defined in URL");const d=Math.round(Date.now()/1e3),f=parseInt(l);let p=d+f;c&&(p=parseInt(c));const h=p-d;h*1e3<=Vl&&console.warn(`@supabase/gotrue-js: Session as retrieved from URL expires in ${h}s, should have been closer to ${f}s`);const g=p-f;d-g>=120?console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued over 120s ago, URL could be stale",g,p,d):d-g<0&&console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued in the future? Check the device clock for skew",g,p,d);const{data:m,error:x}=await this._getUser(a);if(x)throw x;const w={provider_token:n,provider_refresh_token:s,access_token:a,expires_in:f,expires_at:p,refresh_token:o,token_type:u,user:m.user};return window.location.hash="",this._debug("#_getSessionFromURL()","clearing window.location.hash"),{data:{session:w,redirectType:t.type},error:null}}catch(n){if(lt(n))return{data:{session:null,redirectType:null},error:n};throw n}}_isImplicitGrantCallback(t){return!!(t.access_token||t.error_description)}async _isPKCECallback(t){const r=await Eh(this.storage,`${this.storageKey}-code-verifier`);return!!(t.code&&r)}async signOut(t={scope:"global"}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._signOut(t))}async _signOut({scope:t}={scope:"global"}){return await this._useSession(async r=>{var n;const{data:s,error:a}=r;if(a)return{error:a};const o=(n=s.session)===null||n===void 0?void 0:n.access_token;if(o){const{error:l}=await this.admin.signOut(o,t);if(l&&!(RB(l)&&(l.status===404||l.status===401||l.status===403)))return{error:l}}return t!=="others"&&(await this._removeSession(),await kh(this.storage,`${this.storageKey}-code-verifier`)),{error:null}})}onAuthStateChange(t){const r=WB(),n={id:r,callback:t,unsubscribe:()=>{this._debug("#unsubscribe()","state change callback with id removed",r),this.stateChangeEmitters.delete(r)}};return this._debug("#onAuthStateChange()","registered callback with id",r),this.stateChangeEmitters.set(r,n),(async()=>(await this.initializePromise,await this._acquireLock(-1,async()=>{this._emitInitialSession(r)})))(),{data:{subscription:n}}}async _emitInitialSession(t){return await this._useSession(async r=>{var n,s;try{const{data:{session:a},error:o}=r;if(o)throw o;await((n=this.stateChangeEmitters.get(t))===null||n===void 0?void 0:n.callback("INITIAL_SESSION",a)),this._debug("INITIAL_SESSION","callback id",t,"session",a)}catch(a){await((s=this.stateChangeEmitters.get(t))===null||s===void 0?void 0:s.callback("INITIAL_SESSION",null)),this._debug("INITIAL_SESSION","callback id",t,"error",a),console.error(a)}})}async resetPasswordForEmail(t,r={}){let n=null,s=null;this.flowType==="pkce"&&([n,s]=await Dl(this.storage,this.storageKey,!0));try{return await wt(this.fetch,"POST",`${this.url}/recover`,{body:{email:t,code_challenge:n,code_challenge_method:s,gotrue_meta_security:{captcha_token:r.captchaToken}},headers:this.headers,redirectTo:r.redirectTo})}catch(a){if(lt(a))return{data:null,error:a};throw a}}async getUserIdentities(){var t;try{const{data:r,error:n}=await this.getUser();if(n)throw n;return{data:{identities:(t=r.user.identities)!==null&&t!==void 0?t:[]},error:null}}catch(r){if(lt(r))return{data:null,error:r};throw r}}async linkIdentity(t){var r;try{const{data:n,error:s}=await this._useSession(async a=>{var o,l,c,u,d;const{data:f,error:p}=a;if(p)throw p;const h=await this._getUrlForProvider(`${this.url}/user/identities/authorize`,t.provider,{redirectTo:(o=t.options)===null||o===void 0?void 0:o.redirectTo,scopes:(l=t.options)===null||l===void 0?void 0:l.scopes,queryParams:(c=t.options)===null||c===void 0?void 0:c.queryParams,skipBrowserRedirect:!0});return await wt(this.fetch,"GET",h,{headers:this.headers,jwt:(d=(u=f.session)===null||u===void 0?void 0:u.access_token)!==null&&d!==void 0?d:void 0})});if(s)throw s;return Ls()&&!(!((r=t.options)===null||r===void 0)&&r.skipBrowserRedirect)&&window.location.assign(n==null?void 0:n.url),{data:{provider:t.provider,url:n==null?void 0:n.url},error:null}}catch(n){if(lt(n))return{data:{provider:t.provider,url:null},error:n};throw n}}async unlinkIdentity(t){try{return await this._useSession(async r=>{var n,s;const{data:a,error:o}=r;if(o)throw o;return await wt(this.fetch,"DELETE",`${this.url}/user/identities/${t.identity_id}`,{headers:this.headers,jwt:(s=(n=a.session)===null||n===void 0?void 0:n.access_token)!==null&&s!==void 0?s:void 0})})}catch(r){if(lt(r))return{data:null,error:r};throw r}}async _refreshAccessToken(t){const r=`#_refreshAccessToken(${t.substring(0,5)}...)`;this._debug(r,"begin");try{const n=Date.now();return await YB(async s=>(s>0&&await qB(200*Math.pow(2,s-1)),this._debug(r,"refreshing attempt",s),await wt(this.fetch,"POST",`${this.url}/token?grant_type=refresh_token`,{body:{refresh_token:t},headers:this.headers,xform:za})),(s,a)=>{const o=200*Math.pow(2,s);return a&&Ug(a)&&Date.now()+o-n<Vl})}catch(n){if(this._debug(r,"error",n),lt(n))return{data:{session:null,user:null},error:n};throw n}finally{this._debug(r,"end")}}_isValidSession(t){return typeof t=="object"&&t!==null&&"access_token"in t&&"refresh_token"in t&&"expires_at"in t}async _handleProviderSignIn(t,r){const n=await this._getUrlForProvider(`${this.url}/authorize`,t,{redirectTo:r.redirectTo,scopes:r.scopes,queryParams:r.queryParams});return this._debug("#_handleProviderSignIn()","provider",t,"options",r,"url",n),Ls()&&!r.skipBrowserRedirect&&window.location.assign(n),{data:{provider:t,url:n},error:null}}async _recoverAndRefresh(){var t;const r="#_recoverAndRefresh()";this._debug(r,"begin");try{const n=await Eh(this.storage,this.storageKey);if(this._debug(r,"session from storage",n),!this._isValidSession(n)){this._debug(r,"session is not valid"),n!==null&&await this._removeSession();return}const s=((t=n.expires_at)!==null&&t!==void 0?t:1/0)*1e3-Date.now()<Bg;if(this._debug(r,`session has${s?"":" not"} expired with margin of ${Bg}s`),s){if(this.autoRefreshToken&&n.refresh_token){const{error:a}=await this._callRefreshToken(n.refresh_token);a&&(console.error(a),Ug(a)||(this._debug(r,"refresh failed with a non-retryable error, removing the session",a),await this._removeSession()))}}else await this._notifyAllSubscribers("SIGNED_IN",n)}catch(n){this._debug(r,"error",n),console.error(n);return}finally{this._debug(r,"end")}}async _callRefreshToken(t){var r,n;if(!t)throw new Ei;if(this.refreshingDeferred)return this.refreshingDeferred.promise;const s=`#_callRefreshToken(${t.substring(0,5)}...)`;this._debug(s,"begin");try{this.refreshingDeferred=new dp;const{data:a,error:o}=await this._refreshAccessToken(t);if(o)throw o;if(!a.session)throw new Ei;await this._saveSession(a.session),await this._notifyAllSubscribers("TOKEN_REFRESHED",a.session);const l={session:a.session,error:null};return this.refreshingDeferred.resolve(l),l}catch(a){if(this._debug(s,"error",a),lt(a)){const o={session:null,error:a};return Ug(a)||await this._removeSession(),(r=this.refreshingDeferred)===null||r===void 0||r.resolve(o),o}throw(n=this.refreshingDeferred)===null||n===void 0||n.reject(a),a}finally{this.refreshingDeferred=null,this._debug(s,"end")}}async _notifyAllSubscribers(t,r,n=!0){const s=`#_notifyAllSubscribers(${t})`;this._debug(s,"begin",r,`broadcast = ${n}`);try{this.broadcastChannel&&n&&this.broadcastChannel.postMessage({event:t,session:r});const a=[],o=Array.from(this.stateChangeEmitters.values()).map(async l=>{try{await l.callback(t,r)}catch(c){a.push(c)}});if(await Promise.all(o),a.length>0){for(let l=0;l<a.length;l+=1)console.error(a[l]);throw a[0]}}finally{this._debug(s,"end")}}async _saveSession(t){this._debug("#_saveSession()",t),this.suppressGetSessionWarning=!0,await VC(this.storage,this.storageKey,t)}async _removeSession(){this._debug("#_removeSession()"),await kh(this.storage,this.storageKey),await this._notifyAllSubscribers("SIGNED_OUT",null)}_removeVisibilityChangedCallback(){this._debug("#_removeVisibilityChangedCallback()");const t=this.visibilityChangedCallback;this.visibilityChangedCallback=null;try{t&&Ls()&&(window!=null&&window.removeEventListener)&&window.removeEventListener("visibilitychange",t)}catch(r){console.error("removing visibilitychange callback failed",r)}}async _startAutoRefresh(){await this._stopAutoRefresh(),this._debug("#_startAutoRefresh()");const t=setInterval(()=>this._autoRefreshTokenTick(),Vl);this.autoRefreshTicker=t,t&&typeof t=="object"&&typeof t.unref=="function"?t.unref():typeof Deno<"u"&&typeof Deno.unrefTimer=="function"&&Deno.unrefTimer(t),setTimeout(async()=>{await this.initializePromise,await this._autoRefreshTokenTick()},0)}async _stopAutoRefresh(){this._debug("#_stopAutoRefresh()");const t=this.autoRefreshTicker;this.autoRefreshTicker=null,t&&clearInterval(t)}async startAutoRefresh(){this._removeVisibilityChangedCallback(),await this._startAutoRefresh()}async stopAutoRefresh(){this._removeVisibilityChangedCallback(),await this._stopAutoRefresh()}async _autoRefreshTokenTick(){this._debug("#_autoRefreshTokenTick()","begin");try{await this._acquireLock(0,async()=>{try{const t=Date.now();try{return await this._useSession(async r=>{const{data:{session:n}}=r;if(!n||!n.refresh_token||!n.expires_at){this._debug("#_autoRefreshTokenTick()","no session");return}const s=Math.floor((n.expires_at*1e3-t)/Vl);this._debug("#_autoRefreshTokenTick()",`access token expires in ${s} ticks, a tick lasts ${Vl}ms, refresh threshold is ${Vv} ticks`),s<=Vv&&await this._callRefreshToken(n.refresh_token)})}catch(r){console.error("Auto refresh tick failed with error. This is likely a transient error.",r)}}finally{this._debug("#_autoRefreshTokenTick()","end")}})}catch(t){if(t.isAcquireTimeout||t instanceof WC)this._debug("auto refresh token tick lock not available");else throw t}}async _handleVisibilityChange(){if(this._debug("#_handleVisibilityChange()"),!Ls()||!(window!=null&&window.addEventListener))return this.autoRefreshToken&&this.startAutoRefresh(),!1;try{this.visibilityChangedCallback=async()=>await this._onVisibilityChanged(!1),window==null||window.addEventListener("visibilitychange",this.visibilityChangedCallback),await this._onVisibilityChanged(!0)}catch(t){console.error("_handleVisibilityChange",t)}}async _onVisibilityChanged(t){const r=`#_onVisibilityChanged(${t})`;this._debug(r,"visibilityState",document.visibilityState),document.visibilityState==="visible"?(this.autoRefreshToken&&this._startAutoRefresh(),t||(await this.initializePromise,await this._acquireLock(-1,async()=>{if(document.visibilityState!=="visible"){this._debug(r,"acquired the lock to recover the session, but the browser visibilityState is no longer visible, aborting");return}await this._recoverAndRefresh()}))):document.visibilityState==="hidden"&&this.autoRefreshToken&&this._stopAutoRefresh()}async _getUrlForProvider(t,r,n){const s=[`provider=${encodeURIComponent(r)}`];if(n!=null&&n.redirectTo&&s.push(`redirect_to=${encodeURIComponent(n.redirectTo)}`),n!=null&&n.scopes&&s.push(`scopes=${encodeURIComponent(n.scopes)}`),this.flowType==="pkce"){const[a,o]=await Dl(this.storage,this.storageKey),l=new URLSearchParams({code_challenge:`${encodeURIComponent(a)}`,code_challenge_method:`${encodeURIComponent(o)}`});s.push(l.toString())}if(n!=null&&n.queryParams){const a=new URLSearchParams(n.queryParams);s.push(a.toString())}return n!=null&&n.skipBrowserRedirect&&s.push(`skip_http_redirect=${n.skipBrowserRedirect}`),`${t}?${s.join("&")}`}async _unenroll(t){try{return await this._useSession(async r=>{var n;const{data:s,error:a}=r;return a?{data:null,error:a}:await wt(this.fetch,"DELETE",`${this.url}/factors/${t.factorId}`,{headers:this.headers,jwt:(n=s==null?void 0:s.session)===null||n===void 0?void 0:n.access_token})})}catch(r){if(lt(r))return{data:null,error:r};throw r}}async _enroll(t){try{return await this._useSession(async r=>{var n,s;const{data:a,error:o}=r;if(o)return{data:null,error:o};const l=Object.assign({friendly_name:t.friendlyName,factor_type:t.factorType},t.factorType==="phone"?{phone:t.phone}:{issuer:t.issuer}),{data:c,error:u}=await wt(this.fetch,"POST",`${this.url}/factors`,{body:l,headers:this.headers,jwt:(n=a==null?void 0:a.session)===null||n===void 0?void 0:n.access_token});return u?{data:null,error:u}:(t.factorType==="totp"&&(!((s=c==null?void 0:c.totp)===null||s===void 0)&&s.qr_code)&&(c.totp.qr_code=`data:image/svg+xml;utf-8,${c.totp.qr_code}`),{data:c,error:null})})}catch(r){if(lt(r))return{data:null,error:r};throw r}}async _verify(t){return this._acquireLock(-1,async()=>{try{return await this._useSession(async r=>{var n;const{data:s,error:a}=r;if(a)return{data:null,error:a};const{data:o,error:l}=await wt(this.fetch,"POST",`${this.url}/factors/${t.factorId}/verify`,{body:{code:t.code,challenge_id:t.challengeId},headers:this.headers,jwt:(n=s==null?void 0:s.session)===null||n===void 0?void 0:n.access_token});return l?{data:null,error:l}:(await this._saveSession(Object.assign({expires_at:Math.round(Date.now()/1e3)+o.expires_in},o)),await this._notifyAllSubscribers("MFA_CHALLENGE_VERIFIED",o),{data:o,error:l})})}catch(r){if(lt(r))return{data:null,error:r};throw r}})}async _challenge(t){return this._acquireLock(-1,async()=>{try{return await this._useSession(async r=>{var n;const{data:s,error:a}=r;return a?{data:null,error:a}:await wt(this.fetch,"POST",`${this.url}/factors/${t.factorId}/challenge`,{body:{channel:t.channel},headers:this.headers,jwt:(n=s==null?void 0:s.session)===null||n===void 0?void 0:n.access_token})})}catch(r){if(lt(r))return{data:null,error:r};throw r}})}async _challengeAndVerify(t){const{data:r,error:n}=await this._challenge({factorId:t.factorId});return n?{data:null,error:n}:await this._verify({factorId:t.factorId,challengeId:r.id,code:t.code})}async _listFactors(){const{data:{user:t},error:r}=await this.getUser();if(r)return{data:null,error:r};const n=(t==null?void 0:t.factors)||[],s=n.filter(o=>o.factor_type==="totp"&&o.status==="verified"),a=n.filter(o=>o.factor_type==="phone"&&o.status==="verified");return{data:{all:n,totp:s,phone:a},error:null}}async _getAuthenticatorAssuranceLevel(){return this._acquireLock(-1,async()=>await this._useSession(async t=>{var r,n;const{data:{session:s},error:a}=t;if(a)return{data:null,error:a};if(!s)return{data:{currentLevel:null,nextLevel:null,currentAuthenticationMethods:[]},error:null};const{payload:o}=zg(s.access_token);let l=null;o.aal&&(l=o.aal);let c=l;((n=(r=s.user.factors)===null||r===void 0?void 0:r.filter(f=>f.status==="verified"))!==null&&n!==void 0?n:[]).length>0&&(c="aal2");const d=o.amr||[];return{data:{currentLevel:l,nextLevel:c,currentAuthenticationMethods:d},error:null}}))}async fetchJwk(t,r={keys:[]}){let n=r.keys.find(o=>o.kid===t);if(n||(n=this.jwks.keys.find(o=>o.kid===t),n&&this.jwks_cached_at+PB>Date.now()))return n;const{data:s,error:a}=await wt(this.fetch,"GET",`${this.url}/.well-known/jwks.json`,{headers:this.headers});if(a)throw a;if(!s.keys||s.keys.length===0)throw new ud("JWKS is empty");if(this.jwks=s,this.jwks_cached_at=Date.now(),n=s.keys.find(o=>o.kid===t),!n)throw new ud("No matching signing key found in JWKS");return n}async getClaims(t,r={keys:[]}){try{let n=t;if(!n){const{data:h,error:g}=await this.getSession();if(g||!h.session)return{data:null,error:g};n=h.session.access_token}const{header:s,payload:a,signature:o,raw:{header:l,payload:c}}=zg(n);if(t7(a.exp),!s.kid||s.alg==="HS256"||!("crypto"in globalThis&&"subtle"in globalThis.crypto)){const{error:h}=await this.getUser(n);if(h)throw h;return{data:{claims:a,header:s,signature:o},error:null}}const u=r7(s.alg),d=await this.fetchJwk(s.kid,r),f=await crypto.subtle.importKey("jwk",d,u,!0,["verify"]);if(!await crypto.subtle.verify(u,f,o,UB(`${l}.${c}`)))throw new ud("Invalid JWT signature");return{data:{claims:a,header:s,signature:o},error:null}}catch(n){if(lt(n))return{data:null,error:n};throw n}}}Gd.nextInstanceID=0;const y7=Gd;class w7 extends y7{constructor(t){super(t)}}var _7=function(e,t,r,n){function s(a){return a instanceof r?a:new r(function(o){o(a)})}return new(r||(r=Promise))(function(a,o){function l(d){try{u(n.next(d))}catch(f){o(f)}}function c(d){try{u(n.throw(d))}catch(f){o(f)}}function u(d){d.done?a(d.value):s(d.value).then(l,c)}u((n=n.apply(e,t||[])).next())})};class b7{constructor(t,r,n){var s,a,o;if(this.supabaseUrl=t,this.supabaseKey=r,!t)throw new Error("supabaseUrl is required.");if(!r)throw new Error("supabaseKey is required.");const l=jB(t),c=new URL(l);this.realtimeUrl=new URL("realtime/v1",c),this.realtimeUrl.protocol=this.realtimeUrl.protocol.replace("http","ws"),this.authUrl=new URL("auth/v1",c),this.storageUrl=new URL("storage/v1",c),this.functionsUrl=new URL("functions/v1",c);const u=`sb-${c.hostname.split(".")[0]}-auth-token`,d={db:xB,realtime:yB,auth:Object.assign(Object.assign({},vB),{storageKey:u}),global:gB},f=EB(n??{},d);this.storageKey=(s=f.auth.storageKey)!==null&&s!==void 0?s:"",this.headers=(a=f.global.headers)!==null&&a!==void 0?a:{},f.accessToken?(this.accessToken=f.accessToken,this.auth=new Proxy({},{get:(p,h)=>{throw new Error(`@supabase/supabase-js: Supabase Client is configured with the accessToken option, accessing supabase.auth.${String(h)} is not possible`)}})):this.auth=this._initSupabaseAuthClient((o=f.auth)!==null&&o!==void 0?o:{},this.headers,f.global.fetch),this.fetch=SB(r,this._getAccessToken.bind(this),f.global.fetch),this.realtime=this._initRealtimeClient(Object.assign({headers:this.headers,accessToken:this._getAccessToken.bind(this)},f.realtime)),this.rest=new $$(new URL("rest/v1",c).href,{headers:this.headers,schema:f.db.schema,fetch:this.fetch}),f.accessToken||this._listenForAuthEvents()}get functions(){return new p$(this.functionsUrl.href,{headers:this.headers,customFetch:this.fetch})}get storage(){return new hB(this.storageUrl.href,this.headers,this.fetch)}from(t){return this.rest.from(t)}schema(t){return this.rest.schema(t)}rpc(t,r={},n={}){return this.rest.rpc(t,r,n)}channel(t,r={config:{}}){return this.realtime.channel(t,r)}getChannels(){return this.realtime.getChannels()}removeChannel(t){return this.realtime.removeChannel(t)}removeAllChannels(){return this.realtime.removeAllChannels()}_getAccessToken(){var t,r;return _7(this,void 0,void 0,function*(){if(this.accessToken)return yield this.accessToken();const{data:n}=yield this.auth.getSession();return(r=(t=n.session)===null||t===void 0?void 0:t.access_token)!==null&&r!==void 0?r:null})}_initSupabaseAuthClient({autoRefreshToken:t,persistSession:r,detectSessionInUrl:n,storage:s,storageKey:a,flowType:o,lock:l,debug:c},u,d){const f={Authorization:`Bearer ${this.supabaseKey}`,apikey:`${this.supabaseKey}`};return new w7({url:this.authUrl.href,headers:Object.assign(Object.assign({},f),u),storageKey:a,autoRefreshToken:t,persistSession:r,detectSessionInUrl:n,storage:s,flowType:o,lock:l,debug:c,fetch:d,hasCustomAuthorizationHeader:"Authorization"in this.headers})}_initRealtimeClient(t){return new eB(this.realtimeUrl.href,Object.assign(Object.assign({},t),{params:Object.assign({apikey:this.supabaseKey},t==null?void 0:t.params)}))}_listenForAuthEvents(){return this.auth.onAuthStateChange((r,n)=>{this._handleTokenChanged(r,"CLIENT",n==null?void 0:n.access_token)})}_handleTokenChanged(t,r,n){(t==="TOKEN_REFRESHED"||t==="SIGNED_IN")&&this.changedAccessToken!==n?this.changedAccessToken=n:t==="SIGNED_OUT"&&(this.realtime.setAuth(),r=="STORAGE"&&this.auth.signOut(),this.changedAccessToken=void 0)}}const S7=(e,t,r)=>new b7(e,t,r),N7=void 0,j7=void 0,he=S7(N7,j7),HC=y.createContext(void 0),kt=()=>{const e=y.useContext(HC);if(e===void 0)throw new Error("useAuth must be used within an AuthProvider");return e},E7=({children:e})=>{const[t,r]=y.useState(null),[n,s]=y.useState(null),[a,o]=y.useState(!0),{toast:l}=St(),c=y.useRef(!1);y.useEffect(()=>{if(c.current)return;c.current=!0,(async()=>{try{const S=localStorage.getItem("rememberMe")==="true",T=localStorage.getItem("rememberMeExpiry");(!S||T&&Date.now()>parseInt(T))&&(localStorage.removeItem("rememberMe"),localStorage.removeItem("rememberMeExpiry"),localStorage.removeItem("sb-daiimiznlkffbbadhodw-auth-token"),sessionStorage.removeItem("sb-daiimiznlkffbbadhodw-auth-token"));const{data:{session:N},error:C}=await he.auth.getSession();C&&console.error("Error getting session:",C),N&&(S||u(N))?(s(N),r((N==null?void 0:N.user)??null)):(N&&!S&&await he.auth.signOut(),s(null),r(null))}catch(S){console.error("Error in auth initialization:",S)}finally{o(!1)}})();const{data:{subscription:b}}=he.auth.onAuthStateChange(async(S,T)=>{var N;console.log("Auth state changed:",S,(N=T==null?void 0:T.user)==null?void 0:N.email),S==="SIGNED_OUT"?(s(null),r(null)):T&&(localStorage.getItem("rememberMe")==="true"||u(T)?(s(T),r((T==null?void 0:T.user)??null)):await he.auth.signOut()),o(!1)});return()=>{b.unsubscribe(),c.current=!1}},[]);const u=_=>_.expires_at?Date.now()-(_.expires_at*1e3-_.expires_in*1e3)<60*60*1e3:!1,v={user:t,session:n,signUp:async(_,b,S,T,N)=>{try{const C=`${window.location.origin}/`,{error:E}=await he.auth.signUp({email:_,password:b,options:{emailRedirectTo:C,data:{first_name:S,last_name:T,phone:N}}});return E?(l({title:"Sign Up Error",description:E.message,variant:"destructive"}),{error:E}):(l({title:"Check your email",description:"We've sent you a confirmation link to complete your registration."}),{error:null})}catch(C){return l({title:"Sign Up Error",description:C.message,variant:"destructive"}),{error:C}}},signIn:async(_,b,S=!1)=>{try{localStorage.removeItem("rememberMe"),localStorage.removeItem("rememberMeExpiry");const{error:T}=await he.auth.signInWithPassword({email:_,password:b});return T?(l({title:"Sign In Error",description:T.message,variant:"destructive"}),{error:T}):(S&&(localStorage.setItem("rememberMe","true"),localStorage.setItem("rememberMeExpiry",(Date.now()+30*24*60*60*1e3).toString())),l({title:"Welcome back!",description:"You have been signed in successfully."}),{error:null})}catch(T){return l({title:"Sign In Error",description:T.message,variant:"destructive"}),{error:T}}},signOut:async()=>{try{if(localStorage.removeItem("rememberMe"),localStorage.removeItem("rememberMeExpiry"),!n){console.log("No active session found, clearing local state"),s(null),r(null),l({title:"Signed out",description:"You have been signed out successfully."});return}const{error:_}=await he.auth.signOut();s(null),r(null),_?(console.error("Logout error:",_),l({title:"Logout Notice",description:"You have been signed out locally."})):l({title:"Signed out",description:"You have been signed out successfully."})}catch(_){console.error("Logout error:",_),s(null),r(null),l({title:"Signed out",description:"You have been signed out locally."})}},sendOTP:async _=>{try{const b=_.includes("@");console.log("Sending OTP to:",_,"Type:",b?"email":"phone");const S=await fetch("https://daiimiznlkffbbadhodw.supabase.co/functions/v1/send-otp-fixed",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:_})});if(!S.ok){const N=await S.json();throw new Error(N.error||"Failed to send verification code")}const T=await S.json();return l({title:"OTP Sent",description:`Please check your ${b?"email":"phone"} for the verification code.`}),{error:null,otp:T.otp}}catch(b){return console.error("Error sending OTP:",b),l({title:"OTP Error",description:b.message,variant:"destructive"}),{error:b}}},sendLoginOTP:async _=>{try{const{data:b,error:S}=await he.functions.invoke("send-login-otp",{body:{email:_}});return S?(l({title:"OTP Error",description:"Failed to send verification code. Please try again.",variant:"destructive"}),{error:S}):(l({title:"Verification Code Sent",description:"Please check your phone for the verification code."}),{error:null,otp:b.otp})}catch(b){return l({title:"OTP Error",description:b.message,variant:"destructive"}),{error:b}}},verifyOTP:async(_,b,S)=>{try{const T=await fetch("https://daiimiznlkffbbadhodw.supabase.co/functions/v1/verify-otp-fixed",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:_,code:b})});if(!T.ok){const P=await T.json();throw new Error(P.error||"Failed to verify code")}const N=await T.json(),C=await fetch("https://daiimiznlkffbbadhodw.supabase.co/functions/v1/reset-password",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:_,otpCode:b,newPassword:S})});if(!C.ok){const P=await C.json();throw new Error(P.error||"Failed to reset password")}const E=await C.json();return l({title:"Password Reset Successful",description:"Your password has been updated successfully."}),{error:null}}catch(T){return console.error("Error verifying OTP:",T),l({title:"Password Reset Error",description:T.message,variant:"destructive"}),{error:T}}},verifyLoginOTP:async(_,b)=>{try{const S=await fetch("https://daiimiznlkffbbadhodw.supabase.co/functions/v1/verify-otp-fixed",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:_,code:b})});if(!S.ok){const T=await S.json();throw new Error(T.error||"Failed to verify code")}return await S.json()}catch(S){return console.error("Error verifying OTP:",S),l({title:"Verification Error",description:S.message,variant:"destructive"}),{error:S}}},resetPasswordWithOTP:async(_,b,S)=>{try{const T=await fetch("https://daiimiznlkffbbadhodw.supabase.co/functions/v1/reset-password",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:_,otpCode:b,newPassword:S})});if(!T.ok){const C=await T.json();throw new Error(C.error||"Failed to reset password")}const N=await T.json();return l({title:"Password Reset Successful",description:"Your password has been updated successfully. Please login with your new password."}),{error:null}}catch(T){return console.error("Error resetting password:",T),l({title:"Password Reset Error",description:T.message,variant:"destructive"}),{error:T}}},loading:a};return i.jsx(HC.Provider,{value:v,children:e})},ua=()=>{const[e,t]=y.useState(null),[r,n]=y.useState(!0),{user:s}=kt();y.useEffect(()=>{const F=async()=>{if(!s){t(null),n(!1);return}try{console.log("Fetching role for user:",s.email);const{data:G,error:O}=await he.rpc("get_current_user_role");O?(console.error("Error fetching user role:",O),t("member")):(console.log("User role from database function:",G),t(G))}catch(G){console.error("Error in fetchUserRole:",G),t("member")}finally{n(!1)}};F();const D=he.channel("user-role-changes").on("postgres_changes",{event:"*",schema:"public",table:"user_roles",filter:`user_id=eq.${s==null?void 0:s.id}`},()=>{console.log("User role changed, refetching..."),F()}).subscribe();return()=>{D.unsubscribe()}},[s]);const a=e==="super_admin"&&((s==null?void 0:s.email)==="atd@iskconbureau.in"||(s==null?void 0:s.email)==="bgd@iskconbureau.in"),o=e==="admin"||a;return{userRole:e,isSuperAdmin:a,isAdmin:o,isMember:e==="member"||o||a,loading:r,canManageMembers:a||o,canManageMeetings:a||o,canManageDocuments:a||o,canViewReports:a||o,canManageSettings:!0,canCreateContent:a||o,canDeleteContent:a||o,canEditContent:a||o,canEditAllUserInfo:a,canEditUserRoles:a||o,canDeleteUsers:a||o,canEditPhoneNumbers:a||o,canViewMemberSettings:a||o,canViewMembers:a||o,canScheduleMeetings:a||o,canDeleteMeetings:a||o,canEditVoting:a||o,canCreateVoting:a||o,canVoteOnly:e==="member",canMarkAttendanceOnly:e==="member",canAccessDashboard:!0,canAccessMeetings:!0,canAccessDocuments:!0,canAccessVoting:!0,canAccessAttendance:!0,canAccessEmail:!0,canAccessMembersModule:a||o,canAccessReports:a||o,canAccessSettings:!0,user:s}},Df=()=>{const{user:e}=kt(),{toast:t}=St(),[r,n]=y.useState(null),[s,a]=y.useState(!0),[o,l]=y.useState(0),c=y.useRef(!1),u=y.useRef(0),d=y.useCallback(async()=>{if(!e||c.current){a(!1);return}const g=Date.now();if(!(g-u.current<2e3))try{c.current=!0,u.current=g,a(!0),console.log("Fetching profile for user:",e.id);const{data:m,error:x}=await he.from("profiles").select("*").eq("id",e.id).single();if(x&&x.code!=="PGRST116"){if(console.error("Error fetching profile:",x),x.message.includes("row-level security")){console.log("User may not have access to their profile yet, creating..."),await f();return}throw x}m?(console.log("Profile fetched successfully:",m),n(m)):(console.log("No profile found, creating..."),await f())}catch(m){console.error("Error fetching profile:",m),t({title:"Profile Error",description:"Failed to load profile information",variant:"destructive"})}finally{a(!1),c.current=!1}},[e,t]),f=async()=>{var g,m;if(!(!e||c.current))try{const x={id:e.id,email:e.email||"",first_name:((g=e.user_metadata)==null?void 0:g.first_name)||"",last_name:((m=e.user_metadata)==null?void 0:m.last_name)||"",phone:e.phone||"",avatar_url:"",updated_at:new Date().toISOString()};console.log("Creating profile:",x);const{data:w,error:v}=await he.from("profiles").insert(x).select().single();if(v){if(console.error("Error creating profile:",v),v.message.includes("row-level security")){console.log("RLS prevented profile creation, profile might already exist"),setTimeout(()=>d(),2e3);return}throw v}console.log("Profile created successfully:",w),n(w)}catch(x){console.error("Error creating profile:",x)}},p=async g=>{if(!e||!r)return{error:"No user or profile found"};try{console.log("Updating profile with:",g);const m={...g,updated_at:new Date().toISOString()},{data:x,error:w}=await he.from("profiles").update(m).eq("id",e.id).select().single();if(w){if(console.error("Error updating profile:",w),w.message.includes("row-level security"))return t({title:"Permission Denied",description:"You don't have permission to make this update",variant:"destructive"}),{error:w};throw w}return console.log("Profile updated successfully:",x),n(x),setTimeout(()=>{const v={profile:x,userId:e.id};console.log("Dispatching profile update from useProfile:",v),window.dispatchEvent(new CustomEvent("profileUpdated",{detail:v}))},100),t({title:"Profile Updated",description:"Your information has been saved successfully"}),{error:null}}catch(m){return console.error("Error updating profile:",m),t({title:"Update Failed",description:m.message||"Failed to update profile",variant:"destructive"}),{error:m}}},h=y.useCallback(()=>{console.log("Forcing profile refresh"),l(g=>g+1)},[]);return y.useEffect(()=>{e!=null&&e.id&&d()},[e==null?void 0:e.id,o]),y.useEffect(()=>{let g;const m=x=>{console.log("useProfile received profile update event:",x.detail),x.detail.userId===(e==null?void 0:e.id)&&(clearTimeout(g),g=setTimeout(()=>{d()},1e3))};return window.addEventListener("profileUpdated",m),()=>{window.removeEventListener("profileUpdated",m),clearTimeout(g)}},[e==null?void 0:e.id]),{profile:r,loading:s,updateProfile:p,refreshProfile:h,fetchProfile:d}},Wg=768;function lu(){const[e,t]=y.useState(void 0);return y.useEffect(()=>{const r=window.matchMedia(`(max-width: ${Wg-1}px)`),n=()=>{t(window.innerWidth<Wg)};return r.addEventListener("change",n),t(window.innerWidth<Wg),()=>r.removeEventListener("change",n)},[]),!!e}var Hg="focusScope.autoFocusOnMount",Gg="focusScope.autoFocusOnUnmount",j2={bubbles:!1,cancelable:!0},k7="FocusScope",Rf=y.forwardRef((e,t)=>{const{loop:r=!1,trapped:n=!1,onMountAutoFocus:s,onUnmountAutoFocus:a,...o}=e,[l,c]=y.useState(null),u=hr(s),d=hr(a),f=y.useRef(null),p=st(t,m=>c(m)),h=y.useRef({paused:!1,pause(){this.paused=!0},resume(){this.paused=!1}}).current;y.useEffect(()=>{if(n){let m=function(_){if(h.paused||!l)return;const b=_.target;l.contains(b)?f.current=b:ki(f.current,{select:!0})},x=function(_){if(h.paused||!l)return;const b=_.relatedTarget;b!==null&&(l.contains(b)||ki(f.current,{select:!0}))},w=function(_){if(document.activeElement===document.body)for(const S of _)S.removedNodes.length>0&&ki(l)};document.addEventListener("focusin",m),document.addEventListener("focusout",x);const v=new MutationObserver(w);return l&&v.observe(l,{childList:!0,subtree:!0}),()=>{document.removeEventListener("focusin",m),document.removeEventListener("focusout",x),v.disconnect()}}},[n,l,h.paused]),y.useEffect(()=>{if(l){k2.add(h);const m=document.activeElement;if(!l.contains(m)){const w=new CustomEvent(Hg,j2);l.addEventListener(Hg,u),l.dispatchEvent(w),w.defaultPrevented||(C7(R7(GC(l)),{select:!0}),document.activeElement===m&&ki(l))}return()=>{l.removeEventListener(Hg,u),setTimeout(()=>{const w=new CustomEvent(Gg,j2);l.addEventListener(Gg,d),l.dispatchEvent(w),w.defaultPrevented||ki(m??document.body,{select:!0}),l.removeEventListener(Gg,d),k2.remove(h)},0)}}},[l,u,d,h]);const g=y.useCallback(m=>{if(!r&&!n||h.paused)return;const x=m.key==="Tab"&&!m.altKey&&!m.ctrlKey&&!m.metaKey,w=document.activeElement;if(x&&w){const v=m.currentTarget,[_,b]=T7(v);_&&b?!m.shiftKey&&w===b?(m.preventDefault(),r&&ki(_,{select:!0})):m.shiftKey&&w===_&&(m.preventDefault(),r&&ki(b,{select:!0})):w===v&&m.preventDefault()}},[r,n,h.paused]);return i.jsx(ze.div,{tabIndex:-1,...o,ref:p,onKeyDown:g})});Rf.displayName=k7;function C7(e,{select:t=!1}={}){const r=document.activeElement;for(const n of e)if(ki(n,{select:t}),document.activeElement!==r)return}function T7(e){const t=GC(e),r=E2(t,e),n=E2(t.reverse(),e);return[r,n]}function GC(e){const t=[],r=document.createTreeWalker(e,NodeFilter.SHOW_ELEMENT,{acceptNode:n=>{const s=n.tagName==="INPUT"&&n.type==="hidden";return n.disabled||n.hidden||s?NodeFilter.FILTER_SKIP:n.tabIndex>=0?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP}});for(;r.nextNode();)t.push(r.currentNode);return t}function E2(e,t){for(const r of e)if(!A7(r,{upTo:t}))return r}function A7(e,{upTo:t}){if(getComputedStyle(e).visibility==="hidden")return!0;for(;e;){if(t!==void 0&&e===t)return!1;if(getComputedStyle(e).display==="none")return!0;e=e.parentElement}return!1}function P7(e){return e instanceof HTMLInputElement&&"select"in e}function ki(e,{select:t=!1}={}){if(e&&e.focus){const r=document.activeElement;e.focus({preventScroll:!0}),e!==r&&P7(e)&&t&&e.select()}}var k2=D7();function D7(){let e=[];return{add(t){const r=e[0];t!==r&&(r==null||r.pause()),e=C2(e,t),e.unshift(t)},remove(t){var r;e=C2(e,t),(r=e[0])==null||r.resume()}}}function C2(e,t){const r=[...e],n=r.indexOf(t);return n!==-1&&r.splice(n,1),r}function R7(e){return e.filter(t=>t.tagName!=="A")}var qg=0;function fp(){y.useEffect(()=>{const e=document.querySelectorAll("[data-radix-focus-guard]");return document.body.insertAdjacentElement("afterbegin",e[0]??T2()),document.body.insertAdjacentElement("beforeend",e[1]??T2()),qg++,()=>{qg===1&&document.querySelectorAll("[data-radix-focus-guard]").forEach(t=>t.remove()),qg--}},[])}function T2(){const e=document.createElement("span");return e.setAttribute("data-radix-focus-guard",""),e.tabIndex=0,e.style.outline="none",e.style.opacity="0",e.style.position="fixed",e.style.pointerEvents="none",e}var Na=function(){return Na=Object.assign||function(t){for(var r,n=1,s=arguments.length;n<s;n++){r=arguments[n];for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(t[a]=r[a])}return t},Na.apply(this,arguments)};function qC(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,n=Object.getOwnPropertySymbols(e);s<n.length;s++)t.indexOf(n[s])<0&&Object.prototype.propertyIsEnumerable.call(e,n[s])&&(r[n[s]]=e[n[s]]);return r}function M7(e,t,r){if(r||arguments.length===2)for(var n=0,s=t.length,a;n<s;n++)(a||!(n in t))&&(a||(a=Array.prototype.slice.call(t,0,n)),a[n]=t[n]);return e.concat(a||Array.prototype.slice.call(t))}var om="right-scroll-bar-position",lm="width-before-scroll-bar",O7="with-scroll-bars-hidden",F7="--removed-body-scroll-bar-size";function Yg(e,t){return typeof e=="function"?e(t):e&&(e.current=t),e}function I7(e,t){var r=y.useState(function(){return{value:e,callback:t,facade:{get current(){return r.value},set current(n){var s=r.value;s!==n&&(r.value=n,r.callback(n,s))}}}})[0];return r.callback=t,r.facade}var L7=typeof window<"u"?y.useLayoutEffect:y.useEffect,A2=new WeakMap;function $7(e,t){var r=I7(null,function(n){return e.forEach(function(s){return Yg(s,n)})});return L7(function(){var n=A2.get(r);if(n){var s=new Set(n),a=new Set(e),o=r.current;s.forEach(function(l){a.has(l)||Yg(l,null)}),a.forEach(function(l){s.has(l)||Yg(l,o)})}A2.set(r,e)},[e]),r}function B7(e){return e}function U7(e,t){t===void 0&&(t=B7);var r=[],n=!1,s={read:function(){if(n)throw new Error("Sidecar: could not `read` from an `assigned` medium. `read` could be used only with `useMedium`.");return r.length?r[r.length-1]:e},useMedium:function(a){var o=t(a,n);return r.push(o),function(){r=r.filter(function(l){return l!==o})}},assignSyncMedium:function(a){for(n=!0;r.length;){var o=r;r=[],o.forEach(a)}r={push:function(l){return a(l)},filter:function(){return r}}},assignMedium:function(a){n=!0;var o=[];if(r.length){var l=r;r=[],l.forEach(a),o=r}var c=function(){var d=o;o=[],d.forEach(a)},u=function(){return Promise.resolve().then(c)};u(),r={push:function(d){o.push(d),u()},filter:function(d){return o=o.filter(d),r}}}};return s}function z7(e){e===void 0&&(e={});var t=U7(null);return t.options=Na({async:!0,ssr:!1},e),t}var YC=function(e){var t=e.sideCar,r=qC(e,["sideCar"]);if(!t)throw new Error("Sidecar: please provide `sideCar` property to import the right car");var n=t.read();if(!n)throw new Error("Sidecar medium not found");return y.createElement(n,Na({},r))};YC.isSideCarExport=!0;function V7(e,t){return e.useMedium(t),YC}var KC=z7(),Kg=function(){},hp=y.forwardRef(function(e,t){var r=y.useRef(null),n=y.useState({onScrollCapture:Kg,onWheelCapture:Kg,onTouchMoveCapture:Kg}),s=n[0],a=n[1],o=e.forwardProps,l=e.children,c=e.className,u=e.removeScrollBar,d=e.enabled,f=e.shards,p=e.sideCar,h=e.noRelative,g=e.noIsolation,m=e.inert,x=e.allowPinchZoom,w=e.as,v=w===void 0?"div":w,_=e.gapMode,b=qC(e,["forwardProps","children","className","removeScrollBar","enabled","shards","sideCar","noRelative","noIsolation","inert","allowPinchZoom","as","gapMode"]),S=p,T=$7([r,t]),N=Na(Na({},b),s);return y.createElement(y.Fragment,null,d&&y.createElement(S,{sideCar:KC,removeScrollBar:u,shards:f,noRelative:h,noIsolation:g,inert:m,setCallbacks:a,allowPinchZoom:!!x,lockRef:r,gapMode:_}),o?y.cloneElement(y.Children.only(l),Na(Na({},N),{ref:T})):y.createElement(v,Na({},N,{className:c,ref:T}),l))});hp.defaultProps={enabled:!0,removeScrollBar:!0,inert:!1};hp.classNames={fullWidth:lm,zeroRight:om};var W7=function(){if(typeof __webpack_nonce__<"u")return __webpack_nonce__};function H7(){if(!document)return null;var e=document.createElement("style");e.type="text/css";var t=W7();return t&&e.setAttribute("nonce",t),e}function G7(e,t){e.styleSheet?e.styleSheet.cssText=t:e.appendChild(document.createTextNode(t))}function q7(e){var t=document.head||document.getElementsByTagName("head")[0];t.appendChild(e)}var Y7=function(){var e=0,t=null;return{add:function(r){e==0&&(t=H7())&&(G7(t,r),q7(t)),e++},remove:function(){e--,!e&&t&&(t.parentNode&&t.parentNode.removeChild(t),t=null)}}},K7=function(){var e=Y7();return function(t,r){y.useEffect(function(){return e.add(t),function(){e.remove()}},[t&&r])}},XC=function(){var e=K7(),t=function(r){var n=r.styles,s=r.dynamic;return e(n,s),null};return t},X7={left:0,top:0,right:0,gap:0},Xg=function(e){return parseInt(e||"",10)||0},Q7=function(e){var t=window.getComputedStyle(document.body),r=t[e==="padding"?"paddingLeft":"marginLeft"],n=t[e==="padding"?"paddingTop":"marginTop"],s=t[e==="padding"?"paddingRight":"marginRight"];return[Xg(r),Xg(n),Xg(s)]},J7=function(e){if(e===void 0&&(e="margin"),typeof window>"u")return X7;var t=Q7(e),r=document.documentElement.clientWidth,n=window.innerWidth;return{left:t[0],top:t[1],right:t[2],gap:Math.max(0,n-r+t[2]-t[0])}},Z7=XC(),pc="data-scroll-locked",e9=function(e,t,r,n){var s=e.left,a=e.top,o=e.right,l=e.gap;return r===void 0&&(r="margin"),`
  .`.concat(O7,` {
   overflow: hidden `).concat(n,`;
   padding-right: `).concat(l,"px ").concat(n,`;
  }
  body[`).concat(pc,`] {
    overflow: hidden `).concat(n,`;
    overscroll-behavior: contain;
    `).concat([t&&"position: relative ".concat(n,";"),r==="margin"&&`
    padding-left: `.concat(s,`px;
    padding-top: `).concat(a,`px;
    padding-right: `).concat(o,`px;
    margin-left:0;
    margin-top:0;
    margin-right: `).concat(l,"px ").concat(n,`;
    `),r==="padding"&&"padding-right: ".concat(l,"px ").concat(n,";")].filter(Boolean).join(""),`
  }
  
  .`).concat(om,` {
    right: `).concat(l,"px ").concat(n,`;
  }
  
  .`).concat(lm,` {
    margin-right: `).concat(l,"px ").concat(n,`;
  }
  
  .`).concat(om," .").concat(om,` {
    right: 0 `).concat(n,`;
  }
  
  .`).concat(lm," .").concat(lm,` {
    margin-right: 0 `).concat(n,`;
  }
  
  body[`).concat(pc,`] {
    `).concat(F7,": ").concat(l,`px;
  }
`)},P2=function(){var e=parseInt(document.body.getAttribute(pc)||"0",10);return isFinite(e)?e:0},t9=function(){y.useEffect(function(){return document.body.setAttribute(pc,(P2()+1).toString()),function(){var e=P2()-1;e<=0?document.body.removeAttribute(pc):document.body.setAttribute(pc,e.toString())}},[])},r9=function(e){var t=e.noRelative,r=e.noImportant,n=e.gapMode,s=n===void 0?"margin":n;t9();var a=y.useMemo(function(){return J7(s)},[s]);return y.createElement(Z7,{styles:e9(a,!t,s,r?"":"!important")})},Gv=!1;if(typeof window<"u")try{var Ch=Object.defineProperty({},"passive",{get:function(){return Gv=!0,!0}});window.addEventListener("test",Ch,Ch),window.removeEventListener("test",Ch,Ch)}catch{Gv=!1}var Ol=Gv?{passive:!1}:!1,n9=function(e){return e.tagName==="TEXTAREA"},QC=function(e,t){if(!(e instanceof Element))return!1;var r=window.getComputedStyle(e);return r[t]!=="hidden"&&!(r.overflowY===r.overflowX&&!n9(e)&&r[t]==="visible")},s9=function(e){return QC(e,"overflowY")},a9=function(e){return QC(e,"overflowX")},D2=function(e,t){var r=t.ownerDocument,n=t;do{typeof ShadowRoot<"u"&&n instanceof ShadowRoot&&(n=n.host);var s=JC(e,n);if(s){var a=ZC(e,n),o=a[1],l=a[2];if(o>l)return!0}n=n.parentNode}while(n&&n!==r.body);return!1},i9=function(e){var t=e.scrollTop,r=e.scrollHeight,n=e.clientHeight;return[t,r,n]},o9=function(e){var t=e.scrollLeft,r=e.scrollWidth,n=e.clientWidth;return[t,r,n]},JC=function(e,t){return e==="v"?s9(t):a9(t)},ZC=function(e,t){return e==="v"?i9(t):o9(t)},l9=function(e,t){return e==="h"&&t==="rtl"?-1:1},c9=function(e,t,r,n,s){var a=l9(e,window.getComputedStyle(t).direction),o=a*n,l=r.target,c=t.contains(l),u=!1,d=o>0,f=0,p=0;do{if(!l)break;var h=ZC(e,l),g=h[0],m=h[1],x=h[2],w=m-x-a*g;(g||w)&&JC(e,l)&&(f+=w,p+=g);var v=l.parentNode;l=v&&v.nodeType===Node.DOCUMENT_FRAGMENT_NODE?v.host:v}while(!c&&l!==document.body||c&&(t.contains(l)||t===l));return(d&&Math.abs(f)<1||!d&&Math.abs(p)<1)&&(u=!0),u},Th=function(e){return"changedTouches"in e?[e.changedTouches[0].clientX,e.changedTouches[0].clientY]:[0,0]},R2=function(e){return[e.deltaX,e.deltaY]},M2=function(e){return e&&"current"in e?e.current:e},u9=function(e,t){return e[0]===t[0]&&e[1]===t[1]},d9=function(e){return`
  .block-interactivity-`.concat(e,` {pointer-events: none;}
  .allow-interactivity-`).concat(e,` {pointer-events: all;}
`)},f9=0,Fl=[];function h9(e){var t=y.useRef([]),r=y.useRef([0,0]),n=y.useRef(),s=y.useState(f9++)[0],a=y.useState(XC)[0],o=y.useRef(e);y.useEffect(function(){o.current=e},[e]),y.useEffect(function(){if(e.inert){document.body.classList.add("block-interactivity-".concat(s));var m=M7([e.lockRef.current],(e.shards||[]).map(M2),!0).filter(Boolean);return m.forEach(function(x){return x.classList.add("allow-interactivity-".concat(s))}),function(){document.body.classList.remove("block-interactivity-".concat(s)),m.forEach(function(x){return x.classList.remove("allow-interactivity-".concat(s))})}}},[e.inert,e.lockRef.current,e.shards]);var l=y.useCallback(function(m,x){if("touches"in m&&m.touches.length===2||m.type==="wheel"&&m.ctrlKey)return!o.current.allowPinchZoom;var w=Th(m),v=r.current,_="deltaX"in m?m.deltaX:v[0]-w[0],b="deltaY"in m?m.deltaY:v[1]-w[1],S,T=m.target,N=Math.abs(_)>Math.abs(b)?"h":"v";if("touches"in m&&N==="h"&&T.type==="range")return!1;var C=D2(N,T);if(!C)return!0;if(C?S=N:(S=N==="v"?"h":"v",C=D2(N,T)),!C)return!1;if(!n.current&&"changedTouches"in m&&(_||b)&&(n.current=S),!S)return!0;var E=n.current||S;return c9(E,x,m,E==="h"?_:b)},[]),c=y.useCallback(function(m){var x=m;if(!(!Fl.length||Fl[Fl.length-1]!==a)){var w="deltaY"in x?R2(x):Th(x),v=t.current.filter(function(S){return S.name===x.type&&(S.target===x.target||x.target===S.shadowParent)&&u9(S.delta,w)})[0];if(v&&v.should){x.cancelable&&x.preventDefault();return}if(!v){var _=(o.current.shards||[]).map(M2).filter(Boolean).filter(function(S){return S.contains(x.target)}),b=_.length>0?l(x,_[0]):!o.current.noIsolation;b&&x.cancelable&&x.preventDefault()}}},[]),u=y.useCallback(function(m,x,w,v){var _={name:m,delta:x,target:w,should:v,shadowParent:m9(w)};t.current.push(_),setTimeout(function(){t.current=t.current.filter(function(b){return b!==_})},1)},[]),d=y.useCallback(function(m){r.current=Th(m),n.current=void 0},[]),f=y.useCallback(function(m){u(m.type,R2(m),m.target,l(m,e.lockRef.current))},[]),p=y.useCallback(function(m){u(m.type,Th(m),m.target,l(m,e.lockRef.current))},[]);y.useEffect(function(){return Fl.push(a),e.setCallbacks({onScrollCapture:f,onWheelCapture:f,onTouchMoveCapture:p}),document.addEventListener("wheel",c,Ol),document.addEventListener("touchmove",c,Ol),document.addEventListener("touchstart",d,Ol),function(){Fl=Fl.filter(function(m){return m!==a}),document.removeEventListener("wheel",c,Ol),document.removeEventListener("touchmove",c,Ol),document.removeEventListener("touchstart",d,Ol)}},[]);var h=e.removeScrollBar,g=e.inert;return y.createElement(y.Fragment,null,g?y.createElement(a,{styles:d9(s)}):null,h?y.createElement(r9,{noRelative:e.noRelative,gapMode:e.gapMode}):null)}function m9(e){for(var t=null;e!==null;)e instanceof ShadowRoot&&(t=e.host,e=e.host),e=e.parentNode;return t}const p9=V7(KC,h9);var Mf=y.forwardRef(function(e,t){return y.createElement(hp,Na({},e,{ref:t,sideCar:p9}))});Mf.classNames=hp.classNames;var g9=function(e){if(typeof document>"u")return null;var t=Array.isArray(e)?e[0]:e;return t.ownerDocument.body},Il=new WeakMap,Ah=new WeakMap,Ph={},Qg=0,eT=function(e){return e&&(e.host||eT(e.parentNode))},x9=function(e,t){return t.map(function(r){if(e.contains(r))return r;var n=eT(r);return n&&e.contains(n)?n:(console.error("aria-hidden",r,"in not contained inside",e,". Doing nothing"),null)}).filter(function(r){return!!r})},v9=function(e,t,r,n){var s=x9(t,Array.isArray(e)?e:[e]);Ph[r]||(Ph[r]=new WeakMap);var a=Ph[r],o=[],l=new Set,c=new Set(s),u=function(f){!f||l.has(f)||(l.add(f),u(f.parentNode))};s.forEach(u);var d=function(f){!f||c.has(f)||Array.prototype.forEach.call(f.children,function(p){if(l.has(p))d(p);else try{var h=p.getAttribute(n),g=h!==null&&h!=="false",m=(Il.get(p)||0)+1,x=(a.get(p)||0)+1;Il.set(p,m),a.set(p,x),o.push(p),m===1&&g&&Ah.set(p,!0),x===1&&p.setAttribute(r,"true"),g||p.setAttribute(n,"true")}catch(w){console.error("aria-hidden: cannot operate on ",p,w)}})};return d(t),l.clear(),Qg++,function(){o.forEach(function(f){var p=Il.get(f)-1,h=a.get(f)-1;Il.set(f,p),a.set(f,h),p||(Ah.has(f)||f.removeAttribute(n),Ah.delete(f)),h||f.removeAttribute(r)}),Qg--,Qg||(Il=new WeakMap,Il=new WeakMap,Ah=new WeakMap,Ph={})}},mp=function(e,t,r){r===void 0&&(r="data-aria-hidden");var n=Array.from(Array.isArray(e)?e:[e]),s=g9(e);return s?(n.push.apply(n,Array.from(s.querySelectorAll("[aria-live], script"))),v9(n,s,r,"aria-hidden")):function(){return null}},pp="Dialog",[tT,rT]=Fr(pp),[y9,da]=tT(pp),nT=e=>{const{__scopeDialog:t,children:r,open:n,defaultOpen:s,onOpenChange:a,modal:o=!0}=e,l=y.useRef(null),c=y.useRef(null),[u,d]=Hn({prop:n,defaultProp:s??!1,onChange:a,caller:pp});return i.jsx(y9,{scope:t,triggerRef:l,contentRef:c,contentId:Er(),titleId:Er(),descriptionId:Er(),open:u,onOpenChange:d,onOpenToggle:y.useCallback(()=>d(f=>!f),[d]),modal:o,children:r})};nT.displayName=pp;var sT="DialogTrigger",aT=y.forwardRef((e,t)=>{const{__scopeDialog:r,...n}=e,s=da(sT,r),a=st(t,s.triggerRef);return i.jsx(ze.button,{type:"button","aria-haspopup":"dialog","aria-expanded":s.open,"aria-controls":s.contentId,"data-state":$1(s.open),...n,ref:a,onClick:Oe(e.onClick,s.onOpenToggle)})});aT.displayName=sT;var I1="DialogPortal",[w9,iT]=tT(I1,{forceMount:void 0}),oT=e=>{const{__scopeDialog:t,forceMount:r,children:n,container:s}=e,a=da(I1,t);return i.jsx(w9,{scope:t,forceMount:r,children:y.Children.map(n,o=>i.jsx(Ir,{present:r||a.open,children:i.jsx(Jc,{asChild:!0,container:s,children:o})}))})};oT.displayName=I1;var Ym="DialogOverlay",lT=y.forwardRef((e,t)=>{const r=iT(Ym,e.__scopeDialog),{forceMount:n=r.forceMount,...s}=e,a=da(Ym,e.__scopeDialog);return a.modal?i.jsx(Ir,{present:n||a.open,children:i.jsx(b9,{...s,ref:t})}):null});lT.displayName=Ym;var _9=oo("DialogOverlay.RemoveScroll"),b9=y.forwardRef((e,t)=>{const{__scopeDialog:r,...n}=e,s=da(Ym,r);return i.jsx(Mf,{as:_9,allowPinchZoom:!0,shards:[s.contentRef],children:i.jsx(ze.div,{"data-state":$1(s.open),...n,ref:t,style:{pointerEvents:"auto",...n.style}})})}),ol="DialogContent",cT=y.forwardRef((e,t)=>{const r=iT(ol,e.__scopeDialog),{forceMount:n=r.forceMount,...s}=e,a=da(ol,e.__scopeDialog);return i.jsx(Ir,{present:n||a.open,children:a.modal?i.jsx(S9,{...s,ref:t}):i.jsx(N9,{...s,ref:t})})});cT.displayName=ol;var S9=y.forwardRef((e,t)=>{const r=da(ol,e.__scopeDialog),n=y.useRef(null),s=st(t,r.contentRef,n);return y.useEffect(()=>{const a=n.current;if(a)return mp(a)},[]),i.jsx(uT,{...e,ref:s,trapFocus:r.open,disableOutsidePointerEvents:!0,onCloseAutoFocus:Oe(e.onCloseAutoFocus,a=>{var o;a.preventDefault(),(o=r.triggerRef.current)==null||o.focus()}),onPointerDownOutside:Oe(e.onPointerDownOutside,a=>{const o=a.detail.originalEvent,l=o.button===0&&o.ctrlKey===!0;(o.button===2||l)&&a.preventDefault()}),onFocusOutside:Oe(e.onFocusOutside,a=>a.preventDefault())})}),N9=y.forwardRef((e,t)=>{const r=da(ol,e.__scopeDialog),n=y.useRef(!1),s=y.useRef(!1);return i.jsx(uT,{...e,ref:t,trapFocus:!1,disableOutsidePointerEvents:!1,onCloseAutoFocus:a=>{var o,l;(o=e.onCloseAutoFocus)==null||o.call(e,a),a.defaultPrevented||(n.current||(l=r.triggerRef.current)==null||l.focus(),a.preventDefault()),n.current=!1,s.current=!1},onInteractOutside:a=>{var c,u;(c=e.onInteractOutside)==null||c.call(e,a),a.defaultPrevented||(n.current=!0,a.detail.originalEvent.type==="pointerdown"&&(s.current=!0));const o=a.target;((u=r.triggerRef.current)==null?void 0:u.contains(o))&&a.preventDefault(),a.detail.originalEvent.type==="focusin"&&s.current&&a.preventDefault()}})}),uT=y.forwardRef((e,t)=>{const{__scopeDialog:r,trapFocus:n,onOpenAutoFocus:s,onCloseAutoFocus:a,...o}=e,l=da(ol,r),c=y.useRef(null),u=st(t,c);return fp(),i.jsxs(i.Fragment,{children:[i.jsx(Rf,{asChild:!0,loop:!0,trapped:n,onMountAutoFocus:s,onUnmountAutoFocus:a,children:i.jsx(vl,{role:"dialog",id:l.contentId,"aria-describedby":l.descriptionId,"aria-labelledby":l.titleId,"data-state":$1(l.open),...o,ref:u,onDismiss:()=>l.onOpenChange(!1)})}),i.jsxs(i.Fragment,{children:[i.jsx(E9,{titleId:l.titleId}),i.jsx(C9,{contentRef:c,descriptionId:l.descriptionId})]})]})}),L1="DialogTitle",dT=y.forwardRef((e,t)=>{const{__scopeDialog:r,...n}=e,s=da(L1,r);return i.jsx(ze.h2,{id:s.titleId,...n,ref:t})});dT.displayName=L1;var fT="DialogDescription",hT=y.forwardRef((e,t)=>{const{__scopeDialog:r,...n}=e,s=da(fT,r);return i.jsx(ze.p,{id:s.descriptionId,...n,ref:t})});hT.displayName=fT;var mT="DialogClose",pT=y.forwardRef((e,t)=>{const{__scopeDialog:r,...n}=e,s=da(mT,r);return i.jsx(ze.button,{type:"button",...n,ref:t,onClick:Oe(e.onClick,()=>s.onOpenChange(!1))})});pT.displayName=mT;function $1(e){return e?"open":"closed"}var gT="DialogTitleWarning",[j9,xT]=k5(gT,{contentName:ol,titleName:L1,docsSlug:"dialog"}),E9=({titleId:e})=>{const t=xT(gT),r=`\`${t.contentName}\` requires a \`${t.titleName}\` for the component to be accessible for screen reader users.

If you want to hide the \`${t.titleName}\`, you can wrap it with our VisuallyHidden component.

For more information, see https://radix-ui.com/primitives/docs/components/${t.docsSlug}`;return y.useEffect(()=>{e&&(document.getElementById(e)||console.error(r))},[r,e]),null},k9="DialogDescriptionWarning",C9=({contentRef:e,descriptionId:t})=>{const n=`Warning: Missing \`Description\` or \`aria-describedby={undefined}\` for {${xT(k9).contentName}}.`;return y.useEffect(()=>{var a;const s=(a=e.current)==null?void 0:a.getAttribute("aria-describedby");t&&s&&(document.getElementById(t)||console.warn(n))},[n,e,t]),null},B1=nT,vT=aT,U1=oT,gp=lT,xp=cT,z1=dT,V1=hT,W1=pT,yT="AlertDialog",[T9,ise]=Fr(yT,[rT]),vi=rT(),wT=e=>{const{__scopeAlertDialog:t,...r}=e,n=vi(t);return i.jsx(B1,{...n,...r,modal:!0})};wT.displayName=yT;var A9="AlertDialogTrigger",_T=y.forwardRef((e,t)=>{const{__scopeAlertDialog:r,...n}=e,s=vi(r);return i.jsx(vT,{...s,...n,ref:t})});_T.displayName=A9;var P9="AlertDialogPortal",bT=e=>{const{__scopeAlertDialog:t,...r}=e,n=vi(t);return i.jsx(U1,{...n,...r})};bT.displayName=P9;var D9="AlertDialogOverlay",ST=y.forwardRef((e,t)=>{const{__scopeAlertDialog:r,...n}=e,s=vi(r);return i.jsx(gp,{...s,...n,ref:t})});ST.displayName=D9;var gc="AlertDialogContent",[R9,M9]=T9(gc),O9=OE("AlertDialogContent"),NT=y.forwardRef((e,t)=>{const{__scopeAlertDialog:r,children:n,...s}=e,a=vi(r),o=y.useRef(null),l=st(t,o),c=y.useRef(null);return i.jsx(j9,{contentName:gc,titleName:jT,docsSlug:"alert-dialog",children:i.jsx(R9,{scope:r,cancelRef:c,children:i.jsxs(xp,{role:"alertdialog",...a,...s,ref:l,onOpenAutoFocus:Oe(s.onOpenAutoFocus,u=>{var d;u.preventDefault(),(d=c.current)==null||d.focus({preventScroll:!0})}),onPointerDownOutside:u=>u.preventDefault(),onInteractOutside:u=>u.preventDefault(),children:[i.jsx(O9,{children:n}),i.jsx(I9,{contentRef:o})]})})})});NT.displayName=gc;var jT="AlertDialogTitle",ET=y.forwardRef((e,t)=>{const{__scopeAlertDialog:r,...n}=e,s=vi(r);return i.jsx(z1,{...s,...n,ref:t})});ET.displayName=jT;var kT="AlertDialogDescription",CT=y.forwardRef((e,t)=>{const{__scopeAlertDialog:r,...n}=e,s=vi(r);return i.jsx(V1,{...s,...n,ref:t})});CT.displayName=kT;var F9="AlertDialogAction",TT=y.forwardRef((e,t)=>{const{__scopeAlertDialog:r,...n}=e,s=vi(r);return i.jsx(W1,{...s,...n,ref:t})});TT.displayName=F9;var AT="AlertDialogCancel",PT=y.forwardRef((e,t)=>{const{__scopeAlertDialog:r,...n}=e,{cancelRef:s}=M9(AT,r),a=vi(r),o=st(t,s);return i.jsx(W1,{...a,...n,ref:o})});PT.displayName=AT;var I9=({contentRef:e})=>{const t=`\`${gc}\` requires a description for the component to be accessible for screen reader users.

You can add a description to the \`${gc}\` by passing a \`${kT}\` component as a child, which also benefits sighted users by adding visible context to the dialog.

Alternatively, you can use your own component as a description by assigning it an \`id\` and passing the same value to the \`aria-describedby\` prop in \`${gc}\`. If the description is confusing or duplicative for sighted users, you can use the \`@radix-ui/react-visually-hidden\` primitive as a wrapper around your description component.

For more information, see https://radix-ui.com/primitives/docs/components/alert-dialog`;return y.useEffect(()=>{var n;document.getElementById((n=e.current)==null?void 0:n.getAttribute("aria-describedby"))||console.warn(t)},[t,e]),null},L9=wT,$9=_T,B9=bT,DT=ST,RT=NT,MT=TT,OT=PT,FT=ET,IT=CT;const H1=L9,LT=$9,U9=B9,$T=y.forwardRef(({className:e,...t},r)=>i.jsx(DT,{className:De("fixed inset-0 z-50 bg-black/80  data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",e),...t,ref:r}));$T.displayName=DT.displayName;const vp=y.forwardRef(({className:e,...t},r)=>i.jsxs(U9,{children:[i.jsx($T,{}),i.jsx(RT,{ref:r,className:De("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",e),...t})]}));vp.displayName=RT.displayName;const yp=({className:e,...t})=>i.jsx("div",{className:De("flex flex-col space-y-2 text-center sm:text-left",e),...t});yp.displayName="AlertDialogHeader";const wp=({className:e,...t})=>i.jsx("div",{className:De("flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2",e),...t});wp.displayName="AlertDialogFooter";const _p=y.forwardRef(({className:e,...t},r)=>i.jsx(FT,{ref:r,className:De("text-lg font-semibold",e),...t}));_p.displayName=FT.displayName;const bp=y.forwardRef(({className:e,...t},r)=>i.jsx(IT,{ref:r,className:De("text-sm text-muted-foreground",e),...t}));bp.displayName=IT.displayName;const Sp=y.forwardRef(({className:e,...t},r)=>i.jsx(MT,{ref:r,className:De(Hd(),e),...t}));Sp.displayName=MT.displayName;const Np=y.forwardRef(({className:e,...t},r)=>i.jsx(OT,{ref:r,className:De(Hd({variant:"outline"}),"mt-2 sm:mt-0",e),...t}));Np.displayName=OT.displayName;const z9=[{id:"dashboard",label:"Dashboard",icon:wf,requiredPermission:"canAccessDashboard"},{id:"meetings",label:"Meetings",icon:en,requiredPermission:"canAccessMeetings"},{id:"documents",label:"Documents",icon:Ld,requiredPermission:"canAccessDocuments"},{id:"voting",label:"Voting",icon:Qa,requiredPermission:"canAccessVoting"},{id:"attendance",label:"Attendance",icon:qr,requiredPermission:"canAccessAttendance"},{id:"email",label:"Email",icon:ta,requiredPermission:"canAccessEmail"},{id:"members",label:"Members",icon:mr,requiredPermission:"canAccessMembersModule"},{id:"settings",label:"Settings",icon:bf,requiredPermission:"canAccessSettings"}],V9=({isOpen:e,currentModule:t,onModuleChange:r,onClose:n,avatarRefreshTrigger:s=0,isCollapsed:a=!1})=>{var T,N;const{user:o,signOut:l}=kt(),c=ua(),{profile:u,refreshProfile:d}=Df(),f=lu(),[p,h]=y.useState(!1),[g,m]=y.useState(0);y.useEffect(()=>{const C=R=>{console.log("Sidebar received profile update:",R.detail),R.detail.userId===(o==null?void 0:o.id)&&(m(j=>j+1),d())},E=R=>{console.log("Sidebar received avatar update:",R.detail),R.detail.userId===(o==null?void 0:o.id)&&(m(j=>j+1),d())},P=R=>{console.log("Sidebar received force avatar refresh:",R.detail),R.detail.userId===(o==null?void 0:o.id)&&(m(j=>j+1),d())};return window.addEventListener("profileUpdated",C),window.addEventListener("avatarUpdated",E),window.addEventListener("forceAvatarRefresh",P),()=>{window.removeEventListener("profileUpdated",C),window.removeEventListener("avatarUpdated",E),window.removeEventListener("forceAvatarRefresh",P)}},[o==null?void 0:o.id,d]),y.useEffect(()=>{o!=null&&o.id&&d()},[o==null?void 0:o.id,d]);const x=z9.filter(C=>C.requiredPermission?c[C.requiredPermission]:!0),w=ke.useMemo(()=>{var C,E;return u!=null&&u.first_name||u!=null&&u.last_name?`${u.first_name||""} ${u.last_name||""}`.trim():u!=null&&u.email?u.email.split("@")[0]:(C=o==null?void 0:o.user_metadata)!=null&&C.first_name||(E=o==null?void 0:o.user_metadata)!=null&&E.last_name?`${o.user_metadata.first_name||""} ${o.user_metadata.last_name||""}`.trim():o!=null&&o.email?o.email.split("@")[0]:"User"},[u,o]),v=(u==null?void 0:u.email)||(o==null?void 0:o.email)||"user@iskcon.org",_=C=>{r(C),f&&n()},b=async()=>{await l(),h(!1),f&&n()},S=()=>{r("settings"),f&&n()};return i.jsx("div",{className:`fixed transform transition-all duration-300 ${e?"translate-x-0":"-translate-x-full"} ${f?"w-64 top-12 bottom-0 z-50":"top-16 bottom-0 lg:translate-x-0 z-20"} ${!f&&a?"w-20":"w-64"} left-0 bg-white shadow-xl`,children:i.jsxs("div",{className:"flex flex-col h-full",children:[i.jsxs("nav",{className:"flex-1 px-4 pt-6 pb-6 space-y-1 overflow-y-auto",children:[x.map(C=>i.jsxs("button",{onClick:()=>_(C.id),className:`w-full flex items-center px-4 py-3 text-sm font-medium rounded-lg transition-colors ${t===C.id?"bg-primary text-white shadow-sm":"text-gray-600 hover:bg-secondary hover:text-gray-900"} ${!f&&a?"justify-center px-2":""}`,title:!f&&a?C.label:void 0,children:[i.jsx(C.icon,{className:`h-5 w-5 flex-shrink-0 ${!a||f?"mr-3":""}`}),(!a||f)&&i.jsx("span",{className:"truncate",children:C.label})]},C.id)),i.jsxs(H1,{open:p,onOpenChange:h,children:[i.jsx(LT,{asChild:!0,children:i.jsxs(ue,{variant:"ghost",className:`w-full flex items-center px-4 py-3 text-sm font-medium text-gray-600 hover:bg-red-50 hover:text-red-600 transition-colors mt-4 ${!f&&a?"justify-center px-2":"justify-start"}`,title:!f&&a?"Logout":void 0,children:[i.jsx(EF,{className:`h-5 w-5 flex-shrink-0 ${!a||f?"mr-3":""}`}),(!a||f)&&"Logout"]})}),i.jsxs(vp,{children:[i.jsxs(yp,{children:[i.jsx(_p,{children:"Are you sure you want to log out?"}),i.jsx(bp,{children:"You will be signed out of your account and redirected to the login page."})]}),i.jsxs(wp,{children:[i.jsx(Np,{children:"Cancel"}),i.jsx(Sp,{onClick:b,children:"Yes, Log Out"})]})]})]})]}),(!a||f)&&i.jsx("div",{className:"border-t border-gray-200 p-4",children:i.jsxs("button",{onClick:S,className:"w-full flex items-center space-x-3 p-3 rounded-lg hover:bg-gray-50 transition-colors",children:[u!=null&&u.avatar_url?i.jsx("img",{src:u.avatar_url,alt:w,className:"h-10 w-10 rounded-full object-cover"}):(T=o==null?void 0:o.user_metadata)!=null&&T.avatar_url?i.jsx("img",{src:o.user_metadata.avatar_url,alt:w,className:"h-10 w-10 rounded-full object-cover"}):i.jsx("div",{className:"h-10 w-10 rounded-full bg-gray-200 flex items-center justify-center text-lg font-bold text-gray-500",children:w.charAt(0).toUpperCase()}),i.jsxs("div",{className:"flex-1 min-w-0 text-left",children:[i.jsx("p",{className:"text-sm font-medium text-gray-900 truncate",children:w}),i.jsx("p",{className:"text-xs text-gray-500 truncate",children:v})]})]})}),!f&&a&&i.jsx("div",{className:"border-t border-gray-200 p-4 flex justify-center",children:i.jsx("button",{onClick:S,className:"p-2 rounded-lg hover:bg-gray-50 transition-colors",title:w,children:u!=null&&u.avatar_url?i.jsx("img",{src:u.avatar_url,alt:w,className:"h-10 w-10 rounded-full object-cover"}):(N=o==null?void 0:o.user_metadata)!=null&&N.avatar_url?i.jsx("img",{src:o.user_metadata.avatar_url,alt:w,className:"h-10 w-10 rounded-full object-cover"}):i.jsx("div",{className:"h-10 w-10 rounded-full bg-gray-200 flex items-center justify-center text-lg font-bold text-gray-500",children:w.charAt(0).toUpperCase()})})})]})})},Nt=B1,BT=vT,W9=U1,O2=W1,UT=y.forwardRef(({className:e,...t},r)=>i.jsx(gp,{ref:r,className:De("fixed inset-0 z-[12000] bg-black/60 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 pointer-events-auto",e),...t}));UT.displayName=gp.displayName;const bt=y.forwardRef(({className:e,children:t,...r},n)=>i.jsxs(W9,{children:[i.jsx(UT,{}),i.jsx(xp,{ref:n,className:De("fixed left-1/2 top-1/2 z-[13000] border-4 border-red-500 bg-white grid w-full max-w-lg -translate-x-1/2 -translate-y-1/2 shadow-2xl rounded-2xl p-8 sm:p-10 duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] pointer-events-auto overflow-visible",e),...r,children:t})]}));bt.displayName=xp.displayName;const jt=({className:e,...t})=>i.jsx("div",{className:De("flex flex-col space-y-1.5 text-center sm:text-left",e),...t});jt.displayName="DialogHeader";const G1=({className:e,...t})=>i.jsx("div",{className:De("flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2",e),...t});G1.displayName="DialogFooter";const Et=y.forwardRef(({className:e,...t},r)=>i.jsx(z1,{ref:r,className:De("text-lg font-semibold leading-none tracking-tight",e),...t}));Et.displayName=z1.displayName;const $t=y.forwardRef(({className:e,...t},r)=>i.jsx(V1,{ref:r,className:De("text-sm text-muted-foreground",e),...t}));$t.displayName=V1.displayName;const H9=yf("inline-flex items-center rounded-full border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground hover:bg-primary/80",secondary:"border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80",destructive:"border-transparent bg-destructive text-destructive-foreground hover:bg-destructive/80",outline:"text-foreground"}},defaultVariants:{variant:"default"}});function We({className:e,variant:t,...r}){return i.jsx("div",{className:De(H9({variant:t}),e),...r})}const q1=()=>{const[e,t]=y.useState([]),[r,n]=y.useState(!0),[s,a]=y.useState(new Set),{user:o}=kt(),{toast:l}=St();y.useEffect(()=>{if(o){const w=localStorage.getItem(`notifications_read_${o.id}`);if(w)try{const v=new Set(JSON.parse(w));a(v)}catch{}}},[o]);const c=y.useCallback(w=>{if(o)try{localStorage.setItem(`notifications_read_${o.id}`,JSON.stringify([...w]))}catch{}},[o]),u=y.useCallback(async()=>{if(o)try{n(!0),od.log("Fetching notifications for user:",o.id);const w=new Date(Date.now()-7*24*60*60*1e3).toISOString(),[v,_,b]=await Promise.allSettled([he.from("meetings").select("*").gte("created_at",w).order("created_at",{ascending:!1}).limit(3),he.from("documents").select("*").gte("created_at",w).order("created_at",{ascending:!1}).limit(3),he.from("polls").select("*").gte("created_at",w).order("created_at",{ascending:!1}).limit(3)]),S=v.status==="fulfilled"?v.value.data||[]:[],T=_.status==="fulfilled"?_.value.data||[]:[],N=b.status==="fulfilled"?b.value.data||[]:[],C=[],E=new Date;S.forEach(j=>{if(!j.title||!j.start_time)return;const M=new Date(j.start_time),A=new Date,X=(M.getTime()-A.getTime())/(1e3*60*60),Y=new Date(j.created_at);(A.getTime()-Y.getTime())/(1e3*60*60*24)<=3&&C.push({id:`meeting-${j.id}`,title:"New Meeting Scheduled",message:`${j.title} scheduled for ${M.toLocaleString()}`,type:"meeting",read:!1,created_at:j.created_at,related_id:j.id,related_type:"meeting"}),X>0&&X<=24&&C.push({id:`meeting-reminder-${j.id}`,title:"Meeting Reminder",message:`${j.title} starts in ${Math.round(X)} hours (${M.toLocaleString()})`,type:"meeting",read:!1,created_at:A.toISOString(),related_id:j.id,related_type:"meeting"})}),T.forEach(j=>{if(!j.name)return;const M=new Date(j.created_at);(E.getTime()-M.getTime())/(1e3*60*60*24)<=3&&C.push({id:`document-${j.id}`,title:"Document Shared",message:`New document "${j.name}" has been uploaded`,type:"document",read:!1,created_at:j.created_at,related_id:j.id,related_type:"document"})}),N.forEach(j=>{if(!j.title||!j.deadline)return;const M=new Date(j.created_at);(E.getTime()-M.getTime())/(1e3*60*60*24)<=3&&C.push({id:`poll-${j.id}`,title:"New Poll Available",message:`Vote on "${j.title}" - Deadline: ${new Date(j.deadline).toLocaleDateString()}`,type:"voting",read:!1,created_at:j.created_at,related_id:j.id,related_type:"voting"})});const R=C.sort((j,M)=>new Date(M.created_at).getTime()-new Date(j.created_at).getTime()).slice(0,6).map(j=>({...j,read:s.has(j.id)}));od.log("Fetched notifications:",{total:R.length,unread:R.filter(j=>!j.read).length,readCount:s.size}),t(R)}catch{t([])}finally{n(!1)}},[o,s]),d=async(w,v,_,b)=>{try{const{error:S}=await he.functions.invoke("send-push-notification",{body:{title:w,body:v,data:_,userIds:b||[o==null?void 0:o.id]}});if(S)throw S;od.log("Push notification sent successfully")}catch{}},f=y.useCallback(()=>{const w=new Set(s);e.forEach(v=>w.add(v.id)),a(w),c(w),t(v=>v.map(_=>({..._,read:!0}))),l({title:"Success",description:"All notifications marked as read"})},[e,s,c,l]),p=y.useCallback(w=>{const v=new Set([...s,w]);a(v),c(v),t(_=>_.map(b=>b.id===w?{...b,read:!0}:b))},[s,c]),h=y.useCallback(w=>(p(w.id),{type:w.related_type,id:w.related_id}),[p]),g=y.useMemo(()=>e.filter(w=>!w.read).length,[e]),m=y.useCallback(()=>g,[g]),x=y.useCallback(w=>{const v=new Date(w),b=Math.floor((new Date().getTime()-v.getTime())/(1e3*60*60));if(b<1)return"Just now";if(b<24)return`${b} hours ago`;const S=Math.floor(b/24);return`${S} day${S>1?"s":""} ago`},[]);return y.useEffect(()=>{o&&u()},[o==null?void 0:o.id]),y.useEffect(()=>{if(o&&s.size>=0){const w=setTimeout(()=>{u()},100);return()=>clearTimeout(w)}},[s.size,o==null?void 0:o.id]),{notifications:e,loading:r,markAllAsRead:f,markAsRead:p,handleNotificationClick:h,getUnreadCount:m,getTimeAgo:x,fetchNotifications:u,sendPushNotification:d}},G9=({open:e,onOpenChange:t,onNavigate:r})=>{const{notifications:n,loading:s,markAllAsRead:a,handleNotificationClick:o,getUnreadCount:l,getTimeAgo:c,markAsRead:u}=q1(),d=y.useCallback(m=>{switch(m){case"meeting":return i.jsx(en,{className:"h-5 w-5 text-primary"});case"voting":return i.jsx(Gs,{className:"h-5 w-5 text-orange-500"});case"document":return i.jsx(tr,{className:"h-5 w-5 text-green-500"});default:return i.jsx(Bo,{className:"h-5 w-5 text-gray-500"})}},[]),f=y.useCallback(m=>{const x=o(m);if(r&&x){let w="dashboard";switch(x.type){case"meeting":w="meetings";break;case"document":w="documents";break;case"voting":w="voting";break;default:w="dashboard"}r(w,x.id)}},[o,r]),p=y.useCallback(()=>{a()},[a]),h=y.useCallback(m=>{u(m)},[u]),g=l();return s?i.jsx(Nt,{open:e,onOpenChange:t,children:i.jsxs(bt,{className:"sm:max-w-[500px]",children:[i.jsx(jt,{children:i.jsxs(Et,{className:"flex items-center space-x-2",children:[i.jsx(Bo,{className:"h-5 w-5"}),i.jsx("span",{children:"Notifications"})]})}),i.jsx("div",{className:"flex items-center justify-center py-8",children:i.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary"})})]})}):i.jsx(Nt,{open:e,onOpenChange:t,children:i.jsxs(bt,{className:"sm:max-w-[500px] p-0 rounded-2xl shadow-xl bg-white",children:[i.jsxs(jt,{className:"sticky top-0 z-10 bg-white rounded-t-2xl border-b px-6 pt-5 pb-3",children:[i.jsxs(Et,{className:"flex items-center space-x-2 text-lg font-bold",children:[i.jsx(Bo,{className:"h-5 w-5 text-primary"}),i.jsx("span",{children:"Notifications"}),g>0&&i.jsxs(We,{className:"bg-primary text-white px-2 py-0.5 rounded-full text-xs",children:[g," new"]})]}),i.jsx($t,{className:"text-xs text-gray-500 mt-1",children:"Stay updated with all platform activities"})]}),i.jsx("div",{className:"max-h-[28rem] overflow-y-auto px-2 sm:px-4 py-2 bg-white rounded-b-2xl",children:n.length===0?i.jsxs("div",{className:"flex flex-col items-center justify-center py-16 text-gray-400",children:[i.jsx(Bo,{className:"h-12 w-12 mb-4"}),i.jsx("p",{className:"font-medium text-base",children:"No notifications yet"}),i.jsx("p",{className:"text-xs text-gray-400 mt-1",children:"You'll see updates here when activities happen"})]}):i.jsx("div",{className:"space-y-3",children:n.map(m=>i.jsxs("div",{className:`flex items-start gap-3 p-4 rounded-xl border transition-colors group ${m.read?"bg-gray-50 border-gray-200":"bg-blue-50 border-blue-200 shadow-sm"}`,children:[i.jsx("div",{className:"flex-shrink-0 mt-1",children:d(m.type)}),i.jsxs("div",{className:"flex-1 min-w-0",children:[i.jsxs("div",{className:"flex justify-between items-start",children:[i.jsx("h4",{className:`text-sm font-semibold ${m.read?"text-gray-900":"text-primary"}`,children:m.title}),i.jsxs("div",{className:"flex items-center space-x-2",children:[!m.read&&i.jsx("span",{className:"w-2 h-2 bg-primary rounded-full"}),i.jsx(qr,{className:"h-3 w-3 text-gray-400"}),i.jsx("span",{className:"text-xs text-gray-500",children:c(m.created_at)})]})]}),i.jsx("p",{className:"text-xs text-gray-600 mt-1 line-clamp-2",children:m.message}),i.jsxs("div",{className:"flex gap-2 mt-2",children:[i.jsx(ue,{variant:"outline",size:"sm",className:"text-xs px-2 py-1 rounded-md border-gray-300 hover:bg-primary/10",onClick:()=>f(m),children:"View"}),!m.read&&i.jsx(ue,{variant:"ghost",size:"sm",className:"text-xs px-2 py-1 rounded-md text-primary hover:bg-primary/10",onClick:()=>h(m.id),children:"Mark as Read"})]})]})]},m.id))})}),n.length>0&&g>0&&i.jsx("div",{className:"flex justify-end px-6 py-3 border-t bg-white rounded-b-2xl",children:i.jsxs(ue,{variant:"outline",size:"sm",onClick:p,className:"text-xs px-3 py-1 rounded-md border-gray-300 hover:bg-primary/10",children:[i.jsx(Qa,{className:"h-4 w-4 mr-1"}),"Mark All Read"]})})]})})},q9=({onMenuClick:e,onProfileClick:t,onSettingsClick:r,onNavigate:n,showMenuButton:s=!0})=>{var g,m;const[a,o]=y.useState(!1),{user:l}=kt(),c=lu(),{getUnreadCount:u}=q1(),d=u();(g=l==null?void 0:l.user_metadata)!=null&&g.first_name?`${l.user_metadata.first_name} ${l.user_metadata.last_name||""}`.trim():(m=l==null?void 0:l.email)!=null&&m.split("@")[0];const f=y.useCallback((x,w)=>{o(!1),n&&n(x,w)},[n]);y.useCallback(()=>{t&&t()},[t]);const p=y.useCallback(()=>{n&&n("dashboard")},[n]),h=y.useCallback(()=>{o(!0)},[d]);return i.jsxs(i.Fragment,{children:[c&&i.jsx("div",{className:"fixed top-0 left-0 right-0 h-12 bg-[#8E1616] z-60","aria-hidden":"true"}),i.jsx("header",{className:`bg-white border-b border-gray-200 px-4 py-3 fixed left-0 right-0 h-16 ${c?"top-12 z-60":"top-0 z-50"}`,role:"banner",children:i.jsxs("div",{className:"flex items-center justify-between h-full",children:[i.jsxs("div",{className:"flex items-center space-x-4",children:[e&&s&&i.jsx(ue,{variant:"ghost",size:"icon",onClick:e,className:"hover:bg-gray-100 transition-colors",title:c?"Open navigation menu":"Toggle sidebar","aria-label":c?"Open navigation menu":"Toggle sidebar","aria-expanded":"false",children:i.jsx(kF,{className:"h-4 w-4 text-foreground","aria-hidden":"true"})}),i.jsxs("button",{onClick:p,className:"flex items-center space-x-3 hover:opacity-80 transition-opacity",title:"Go to Dashboard","aria-label":"Go to Dashboard",children:[i.jsx("div",{className:"flex items-center justify-center w-10 h-10 flex-shrink-0",children:i.jsx("img",{src:"/icons/icon-512.png",alt:"ISKCON Logo",className:"w-full h-full object-contain"})}),i.jsxs("div",{className:"text-left",children:[!c&&i.jsxs(i.Fragment,{children:[i.jsx("h1",{className:"text-xl font-bold text-[#8E1616]",children:"ISKCON BUREAU"}),i.jsx("p",{className:"text-sm text-muted-foreground -mt-1",children:"Management Portal"})]}),c&&i.jsxs(i.Fragment,{children:[i.jsx("h1",{className:"text-lg font-bold text-[#8E1616]",children:"ISKCON BUREAU"}),i.jsx("p",{className:"text-xs text-muted-foreground -mt-1",children:"Management Portal"})]})]})]})]}),i.jsxs("div",{className:"flex items-center space-x-2",children:[i.jsxs(ue,{variant:"ghost",size:"icon",onClick:h,className:"relative","aria-label":`Notifications${d>0?` (${d} unread)`:""}`,"aria-haspopup":"dialog",children:[i.jsx(Bo,{className:"h-4 w-4 text-foreground","aria-hidden":"true"}),d>0&&i.jsx("span",{className:"absolute -top-1 -right-1 h-3 w-3 bg-[#8E1616] rounded-full animate-pulse","aria-label":`${d} unread notifications`})]}),i.jsx(ue,{variant:"ghost",size:"icon",onClick:r,"aria-label":"Settings",children:i.jsx(bf,{className:"h-4 w-4 text-foreground","aria-hidden":"true"})})]})]})}),i.jsx(G9,{open:a,onOpenChange:o,onNavigate:f})]})},Y9=({children:e})=>{const[t,r]=y.useState(!0),[n,s]=y.useState(!1),[a,o]=y.useState("dashboard"),l=lu(),c=yl(),u=_o();od.log("Layout - Current location:",c.pathname),y.useEffect(()=>{const p=c.pathname;let h="dashboard";p==="/"?h="dashboard":p.startsWith("/")&&(h=p.substring(1)),o(h)},[c]),y.useEffect(()=>{r(!l)},[l]);const d=(p,h)=>{if(o(p),l&&r(!1),p==="documents"&&h){u(`/documents/doc/${h}`);return}if(p==="meetings"&&h){u("/meetings",{state:{highlightMeetingId:h}});return}if(p==="voting"&&h){u("/voting",{state:{highlightPollId:h}});return}const g=p==="dashboard"?"/":`/${p}`;try{u(g)}catch{window.location.href=g}},f=[{id:"dashboard",icon:wf,label:"Home"},{id:"meetings",icon:en,label:"Meeting"},{id:"documents",icon:Ld,label:"Docs"},{id:"attendance",icon:sl,label:"Attendance"},{id:"voting",icon:Gs,label:"Voting"}];return i.jsxs("div",{className:"min-h-screen flex w-full",style:{backgroundColor:"#FCFAF5"},role:"application",children:[l&&t&&i.jsx("div",{className:"fixed inset-0 bg-black/30 backdrop-blur-sm z-40",onClick:()=>r(!1),"aria-hidden":"true"}),i.jsx(q9,{onMenuClick:()=>{l?r(!t):s(!n)},onProfileClick:()=>d("settings"),onSettingsClick:()=>d("settings"),onNavigate:d,showMenuButton:!0}),i.jsx(V9,{isOpen:t,onClose:()=>r(!1),currentModule:a,onModuleChange:d,isCollapsed:!l&&n}),i.jsxs("div",{className:`flex-1 flex flex-col min-w-0 w-full transition-all duration-300 ${l?"ml-0":!l&&t&&!n?"ml-64":!l&&t&&n?"ml-16":"ml-0"} ${l?"pt-28":"pt-16"}`,children:[i.jsx("main",{className:`flex-1 w-full min-w-0 overflow-x-hidden transition-all duration-300 ${l?"p-4 pb-32":"p-6"}`,style:{},role:"main","aria-label":`${a.charAt(0).toUpperCase()+a.slice(1)} module content`,children:i.jsx("div",{className:"w-full max-w-none mx-auto",children:e})}),l&&i.jsx("nav",{className:"bg-white border-t border-gray-200 px-2 py-2 fixed bottom-2 left-0 right-0 z-30 h-20 mx-2 rounded-lg shadow-lg",role:"navigation","aria-label":"Mobile navigation",children:i.jsx("div",{className:"flex items-center justify-around h-full max-w-full",children:f.map(p=>i.jsxs("button",{onClick:()=>d(p.id),className:`flex flex-col items-center justify-center flex-1 py-2 px-1 transition-colors duration-200 h-full ${a===p.id?"text-primary":"text-black hover:text-gray-700"}`,style:{WebkitTapHighlightColor:"transparent",touchAction:"manipulation"},"aria-label":`Navigate to ${p.label}`,"aria-current":a===p.id?"page":void 0,children:[i.jsx(p.icon,{className:`h-8 w-8 mb-1 ${a===p.id?"text-primary":"text-black"}`,"aria-hidden":"true"}),i.jsx("span",{className:`text-xs font-medium leading-tight ${a===p.id?"text-primary":"text-black"}`,children:p.label})]},p.id))})})]})]})},Ye=y.forwardRef(({className:e,...t},r)=>i.jsx("div",{ref:r,className:De("rounded-lg border bg-card text-card-foreground shadow-sm",e),...t}));Ye.displayName="Card";const ct=y.forwardRef(({className:e,...t},r)=>i.jsx("div",{ref:r,className:De("flex flex-col space-y-1.5 p-6",e),...t}));ct.displayName="CardHeader";const ft=y.forwardRef(({className:e,...t},r)=>i.jsx("h3",{ref:r,className:De("text-2xl font-semibold leading-none tracking-tight",e),...t}));ft.displayName="CardTitle";const tn=y.forwardRef(({className:e,...t},r)=>i.jsx("p",{ref:r,className:De("text-sm text-muted-foreground",e),...t}));tn.displayName="CardDescription";const Je=y.forwardRef(({className:e,...t},r)=>i.jsx("div",{ref:r,className:De("p-6 pt-0",e),...t}));Je.displayName="CardContent";const K9=y.forwardRef(({className:e,...t},r)=>i.jsx("div",{ref:r,className:De("flex items-center p-6 pt-0",e),...t}));K9.displayName="CardFooter";function X9(e){switch(e){case"30min":return 30;case"1hour":return 60;case"1.5hours":return 90;case"2hours":return 120;case"3hours":return 180;default:const t=parseFloat(e);return isNaN(t)?60:t}}const _l=()=>{const[e,t]=y.useState([]),[r,n]=y.useState(!0),[s,a]=y.useState(new Map),{user:o}=kt(),{toast:l}=St(),c=async()=>{try{const{data:b,error:S}=await he.from("meetings").select("*, meeting_attendees(user_id)").order("start_time",{ascending:!0});if(S)throw S;if(!Array.isArray(b)){console.warn("Meetings API returned non-array data:",b),t([]);return}const T=b.filter(R=>R&&R.id&&R.start_time&&R.end_time&&R.title);T.length!==b.length&&console.warn("Some meetings were skipped due to missing required fields.");const N=Array.from(new Set((T||[]).map(R=>R.created_by).filter(Boolean)));let C={};if(N.length>0){const{data:R}=await he.from("profiles").select("id, first_name, last_name, email").in("id",N);if(R)for(const j of R)C[j.id]=j}const E=(T||[]).map(R=>{let j=R.created_by;const M=C[R.created_by];M&&(j=M.first_name?`${M.first_name} ${M.last_name||""}`.trim():M.email||R.created_by);let A=[];Array.isArray(R.manual_attendees)&&(A=R.manual_attendees.map(Y=>typeof Y=="string"?{email:Y,rsvp:null}:Y&&typeof Y.email=="string"?{email:Y.email,rsvp:Y.rsvp||null}:null).filter(Boolean));const I=Array.isArray(R.meeting_attendees)?R.meeting_attendees:[],X=I.length+(Array.isArray(A)?A.length:0);return{...R,created_by_name:j,manual_attendees:A,meeting_attendees:I,attendee_count:X}});let P=E;o&&o.role!=="admin"&&o.role!=="super_admin"&&(P=E.filter((R,j,M)=>R.attendee_count===0&&R.created_by===o.id&&M.some(I=>I.id!==R.id&&I.title===R.title&&I.start_time===R.start_time&&I.created_by!==o.id)?!1:R.created_by===o.id||Array.isArray(R.meeting_attendees)&&R.meeting_attendees.some(I=>I.user_id===o.id))),t(P)}catch(b){console.error("Error fetching meetings:",b),t([]),l({title:"Error",description:"Failed to load meetings",variant:"destructive"})}finally{n(!1)}};y.useEffect(()=>{c();const b=he.channel("meetings-changes").on("postgres_changes",{event:"*",schema:"public",table:"meetings"},T=>{var N;if(console.log("Meetings table changed:",T),T.eventType==="DELETE"){console.log("Meeting deleted from database:",(N=T.old)==null?void 0:N.id),t(C=>C.filter(E=>{var P;return E.id!==((P=T.old)==null?void 0:P.id)}));return}setTimeout(()=>{c()},500)}).subscribe(),S=he.channel("meeting-attendees-changes").on("postgres_changes",{event:"*",schema:"public",table:"meeting_attendees"},T=>{console.log("Meeting attendees changed:",T),setTimeout(()=>{c()},500)}).subscribe();return()=>{he.removeChannel(b),he.removeChannel(S)}},[]);const u=async b=>{if(!o){l({title:"Authentication Required",description:"Please sign in to create meetings",variant:"destructive"});return}try{const S=new Date(`${b.date.toISOString().split("T")[0]}T${b.time}`),T=X9(b.duration),N=new Date(S.getTime()+T*6e4);console.log("Creating meeting with data:",{title:b.title,description:b.description,start_time:S.toISOString(),end_time:N.toISOString(),location:b.location,meeting_type:b.type,created_by:o.id});let C,E=null,P=null,R=!1;if(b.type==="online"||b.type==="hybrid"){const{data:Y}=await he.from("profiles").select("microsoft_access_token").eq("id",o.id).single();if(Y!=null&&Y.microsoft_access_token){const{data:z,error:U}=await he.functions.invoke("create-teams-meeting",{body:{title:b.title,description:b.description,startTime:S.toISOString(),endTime:N.toISOString(),attendees:b.attendees?b.attendees.split(",").map(V=>V.trim()):[]}});U?(console.error("Teams meeting creation failed:",U),l({title:"Teams Meeting Creation Failed",description:"Creating regular meeting instead. Connect Microsoft account for Teams integration.",variant:"destructive"})):z!=null&&z.meeting&&(E=z.meeting.teams_join_url||null,P=z.meeting.teams_meeting_id||null,R=!0,l({title:"Teams Meeting Created!",description:`"${b.title}" created with Teams link and calendar event`}))}else l({title:"Microsoft Account Not Connected",description:"Connect your Microsoft account in Settings to create Teams meetings automatically",variant:"destructive"})}let j=[],M=[];if(b.attendees){const Y=b.attendees.split(",").map(z=>z.trim());for(const z of Y){const{data:U}=await he.from("profiles").select("id").eq("email",z).single();U!=null&&U.id?j.push(z):M.push(z)}}const A=M.map(Y=>({email:Y,rsvp:null}));console.log("Inserting meeting:",{meeting_id:b.meeting_id,...b});const{data:I,error:X}=await he.from("meetings").insert({meeting_id:b.meeting_id,title:b.title,description:b.description,start_time:S.toISOString(),end_time:N.toISOString(),location:b.location,meeting_type:b.type,status:"scheduled",created_by:o.id,manual_attendees:A,teams_join_url:E,teams_meeting_id:P,agendas:b.agendas}).select().single();if(X)throw X;return C=I,R&&C&&P&&await p(C.id,P),o&&o.email&&!j.includes(o.email)&&j.unshift(o.email),j.length>0&&await f(C.id,j.join(", ")),b.attendees&&C&&await d(C,b.attendees,b.attachments),l({title:"Meeting Created",description:`"${b.title}" has been scheduled successfully`}),c(),C}catch(S){console.error("Error creating meeting:",S),l({title:"Creation Failed",description:S.message||"Failed to create meeting",variant:"destructive"})}},d=async(b,S,T)=>{try{const N=S.split(",").map(X=>X.trim());let C=[];if(T&&T.length>0){const{data:X}=await he.from("meeting_attachments").select("*").eq("meeting_id",b.id);C=X||[]}const E=new Date(b.start_time),P=new Date(b.end_time),R=E.toLocaleDateString("en-US",{weekday:"long",year:"numeric",month:"long",day:"numeric"}),j=`${E.toLocaleTimeString("en-US",{hour:"numeric",minute:"2-digit",hour12:!0})} - ${P.toLocaleTimeString("en-US",{hour:"numeric",minute:"2-digit",hour12:!0})}`,M=`
        <div style="font-family: Arial, sans-serif; max-width: 600px; margin: 0 auto; padding: 20px; background-color: #ffffff;">
          <div style="text-align: center; margin-bottom: 30px;">
            <h1 style="color: #2563eb; font-size: 28px; margin: 0; font-weight: 600;">Meeting Invitation</h1>
          </div>
          
          <div style="background-color: #f8fafc; padding: 25px; border-radius: 8px; border-left: 4px solid #2563eb; margin-bottom: 25px;">
            <h2 style="margin: 0 0 20px 0; color: #1e293b; font-size: 22px; font-weight: 600;">${b.title}</h2>
            
            <table style="width: 100%; border-collapse: collapse;">
              <tr>
                <td style="padding: 8px 0; vertical-align: top; width: 80px;">
                  <strong style="color: #374151;">Date:</strong>
                </td>
                <td style="padding: 8px 0; color: #1f2937;">
                  ${R}
                </td>
              </tr>
              <tr>
                <td style="padding: 8px 0; vertical-align: top;">
                  <strong style="color: #374151;">Time:</strong>
                </td>
                <td style="padding: 8px 0; color: #1f2937;">
                  ${j}
                </td>
              </tr>
              <tr>
                <td style="padding: 8px 0; vertical-align: top;">
                  <strong style="color: #374151;">Location:</strong>
                </td>
                <td style="padding: 8px 0; color: #1f2937;">
                  ${b.location||"To be determined"}
                </td>
              </tr>
              ${b.teams_join_url?`
                <tr>
                  <td style="padding: 8px 0; vertical-align: top;">
                    <strong style="color: #374151;">Join Online:</strong>
                  </td>
                  <td style="padding: 8px 0;">
                    <a href="${b.teams_join_url}" style="color: #2563eb; text-decoration: none; background-color: #dbeafe; padding: 8px 12px; border-radius: 4px; display: inline-block;">Click to join Teams meeting</a>
                  </td>
                </tr>
              `:""}
            </table>
            
            ${b.description?`
              <div style="margin-top: 20px; padding-top: 20px; border-top: 1px solid #e5e7eb;">
                <strong style="color: #374151; display: block; margin-bottom: 8px;">Description:</strong>
                <p style="margin: 0; color: #4b5563; line-height: 1.5;">${b.description}</p>
              </div>
            `:""}
          </div>
          
          ${C.length>0?`
            <div style="margin-bottom: 25px; padding: 20px; background-color: #f9fafb; border-radius: 6px;">
              <strong style="color: #374151; display: block; margin-bottom: 12px;">Attachments:</strong>
              <ul style="margin: 0; padding-left: 20px; color: #4b5563;">
                ${C.map(X=>`<li style="margin-bottom: 4px;">${X.name}</li>`).join("")}
              </ul>
            </div>
          `:""}
          
          <div style="background-color: #fef3c7; padding: 15px; border-radius: 6px; border-left: 4px solid #f59e0b; margin-bottom: 25px;">
            <p style="margin: 0; color: #92400e; font-weight: 500;">
              Please mark your calendar and let us know if you cannot attend.
            </p>
          </div>
          
          <div style="text-align: center; padding-top: 20px; border-top: 1px solid #e5e7eb;">
            <p style="color: #6b7280; font-size: 14px; margin: 0;">
              This invitation was sent automatically by the meeting management system.
            </p>
          </div>
        </div>
      `,{data:A,error:I}=await he.functions.invoke("send-outlook-email",{body:{subject:`Meeting Invitation: ${b.title}`,body:M,recipients:N,attachments:C,meetingId:b.id}});I?(console.error("Error sending invitations:",I),l({title:"Invitation Email Failed",description:"Meeting created but email invitations could not be sent",variant:"destructive"})):l({title:"Invitations Sent",description:`Meeting invitations sent to ${N.length} attendee(s)${C.length>0?` with ${C.length} attachment(s)`:""}`})}catch(N){console.error("Error sending meeting invitations:",N)}},f=async(b,S)=>{try{const T=S.split(",").map(N=>N.trim());for(const N of T){const{data:C}=await he.from("profiles").select("id").eq("email",N).maybeSingle();C?await he.from("meeting_attendees").insert({meeting_id:b,user_id:C.id,status:"pending"}):console.warn(`No user profile found for attendee email: ${N}`)}}catch(T){console.error("Error adding attendees:",T)}},p=async(b,S)=>{try{await he.from("meeting_transcripts").insert({meeting_id:b,teams_transcript_id:S,created_at:new Date().toISOString()})}catch(T){console.error("Error saving transcript reference:",T)}},h=async(b,S,T)=>{if(!o){l({title:"Authentication Required",description:"Please sign in to delete meetings",variant:"destructive"});return}const N=e.find(E=>E.id===b);if(!N){l({title:"Meeting Not Found",description:"The meeting you're trying to delete was not found",variant:"destructive"});return}if(!(N.created_by===o.id||S||T)){l({title:"Permission Denied",description:"You can only delete meetings you created unless you are an admin or super admin",variant:"destructive"});return}const C=[{step:"Preparing deletion",completed:!1},{step:"Removing from Microsoft Teams",completed:!1},{step:"Deleting Outlook calendar event",completed:!1},{step:"Cleaning up attachments",completed:!1},{step:"Removing attendee records",completed:!1},{step:"Deleting attendance data",completed:!1},{step:"Removing transcripts",completed:!1},{step:"Finalizing deletion",completed:!1}];a(E=>new Map(E.set(b,[...C]))),t(E=>E.filter(P=>P.id!==b));try{if(console.log(`Starting comprehensive deletion for meeting: ${b}`),await g(b,0,!0),N.teams_meeting_id||N.outlook_event_id)try{const{data:A}=await he.from("profiles").select("microsoft_access_token").eq("id",o.id).maybeSingle();if(A!=null&&A.microsoft_access_token){if(N.teams_meeting_id){console.log(`Deleting Teams meeting: ${N.teams_meeting_id}`);const I=await fetch(`https://graph.microsoft.com/v1.0/me/onlineMeetings/${N.teams_meeting_id}`,{method:"DELETE",headers:{Authorization:`Bearer ${A.microsoft_access_token}`}});if(!I.ok&&I.status!==404)throw new Error(`Teams deletion failed: ${I.statusText}`)}if(await g(b,1,!0),N.outlook_event_id){console.log(`Deleting Outlook event: ${N.outlook_event_id}`);const I=await fetch(`https://graph.microsoft.com/v1.0/me/events/${N.outlook_event_id}`,{method:"DELETE",headers:{Authorization:`Bearer ${A.microsoft_access_token}`}});if(!I.ok&&I.status!==404)throw new Error(`Outlook deletion failed: ${I.statusText}`)}await g(b,2,!0)}else await g(b,1,!0),await g(b,2,!0)}catch(A){console.warn("Microsoft services deletion warning:",A),await g(b,1,!0,`Warning: ${A}`),await g(b,2,!0,`Warning: ${A}`)}else await g(b,1,!0),await g(b,2,!0);console.log("Deleting meeting attachments...");const{error:E}=await he.from("meeting_attachments").delete().eq("meeting_id",b);E?(console.warn("Attachments deletion warning:",E),await g(b,3,!0,`Warning: ${E.message}`)):await g(b,3,!0),console.log("Deleting meeting attendees...");const{error:P}=await he.from("meeting_attendees").delete().eq("meeting_id",b);P?(console.warn("Attendees deletion warning:",P),await g(b,4,!0,`Warning: ${P.message}`)):await g(b,4,!0),console.log("Deleting attendance records...");const{error:R}=await he.from("attendance_records").delete().eq("meeting_id",b);R?(console.warn("Attendance deletion warning:",R),await g(b,5,!0,`Warning: ${R.message}`)):await g(b,5,!0),console.log("Deleting meeting transcripts...");const{error:j}=await he.from("meeting_transcripts").delete().eq("meeting_id",b);j?(console.warn("Transcripts deletion warning:",j),await g(b,6,!0,`Warning: ${j.message}`)):await g(b,6,!0),console.log("Deleting main meeting record...");const{error:M}=await he.from("meetings").delete().eq("id",b);if(M)throw console.error("Failed to delete meeting from database:",M),t(A=>[...A,N].sort((I,X)=>new Date(I.start_time).getTime()-new Date(X.start_time).getTime())),new Error(`Database deletion failed: ${M.message}`);await g(b,7,!0),console.log("Meeting successfully deleted from all platforms"),l({title:"Meeting Deleted Successfully",description:`"${N.title}" has been permanently removed from all platforms`}),setTimeout(()=>{a(A=>{const I=new Map(A);return I.delete(b),I}),setTimeout(()=>{c()},1e3)},2e3)}catch(E){console.error("Error in comprehensive meeting deletion:",E),t(P=>[...P,N].sort((R,j)=>new Date(R.start_time).getTime()-new Date(j.start_time).getTime())),l({title:"Delete Failed",description:E.message||"Failed to delete meeting completely. Please try again.",variant:"destructive"}),a(P=>{const R=new Map(P);return R.delete(b),R})}},g=async(b,S,T,N)=>{a(C=>{const E=new Map(C),R=[...E.get(b)||[]];return R[S]&&(R[S]={...R[S],completed:T,error:N}),E.set(b,R),E}),await new Promise(C=>setTimeout(C,300))};return{meetings:e,loading:r,deletingMeetings:s,createMeeting:u,updateMeeting:async(b,S)=>{try{const{data:T,error:N}=await he.from("meetings").update(S).eq("id",b).select().single();if(N)throw N;return await c(),T}catch(T){return console.error("Error updating meeting:",T),l({title:"Error",description:"Failed to update meeting",variant:"destructive"}),null}},deleteMeeting:h,deletePastMeeting:async b=>{const S=e.find(C=>C.id===b);if(!S)return;const T=new Date;if(new Date(S.end_time)>T){l({title:"Cannot Delete",description:"Can only delete past meetings using this function",variant:"destructive"});return}await h(b,!1,!1)},fetchMeetings:c,autoSaveTranscript:async b=>{try{const{data:S}=await he.from("profiles").select("microsoft_access_token").eq("id",o==null?void 0:o.id).single();if(!(S!=null&&S.microsoft_access_token))return;const T=e.find(E=>E.id===b);if(!(T!=null&&T.teams_meeting_id))return;const{data:N,error:C}=await he.functions.invoke("fetch-teams-transcript",{body:{meetingId:T.teams_meeting_id,accessToken:S.microsoft_access_token}});if(C)throw C;if(N!=null&&N.transcript){await he.from("meeting_transcripts").upsert({meeting_id:b,transcript_content:JSON.stringify(N.transcript),participants:N.attendees,teams_transcript_id:T.teams_meeting_id});const E=`${T.title}_transcript_${new Date().toISOString().split("T")[0]}.txt`;await he.from("documents").insert({name:E,file_path:`transcripts/${b}/${E}`,folder:"Meeting Transcripts",uploaded_by:o==null?void 0:o.id,mime_type:"text/plain",file_size:JSON.stringify(N.transcript).length}),l({title:"Transcript Saved",description:"Meeting transcript has been automatically saved to documents"})}}catch(S){console.error("Error auto-saving transcript:",S)}},getDeletionProgress:b=>s.get(b)||[],isDeletingMeeting:b=>s.has(b)}},jp=e=>{const[t,r]=y.useState([]),[n,s]=y.useState([]),[a,o]=y.useState({}),[l,c]=y.useState(!0),{user:u}=kt(),{toast:d}=St();aC();const f=y.useCallback(async()=>{try{const{data:R,error:j}=await he.from("profiles").select("id, first_name, last_name");if(j)throw j;const M=(R||[]).reduce((A,I)=>(A[I.id]={first_name:I.first_name||"",last_name:I.last_name||""},A),{});o(M)}catch(R){console.error("Error fetching user profiles:",R)}},[]),p=y.useCallback(async()=>{try{console.log("Fetching documents for folder:",e);let R=he.from("documents").select("*");e?R=R.eq("folder_id",e):R=R.is("folder_id",null);const{data:j,error:M}=await R.order("created_at",{ascending:!1});if(M)throw console.error("Database error:",M),M;const A=(j||[]).map(I=>({...I,id:typeof I.id=="string"?I.id:"",name:typeof I.name=="string"?I.name:"Untitled",file_path:typeof I.file_path=="string"?I.file_path:"",created_at:typeof I.created_at=="string"?I.created_at:"",updated_at:typeof I.updated_at=="string"?I.updated_at:"",uploaded_by:typeof I.uploaded_by=="string"?I.uploaded_by:""}));console.log("Fetched documents:",A.length),r(A)}catch(R){console.error("Error fetching documents:",R),d({title:"Error",description:"Failed to load documents",variant:"destructive"}),r([])}},[e,d]),h=y.useCallback(async()=>{try{console.log("Fetching folders...");const{data:R,error:j}=await he.from("folders").select("*").order("name",{ascending:!0});if(j)throw console.error("Database error:",j),j;const M=(R||[]).map(A=>({...A,name:typeof A.name=="string"?A.name:"Folder"}));console.log("Fetched folders:",M.length),s(M)}catch(R){console.error("Error fetching folders:",R),d({title:"Error",description:"Failed to load folders",variant:"destructive"}),s([])}},[d]),g=y.useCallback(async()=>{try{await Promise.all([p(),h(),f()])}catch(R){console.error("Error refreshing documents:",R)}},[p,h,f]),m=pa({mutationFn:async({documentId:R,newName:j})=>{if(!R||!(j!=null&&j.trim()))throw new Error("Document ID and name are required");const{error:M}=await he.from("documents").update({name:j.trim(),updated_at:new Date().toISOString()}).eq("id",R);if(M)throw M},onSuccess:()=>{g()},onError:R=>{console.error("Rename mutation error:",R)}}),x=pa({mutationFn:async R=>{if(!R)throw new Error("Document ID is required");const{data:j,error:M}=await he.from("documents").select("*").eq("id",R).single();if(M)throw M;if(!j)throw new Error("Document not found");const{error:A}=await he.from("documents").insert({...j,id:void 0,name:`${j.name} (Copy)`,created_at:new Date().toISOString(),updated_at:new Date().toISOString()});if(A)throw A},onSuccess:()=>{g()},onError:R=>{console.error("Copy mutation error:",R)}}),w=pa({mutationFn:async({documentId:R,isImportant:j})=>{if(!R)throw new Error("Document ID is required");const{error:M}=await he.from("documents").update({is_important:j,updated_at:new Date().toISOString()}).eq("id",R);if(M)throw M},onSuccess:()=>{g()},onError:R=>{console.error("Toggle important mutation error:",R)}}),v=pa({mutationFn:async({documentId:R,targetFolderId:j})=>{if(!R)throw new Error("Document ID is required");const{error:M}=await he.from("documents").update({folder_id:j,folder:j?null:"general",updated_at:new Date().toISOString()}).eq("id",R);if(M)throw M},onSuccess:()=>{g()},onError:R=>{console.error("Move document mutation error:",R)}}),_=async(R,j)=>{if(!u){d({title:"Authentication Required",description:"Please sign in to upload documents",variant:"destructive"});return}if(!R){d({title:"No File Selected",description:"Please select a file to upload",variant:"destructive"});return}try{console.log("Starting upload for:",R.name,"Size:",R.size,"Type:",R.type);const M=100*1024*1024;if(R.size>M)throw new Error("File size exceeds 100MB limit");const A=R.name.split(".").pop()||"bin",I=`${Date.now()}-${Math.random().toString(36).substring(2)}.${A}`,X=j?`folders/${j}/${I}`:`root/${I}`;console.log("Uploading to storage path:",X);const{data:Y,error:z}=await he.storage.from("documents").upload(X,R,{cacheControl:"3600",upsert:!1});if(z)throw console.error("Storage upload error:",z),new Error(`Upload failed: ${z.message}`);console.log("File uploaded successfully:",Y);const{data:U}=he.storage.from("documents").getPublicUrl(X);if(!(U!=null&&U.publicUrl))throw new Error("Failed to get public URL");console.log("Public URL:",U.publicUrl);const{data:V,error:F}=await he.from("documents").insert({name:R.name,file_path:U.publicUrl,file_size:R.size,mime_type:R.type||"application/octet-stream",folder_id:j||null,folder:j?null:"general",uploaded_by:u.id}).select().single();if(F)throw console.error("Database insert error:",F),new Error(`Database error: ${F.message}`);return console.log("Document record created:",V),d({title:"Upload Complete",description:`Document "${R.name}" uploaded successfully`}),await g(),V}catch(M){throw console.error("Error uploading document:",M),d({title:"Upload Failed",description:M.message||"Failed to upload document",variant:"destructive"}),M}},b=async(R,j)=>{if(!u)return d({title:"Authentication Required",description:"Please sign in to create folders",variant:"destructive"}),null;if(!(R!=null&&R.trim()))return d({title:"Invalid Name",description:"Folder name cannot be empty",variant:"destructive"}),null;try{const{data:M,error:A}=await he.from("folders").insert({name:R.trim(),parent_folder_id:j||null,created_by:u.id,is_locked:!1}).select().single();if(A)throw A.code==="23505"?new Error("A folder with this name already exists in this location"):A;return await g(),M}catch(M){return console.error("Error creating folder:",M),d({title:"Create Failed",description:M.message||"Failed to create folder",variant:"destructive"}),null}},S=pa({mutationFn:async R=>{if(!R)throw new Error("Folder ID is required");const{data:j}=await he.from("documents").select("id").eq("folder_id",R);if(j&&j.length>0)for(const I of j){let X=!1;try{const{error:Y}=await he.rpc("move_to_recycle_bin",{_document_id:I.id,_deleted_by:(u==null?void 0:u.id)||"admin-script"});Y||(X=!0)}catch{}if(!X){const{error:Y}=await he.from("documents").delete().eq("id",I.id);Y&&console.error("Failed to delete document",I.id,Y)}}const{data:M}=await he.from("folders").select("id").eq("parent_folder_id",R);if(M&&M.length>0)for(const I of M)await S.mutateAsync(I.id);const{error:A}=await he.from("folders").delete().eq("id",R);if(A)throw A;return!0},onSuccess:()=>{g()},onError:R=>{console.error("Delete folder mutation error:",R)}}),T=pa({mutationFn:async R=>{if(!u)throw new Error("Authentication required");if(!R)throw new Error("Document ID is required");console.log("Deleting document:",R);const{error:j}=await he.rpc("move_to_recycle_bin",{_document_id:R,_deleted_by:u.id});if(j)throw console.error("RPC error:",j),j;console.log("Document moved to recycle bin successfully")},onSuccess:()=>{g()},onError:R=>{console.error("Delete document mutation error:",R)}}),N=pa({mutationFn:async R=>{const{error:j}=await he.from("folders").update({is_locked:!0}).eq("id",R);if(j)throw j},onSuccess:()=>{g()},onError:R=>{console.error("Lock folder mutation error:",R)}}),C=pa({mutationFn:async R=>{const{error:j}=await he.from("folders").update({is_locked:!1}).eq("id",R);if(j)throw j},onSuccess:()=>{g()},onError:R=>{console.error("Unlock folder mutation error:",R)}}),E=pa({mutationFn:async R=>{const{error:j}=await he.from("documents").update({is_locked:!0}).eq("id",R);if(j)throw j},onSuccess:()=>{g()},onError:R=>{console.error("Lock document mutation error:",R)}}),P=pa({mutationFn:async R=>{const{error:j}=await he.from("documents").update({is_locked:!1}).eq("id",R);if(j)throw j},onSuccess:()=>{g()},onError:R=>{console.error("Unlock document mutation error:",R)}});return y.useEffect(()=>{(async()=>{console.log("useDocuments - Initial data fetch for folder:",e),c(!0);try{await Promise.all([p(),h(),f()])}catch(j){console.error("Error in initial data fetch:",j)}finally{c(!1)}})()},[e]),{documents:t,folders:n,userProfiles:a,loading:l,uploadDocument:_,deleteDocument:T,moveDocument:v,createFolder:b,deleteFolder:S,renameDocumentMutation:m,copyDocument:x,toggleImportant:w,refreshDocuments:g,fetchDocuments:p,fetchFolders:h,lockFolder:N,unlockFolder:C,lockDocument:E,unlockDocument:P}},cu=()=>{const[e,t]=y.useState({isConnected:!1,isExpired:!1,accessToken:null,expiresAt:null,lastError:null}),[r,n]=y.useState(!0),[s,a]=y.useState([]),{user:o}=kt(),{toast:l}=St(),c=y.useCallback(()=>{const m=Date.now()-5*60*1e3;return s.filter(w=>w.timestamp>m).length<3},[s]),u=y.useCallback((g,m)=>{a(x=>[...x.slice(-9),{timestamp:Date.now(),success:g,error:m}])},[]),d=y.useCallback(async()=>{if(o)try{console.log("Clearing invalid Microsoft tokens for user:",o.id);const{error:g}=await he.from("profiles").update({microsoft_user_id:null,microsoft_access_token:null,microsoft_refresh_token:null,token_expires_at:null}).eq("id",o.id);g?console.error("Error clearing invalid tokens:",g):console.log("Invalid tokens cleared successfully")}catch(g){console.error("Exception clearing invalid tokens:",g)}},[o]),f=y.useCallback(async(g=0)=>{if(!o)return t(m=>({...m,isConnected:!1,isExpired:!1,accessToken:null,expiresAt:null,lastError:null})),n(!1),!1;try{console.log(`Microsoft auth check attempt ${g+1}`);const{data:m,error:x}=await he.from("profiles").select("microsoft_access_token, microsoft_refresh_token, token_expires_at").eq("id",o.id).single();if(x){if(console.error("Profile fetch error:",x),g<2)return await new Promise(b=>setTimeout(b,1e3*(g+1))),f(g+1);throw new Error(`Profile fetch failed: ${x.message}`)}if(!(m!=null&&m.microsoft_access_token))return console.log("No Microsoft token found"),t(b=>({...b,isConnected:!1,isExpired:!1,accessToken:null,expiresAt:null,lastError:null})),n(!1),!1;const w=new Date(m.token_expires_at),v=new Date,_=new Date(v.getTime()+10*60*1e3);if(w<=_){console.log("Token expires soon, attempting refresh...");try{const{data:b,error:S}=await he.functions.invoke("refresh-microsoft-token",{body:{user_id:o.id}});if(S){console.error("Token refresh error:",S);const T=S.message||"";if(T.includes("invalid_grant")||T.includes("AADSTS50173")||T.includes("expired")||T.includes("revoked"))return console.log("Authentication error detected, clearing tokens and marking as expired"),await d(),t(C=>({...C,isConnected:!1,isExpired:!0,accessToken:null,expiresAt:null,lastError:"Microsoft account authentication has expired and needs to be reconnected. This usually happens after a password change or security policy update."})),l({title:"Microsoft Account Needs Reconnection",description:"Your Microsoft account authentication has expired. Please disconnect and reconnect your account in Settings.",variant:"destructive"}),n(!1),!1;throw new Error(`Token refresh failed: ${S.message}`)}return b!=null&&b.error?(console.error("Token refresh API error:",b.error),b.error.includes("invalid_grant")||b.error.includes("AADSTS50173")||b.error.includes("expired")||b.error.includes("revoked")?(console.log("Authentication error in response, clearing tokens"),await d(),t(N=>({...N,isConnected:!1,isExpired:!0,accessToken:null,expiresAt:null,lastError:"Microsoft account authentication has expired. Please reconnect your account."})),l({title:"Microsoft Account Disconnected",description:"Authentication expired. Please reconnect your Microsoft account in Settings.",variant:"destructive"}),n(!1),!1):(t(N=>({...N,isConnected:!0,isExpired:!0,accessToken:m.microsoft_access_token,expiresAt:m.token_expires_at,lastError:`Token refresh failed: ${b.error}`})),n(!1),!1)):(console.log("Token refreshed successfully"),t(T=>({...T,isConnected:!0,isExpired:!1,accessToken:b.access_token,expiresAt:b.expires_at,lastError:null})),n(!1),!0)}catch(b){console.error("Token refresh exception:",b);const S=b.message||"";return S.includes("invalid_grant")||S.includes("AADSTS50173")||S.includes("expired")||S.includes("revoked")?(console.log("Authentication error in exception, clearing tokens"),await d(),t(N=>({...N,isConnected:!1,isExpired:!0,accessToken:null,expiresAt:null,lastError:"Microsoft account authentication has expired and must be reconnected"}))):t(N=>({...N,isConnected:!0,isExpired:!0,accessToken:m.microsoft_access_token,expiresAt:m.token_expires_at,lastError:b.message})),n(!1),!1}}else return console.log("Token is valid"),t(b=>({...b,isConnected:!0,isExpired:!1,accessToken:m.microsoft_access_token,expiresAt:m.token_expires_at,lastError:null})),n(!1),!0}catch(m){return console.error("Error checking Microsoft auth:",m),t(x=>({...x,isConnected:!1,isExpired:!1,accessToken:null,expiresAt:null,lastError:m.message})),n(!1),!1}},[o,l,d]);y.useEffect(()=>{if(o){f();const g=setInterval(()=>{f()},15*60*1e3);return()=>clearInterval(g)}},[o,f]);const p=y.useCallback(async()=>{if(o)try{const{error:g}=await he.from("profiles").update({microsoft_user_id:null,microsoft_access_token:null,microsoft_refresh_token:null,token_expires_at:null}).eq("id",o.id);if(g)throw g;t({isConnected:!1,isExpired:!1,accessToken:null,expiresAt:null,lastError:null}),a([]),console.log("Microsoft account disconnected successfully"),l({title:"Microsoft Account Disconnected",description:"You can now reconnect with a fresh authentication."})}catch(g){console.error("Error disconnecting Microsoft:",g),l({title:"Disconnection Failed",description:g.message||"Failed to disconnect Microsoft account",variant:"destructive"})}},[o,l]),h=y.useCallback(async()=>{if(!c()){l({title:"Rate Limited",description:"Too many connection attempts. Please wait 5 minutes before trying again.",variant:"destructive"});return}n(!0);const g=await f();u(g,e.lastError||void 0)},[c,f,l,e.lastError,u]);return{...e,loading:r,disconnectMicrosoft:p,forceRefresh:h,checkAndRefreshToken:f,canAttemptConnection:c(),connectionAttempts:s.length}},zT=()=>{const[e,t]=y.useState([]),[r,n]=y.useState(!1),[s,a]=y.useState(!1),{user:o}=kt(),{toast:l}=St(),{isConnected:c,isExpired:u,accessToken:d,checkAndRefreshToken:f}=cu(),p=async()=>{if(o){n(!0);try{if(!c){l({title:"Microsoft Account Required",description:"Please connect your Microsoft account in Settings to view emails",variant:"destructive"});return}if(u){await f();return}if(!d){l({title:"Authentication Error",description:"Microsoft access token not available. Please reconnect your account.",variant:"destructive"});return}const m=await fetch("https://graph.microsoft.com/v1.0/me/messages?$top=50&$orderby=receivedDateTime desc",{headers:{Authorization:`Bearer ${d}`,"Content-Type":"application/json"}});if(!m.ok){if(m.status===401){await f();return}throw new Error("Failed to fetch emails from Microsoft Graph")}const w=(await m.json()).value.map(v=>{var _,b,S,T,N;return{id:v.id,subject:v.subject||"No Subject",from:{name:((b=(_=v.from)==null?void 0:_.emailAddress)==null?void 0:b.name)||"Unknown Sender",address:((T=(S=v.from)==null?void 0:S.emailAddress)==null?void 0:T.address)||""},body:((N=v.body)==null?void 0:N.content)||"",receivedDateTime:v.receivedDateTime,isRead:v.isRead,hasAttachments:v.hasAttachments,importance:v.importance}});t(w)}catch(m){console.error("Error fetching emails:",m);let x=m.message||"Failed to load emails from Outlook";c?u?x="Your Microsoft authentication has expired. Please reconnect your account in Settings.":d||(x="Microsoft access token not available. Please reconnect your account."):x="Please connect your Microsoft account in Settings to view emails.",l({title:"Error Fetching Emails",description:x,variant:"destructive"})}finally{n(!1)}}},h=async m=>{if(o){a(!0);try{const{error:x}=await he.functions.invoke("send-outlook-email",{body:m});if(x)throw x;l({title:"Email Sent",description:"Your email has been sent successfully"}),p()}catch(x){console.error("Error sending email:",x),l({title:"Failed to Send Email",description:x.message||"Failed to send email",variant:"destructive"})}finally{a(!1)}}},g=async m=>{if(!(!o||!d))try{const x=await fetch(`https://graph.microsoft.com/v1.0/me/messages/${m}`,{method:"PATCH",headers:{Authorization:`Bearer ${d}`,"Content-Type":"application/json"},body:JSON.stringify({isRead:!0})});x.ok?t(w=>w.map(v=>v.id===m?{...v,isRead:!0}:v)):x.status===401&&await f()}catch(x){console.error("Error marking email as read:",x)}};return y.useEffect(()=>{o&&c&&!u&&p()},[o,c,u,d]),{emails:e,loading:r,sending:s,fetchEmails:p,sendEmail:h,markAsRead:g}},cm=e=>{if(!e)return"Unknown";const t=["Bytes","KB","MB","GB"],r=Math.floor(Math.log(e)/Math.log(1024));return Math.round(e/Math.pow(1024,r)*100)/100+" "+t[r]},um=e=>new Date(e).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}),F2=({document:e,zoom:t,onZoomIn:r,onZoomOut:n,onDownload:s,onExternalView:a,onClose:o})=>{var c,u;const l=(c=e.mime_type)==null?void 0:c.includes("image");return i.jsxs("div",{className:"flex items-center justify-between p-4 border-b document-viewer-header-mobile",children:[i.jsxs("div",{className:"flex-1 min-w-0",children:[i.jsx(Et,{className:"text-lg font-semibold truncate",children:e.name}),i.jsxs("div",{className:"flex items-center space-x-4 mt-2 text-sm text-gray-500",children:[i.jsx(We,{variant:"secondary",children:((u=e.mime_type)==null?void 0:u.split("/")[1])||"file"}),i.jsx("span",{children:cm(e.file_size)}),i.jsxs("span",{children:["Created ",um(e.created_at)]})]})]}),i.jsxs("div",{className:"flex items-center space-x-2 ml-4 document-viewer-header-controls mobile-header-controls",children:[l&&i.jsxs("div",{className:"flex items-center bg-muted rounded-md",children:[i.jsx(ue,{size:"sm",variant:"ghost",onClick:n,disabled:t<=25,className:"h-9 w-9 p-0 rounded-r-none",children:i.jsx(UF,{className:"h-4 w-4"})}),i.jsxs("div",{className:"px-3 py-2 text-sm font-medium bg-muted border-x min-w-[60px] text-center",children:[t,"%"]}),i.jsx(ue,{size:"sm",variant:"ghost",onClick:r,disabled:t>=200,className:"h-9 w-9 p-0 rounded-l-none",children:i.jsx(BF,{className:"h-4 w-4"})})]}),i.jsx(ue,{size:"sm",variant:"outline",onClick:a,className:"h-9 open-external-btn",title:"Open in new tab (use this to download)",children:i.jsx(Ta,{className:"h-4 w-4"})}),i.jsx(ue,{size:"sm",variant:"ghost",onClick:o,className:"h-9",children:i.jsx(Cn,{className:"h-4 w-4"})})]})]})},I2=({document:e,zoom:t=100,onDownload:r,onExternalView:n,hideActions:s=!1,headerHeight:a=0})=>{if(!e||!e.file_path||!e.mime_type)return i.jsx("div",{className:"p-8 text-center text-red-500",children:"File not found or not loaded."});console.log("DocumentViewerContent - Document:",e),console.log("DocumentViewerContent - File path:",e.file_path),console.log("DocumentViewerContent - MIME type:",e.mime_type);const o=e.mime_type||"",l=()=>{var u,d,f;console.log("Rendering file preview for:",e.name,"Type:",o);const c=e.file_path.includes("supabase.co/storage")||e.file_path.includes("/storage/v1/object/public/");return console.log("Is Supabase storage URL?",c),c?o.includes("image")?i.jsx("div",{className:"w-full bg-gray-100 document-viewer-image-mobile-parent",style:{height:"60vh",display:"flex",alignItems:"center",justifyContent:"center"},children:i.jsx("img",{src:e.file_path,alt:e.name,className:"document-viewer-image-mobile",style:{width:"auto",height:"auto",maxWidth:"100vw",maxHeight:"100%",objectFit:"contain",display:"block",background:"#fff",borderRadius:8,boxShadow:"0 2px 8px rgba(0,0,0,0.04)"},onError:p=>{console.error("Image failed to load:",e.file_path),p.currentTarget.style.display="none"},onLoad:()=>{console.log("Image loaded successfully:",e.file_path)}})}):o.includes("pdf")?i.jsx("iframe",{src:`${e.file_path}#toolbar=0&navpanes=0&scrollbar=1`,className:"w-full border-0 document-viewer-pdf-mobile",style:{height:"60vh"},title:e.name,onError:()=>{console.error("PDF failed to load:",e.file_path)}}):o.includes("text")?i.jsx("div",{className:"w-full h-full p-4 bg-white overflow-auto",children:i.jsx("iframe",{src:e.file_path,className:"w-full h-full border-0",title:e.name,style:{fontSize:`${t}%`}})}):o.includes("word")||o.includes("document")||o.includes("spreadsheet")||o.includes("excel")||o.includes("presentation")||o.includes("powerpoint")?i.jsx("div",{className:"w-full h-full bg-white rounded-lg border flex items-center justify-center p-8",children:i.jsxs("div",{className:"text-center max-w-md",children:[i.jsx(tr,{className:"h-24 w-24 text-blue-500 mx-auto mb-6"}),i.jsx("h3",{className:"text-xl font-semibold text-gray-700 mb-2",children:"Office Document"}),i.jsxs("p",{className:"text-gray-500 mb-4",children:["Click download to access this ",o.includes("word")?"Word":o.includes("excel")?"Excel":o.includes("powerpoint")?"PowerPoint":"Office"," document."]}),i.jsx("div",{className:"bg-gray-50 p-4 rounded-lg mb-6",children:i.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[i.jsxs("div",{children:[i.jsx("span",{className:"font-medium",children:"Type:"})," ",o.includes("word")?"Word":o.includes("excel")?"Excel":o.includes("powerpoint")?"PowerPoint":"Office"]}),i.jsxs("div",{children:[i.jsx("span",{className:"font-medium",children:"Size:"})," ",cm(e.file_size)]}),i.jsxs("div",{children:[i.jsx("span",{className:"font-medium",children:"Created:"})," ",um(e.created_at)]}),i.jsxs("div",{children:[i.jsx("span",{className:"font-medium",children:"Format:"})," ",(d=e.name.split(".").pop())==null?void 0:d.toUpperCase()]})]})}),!s&&i.jsxs("div",{className:"flex space-x-2 justify-center",children:[i.jsxs(ue,{onClick:r,size:"sm",children:[i.jsx(js,{className:"h-4 w-4 mr-2"}),"Download"]}),i.jsxs(ue,{onClick:n,variant:"outline",size:"sm",children:[i.jsx(Ta,{className:"h-4 w-4 mr-2"}),"Open External"]})]})]})}):i.jsx("div",{className:"w-full h-full bg-white rounded-lg border flex items-center justify-center p-8",children:i.jsxs("div",{className:"text-center max-w-md",children:[i.jsx(tr,{className:"h-24 w-24 text-blue-500 mx-auto mb-6"}),i.jsx("h3",{className:"text-xl font-semibold text-gray-700 mb-2",children:"File Ready"}),i.jsxs("p",{className:"text-gray-500 mb-4",children:["Click download to access this ",o.split("/")[1]||"file"," file."]}),i.jsx("div",{className:"bg-gray-50 p-4 rounded-lg mb-6",children:i.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[i.jsxs("div",{children:[i.jsx("span",{className:"font-medium",children:"Type:"})," ",o.split("/")[1]||"file"]}),i.jsxs("div",{children:[i.jsx("span",{className:"font-medium",children:"Size:"})," ",cm(e.file_size)]}),i.jsxs("div",{children:[i.jsx("span",{className:"font-medium",children:"Created:"})," ",um(e.created_at)]}),i.jsxs("div",{children:[i.jsx("span",{className:"font-medium",children:"Format:"})," ",(f=e.name.split(".").pop())==null?void 0:f.toUpperCase()]})]})}),!s&&i.jsxs("div",{className:"flex space-x-2 justify-center",children:[i.jsxs(ue,{onClick:r,size:"sm",children:[i.jsx(js,{className:"h-4 w-4 mr-2"}),"Download"]}),i.jsxs(ue,{onClick:n,variant:"outline",size:"sm",children:[i.jsx(Ta,{className:"h-4 w-4 mr-2"}),"Open External"]})]})]})}):i.jsx("div",{className:"w-full h-full bg-white rounded-lg border flex items-center justify-center p-8",children:i.jsxs("div",{className:"text-center max-w-md",children:[i.jsx(Ld,{className:"h-24 w-24 text-gray-400 mx-auto mb-6"}),i.jsx("h3",{className:"text-xl font-semibold text-gray-700 mb-2",children:"Demo Environment"}),i.jsx("p",{className:"text-gray-500 mb-4",children:"This document was created before storage was configured."}),i.jsx("div",{className:"bg-gray-50 p-4 rounded-lg mb-6",children:i.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[i.jsxs("div",{children:[i.jsx("span",{className:"font-medium",children:"Type:"})," ",o.split("/")[1]||"file"]}),i.jsxs("div",{children:[i.jsx("span",{className:"font-medium",children:"Size:"})," ",cm(e.file_size)]}),i.jsxs("div",{children:[i.jsx("span",{className:"font-medium",children:"Created:"})," ",um(e.created_at)]}),i.jsxs("div",{children:[i.jsx("span",{className:"font-medium",children:"Format:"})," ",(u=e.name.split(".").pop())==null?void 0:u.toUpperCase()]})]})}),i.jsxs("div",{className:"text-xs text-gray-400 mb-4",children:["File path: ",e.file_path]}),!s&&i.jsxs("div",{className:"flex space-x-2 justify-center",children:[i.jsxs(ue,{onClick:r,variant:"outline",size:"sm",children:[i.jsx(js,{className:"h-4 w-4 mr-2"}),"Download (Demo)"]}),i.jsxs(ue,{onClick:n,size:"sm",children:[i.jsx(Ta,{className:"h-4 w-4 mr-2"}),"View (Demo)"]})]})]})})};return i.jsx("div",{className:"w-full h-full",children:l()})},Q9=({documentId:e,userId:t,isViewing:r,documentType:n="document"})=>{const s=y.useRef(null),a=y.useRef(null),o=y.useRef(null);y.useEffect(()=>(r&&e&&t?l():u(),()=>{u()}),[r,e,t]);const l=async()=>{if(!(!e||!t))try{if(s.current=new Date,console.log("Starting document view tracking at:",s.current),n==="poll_attachment"){console.log("Tracking poll attachment view:",e);return}const{data:d,error:f}=await he.from("document_views").insert({document_id:e,user_id:t,view_started_at:s.current.toISOString(),time_spent_seconds:0,completion_percentage:0,last_page_viewed:1}).select("id").single();if(f){console.error("Error creating view record:",f);return}a.current=d.id,console.log("Created view record:",d.id),o.current=setInterval(()=>{c()},3e4)}catch(d){console.error("Error starting tracking:",d)}},c=async()=>{if(!(!s.current||!a.current))try{const f=Math.floor((new Date().getTime()-s.current.getTime())/1e3);console.log("Updating time spent:",f,"seconds"),await he.from("document_views").update({time_spent_seconds:f}).eq("id",a.current)}catch(d){console.error("Error updating time spent:",d)}},u=async()=>{if(o.current&&(clearInterval(o.current),o.current=null),!(!s.current||!a.current))try{const d=new Date,f=Math.floor((d.getTime()-s.current.getTime())/1e3);console.log("Stopping tracking. Total time:",f,"seconds"),await he.from("document_views").update({view_ended_at:d.toISOString(),time_spent_seconds:f}).eq("id",a.current),s.current=null,a.current=null}catch(d){console.error("Error stopping tracking:",d)}};return{updateTimeSpent:c}};var VT={exports:{}},WT={};/**
 * @license React
 * use-sync-external-store-shim.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Uc=y;function J9(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var Z9=typeof Object.is=="function"?Object.is:J9,eU=Uc.useState,tU=Uc.useEffect,rU=Uc.useLayoutEffect,nU=Uc.useDebugValue;function sU(e,t){var r=t(),n=eU({inst:{value:r,getSnapshot:t}}),s=n[0].inst,a=n[1];return rU(function(){s.value=r,s.getSnapshot=t,Jg(s)&&a({inst:s})},[e,r,t]),tU(function(){return Jg(s)&&a({inst:s}),e(function(){Jg(s)&&a({inst:s})})},[e]),nU(r),r}function Jg(e){var t=e.getSnapshot;e=e.value;try{var r=t();return!Z9(e,r)}catch{return!0}}function aU(e,t){return t()}var iU=typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"?aU:sU;WT.useSyncExternalStore=Uc.useSyncExternalStore!==void 0?Uc.useSyncExternalStore:iU;VT.exports=WT;var oU=VT.exports;function lU(){return oU.useSyncExternalStore(cU,()=>!0,()=>!1)}function cU(){return()=>{}}var Y1="Avatar",[uU,ose]=Fr(Y1),[dU,HT]=uU(Y1),GT=y.forwardRef((e,t)=>{const{__scopeAvatar:r,...n}=e,[s,a]=y.useState("idle");return i.jsx(dU,{scope:r,imageLoadingStatus:s,onImageLoadingStatusChange:a,children:i.jsx(ze.span,{...n,ref:t})})});GT.displayName=Y1;var qT="AvatarImage",YT=y.forwardRef((e,t)=>{const{__scopeAvatar:r,src:n,onLoadingStatusChange:s=()=>{},...a}=e,o=HT(qT,r),l=fU(n,a),c=hr(u=>{s(u),o.onImageLoadingStatusChange(u)});return gr(()=>{l!=="idle"&&c(l)},[l,c]),l==="loaded"?i.jsx(ze.img,{...a,ref:t,src:n}):null});YT.displayName=qT;var KT="AvatarFallback",XT=y.forwardRef((e,t)=>{const{__scopeAvatar:r,delayMs:n,...s}=e,a=HT(KT,r),[o,l]=y.useState(n===void 0);return y.useEffect(()=>{if(n!==void 0){const c=window.setTimeout(()=>l(!0),n);return()=>window.clearTimeout(c)}},[n]),o&&a.imageLoadingStatus!=="loaded"?i.jsx(ze.span,{...s,ref:t}):null});XT.displayName=KT;function L2(e,t){return e?t?(e.src!==t&&(e.src=t),e.complete&&e.naturalWidth>0?"loaded":"loading"):"error":"idle"}function fU(e,{referrerPolicy:t,crossOrigin:r}){const n=lU(),s=y.useRef(null),a=n?(s.current||(s.current=new window.Image),s.current):null,[o,l]=y.useState(()=>L2(a,e));return gr(()=>{l(L2(a,e))},[a,e]),gr(()=>{const c=f=>()=>{l(f)};if(!a)return;const u=c("loaded"),d=c("error");return a.addEventListener("load",u),a.addEventListener("error",d),t&&(a.referrerPolicy=t),typeof r=="string"&&(a.crossOrigin=r),()=>{a.removeEventListener("load",u),a.removeEventListener("error",d)}},[a,r,t]),o}var QT=GT,JT=YT,ZT=XT;const qd=y.forwardRef(({className:e,...t},r)=>i.jsx(QT,{ref:r,className:De("relative flex h-10 w-10 shrink-0 overflow-hidden rounded-full",e),...t}));qd.displayName=QT.displayName;const Km=y.forwardRef(({className:e,...t},r)=>i.jsx(JT,{ref:r,className:De("aspect-square h-full w-full",e),...t}));Km.displayName=JT.displayName;const Xm=y.forwardRef(({className:e,...t},r)=>i.jsx(ZT,{ref:r,className:De("flex h-full w-full items-center justify-center rounded-full bg-muted",e),...t}));Xm.displayName=ZT.displayName;const dt=y.forwardRef(({className:e,type:t,...r},n)=>i.jsx("input",{type:t,className:De("flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-base ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium file:text-foreground placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",e),ref:n,...r}));dt.displayName="Input";const Ep=y.forwardRef(({className:e,value:t,onChange:r,...n},s)=>i.jsxs("div",{className:"relative w-full",children:[i.jsx("input",{ref:s,value:t,onChange:r,className:De("flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-base ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium file:text-foreground placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 md:text-sm pr-8",e),...n}),!!t&&i.jsx("button",{type:"button",onClick:a=>{if(r){const o={...a,target:{value:""}};r(o)}},className:"absolute right-2 top-1/2 -translate-y-1/2 text-gray-400 hover:text-gray-700 focus:outline-none","aria-label":"Clear search",tabIndex:-1,children:i.jsx(Cn,{className:"h-5 w-5"})})]}));Ep.displayName="SearchInput";const K1=({isOpen:e,onClose:t,document:r,documentType:n="document"})=>{var N,C;const[s,a]=y.useState(100),{toast:o}=St(),{user:l}=kt();Df();const[c,u]=y.useState([]),[d,f]=y.useState(""),[p,h]=y.useState(!1),[g,m]=y.useState(!1);Q9({documentId:(r==null?void 0:r.id)||null,userId:(l==null?void 0:l.id)||null,isViewing:e,documentType:n}),y.useEffect(()=>{r&&a(100)},[r==null?void 0:r.id]),y.useEffect(()=>{(async()=>{if(!r)return;h(!0);const{data:P,error:R}=await he.from("document_comments").select("*, profiles:profiles(id, first_name, last_name, avatar_url, email)").eq("document_id",r.id).order("created_at",{ascending:!0});R||u(P||[]),h(!1)})()},[r==null?void 0:r.id,e]);const x=async()=>{if(!d.trim()||!l||!r)return;m(!0);const{error:E}=await he.from("document_comments").insert({document_id:r.id,user_id:l.id,comment:d.trim()});if(m(!1),E)o({title:"Error",description:"Failed to add comment",variant:"destructive"});else{f("");const{data:P}=await he.from("document_comments").select("*, profiles:profiles(id, first_name, last_name, avatar_url, email)").eq("document_id",r.id).order("created_at",{ascending:!0});u(P||[])}},w=async()=>{if(r){o({title:"Downloading...",description:`Preparing "${r.name}" for download...`});try{const E="documents",P=r.file_path;if(typeof P!="string"||!P.trim()){o({title:"Download Error",description:"File path is missing or invalid.",variant:"destructive"});return}const{data:R,error:j}=await he.storage.from(E).createSignedUrl(P,60);if(j||!(R!=null&&R.signedUrl)){o({title:"Download Error",description:"Unable to generate download link.",variant:"destructive"});return}const M=document.createElement("a");M.href=R.signedUrl,M.download=r.name,document.body.appendChild(M),M.click(),document.body.removeChild(M),o({title:"Download Started",description:`"${r.name}" download initiated successfully`})}catch(E){console.error("Download error:",E),o({title:"Download Error",description:"Unable to download the file. Please try again.",variant:"destructive"})}}},v=()=>{if(r)try{const E=window.open(r.file_path,"_blank","noopener,noreferrer");o(E?{title:"External View",description:`Opening "${r.name}" in new tab`}:{title:"Popup Blocked",description:"Please allow popups to open files in external tabs",variant:"destructive"})}catch(E){console.error("External view error:",E),o({title:"Error",description:"Unable to open file in external tab",variant:"destructive"})}},_=()=>{a(Math.min(200,s+25))},b=()=>{a(Math.max(25,s-25))},S=(N=r==null?void 0:r.mime_type)==null?void 0:N.includes("image"),T=(C=r==null?void 0:r.mime_type)==null?void 0:C.includes("pdf");return r?i.jsx(Nt,{open:e,onOpenChange:t,children:i.jsxs(bt,{className:"max-w-3xl max-h-[90vh] w-[95vw] h-[85vh] overflow-hidden p-0 flex flex-col",children:[T?i.jsxs("div",{className:"w-full flex-1 flex flex-col min-h-0",children:[i.jsx("div",{className:"w-full flex-shrink-0",style:{height:56},children:i.jsx("div",{className:"w-full h-full flex items-center px-4 border-b bg-white",children:i.jsx(F2,{document:r,zoom:s,onZoomIn:_,onZoomOut:b,onDownload:w,onExternalView:v,onClose:t})})}),i.jsx("div",{className:"flex-1 min-h-0 overflow-auto",children:i.jsx(I2,{document:r,zoom:s,onDownload:w,onExternalView:v,hideActions:!0,headerHeight:56})})]}):i.jsxs(i.Fragment,{children:[i.jsx(jt,{className:"px-6 py-4 border-b bg-white",children:i.jsx(F2,{document:r,zoom:s,onZoomIn:_,onZoomOut:b,onDownload:w,onExternalView:v,onClose:t})}),i.jsx("div",{className:S?"flex-1 overflow-auto bg-gray-50 flex items-center justify-center p-4":"flex-1 overflow-auto bg-gray-50",children:i.jsx(I2,{document:r,zoom:s,onDownload:w,onExternalView:v,hideActions:!0})})]}),i.jsxs("div",{className:"border-t bg-white px-6 py-4 max-h-64 overflow-y-auto flex-shrink-0",children:[i.jsx("h3",{className:"font-semibold text-lg mb-2",children:"Comments"}),p?i.jsx("div",{className:"text-gray-500",children:"Loading comments..."}):c.length===0?i.jsx("div",{className:"text-gray-400 italic",children:"No comments yet. Be the first to comment!"}):i.jsx("div",{className:"space-y-4",children:c.map((E,P)=>{var R,j,M,A,I,X;return i.jsxs("div",{className:"flex items-start gap-3",children:[i.jsx(qd,{src:(R=E.profiles)==null?void 0:R.avatar_url,alt:((j=E.profiles)==null?void 0:j.first_name)||((M=E.profiles)==null?void 0:M.email)||"User"}),i.jsxs("div",{children:[i.jsxs("div",{className:"font-medium text-gray-900 text-sm",children:[((A=E.profiles)==null?void 0:A.first_name)||""," ",((I=E.profiles)==null?void 0:I.last_name)||""," ",i.jsx("span",{className:"text-xs text-gray-500",children:(X=E.profiles)==null?void 0:X.email})]}),i.jsx("div",{className:"text-xs text-gray-400 mb-1",children:new Date(E.created_at).toLocaleString()}),i.jsx("div",{className:"text-gray-800 text-base",children:E.comment})]})]},E.id||P)})}),l&&i.jsxs("div",{className:"flex items-center gap-2 mt-4",children:[i.jsx(dt,{value:d,onChange:E=>f(E.target.value),placeholder:"Add a comment...",disabled:g,onKeyDown:E=>{E.key==="Enter"&&!E.shiftKey&&(E.preventDefault(),x())}}),i.jsx(ue,{onClick:x,disabled:g||!d.trim(),children:g?"Posting...":"Post"})]})]})]})}):null};var hU=y.createContext(void 0);function uu(e){const t=y.useContext(hU);return e||t||"ltr"}var Zg="rovingFocusGroup.onEntryFocus",mU={bubbles:!1,cancelable:!0},Of="RovingFocusGroup",[qv,e4,pU]=xf(Of),[gU,kp]=Fr(Of,[pU]),[xU,vU]=gU(Of),t4=y.forwardRef((e,t)=>i.jsx(qv.Provider,{scope:e.__scopeRovingFocusGroup,children:i.jsx(qv.Slot,{scope:e.__scopeRovingFocusGroup,children:i.jsx(yU,{...e,ref:t})})}));t4.displayName=Of;var yU=y.forwardRef((e,t)=>{const{__scopeRovingFocusGroup:r,orientation:n,loop:s=!1,dir:a,currentTabStopId:o,defaultCurrentTabStopId:l,onCurrentTabStopIdChange:c,onEntryFocus:u,preventScrollOnEntryFocus:d=!1,...f}=e,p=y.useRef(null),h=st(t,p),g=uu(a),[m,x]=Hn({prop:o,defaultProp:l??null,onChange:c,caller:Of}),[w,v]=y.useState(!1),_=hr(u),b=e4(r),S=y.useRef(!1),[T,N]=y.useState(0);return y.useEffect(()=>{const C=p.current;if(C)return C.addEventListener(Zg,_),()=>C.removeEventListener(Zg,_)},[_]),i.jsx(xU,{scope:r,orientation:n,dir:g,loop:s,currentTabStopId:m,onItemFocus:y.useCallback(C=>x(C),[x]),onItemShiftTab:y.useCallback(()=>v(!0),[]),onFocusableItemAdd:y.useCallback(()=>N(C=>C+1),[]),onFocusableItemRemove:y.useCallback(()=>N(C=>C-1),[]),children:i.jsx(ze.div,{tabIndex:w||T===0?-1:0,"data-orientation":n,...f,ref:h,style:{outline:"none",...e.style},onMouseDown:Oe(e.onMouseDown,()=>{S.current=!0}),onFocus:Oe(e.onFocus,C=>{const E=!S.current;if(C.target===C.currentTarget&&E&&!w){const P=new CustomEvent(Zg,mU);if(C.currentTarget.dispatchEvent(P),!P.defaultPrevented){const R=b().filter(X=>X.focusable),j=R.find(X=>X.active),M=R.find(X=>X.id===m),I=[j,M,...R].filter(Boolean).map(X=>X.ref.current);s4(I,d)}}S.current=!1}),onBlur:Oe(e.onBlur,()=>v(!1))})})}),r4="RovingFocusGroupItem",n4=y.forwardRef((e,t)=>{const{__scopeRovingFocusGroup:r,focusable:n=!0,active:s=!1,tabStopId:a,children:o,...l}=e,c=Er(),u=a||c,d=vU(r4,r),f=d.currentTabStopId===u,p=e4(r),{onFocusableItemAdd:h,onFocusableItemRemove:g,currentTabStopId:m}=d;return y.useEffect(()=>{if(n)return h(),()=>g()},[n,h,g]),i.jsx(qv.ItemSlot,{scope:r,id:u,focusable:n,active:s,children:i.jsx(ze.span,{tabIndex:f?0:-1,"data-orientation":d.orientation,...l,ref:t,onMouseDown:Oe(e.onMouseDown,x=>{n?d.onItemFocus(u):x.preventDefault()}),onFocus:Oe(e.onFocus,()=>d.onItemFocus(u)),onKeyDown:Oe(e.onKeyDown,x=>{if(x.key==="Tab"&&x.shiftKey){d.onItemShiftTab();return}if(x.target!==x.currentTarget)return;const w=bU(x,d.orientation,d.dir);if(w!==void 0){if(x.metaKey||x.ctrlKey||x.altKey||x.shiftKey)return;x.preventDefault();let _=p().filter(b=>b.focusable).map(b=>b.ref.current);if(w==="last")_.reverse();else if(w==="prev"||w==="next"){w==="prev"&&_.reverse();const b=_.indexOf(x.currentTarget);_=d.loop?SU(_,b+1):_.slice(b+1)}setTimeout(()=>s4(_))}}),children:typeof o=="function"?o({isCurrentTabStop:f,hasTabStop:m!=null}):o})})});n4.displayName=r4;var wU={ArrowLeft:"prev",ArrowUp:"prev",ArrowRight:"next",ArrowDown:"next",PageUp:"first",Home:"first",PageDown:"last",End:"last"};function _U(e,t){return t!=="rtl"?e:e==="ArrowLeft"?"ArrowRight":e==="ArrowRight"?"ArrowLeft":e}function bU(e,t,r){const n=_U(e.key,r);if(!(t==="vertical"&&["ArrowLeft","ArrowRight"].includes(n))&&!(t==="horizontal"&&["ArrowUp","ArrowDown"].includes(n)))return wU[n]}function s4(e,t=!1){const r=document.activeElement;for(const n of e)if(n===r||(n.focus({preventScroll:t}),document.activeElement!==r))return}function SU(e,t){return e.map((r,n)=>e[(t+n)%e.length])}var a4=t4,i4=n4,Cp="Tabs",[NU,lse]=Fr(Cp,[kp]),o4=kp(),[jU,X1]=NU(Cp),l4=y.forwardRef((e,t)=>{const{__scopeTabs:r,value:n,onValueChange:s,defaultValue:a,orientation:o="horizontal",dir:l,activationMode:c="automatic",...u}=e,d=uu(l),[f,p]=Hn({prop:n,onChange:s,defaultProp:a??"",caller:Cp});return i.jsx(jU,{scope:r,baseId:Er(),value:f,onValueChange:p,orientation:o,dir:d,activationMode:c,children:i.jsx(ze.div,{dir:d,"data-orientation":o,...u,ref:t})})});l4.displayName=Cp;var c4="TabsList",u4=y.forwardRef((e,t)=>{const{__scopeTabs:r,loop:n=!0,...s}=e,a=X1(c4,r),o=o4(r);return i.jsx(a4,{asChild:!0,...o,orientation:a.orientation,dir:a.dir,loop:n,children:i.jsx(ze.div,{role:"tablist","aria-orientation":a.orientation,...s,ref:t})})});u4.displayName=c4;var d4="TabsTrigger",f4=y.forwardRef((e,t)=>{const{__scopeTabs:r,value:n,disabled:s=!1,...a}=e,o=X1(d4,r),l=o4(r),c=p4(o.baseId,n),u=g4(o.baseId,n),d=n===o.value;return i.jsx(i4,{asChild:!0,...l,focusable:!s,active:d,children:i.jsx(ze.button,{type:"button",role:"tab","aria-selected":d,"aria-controls":u,"data-state":d?"active":"inactive","data-disabled":s?"":void 0,disabled:s,id:c,...a,ref:t,onMouseDown:Oe(e.onMouseDown,f=>{!s&&f.button===0&&f.ctrlKey===!1?o.onValueChange(n):f.preventDefault()}),onKeyDown:Oe(e.onKeyDown,f=>{[" ","Enter"].includes(f.key)&&o.onValueChange(n)}),onFocus:Oe(e.onFocus,()=>{const f=o.activationMode!=="manual";!d&&!s&&f&&o.onValueChange(n)})})})});f4.displayName=d4;var h4="TabsContent",m4=y.forwardRef((e,t)=>{const{__scopeTabs:r,value:n,forceMount:s,children:a,...o}=e,l=X1(h4,r),c=p4(l.baseId,n),u=g4(l.baseId,n),d=n===l.value,f=y.useRef(d);return y.useEffect(()=>{const p=requestAnimationFrame(()=>f.current=!1);return()=>cancelAnimationFrame(p)},[]),i.jsx(Ir,{present:s||d,children:({present:p})=>i.jsx(ze.div,{"data-state":d?"active":"inactive","data-orientation":l.orientation,role:"tabpanel","aria-labelledby":c,hidden:!p,id:u,tabIndex:0,...o,ref:t,style:{...e.style,animationDuration:f.current?"0s":void 0},children:p&&a})})});m4.displayName=h4;function p4(e,t){return`${e}-trigger-${t}`}function g4(e,t){return`${e}-content-${t}`}var EU=l4,x4=u4,v4=f4,y4=m4;const bl=EU,So=y.forwardRef(({className:e,...t},r)=>i.jsx(x4,{ref:r,className:De("inline-flex h-10 items-center justify-center rounded-md bg-muted p-1 text-muted-foreground",e),...t}));So.displayName=x4.displayName;const Vn=y.forwardRef(({className:e,...t},r)=>i.jsx(v4,{ref:r,className:De("inline-flex items-center justify-center whitespace-nowrap rounded-sm px-3 py-1.5 text-sm font-medium ring-offset-background transition-all focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 data-[state=active]:bg-background data-[state=active]:text-foreground data-[state=active]:shadow-sm",e),...t}));Vn.displayName=v4.displayName;const zr=y.forwardRef(({className:e,...t},r)=>i.jsx(y4,{ref:r,className:De("mt-2 ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2",e),...t}));zr.displayName=y4.displayName;function et(e){const t=Object.prototype.toString.call(e);return e instanceof Date||typeof e=="object"&&t==="[object Date]"?new e.constructor(+e):typeof e=="number"||t==="[object Number]"||typeof e=="string"||t==="[object String]"?new Date(e):new Date(NaN)}function Gn(e,t){return e instanceof Date?new e.constructor(t):new Date(t)}function hn(e,t){const r=et(e);return isNaN(t)?Gn(e,NaN):(t&&r.setDate(r.getDate()+t),r)}function us(e,t){const r=et(e);if(isNaN(t))return Gn(e,NaN);if(!t)return r;const n=r.getDate(),s=Gn(e,r.getTime());s.setMonth(r.getMonth()+t+1,0);const a=s.getDate();return n>=a?s:(r.setFullYear(s.getFullYear(),s.getMonth(),n),r)}function Du(e,t){const{years:r=0,months:n=0,weeks:s=0,days:a=0,hours:o=0,minutes:l=0,seconds:c=0}=t,u=et(e),d=n||r?us(u,n+r*12):u,f=a||s?hn(d,a+s*7):d,p=l+o*60,g=(c+p*60)*1e3;return Gn(e,f.getTime()+g)}const Q1=6048e5,kU=864e5,J1=6e4,Z1=36e5;let CU={};function du(){return CU}function Ts(e,t){var l,c,u,d;const r=du(),n=(t==null?void 0:t.weekStartsOn)??((c=(l=t==null?void 0:t.locale)==null?void 0:l.options)==null?void 0:c.weekStartsOn)??r.weekStartsOn??((d=(u=r.locale)==null?void 0:u.options)==null?void 0:d.weekStartsOn)??0,s=et(e),a=s.getDay(),o=(a<n?7:0)+a-n;return s.setDate(s.getDate()-o),s.setHours(0,0,0,0),s}function ll(e){return Ts(e,{weekStartsOn:1})}function w4(e){const t=et(e),r=t.getFullYear(),n=Gn(e,0);n.setFullYear(r+1,0,4),n.setHours(0,0,0,0);const s=ll(n),a=Gn(e,0);a.setFullYear(r,0,4),a.setHours(0,0,0,0);const o=ll(a);return t.getTime()>=s.getTime()?r+1:t.getTime()>=o.getTime()?r:r-1}function zc(e){const t=et(e);return t.setHours(0,0,0,0),t}function Qm(e){const t=et(e),r=new Date(Date.UTC(t.getFullYear(),t.getMonth(),t.getDate(),t.getHours(),t.getMinutes(),t.getSeconds(),t.getMilliseconds()));return r.setUTCFullYear(t.getFullYear()),+e-+r}function Xs(e,t){const r=zc(e),n=zc(t),s=+r-Qm(r),a=+n-Qm(n);return Math.round((s-a)/kU)}function TU(e){const t=w4(e),r=Gn(e,0);return r.setFullYear(t,0,4),r.setHours(0,0,0,0),ll(r)}function Jm(e,t){const r=t*7;return hn(e,r)}function AU(e,t){return us(e,t*12)}function PU(e){let t;return e.forEach(function(r){const n=et(r);(t===void 0||t<n||isNaN(Number(n)))&&(t=n)}),t||new Date(NaN)}function DU(e){let t;return e.forEach(r=>{const n=et(r);(!t||t>n||isNaN(+n))&&(t=n)}),t||new Date(NaN)}function xc(e,t){const r=et(e),n=et(t),s=r.getTime()-n.getTime();return s<0?-1:s>0?1:s}function RU(e,t){const r=et(e),n=et(t),s=r.getTime()-n.getTime();return s>0?-1:s<0?1:s}function $n(e,t){const r=zc(e),n=zc(t);return+r==+n}function ew(e){return e instanceof Date||typeof e=="object"&&Object.prototype.toString.call(e)==="[object Date]"}function MU(e){if(!ew(e)&&typeof e!="number")return!1;const t=et(e);return!isNaN(Number(t))}function Vc(e,t){const r=et(e),n=et(t),s=r.getFullYear()-n.getFullYear(),a=r.getMonth()-n.getMonth();return s*12+a}function OU(e,t,r){const n=Ts(e,r),s=Ts(t,r),a=+n-Qm(n),o=+s-Qm(s);return Math.round((a-o)/Q1)}function FU(e,t){const r=et(e),n=et(t);return r.getFullYear()-n.getFullYear()}function IU(e,t){const r=et(e),n=et(t),s=$2(r,n),a=Math.abs(Xs(r,n));r.setDate(r.getDate()-s*a);const o=+($2(r,n)===-s),l=s*(a-o);return l===0?0:l}function $2(e,t){const r=e.getFullYear()-t.getFullYear()||e.getMonth()-t.getMonth()||e.getDate()-t.getDate()||e.getHours()-t.getHours()||e.getMinutes()-t.getMinutes()||e.getSeconds()-t.getSeconds()||e.getMilliseconds()-t.getMilliseconds();return r<0?-1:r>0?1:r}function tw(e){return t=>{const n=(e?Math[e]:Math.trunc)(t);return n===0?0:n}}function rw(e,t){return+et(e)-+et(t)}function LU(e,t,r){const n=rw(e,t)/Z1;return tw(r==null?void 0:r.roundingMethod)(n)}function $U(e,t,r){const n=rw(e,t)/J1;return tw(r==null?void 0:r.roundingMethod)(n)}function BU(e){const t=et(e);return t.setHours(23,59,59,999),t}function Ja(e){const t=et(e),r=t.getMonth();return t.setFullYear(t.getFullYear(),r+1,0),t.setHours(23,59,59,999),t}function UU(e){const t=et(e);return+BU(t)==+Ja(t)}function zU(e,t){const r=et(e),n=et(t),s=xc(r,n),a=Math.abs(Vc(r,n));let o;if(a<1)o=0;else{r.getMonth()===1&&r.getDate()>27&&r.setDate(30),r.setMonth(r.getMonth()-s*a);let l=xc(r,n)===-s;UU(et(e))&&a===1&&xc(e,n)===1&&(l=!1),o=s*(a-Number(l))}return o===0?0:o}function VU(e,t,r){const n=rw(e,t)/1e3;return tw(r==null?void 0:r.roundingMethod)(n)}function WU(e,t){const r=et(e),n=et(t),s=xc(r,n),a=Math.abs(FU(r,n));r.setFullYear(1584),n.setFullYear(1584);const o=xc(r,n)===-s,l=s*(a-+o);return l===0?0:l}function Mr(e){const t=et(e);return t.setDate(1),t.setHours(0,0,0,0),t}function _4(e){const t=et(e),r=Gn(e,0);return r.setFullYear(t.getFullYear(),0,1),r.setHours(0,0,0,0),r}function Yd(e,t){var l,c,u,d;const r=du(),n=(t==null?void 0:t.weekStartsOn)??((c=(l=t==null?void 0:t.locale)==null?void 0:l.options)==null?void 0:c.weekStartsOn)??r.weekStartsOn??((d=(u=r.locale)==null?void 0:u.options)==null?void 0:d.weekStartsOn)??0,s=et(e),a=s.getDay(),o=(a<n?-7:0)+6-(a-n);return s.setDate(s.getDate()+o),s.setHours(23,59,59,999),s}function b4(e){return Yd(e,{weekStartsOn:1})}const HU={lessThanXSeconds:{one:"less than a second",other:"less than {{count}} seconds"},xSeconds:{one:"1 second",other:"{{count}} seconds"},halfAMinute:"half a minute",lessThanXMinutes:{one:"less than a minute",other:"less than {{count}} minutes"},xMinutes:{one:"1 minute",other:"{{count}} minutes"},aboutXHours:{one:"about 1 hour",other:"about {{count}} hours"},xHours:{one:"1 hour",other:"{{count}} hours"},xDays:{one:"1 day",other:"{{count}} days"},aboutXWeeks:{one:"about 1 week",other:"about {{count}} weeks"},xWeeks:{one:"1 week",other:"{{count}} weeks"},aboutXMonths:{one:"about 1 month",other:"about {{count}} months"},xMonths:{one:"1 month",other:"{{count}} months"},aboutXYears:{one:"about 1 year",other:"about {{count}} years"},xYears:{one:"1 year",other:"{{count}} years"},overXYears:{one:"over 1 year",other:"over {{count}} years"},almostXYears:{one:"almost 1 year",other:"almost {{count}} years"}},GU=(e,t,r)=>{let n;const s=HU[e];return typeof s=="string"?n=s:t===1?n=s.one:n=s.other.replace("{{count}}",t.toString()),r!=null&&r.addSuffix?r.comparison&&r.comparison>0?"in "+n:n+" ago":n};function ex(e){return(t={})=>{const r=t.width?String(t.width):e.defaultWidth;return e.formats[r]||e.formats[e.defaultWidth]}}const qU={full:"EEEE, MMMM do, y",long:"MMMM do, y",medium:"MMM d, y",short:"MM/dd/yyyy"},YU={full:"h:mm:ss a zzzz",long:"h:mm:ss a z",medium:"h:mm:ss a",short:"h:mm a"},KU={full:"{{date}} 'at' {{time}}",long:"{{date}} 'at' {{time}}",medium:"{{date}}, {{time}}",short:"{{date}}, {{time}}"},XU={date:ex({formats:qU,defaultWidth:"full"}),time:ex({formats:YU,defaultWidth:"full"}),dateTime:ex({formats:KU,defaultWidth:"full"})},QU={lastWeek:"'last' eeee 'at' p",yesterday:"'yesterday at' p",today:"'today at' p",tomorrow:"'tomorrow at' p",nextWeek:"eeee 'at' p",other:"P"},JU=(e,t,r,n)=>QU[e];function Ru(e){return(t,r)=>{const n=r!=null&&r.context?String(r.context):"standalone";let s;if(n==="formatting"&&e.formattingValues){const o=e.defaultFormattingWidth||e.defaultWidth,l=r!=null&&r.width?String(r.width):o;s=e.formattingValues[l]||e.formattingValues[o]}else{const o=e.defaultWidth,l=r!=null&&r.width?String(r.width):e.defaultWidth;s=e.values[l]||e.values[o]}const a=e.argumentCallback?e.argumentCallback(t):t;return s[a]}}const ZU={narrow:["B","A"],abbreviated:["BC","AD"],wide:["Before Christ","Anno Domini"]},ez={narrow:["1","2","3","4"],abbreviated:["Q1","Q2","Q3","Q4"],wide:["1st quarter","2nd quarter","3rd quarter","4th quarter"]},tz={narrow:["J","F","M","A","M","J","J","A","S","O","N","D"],abbreviated:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],wide:["January","February","March","April","May","June","July","August","September","October","November","December"]},rz={narrow:["S","M","T","W","T","F","S"],short:["Su","Mo","Tu","We","Th","Fr","Sa"],abbreviated:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],wide:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"]},nz={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"}},sz={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"}},az=(e,t)=>{const r=Number(e),n=r%100;if(n>20||n<10)switch(n%10){case 1:return r+"st";case 2:return r+"nd";case 3:return r+"rd"}return r+"th"},iz={ordinalNumber:az,era:Ru({values:ZU,defaultWidth:"wide"}),quarter:Ru({values:ez,defaultWidth:"wide",argumentCallback:e=>e-1}),month:Ru({values:tz,defaultWidth:"wide"}),day:Ru({values:rz,defaultWidth:"wide"}),dayPeriod:Ru({values:nz,defaultWidth:"wide",formattingValues:sz,defaultFormattingWidth:"wide"})};function Mu(e){return(t,r={})=>{const n=r.width,s=n&&e.matchPatterns[n]||e.matchPatterns[e.defaultMatchWidth],a=t.match(s);if(!a)return null;const o=a[0],l=n&&e.parsePatterns[n]||e.parsePatterns[e.defaultParseWidth],c=Array.isArray(l)?lz(l,f=>f.test(o)):oz(l,f=>f.test(o));let u;u=e.valueCallback?e.valueCallback(c):c,u=r.valueCallback?r.valueCallback(u):u;const d=t.slice(o.length);return{value:u,rest:d}}}function oz(e,t){for(const r in e)if(Object.prototype.hasOwnProperty.call(e,r)&&t(e[r]))return r}function lz(e,t){for(let r=0;r<e.length;r++)if(t(e[r]))return r}function cz(e){return(t,r={})=>{const n=t.match(e.matchPattern);if(!n)return null;const s=n[0],a=t.match(e.parsePattern);if(!a)return null;let o=e.valueCallback?e.valueCallback(a[0]):a[0];o=r.valueCallback?r.valueCallback(o):o;const l=t.slice(s.length);return{value:o,rest:l}}}const uz=/^(\d+)(th|st|nd|rd)?/i,dz=/\d+/i,fz={narrow:/^(b|a)/i,abbreviated:/^(b\.?\s?c\.?|b\.?\s?c\.?\s?e\.?|a\.?\s?d\.?|c\.?\s?e\.?)/i,wide:/^(before christ|before common era|anno domini|common era)/i},hz={any:[/^b/i,/^(a|c)/i]},mz={narrow:/^[1234]/i,abbreviated:/^q[1234]/i,wide:/^[1234](th|st|nd|rd)? quarter/i},pz={any:[/1/i,/2/i,/3/i,/4/i]},gz={narrow:/^[jfmasond]/i,abbreviated:/^(jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec)/i,wide:/^(january|february|march|april|may|june|july|august|september|october|november|december)/i},xz={narrow:[/^j/i,/^f/i,/^m/i,/^a/i,/^m/i,/^j/i,/^j/i,/^a/i,/^s/i,/^o/i,/^n/i,/^d/i],any:[/^ja/i,/^f/i,/^mar/i,/^ap/i,/^may/i,/^jun/i,/^jul/i,/^au/i,/^s/i,/^o/i,/^n/i,/^d/i]},vz={narrow:/^[smtwf]/i,short:/^(su|mo|tu|we|th|fr|sa)/i,abbreviated:/^(sun|mon|tue|wed|thu|fri|sat)/i,wide:/^(sunday|monday|tuesday|wednesday|thursday|friday|saturday)/i},yz={narrow:[/^s/i,/^m/i,/^t/i,/^w/i,/^t/i,/^f/i,/^s/i],any:[/^su/i,/^m/i,/^tu/i,/^w/i,/^th/i,/^f/i,/^sa/i]},wz={narrow:/^(a|p|mi|n|(in the|at) (morning|afternoon|evening|night))/i,any:/^([ap]\.?\s?m\.?|midnight|noon|(in the|at) (morning|afternoon|evening|night))/i},_z={any:{am:/^a/i,pm:/^p/i,midnight:/^mi/i,noon:/^no/i,morning:/morning/i,afternoon:/afternoon/i,evening:/evening/i,night:/night/i}},bz={ordinalNumber:cz({matchPattern:uz,parsePattern:dz,valueCallback:e=>parseInt(e,10)}),era:Mu({matchPatterns:fz,defaultMatchWidth:"wide",parsePatterns:hz,defaultParseWidth:"any"}),quarter:Mu({matchPatterns:mz,defaultMatchWidth:"wide",parsePatterns:pz,defaultParseWidth:"any",valueCallback:e=>e+1}),month:Mu({matchPatterns:gz,defaultMatchWidth:"wide",parsePatterns:xz,defaultParseWidth:"any"}),day:Mu({matchPatterns:vz,defaultMatchWidth:"wide",parsePatterns:yz,defaultParseWidth:"any"}),dayPeriod:Mu({matchPatterns:wz,defaultMatchWidth:"any",parsePatterns:_z,defaultParseWidth:"any"})},nw={code:"en-US",formatDistance:GU,formatLong:XU,formatRelative:JU,localize:iz,match:bz,options:{weekStartsOn:0,firstWeekContainsDate:1}};function Sz(e){const t=et(e);return Xs(t,_4(t))+1}function S4(e){const t=et(e),r=+ll(t)-+TU(t);return Math.round(r/Q1)+1}function N4(e,t){var d,f,p,h;const r=et(e),n=r.getFullYear(),s=du(),a=(t==null?void 0:t.firstWeekContainsDate)??((f=(d=t==null?void 0:t.locale)==null?void 0:d.options)==null?void 0:f.firstWeekContainsDate)??s.firstWeekContainsDate??((h=(p=s.locale)==null?void 0:p.options)==null?void 0:h.firstWeekContainsDate)??1,o=Gn(e,0);o.setFullYear(n+1,0,a),o.setHours(0,0,0,0);const l=Ts(o,t),c=Gn(e,0);c.setFullYear(n,0,a),c.setHours(0,0,0,0);const u=Ts(c,t);return r.getTime()>=l.getTime()?n+1:r.getTime()>=u.getTime()?n:n-1}function Nz(e,t){var l,c,u,d;const r=du(),n=(t==null?void 0:t.firstWeekContainsDate)??((c=(l=t==null?void 0:t.locale)==null?void 0:l.options)==null?void 0:c.firstWeekContainsDate)??r.firstWeekContainsDate??((d=(u=r.locale)==null?void 0:u.options)==null?void 0:d.firstWeekContainsDate)??1,s=N4(e,t),a=Gn(e,0);return a.setFullYear(s,0,n),a.setHours(0,0,0,0),Ts(a,t)}function j4(e,t){const r=et(e),n=+Ts(r,t)-+Nz(r,t);return Math.round(n/Q1)+1}function Mt(e,t){const r=e<0?"-":"",n=Math.abs(e).toString().padStart(t,"0");return r+n}const Si={y(e,t){const r=e.getFullYear(),n=r>0?r:1-r;return Mt(t==="yy"?n%100:n,t.length)},M(e,t){const r=e.getMonth();return t==="M"?String(r+1):Mt(r+1,2)},d(e,t){return Mt(e.getDate(),t.length)},a(e,t){const r=e.getHours()/12>=1?"pm":"am";switch(t){case"a":case"aa":return r.toUpperCase();case"aaa":return r;case"aaaaa":return r[0];case"aaaa":default:return r==="am"?"a.m.":"p.m."}},h(e,t){return Mt(e.getHours()%12||12,t.length)},H(e,t){return Mt(e.getHours(),t.length)},m(e,t){return Mt(e.getMinutes(),t.length)},s(e,t){return Mt(e.getSeconds(),t.length)},S(e,t){const r=t.length,n=e.getMilliseconds(),s=Math.trunc(n*Math.pow(10,r-3));return Mt(s,t.length)}},Ll={midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},B2={G:function(e,t,r){const n=e.getFullYear()>0?1:0;switch(t){case"G":case"GG":case"GGG":return r.era(n,{width:"abbreviated"});case"GGGGG":return r.era(n,{width:"narrow"});case"GGGG":default:return r.era(n,{width:"wide"})}},y:function(e,t,r){if(t==="yo"){const n=e.getFullYear(),s=n>0?n:1-n;return r.ordinalNumber(s,{unit:"year"})}return Si.y(e,t)},Y:function(e,t,r,n){const s=N4(e,n),a=s>0?s:1-s;if(t==="YY"){const o=a%100;return Mt(o,2)}return t==="Yo"?r.ordinalNumber(a,{unit:"year"}):Mt(a,t.length)},R:function(e,t){const r=w4(e);return Mt(r,t.length)},u:function(e,t){const r=e.getFullYear();return Mt(r,t.length)},Q:function(e,t,r){const n=Math.ceil((e.getMonth()+1)/3);switch(t){case"Q":return String(n);case"QQ":return Mt(n,2);case"Qo":return r.ordinalNumber(n,{unit:"quarter"});case"QQQ":return r.quarter(n,{width:"abbreviated",context:"formatting"});case"QQQQQ":return r.quarter(n,{width:"narrow",context:"formatting"});case"QQQQ":default:return r.quarter(n,{width:"wide",context:"formatting"})}},q:function(e,t,r){const n=Math.ceil((e.getMonth()+1)/3);switch(t){case"q":return String(n);case"qq":return Mt(n,2);case"qo":return r.ordinalNumber(n,{unit:"quarter"});case"qqq":return r.quarter(n,{width:"abbreviated",context:"standalone"});case"qqqqq":return r.quarter(n,{width:"narrow",context:"standalone"});case"qqqq":default:return r.quarter(n,{width:"wide",context:"standalone"})}},M:function(e,t,r){const n=e.getMonth();switch(t){case"M":case"MM":return Si.M(e,t);case"Mo":return r.ordinalNumber(n+1,{unit:"month"});case"MMM":return r.month(n,{width:"abbreviated",context:"formatting"});case"MMMMM":return r.month(n,{width:"narrow",context:"formatting"});case"MMMM":default:return r.month(n,{width:"wide",context:"formatting"})}},L:function(e,t,r){const n=e.getMonth();switch(t){case"L":return String(n+1);case"LL":return Mt(n+1,2);case"Lo":return r.ordinalNumber(n+1,{unit:"month"});case"LLL":return r.month(n,{width:"abbreviated",context:"standalone"});case"LLLLL":return r.month(n,{width:"narrow",context:"standalone"});case"LLLL":default:return r.month(n,{width:"wide",context:"standalone"})}},w:function(e,t,r,n){const s=j4(e,n);return t==="wo"?r.ordinalNumber(s,{unit:"week"}):Mt(s,t.length)},I:function(e,t,r){const n=S4(e);return t==="Io"?r.ordinalNumber(n,{unit:"week"}):Mt(n,t.length)},d:function(e,t,r){return t==="do"?r.ordinalNumber(e.getDate(),{unit:"date"}):Si.d(e,t)},D:function(e,t,r){const n=Sz(e);return t==="Do"?r.ordinalNumber(n,{unit:"dayOfYear"}):Mt(n,t.length)},E:function(e,t,r){const n=e.getDay();switch(t){case"E":case"EE":case"EEE":return r.day(n,{width:"abbreviated",context:"formatting"});case"EEEEE":return r.day(n,{width:"narrow",context:"formatting"});case"EEEEEE":return r.day(n,{width:"short",context:"formatting"});case"EEEE":default:return r.day(n,{width:"wide",context:"formatting"})}},e:function(e,t,r,n){const s=e.getDay(),a=(s-n.weekStartsOn+8)%7||7;switch(t){case"e":return String(a);case"ee":return Mt(a,2);case"eo":return r.ordinalNumber(a,{unit:"day"});case"eee":return r.day(s,{width:"abbreviated",context:"formatting"});case"eeeee":return r.day(s,{width:"narrow",context:"formatting"});case"eeeeee":return r.day(s,{width:"short",context:"formatting"});case"eeee":default:return r.day(s,{width:"wide",context:"formatting"})}},c:function(e,t,r,n){const s=e.getDay(),a=(s-n.weekStartsOn+8)%7||7;switch(t){case"c":return String(a);case"cc":return Mt(a,t.length);case"co":return r.ordinalNumber(a,{unit:"day"});case"ccc":return r.day(s,{width:"abbreviated",context:"standalone"});case"ccccc":return r.day(s,{width:"narrow",context:"standalone"});case"cccccc":return r.day(s,{width:"short",context:"standalone"});case"cccc":default:return r.day(s,{width:"wide",context:"standalone"})}},i:function(e,t,r){const n=e.getDay(),s=n===0?7:n;switch(t){case"i":return String(s);case"ii":return Mt(s,t.length);case"io":return r.ordinalNumber(s,{unit:"day"});case"iii":return r.day(n,{width:"abbreviated",context:"formatting"});case"iiiii":return r.day(n,{width:"narrow",context:"formatting"});case"iiiiii":return r.day(n,{width:"short",context:"formatting"});case"iiii":default:return r.day(n,{width:"wide",context:"formatting"})}},a:function(e,t,r){const s=e.getHours()/12>=1?"pm":"am";switch(t){case"a":case"aa":return r.dayPeriod(s,{width:"abbreviated",context:"formatting"});case"aaa":return r.dayPeriod(s,{width:"abbreviated",context:"formatting"}).toLowerCase();case"aaaaa":return r.dayPeriod(s,{width:"narrow",context:"formatting"});case"aaaa":default:return r.dayPeriod(s,{width:"wide",context:"formatting"})}},b:function(e,t,r){const n=e.getHours();let s;switch(n===12?s=Ll.noon:n===0?s=Ll.midnight:s=n/12>=1?"pm":"am",t){case"b":case"bb":return r.dayPeriod(s,{width:"abbreviated",context:"formatting"});case"bbb":return r.dayPeriod(s,{width:"abbreviated",context:"formatting"}).toLowerCase();case"bbbbb":return r.dayPeriod(s,{width:"narrow",context:"formatting"});case"bbbb":default:return r.dayPeriod(s,{width:"wide",context:"formatting"})}},B:function(e,t,r){const n=e.getHours();let s;switch(n>=17?s=Ll.evening:n>=12?s=Ll.afternoon:n>=4?s=Ll.morning:s=Ll.night,t){case"B":case"BB":case"BBB":return r.dayPeriod(s,{width:"abbreviated",context:"formatting"});case"BBBBB":return r.dayPeriod(s,{width:"narrow",context:"formatting"});case"BBBB":default:return r.dayPeriod(s,{width:"wide",context:"formatting"})}},h:function(e,t,r){if(t==="ho"){let n=e.getHours()%12;return n===0&&(n=12),r.ordinalNumber(n,{unit:"hour"})}return Si.h(e,t)},H:function(e,t,r){return t==="Ho"?r.ordinalNumber(e.getHours(),{unit:"hour"}):Si.H(e,t)},K:function(e,t,r){const n=e.getHours()%12;return t==="Ko"?r.ordinalNumber(n,{unit:"hour"}):Mt(n,t.length)},k:function(e,t,r){let n=e.getHours();return n===0&&(n=24),t==="ko"?r.ordinalNumber(n,{unit:"hour"}):Mt(n,t.length)},m:function(e,t,r){return t==="mo"?r.ordinalNumber(e.getMinutes(),{unit:"minute"}):Si.m(e,t)},s:function(e,t,r){return t==="so"?r.ordinalNumber(e.getSeconds(),{unit:"second"}):Si.s(e,t)},S:function(e,t){return Si.S(e,t)},X:function(e,t,r){const n=e.getTimezoneOffset();if(n===0)return"Z";switch(t){case"X":return z2(n);case"XXXX":case"XX":return Ro(n);case"XXXXX":case"XXX":default:return Ro(n,":")}},x:function(e,t,r){const n=e.getTimezoneOffset();switch(t){case"x":return z2(n);case"xxxx":case"xx":return Ro(n);case"xxxxx":case"xxx":default:return Ro(n,":")}},O:function(e,t,r){const n=e.getTimezoneOffset();switch(t){case"O":case"OO":case"OOO":return"GMT"+U2(n,":");case"OOOO":default:return"GMT"+Ro(n,":")}},z:function(e,t,r){const n=e.getTimezoneOffset();switch(t){case"z":case"zz":case"zzz":return"GMT"+U2(n,":");case"zzzz":default:return"GMT"+Ro(n,":")}},t:function(e,t,r){const n=Math.trunc(e.getTime()/1e3);return Mt(n,t.length)},T:function(e,t,r){const n=e.getTime();return Mt(n,t.length)}};function U2(e,t=""){const r=e>0?"-":"+",n=Math.abs(e),s=Math.trunc(n/60),a=n%60;return a===0?r+String(s):r+String(s)+t+Mt(a,2)}function z2(e,t){return e%60===0?(e>0?"-":"+")+Mt(Math.abs(e)/60,2):Ro(e,t)}function Ro(e,t=""){const r=e>0?"-":"+",n=Math.abs(e),s=Mt(Math.trunc(n/60),2),a=Mt(n%60,2);return r+s+t+a}const V2=(e,t)=>{switch(e){case"P":return t.date({width:"short"});case"PP":return t.date({width:"medium"});case"PPP":return t.date({width:"long"});case"PPPP":default:return t.date({width:"full"})}},E4=(e,t)=>{switch(e){case"p":return t.time({width:"short"});case"pp":return t.time({width:"medium"});case"ppp":return t.time({width:"long"});case"pppp":default:return t.time({width:"full"})}},jz=(e,t)=>{const r=e.match(/(P+)(p+)?/)||[],n=r[1],s=r[2];if(!s)return V2(e,t);let a;switch(n){case"P":a=t.dateTime({width:"short"});break;case"PP":a=t.dateTime({width:"medium"});break;case"PPP":a=t.dateTime({width:"long"});break;case"PPPP":default:a=t.dateTime({width:"full"});break}return a.replace("{{date}}",V2(n,t)).replace("{{time}}",E4(s,t))},Ez={p:E4,P:jz},kz=/^D+$/,Cz=/^Y+$/,Tz=["D","DD","YY","YYYY"];function Az(e){return kz.test(e)}function Pz(e){return Cz.test(e)}function Dz(e,t,r){const n=Rz(e,t,r);if(console.warn(n),Tz.includes(e))throw new RangeError(n)}function Rz(e,t,r){const n=e[0]==="Y"?"years":"days of the month";return`Use \`${e.toLowerCase()}\` instead of \`${e}\` (in \`${t}\`) for formatting ${n} to the input \`${r}\`; see: https://github.com/date-fns/date-fns/blob/master/docs/unicodeTokens.md`}const Mz=/[yYQqMLwIdDecihHKkms]o|(\w)\1*|''|'(''|[^'])+('|$)|./g,Oz=/P+p+|P+|p+|''|'(''|[^'])+('|$)|./g,Fz=/^'([^]*?)'?$/,Iz=/''/g,Lz=/[a-zA-Z]/;function vt(e,t,r){var d,f,p,h,g,m,x,w;const n=du(),s=(r==null?void 0:r.locale)??n.locale??nw,a=(r==null?void 0:r.firstWeekContainsDate)??((f=(d=r==null?void 0:r.locale)==null?void 0:d.options)==null?void 0:f.firstWeekContainsDate)??n.firstWeekContainsDate??((h=(p=n.locale)==null?void 0:p.options)==null?void 0:h.firstWeekContainsDate)??1,o=(r==null?void 0:r.weekStartsOn)??((m=(g=r==null?void 0:r.locale)==null?void 0:g.options)==null?void 0:m.weekStartsOn)??n.weekStartsOn??((w=(x=n.locale)==null?void 0:x.options)==null?void 0:w.weekStartsOn)??0,l=et(e);if(!MU(l))throw new RangeError("Invalid time value");let c=t.match(Oz).map(v=>{const _=v[0];if(_==="p"||_==="P"){const b=Ez[_];return b(v,s.formatLong)}return v}).join("").match(Mz).map(v=>{if(v==="''")return{isToken:!1,value:"'"};const _=v[0];if(_==="'")return{isToken:!1,value:$z(v)};if(B2[_])return{isToken:!0,value:v};if(_.match(Lz))throw new RangeError("Format string contains an unescaped latin alphabet character `"+_+"`");return{isToken:!1,value:v}});s.localize.preprocessor&&(c=s.localize.preprocessor(l,c));const u={firstWeekContainsDate:a,weekStartsOn:o,locale:s};return c.map(v=>{if(!v.isToken)return v.value;const _=v.value;(!(r!=null&&r.useAdditionalWeekYearTokens)&&Pz(_)||!(r!=null&&r.useAdditionalDayOfYearTokens)&&Az(_))&&Dz(_,t,String(e));const b=B2[_[0]];return b(l,_,s.localize,u)}).join("")}function $z(e){const t=e.match(Fz);return t?t[1].replace(Iz,"'"):e}const Bz=["years","months","weeks","days","hours","minutes","seconds"];function Uz(e,t){const r=du(),n=(t==null?void 0:t.locale)??r.locale??nw,s=(t==null?void 0:t.format)??Bz,a=(t==null?void 0:t.zero)??!1,o=(t==null?void 0:t.delimiter)??" ";return n.formatDistance?s.reduce((c,u)=>{const d=`x${u.replace(/(^.)/,p=>p.toUpperCase())}`,f=e[u];return f!==void 0&&(a||e[u])?c.concat(n.formatDistance(d,f)):c},[]).join(o):""}function zz(e){const t=et(e),r=t.getFullYear(),n=t.getMonth(),s=Gn(e,0);return s.setFullYear(r,n+1,0),s.setHours(0,0,0,0),s.getDate()}function Vz(e){return Math.trunc(+et(e)/1e3)}function Wz(e){const t=et(e),r=t.getMonth();return t.setFullYear(t.getFullYear(),r+1,0),t.setHours(0,0,0,0),t}function Hz(e,t){return OU(Wz(e),Mr(e),t)+1}function Gz(e){const t=et(e.start),r=et(e.end),n={},s=WU(r,t);s&&(n.years=s);const a=Du(t,{years:n.years}),o=zU(r,a);o&&(n.months=o);const l=Du(a,{months:n.months}),c=IU(r,l);c&&(n.days=c);const u=Du(l,{days:n.days}),d=LU(r,u);d&&(n.hours=d);const f=Du(u,{hours:n.hours}),p=$U(r,f);p&&(n.minutes=p);const h=Du(f,{minutes:n.minutes}),g=VU(r,h);return g&&(n.seconds=g),n}function Zm(e,t){const r=et(e),n=et(t);return r.getTime()>n.getTime()}function sw(e,t){const r=et(e),n=et(t);return+r<+n}function aw(e,t){const r=et(e),n=et(t);return r.getFullYear()===n.getFullYear()&&r.getMonth()===n.getMonth()}function qz(e,t){const r=et(e),n=et(t);return r.getFullYear()===n.getFullYear()}function tx(e,t){return hn(e,-t)}function dm(e,t){const n=Qz(e);let s;if(n.date){const c=Jz(n.date,2);s=Zz(c.restDateString,c.year)}if(!s||isNaN(s.getTime()))return new Date(NaN);const a=s.getTime();let o=0,l;if(n.time&&(o=eV(n.time),isNaN(o)))return new Date(NaN);if(n.timezone){if(l=tV(n.timezone),isNaN(l))return new Date(NaN)}else{const c=new Date(a+o),u=new Date(0);return u.setFullYear(c.getUTCFullYear(),c.getUTCMonth(),c.getUTCDate()),u.setHours(c.getUTCHours(),c.getUTCMinutes(),c.getUTCSeconds(),c.getUTCMilliseconds()),u}return new Date(a+o+l)}const Dh={dateTimeDelimiter:/[T ]/,timeZoneDelimiter:/[Z ]/i,timezone:/([Z+-].*)$/},Yz=/^-?(?:(\d{3})|(\d{2})(?:-?(\d{2}))?|W(\d{2})(?:-?(\d{1}))?|)$/,Kz=/^(\d{2}(?:[.,]\d*)?)(?::?(\d{2}(?:[.,]\d*)?))?(?::?(\d{2}(?:[.,]\d*)?))?$/,Xz=/^([+-])(\d{2})(?::?(\d{2}))?$/;function Qz(e){const t={},r=e.split(Dh.dateTimeDelimiter);let n;if(r.length>2)return t;if(/:/.test(r[0])?n=r[0]:(t.date=r[0],n=r[1],Dh.timeZoneDelimiter.test(t.date)&&(t.date=e.split(Dh.timeZoneDelimiter)[0],n=e.substr(t.date.length,e.length))),n){const s=Dh.timezone.exec(n);s?(t.time=n.replace(s[1],""),t.timezone=s[1]):t.time=n}return t}function Jz(e,t){const r=new RegExp("^(?:(\\d{4}|[+-]\\d{"+(4+t)+"})|(\\d{2}|[+-]\\d{"+(2+t)+"})$)"),n=e.match(r);if(!n)return{year:NaN,restDateString:""};const s=n[1]?parseInt(n[1]):null,a=n[2]?parseInt(n[2]):null;return{year:a===null?s:a*100,restDateString:e.slice((n[1]||n[2]).length)}}function Zz(e,t){if(t===null)return new Date(NaN);const r=e.match(Yz);if(!r)return new Date(NaN);const n=!!r[4],s=Ou(r[1]),a=Ou(r[2])-1,o=Ou(r[3]),l=Ou(r[4]),c=Ou(r[5])-1;if(n)return iV(t,l,c)?rV(t,l,c):new Date(NaN);{const u=new Date(0);return!sV(t,a,o)||!aV(t,s)?new Date(NaN):(u.setUTCFullYear(t,a,Math.max(s,o)),u)}}function Ou(e){return e?parseInt(e):1}function eV(e){const t=e.match(Kz);if(!t)return NaN;const r=rx(t[1]),n=rx(t[2]),s=rx(t[3]);return oV(r,n,s)?r*Z1+n*J1+s*1e3:NaN}function rx(e){return e&&parseFloat(e.replace(",","."))||0}function tV(e){if(e==="Z")return 0;const t=e.match(Xz);if(!t)return 0;const r=t[1]==="+"?-1:1,n=parseInt(t[2]),s=t[3]&&parseInt(t[3])||0;return lV(n,s)?r*(n*Z1+s*J1):NaN}function rV(e,t,r){const n=new Date(0);n.setUTCFullYear(e,0,4);const s=n.getUTCDay()||7,a=(t-1)*7+r+1-s;return n.setUTCDate(n.getUTCDate()+a),n}const nV=[31,null,31,30,31,30,31,31,30,31,30,31];function k4(e){return e%400===0||e%4===0&&e%100!==0}function sV(e,t,r){return t>=0&&t<=11&&r>=1&&r<=(nV[t]||(k4(e)?29:28))}function aV(e,t){return t>=1&&t<=(k4(e)?366:365)}function iV(e,t,r){return t>=1&&t<=53&&r>=0&&r<=6}function oV(e,t,r){return e===24?t===0&&r===0:r>=0&&r<60&&t>=0&&t<60&&e>=0&&e<25}function lV(e,t){return t>=0&&t<=59}function nx(e,t){const r=et(e),n=r.getFullYear(),s=r.getDate(),a=Gn(e,0);a.setFullYear(n,t,15),a.setHours(0,0,0,0);const o=zz(a);return r.setMonth(t,Math.min(s,o)),r}function W2(e,t){const r=et(e);return isNaN(+r)?Gn(e,NaN):(r.setFullYear(t),r)}function sx(e,t){return us(e,-t)}function H2(e,t){return Jm(e,-1)}const Ff=y.forwardRef(({className:e,...t},r)=>i.jsx("div",{className:"relative w-full overflow-auto",children:i.jsx("table",{ref:r,className:De("w-full caption-bottom text-sm",e),...t})}));Ff.displayName="Table";const If=y.forwardRef(({className:e,...t},r)=>i.jsx("thead",{ref:r,className:De("[&_tr]:border-b",e),...t}));If.displayName="TableHeader";const Lf=y.forwardRef(({className:e,...t},r)=>i.jsx("tbody",{ref:r,className:De("[&_tr:last-child]:border-0",e),...t}));Lf.displayName="TableBody";const cV=y.forwardRef(({className:e,...t},r)=>i.jsx("tfoot",{ref:r,className:De("border-t bg-muted/50 font-medium [&>tr]:last:border-b-0",e),...t}));cV.displayName="TableFooter";const mi=y.forwardRef(({className:e,...t},r)=>i.jsx("tr",{ref:r,className:De("border-b transition-colors hover:bg-muted/50 data-[state=selected]:bg-muted",e),...t}));mi.displayName="TableRow";const dr=y.forwardRef(({className:e,...t},r)=>i.jsx("th",{ref:r,className:De("h-12 px-4 text-left align-middle font-medium text-muted-foreground [&:has([role=checkbox])]:pr-0",e),...t}));dr.displayName="TableHead";const fr=y.forwardRef(({className:e,...t},r)=>i.jsx("td",{ref:r,className:De("p-4 align-middle [&:has([role=checkbox])]:pr-0",e),...t}));fr.displayName="TableCell";const uV=y.forwardRef(({className:e,...t},r)=>i.jsx("caption",{ref:r,className:De("mt-4 text-sm text-muted-foreground",e),...t}));uV.displayName="TableCaption";/*! xlsx.js (C) 2013-present SheetJS -- http://sheetjs.com */var e0={};e0.version="0.18.5";var C4=1252,dV=[874,932,936,949,950,1250,1251,1252,1253,1254,1255,1256,1257,1258,1e4],T4=function(e){dV.indexOf(e)!=-1&&(C4=e)};function fV(){T4(1252)}var Kd=function(e){T4(e)};function hV(){Kd(1200),fV()}var Rh=function(t){return String.fromCharCode(t)},G2=function(t){return String.fromCharCode(t)},t0,Gi="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function Xd(e){for(var t="",r=0,n=0,s=0,a=0,o=0,l=0,c=0,u=0;u<e.length;)r=e.charCodeAt(u++),a=r>>2,n=e.charCodeAt(u++),o=(r&3)<<4|n>>4,s=e.charCodeAt(u++),l=(n&15)<<2|s>>6,c=s&63,isNaN(n)?l=c=64:isNaN(s)&&(c=64),t+=Gi.charAt(a)+Gi.charAt(o)+Gi.charAt(l)+Gi.charAt(c);return t}function pi(e){var t="",r=0,n=0,s=0,a=0,o=0,l=0,c=0;e=e.replace(/[^\w\+\/\=]/g,"");for(var u=0;u<e.length;)a=Gi.indexOf(e.charAt(u++)),o=Gi.indexOf(e.charAt(u++)),r=a<<2|o>>4,t+=String.fromCharCode(r),l=Gi.indexOf(e.charAt(u++)),n=(o&15)<<4|l>>2,l!==64&&(t+=String.fromCharCode(n)),c=Gi.indexOf(e.charAt(u++)),s=(l&3)<<6|c,c!==64&&(t+=String.fromCharCode(s));return t}var At=function(){return typeof Buffer<"u"&&typeof process<"u"&&typeof process.versions<"u"&&!!process.versions.node}(),yi=function(){if(typeof Buffer<"u"){var e=!Buffer.from;if(!e)try{Buffer.from("foo","utf8")}catch{e=!0}return e?function(t,r){return r?new Buffer(t,r):new Buffer(t)}:Buffer.from.bind(Buffer)}return function(){}}();function cl(e){return At?Buffer.alloc?Buffer.alloc(e):new Buffer(e):typeof Uint8Array<"u"?new Uint8Array(e):new Array(e)}function q2(e){return At?Buffer.allocUnsafe?Buffer.allocUnsafe(e):new Buffer(e):typeof Uint8Array<"u"?new Uint8Array(e):new Array(e)}var qs=function(t){return At?yi(t,"binary"):t.split("").map(function(r){return r.charCodeAt(0)&255})};function Tp(e){if(typeof ArrayBuffer>"u")return qs(e);for(var t=new ArrayBuffer(e.length),r=new Uint8Array(t),n=0;n!=e.length;++n)r[n]=e.charCodeAt(n)&255;return t}function $f(e){if(Array.isArray(e))return e.map(function(n){return String.fromCharCode(n)}).join("");for(var t=[],r=0;r<e.length;++r)t[r]=String.fromCharCode(e[r]);return t.join("")}function mV(e){if(typeof Uint8Array>"u")throw new Error("Unsupported");return new Uint8Array(e)}var Jr=At?function(e){return Buffer.concat(e.map(function(t){return Buffer.isBuffer(t)?t:yi(t)}))}:function(e){if(typeof Uint8Array<"u"){var t=0,r=0;for(t=0;t<e.length;++t)r+=e[t].length;var n=new Uint8Array(r),s=0;for(t=0,r=0;t<e.length;r+=s,++t)if(s=e[t].length,e[t]instanceof Uint8Array)n.set(e[t],r);else{if(typeof e[t]=="string")throw"wtf";n.set(new Uint8Array(e[t]),r)}return n}return[].concat.apply([],e.map(function(a){return Array.isArray(a)?a:[].slice.call(a)}))};function pV(e){for(var t=[],r=0,n=e.length+250,s=cl(e.length+255),a=0;a<e.length;++a){var o=e.charCodeAt(a);if(o<128)s[r++]=o;else if(o<2048)s[r++]=192|o>>6&31,s[r++]=128|o&63;else if(o>=55296&&o<57344){o=(o&1023)+64;var l=e.charCodeAt(++a)&1023;s[r++]=240|o>>8&7,s[r++]=128|o>>2&63,s[r++]=128|l>>6&15|(o&3)<<4,s[r++]=128|l&63}else s[r++]=224|o>>12&15,s[r++]=128|o>>6&63,s[r++]=128|o&63;r>n&&(t.push(s.slice(0,r)),r=0,s=cl(65535),n=65530)}return t.push(s.slice(0,r)),Jr(t)}var fd=/\u0000/g,Mh=/[\u0001-\u0006]/g;function vc(e){for(var t="",r=e.length-1;r>=0;)t+=e.charAt(r--);return t}function Qs(e,t){var r=""+e;return r.length>=t?r:ur("0",t-r.length)+r}function iw(e,t){var r=""+e;return r.length>=t?r:ur(" ",t-r.length)+r}function r0(e,t){var r=""+e;return r.length>=t?r:r+ur(" ",t-r.length)}function gV(e,t){var r=""+Math.round(e);return r.length>=t?r:ur("0",t-r.length)+r}function xV(e,t){var r=""+e;return r.length>=t?r:ur("0",t-r.length)+r}var Y2=Math.pow(2,32);function $l(e,t){if(e>Y2||e<-Y2)return gV(e,t);var r=Math.round(e);return xV(r,t)}function n0(e,t){return t=t||0,e.length>=7+t&&(e.charCodeAt(t)|32)===103&&(e.charCodeAt(t+1)|32)===101&&(e.charCodeAt(t+2)|32)===110&&(e.charCodeAt(t+3)|32)===101&&(e.charCodeAt(t+4)|32)===114&&(e.charCodeAt(t+5)|32)===97&&(e.charCodeAt(t+6)|32)===108}var K2=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],ax=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]];function vV(e){return e||(e={}),e[0]="General",e[1]="0",e[2]="0.00",e[3]="#,##0",e[4]="#,##0.00",e[9]="0%",e[10]="0.00%",e[11]="0.00E+00",e[12]="# ?/?",e[13]="# ??/??",e[14]="m/d/yy",e[15]="d-mmm-yy",e[16]="d-mmm",e[17]="mmm-yy",e[18]="h:mm AM/PM",e[19]="h:mm:ss AM/PM",e[20]="h:mm",e[21]="h:mm:ss",e[22]="m/d/yy h:mm",e[37]="#,##0 ;(#,##0)",e[38]="#,##0 ;[Red](#,##0)",e[39]="#,##0.00;(#,##0.00)",e[40]="#,##0.00;[Red](#,##0.00)",e[45]="mm:ss",e[46]="[h]:mm:ss",e[47]="mmss.0",e[48]="##0.0E+0",e[49]="@",e[56]='"/ "hh""mm""ss" "',e}var pr={0:"General",1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"m/d/yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@",56:'"/ "hh""mm""ss" "'},X2={5:37,6:38,7:39,8:40,23:0,24:0,25:0,26:0,27:14,28:14,29:14,30:14,31:14,50:14,51:14,52:14,53:14,54:14,55:14,56:14,57:14,58:14,59:1,60:2,61:3,62:4,67:9,68:10,69:12,70:13,71:14,72:14,73:15,74:16,75:17,76:20,77:21,78:22,79:45,80:46,81:47,82:0},yV={5:'"$"#,##0_);\\("$"#,##0\\)',63:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',41:'_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)'};function s0(e,t,r){for(var n=e<0?-1:1,s=e*n,a=0,o=1,l=0,c=1,u=0,d=0,f=Math.floor(s);u<t&&(f=Math.floor(s),l=f*o+a,d=f*u+c,!(s-f<5e-8));)s=1/(s-f),a=o,o=l,c=u,u=d;if(d>t&&(u>t?(d=c,l=a):(d=u,l=o)),!r)return[0,n*l,d];var p=Math.floor(n*l/d);return[p,n*l-p*d,d]}function Oh(e,t,r){if(e>2958465||e<0)return null;var n=e|0,s=Math.floor(86400*(e-n)),a=0,o=[],l={D:n,T:s,u:86400*(e-n)-s,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(l.u)<1e-6&&(l.u=0),t&&t.date1904&&(n+=1462),l.u>.9999&&(l.u=0,++s==86400&&(l.T=s=0,++n,++l.D)),n===60)o=r?[1317,10,29]:[1900,2,29],a=3;else if(n===0)o=r?[1317,8,29]:[1900,1,0],a=6;else{n>60&&--n;var c=new Date(1900,0,1);c.setDate(c.getDate()+n-1),o=[c.getFullYear(),c.getMonth()+1,c.getDate()],a=c.getDay(),n<60&&(a=(a+6)%7),r&&(a=EV(c,o))}return l.y=o[0],l.m=o[1],l.d=o[2],l.S=s%60,s=Math.floor(s/60),l.M=s%60,s=Math.floor(s/60),l.H=s,l.q=a,l}var A4=new Date(1899,11,31,0,0,0),wV=A4.getTime(),_V=new Date(1900,2,1,0,0,0);function P4(e,t){var r=e.getTime();return t?r-=1461*24*60*60*1e3:e>=_V&&(r+=24*60*60*1e3),(r-(wV+(e.getTimezoneOffset()-A4.getTimezoneOffset())*6e4))/(24*60*60*1e3)}function ow(e){return e.indexOf(".")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)$/,"$1")}function bV(e){return e.indexOf("E")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)[Ee]/,"$1E").replace(/(E[+-])(\d)$/,"$10$2")}function SV(e){var t=e<0?12:11,r=ow(e.toFixed(12));return r.length<=t||(r=e.toPrecision(10),r.length<=t)?r:e.toExponential(5)}function NV(e){var t=ow(e.toFixed(11));return t.length>(e<0?12:11)||t==="0"||t==="-0"?e.toPrecision(6):t}function jV(e){var t=Math.floor(Math.log(Math.abs(e))*Math.LOG10E),r;return t>=-4&&t<=-1?r=e.toPrecision(10+t):Math.abs(t)<=9?r=SV(e):t===10?r=e.toFixed(10).substr(0,12):r=NV(e),ow(bV(r.toUpperCase()))}function Yv(e,t){switch(typeof e){case"string":return e;case"boolean":return e?"TRUE":"FALSE";case"number":return(e|0)===e?e.toString(10):jV(e);case"undefined":return"";case"object":if(e==null)return"";if(e instanceof Date)return fo(14,P4(e,t&&t.date1904),t)}throw new Error("unsupported value in General format: "+e)}function EV(e,t){t[0]-=581;var r=e.getDay();return e<60&&(r=(r+6)%7),r}function kV(e,t,r,n){var s="",a=0,o=0,l=r.y,c,u=0;switch(e){case 98:l=r.y+543;case 121:switch(t.length){case 1:case 2:c=l%100,u=2;break;default:c=l%1e4,u=4;break}break;case 109:switch(t.length){case 1:case 2:c=r.m,u=t.length;break;case 3:return ax[r.m-1][1];case 5:return ax[r.m-1][0];default:return ax[r.m-1][2]}break;case 100:switch(t.length){case 1:case 2:c=r.d,u=t.length;break;case 3:return K2[r.q][0];default:return K2[r.q][1]}break;case 104:switch(t.length){case 1:case 2:c=1+(r.H+11)%12,u=t.length;break;default:throw"bad hour format: "+t}break;case 72:switch(t.length){case 1:case 2:c=r.H,u=t.length;break;default:throw"bad hour format: "+t}break;case 77:switch(t.length){case 1:case 2:c=r.M,u=t.length;break;default:throw"bad minute format: "+t}break;case 115:if(t!="s"&&t!="ss"&&t!=".0"&&t!=".00"&&t!=".000")throw"bad second format: "+t;return r.u===0&&(t=="s"||t=="ss")?Qs(r.S,t.length):(n>=2?o=n===3?1e3:100:o=n===1?10:1,a=Math.round(o*(r.S+r.u)),a>=60*o&&(a=0),t==="s"?a===0?"0":""+a/o:(s=Qs(a,2+n),t==="ss"?s.substr(0,2):"."+s.substr(2,t.length-1)));case 90:switch(t){case"[h]":case"[hh]":c=r.D*24+r.H;break;case"[m]":case"[mm]":c=(r.D*24+r.H)*60+r.M;break;case"[s]":case"[ss]":c=((r.D*24+r.H)*60+r.M)*60+Math.round(r.S+r.u);break;default:throw"bad abstime format: "+t}u=t.length===3?1:2;break;case 101:c=l,u=1;break}var d=u>0?Qs(c,u):"";return d}function qi(e){var t=3;if(e.length<=t)return e;for(var r=e.length%t,n=e.substr(0,r);r!=e.length;r+=t)n+=(n.length>0?",":"")+e.substr(r,t);return n}var D4=/%/g;function CV(e,t,r){var n=t.replace(D4,""),s=t.length-n.length;return ni(e,n,r*Math.pow(10,2*s))+ur("%",s)}function TV(e,t,r){for(var n=t.length-1;t.charCodeAt(n-1)===44;)--n;return ni(e,t.substr(0,n),r/Math.pow(10,3*(t.length-n)))}function R4(e,t){var r,n=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(t==0)return"0.0E+0";if(t<0)return"-"+R4(e,-t);var s=e.indexOf(".");s===-1&&(s=e.indexOf("E"));var a=Math.floor(Math.log(t)*Math.LOG10E)%s;if(a<0&&(a+=s),r=(t/Math.pow(10,a)).toPrecision(n+1+(s+a)%s),r.indexOf("e")===-1){var o=Math.floor(Math.log(t)*Math.LOG10E);for(r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(o-r.length+a):r+="E+"+(o-a);r.substr(0,2)==="0.";)r=r.charAt(0)+r.substr(2,s)+"."+r.substr(2+s),r=r.replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(l,c,u,d){return c+u+d.substr(0,(s+a)%s)+"."+d.substr(a)+"E"})}else r=t.toExponential(n);return e.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),e.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}var M4=/# (\?+)( ?)\/( ?)(\d+)/;function AV(e,t,r){var n=parseInt(e[4],10),s=Math.round(t*n),a=Math.floor(s/n),o=s-a*n,l=n;return r+(a===0?"":""+a)+" "+(o===0?ur(" ",e[1].length+1+e[4].length):iw(o,e[1].length)+e[2]+"/"+e[3]+Qs(l,e[4].length))}function PV(e,t,r){return r+(t===0?"":""+t)+ur(" ",e[1].length+2+e[4].length)}var O4=/^#*0*\.([0#]+)/,F4=/\).*[0#]/,I4=/\(###\) ###\\?-####/;function Sn(e){for(var t="",r,n=0;n!=e.length;++n)switch(r=e.charCodeAt(n)){case 35:break;case 63:t+=" ";break;case 48:t+="0";break;default:t+=String.fromCharCode(r)}return t}function Q2(e,t){var r=Math.pow(10,t);return""+Math.round(e*r)/r}function J2(e,t){var r=e-Math.floor(e),n=Math.pow(10,t);return t<(""+Math.round(r*n)).length?0:Math.round(r*n)}function DV(e,t){return t<(""+Math.round((e-Math.floor(e))*Math.pow(10,t))).length?1:0}function RV(e){return e<2147483647&&e>-2147483648?""+(e>=0?e|0:e-1|0):""+Math.floor(e)}function ps(e,t,r){if(e.charCodeAt(0)===40&&!t.match(F4)){var n=t.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?ps("n",n,r):"("+ps("n",n,-r)+")"}if(t.charCodeAt(t.length-1)===44)return TV(e,t,r);if(t.indexOf("%")!==-1)return CV(e,t,r);if(t.indexOf("E")!==-1)return R4(t,r);if(t.charCodeAt(0)===36)return"$"+ps(e,t.substr(t.charAt(1)==" "?2:1),r);var s,a,o,l,c=Math.abs(r),u=r<0?"-":"";if(t.match(/^00+$/))return u+$l(c,t.length);if(t.match(/^[#?]+$/))return s=$l(r,0),s==="0"&&(s=""),s.length>t.length?s:Sn(t.substr(0,t.length-s.length))+s;if(a=t.match(M4))return AV(a,c,u);if(t.match(/^#+0+$/))return u+$l(c,t.length-t.indexOf("0"));if(a=t.match(O4))return s=Q2(r,a[1].length).replace(/^([^\.]+)$/,"$1."+Sn(a[1])).replace(/\.$/,"."+Sn(a[1])).replace(/\.(\d*)$/,function(g,m){return"."+m+ur("0",Sn(a[1]).length-m.length)}),t.indexOf("0.")!==-1?s:s.replace(/^0\./,".");if(t=t.replace(/^#+([0.])/,"$1"),a=t.match(/^(0*)\.(#*)$/))return u+Q2(c,a[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,a[1].length?"0.":".");if(a=t.match(/^#{1,3},##0(\.?)$/))return u+qi($l(c,0));if(a=t.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+ps(e,t,-r):qi(""+(Math.floor(r)+DV(r,a[1].length)))+"."+Qs(J2(r,a[1].length),a[1].length);if(a=t.match(/^#,#*,#0/))return ps(e,t.replace(/^#,#*,/,""),r);if(a=t.match(/^([0#]+)(\\?-([0#]+))+$/))return s=vc(ps(e,t.replace(/[\\-]/g,""),r)),o=0,vc(vc(t.replace(/\\/g,"")).replace(/[0#]/g,function(g){return o<s.length?s.charAt(o++):g==="0"?"0":""}));if(t.match(I4))return s=ps(e,"##########",r),"("+s.substr(0,3)+") "+s.substr(3,3)+"-"+s.substr(6);var d="";if(a=t.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return o=Math.min(a[4].length,7),l=s0(c,Math.pow(10,o)-1,!1),s=""+u,d=ni("n",a[1],l[1]),d.charAt(d.length-1)==" "&&(d=d.substr(0,d.length-1)+"0"),s+=d+a[2]+"/"+a[3],d=r0(l[2],o),d.length<a[4].length&&(d=Sn(a[4].substr(a[4].length-d.length))+d),s+=d,s;if(a=t.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return o=Math.min(Math.max(a[1].length,a[4].length),7),l=s0(c,Math.pow(10,o)-1,!0),u+(l[0]||(l[1]?"":"0"))+" "+(l[1]?iw(l[1],o)+a[2]+"/"+a[3]+r0(l[2],o):ur(" ",2*o+1+a[2].length+a[3].length));if(a=t.match(/^[#0?]+$/))return s=$l(r,0),t.length<=s.length?s:Sn(t.substr(0,t.length-s.length))+s;if(a=t.match(/^([#0?]+)\.([#0]+)$/)){s=""+r.toFixed(Math.min(a[2].length,10)).replace(/([^0])0+$/,"$1"),o=s.indexOf(".");var f=t.indexOf(".")-o,p=t.length-s.length-f;return Sn(t.substr(0,f)+s+t.substr(t.length-p))}if(a=t.match(/^00,000\.([#0]*0)$/))return o=J2(r,a[1].length),r<0?"-"+ps(e,t,-r):qi(RV(r)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(g){return"00,"+(g.length<3?Qs(0,3-g.length):"")+g})+"."+Qs(o,a[1].length);switch(t){case"###,##0.00":return ps(e,"#,##0.00",r);case"###,###":case"##,###":case"#,###":var h=qi($l(c,0));return h!=="0"?u+h:"";case"###,###.00":return ps(e,"###,##0.00",r).replace(/^0\./,".");case"#,###.00":return ps(e,"#,##0.00",r).replace(/^0\./,".")}throw new Error("unsupported format |"+t+"|")}function MV(e,t,r){for(var n=t.length-1;t.charCodeAt(n-1)===44;)--n;return ni(e,t.substr(0,n),r/Math.pow(10,3*(t.length-n)))}function OV(e,t,r){var n=t.replace(D4,""),s=t.length-n.length;return ni(e,n,r*Math.pow(10,2*s))+ur("%",s)}function L4(e,t){var r,n=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(t==0)return"0.0E+0";if(t<0)return"-"+L4(e,-t);var s=e.indexOf(".");s===-1&&(s=e.indexOf("E"));var a=Math.floor(Math.log(t)*Math.LOG10E)%s;if(a<0&&(a+=s),r=(t/Math.pow(10,a)).toPrecision(n+1+(s+a)%s),!r.match(/[Ee]/)){var o=Math.floor(Math.log(t)*Math.LOG10E);r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(o-r.length+a):r+="E+"+(o-a),r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(l,c,u,d){return c+u+d.substr(0,(s+a)%s)+"."+d.substr(a)+"E"})}else r=t.toExponential(n);return e.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),e.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}function ga(e,t,r){if(e.charCodeAt(0)===40&&!t.match(F4)){var n=t.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?ga("n",n,r):"("+ga("n",n,-r)+")"}if(t.charCodeAt(t.length-1)===44)return MV(e,t,r);if(t.indexOf("%")!==-1)return OV(e,t,r);if(t.indexOf("E")!==-1)return L4(t,r);if(t.charCodeAt(0)===36)return"$"+ga(e,t.substr(t.charAt(1)==" "?2:1),r);var s,a,o,l,c=Math.abs(r),u=r<0?"-":"";if(t.match(/^00+$/))return u+Qs(c,t.length);if(t.match(/^[#?]+$/))return s=""+r,r===0&&(s=""),s.length>t.length?s:Sn(t.substr(0,t.length-s.length))+s;if(a=t.match(M4))return PV(a,c,u);if(t.match(/^#+0+$/))return u+Qs(c,t.length-t.indexOf("0"));if(a=t.match(O4))return s=(""+r).replace(/^([^\.]+)$/,"$1."+Sn(a[1])).replace(/\.$/,"."+Sn(a[1])),s=s.replace(/\.(\d*)$/,function(g,m){return"."+m+ur("0",Sn(a[1]).length-m.length)}),t.indexOf("0.")!==-1?s:s.replace(/^0\./,".");if(t=t.replace(/^#+([0.])/,"$1"),a=t.match(/^(0*)\.(#*)$/))return u+(""+c).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,a[1].length?"0.":".");if(a=t.match(/^#{1,3},##0(\.?)$/))return u+qi(""+c);if(a=t.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+ga(e,t,-r):qi(""+r)+"."+ur("0",a[1].length);if(a=t.match(/^#,#*,#0/))return ga(e,t.replace(/^#,#*,/,""),r);if(a=t.match(/^([0#]+)(\\?-([0#]+))+$/))return s=vc(ga(e,t.replace(/[\\-]/g,""),r)),o=0,vc(vc(t.replace(/\\/g,"")).replace(/[0#]/g,function(g){return o<s.length?s.charAt(o++):g==="0"?"0":""}));if(t.match(I4))return s=ga(e,"##########",r),"("+s.substr(0,3)+") "+s.substr(3,3)+"-"+s.substr(6);var d="";if(a=t.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return o=Math.min(a[4].length,7),l=s0(c,Math.pow(10,o)-1,!1),s=""+u,d=ni("n",a[1],l[1]),d.charAt(d.length-1)==" "&&(d=d.substr(0,d.length-1)+"0"),s+=d+a[2]+"/"+a[3],d=r0(l[2],o),d.length<a[4].length&&(d=Sn(a[4].substr(a[4].length-d.length))+d),s+=d,s;if(a=t.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return o=Math.min(Math.max(a[1].length,a[4].length),7),l=s0(c,Math.pow(10,o)-1,!0),u+(l[0]||(l[1]?"":"0"))+" "+(l[1]?iw(l[1],o)+a[2]+"/"+a[3]+r0(l[2],o):ur(" ",2*o+1+a[2].length+a[3].length));if(a=t.match(/^[#0?]+$/))return s=""+r,t.length<=s.length?s:Sn(t.substr(0,t.length-s.length))+s;if(a=t.match(/^([#0]+)\.([#0]+)$/)){s=""+r.toFixed(Math.min(a[2].length,10)).replace(/([^0])0+$/,"$1"),o=s.indexOf(".");var f=t.indexOf(".")-o,p=t.length-s.length-f;return Sn(t.substr(0,f)+s+t.substr(t.length-p))}if(a=t.match(/^00,000\.([#0]*0)$/))return r<0?"-"+ga(e,t,-r):qi(""+r).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(g){return"00,"+(g.length<3?Qs(0,3-g.length):"")+g})+"."+Qs(0,a[1].length);switch(t){case"###,###":case"##,###":case"#,###":var h=qi(""+c);return h!=="0"?u+h:"";default:if(t.match(/\.[0#?]*$/))return ga(e,t.slice(0,t.lastIndexOf(".")),r)+Sn(t.slice(t.lastIndexOf(".")))}throw new Error("unsupported format |"+t+"|")}function ni(e,t,r){return(r|0)===r?ga(e,t,r):ps(e,t,r)}function FV(e){for(var t=[],r=!1,n=0,s=0;n<e.length;++n)switch(e.charCodeAt(n)){case 34:r=!r;break;case 95:case 42:case 92:++n;break;case 59:t[t.length]=e.substr(s,n-s),s=n+1}if(t[t.length]=e.substr(s),r===!0)throw new Error("Format |"+e+"| unterminated string ");return t}var $4=/\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/;function B4(e){for(var t=0,r="",n="";t<e.length;)switch(r=e.charAt(t)){case"G":n0(e,t)&&(t+=6),t++;break;case'"':for(;e.charCodeAt(++t)!==34&&t<e.length;);++t;break;case"\\":t+=2;break;case"_":t+=2;break;case"@":++t;break;case"B":case"b":if(e.charAt(t+1)==="1"||e.charAt(t+1)==="2")return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":case"":if(e.substr(t,3).toUpperCase()==="A/P"||e.substr(t,5).toUpperCase()==="AM/PM"||e.substr(t,5).toUpperCase()==="/")return!0;++t;break;case"[":for(n=r;e.charAt(t++)!=="]"&&t<e.length;)n+=e.charAt(t);if(n.match($4))return!0;break;case".":case"0":case"#":for(;t<e.length&&("0#?.,E+-%".indexOf(r=e.charAt(++t))>-1||r=="\\"&&e.charAt(t+1)=="-"&&"0#".indexOf(e.charAt(t+2))>-1););break;case"?":for(;e.charAt(++t)===r;);break;case"*":++t,(e.charAt(t)==" "||e.charAt(t)=="*")&&++t;break;case"(":case")":++t;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;t<e.length&&"0123456789".indexOf(e.charAt(++t))>-1;);break;case" ":++t;break;default:++t;break}return!1}function IV(e,t,r,n){for(var s=[],a="",o=0,l="",c="t",u,d,f,p="H";o<e.length;)switch(l=e.charAt(o)){case"G":if(!n0(e,o))throw new Error("unrecognized character "+l+" in "+e);s[s.length]={t:"G",v:"General"},o+=7;break;case'"':for(a="";(f=e.charCodeAt(++o))!==34&&o<e.length;)a+=String.fromCharCode(f);s[s.length]={t:"t",v:a},++o;break;case"\\":var h=e.charAt(++o),g=h==="("||h===")"?h:"t";s[s.length]={t:g,v:h},++o;break;case"_":s[s.length]={t:"t",v:" "},o+=2;break;case"@":s[s.length]={t:"T",v:t},++o;break;case"B":case"b":if(e.charAt(o+1)==="1"||e.charAt(o+1)==="2"){if(u==null&&(u=Oh(t,r,e.charAt(o+1)==="2"),u==null))return"";s[s.length]={t:"X",v:e.substr(o,2)},c=l,o+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":l=l.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(t<0||u==null&&(u=Oh(t,r),u==null))return"";for(a=l;++o<e.length&&e.charAt(o).toLowerCase()===l;)a+=l;l==="m"&&c.toLowerCase()==="h"&&(l="M"),l==="h"&&(l=p),s[s.length]={t:l,v:a},c=l;break;case"A":case"a":case"":var m={t:l,v:l};if(u==null&&(u=Oh(t,r)),e.substr(o,3).toUpperCase()==="A/P"?(u!=null&&(m.v=u.H>=12?"P":"A"),m.t="T",p="h",o+=3):e.substr(o,5).toUpperCase()==="AM/PM"?(u!=null&&(m.v=u.H>=12?"PM":"AM"),m.t="T",o+=5,p="h"):e.substr(o,5).toUpperCase()==="/"?(u!=null&&(m.v=u.H>=12?"":""),m.t="T",o+=5,p="h"):(m.t="t",++o),u==null&&m.t==="T")return"";s[s.length]=m,c=l;break;case"[":for(a=l;e.charAt(o++)!=="]"&&o<e.length;)a+=e.charAt(o);if(a.slice(-1)!=="]")throw'unterminated "[" block: |'+a+"|";if(a.match($4)){if(u==null&&(u=Oh(t,r),u==null))return"";s[s.length]={t:"Z",v:a.toLowerCase()},c=a.charAt(1)}else a.indexOf("$")>-1&&(a=(a.match(/\$([^-\[\]]*)/)||[])[1]||"$",B4(e)||(s[s.length]={t:"t",v:a}));break;case".":if(u!=null){for(a=l;++o<e.length&&(l=e.charAt(o))==="0";)a+=l;s[s.length]={t:"s",v:a};break}case"0":case"#":for(a=l;++o<e.length&&"0#?.,E+-%".indexOf(l=e.charAt(o))>-1;)a+=l;s[s.length]={t:"n",v:a};break;case"?":for(a=l;e.charAt(++o)===l;)a+=l;s[s.length]={t:l,v:a},c=l;break;case"*":++o,(e.charAt(o)==" "||e.charAt(o)=="*")&&++o;break;case"(":case")":s[s.length]={t:n===1?"t":l,v:l},++o;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(a=l;o<e.length&&"0123456789".indexOf(e.charAt(++o))>-1;)a+=e.charAt(o);s[s.length]={t:"D",v:a};break;case" ":s[s.length]={t:l,v:l},++o;break;case"$":s[s.length]={t:"t",v:"$"},++o;break;default:if(",$-+/():!^&'~{}<>=acfijklopqrtuvwxzP".indexOf(l)===-1)throw new Error("unrecognized character "+l+" in "+e);s[s.length]={t:"t",v:l},++o;break}var x=0,w=0,v;for(o=s.length-1,c="t";o>=0;--o)switch(s[o].t){case"h":case"H":s[o].t=p,c="h",x<1&&(x=1);break;case"s":(v=s[o].v.match(/\.0+$/))&&(w=Math.max(w,v[0].length-1)),x<3&&(x=3);case"d":case"y":case"M":case"e":c=s[o].t;break;case"m":c==="s"&&(s[o].t="M",x<2&&(x=2));break;case"X":break;case"Z":x<1&&s[o].v.match(/[Hh]/)&&(x=1),x<2&&s[o].v.match(/[Mm]/)&&(x=2),x<3&&s[o].v.match(/[Ss]/)&&(x=3)}switch(x){case 0:break;case 1:u.u>=.5&&(u.u=0,++u.S),u.S>=60&&(u.S=0,++u.M),u.M>=60&&(u.M=0,++u.H);break;case 2:u.u>=.5&&(u.u=0,++u.S),u.S>=60&&(u.S=0,++u.M);break}var _="",b;for(o=0;o<s.length;++o)switch(s[o].t){case"t":case"T":case" ":case"D":break;case"X":s[o].v="",s[o].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":s[o].v=kV(s[o].t.charCodeAt(0),s[o].v,u,w),s[o].t="t";break;case"n":case"?":for(b=o+1;s[b]!=null&&((l=s[b].t)==="?"||l==="D"||(l===" "||l==="t")&&s[b+1]!=null&&(s[b+1].t==="?"||s[b+1].t==="t"&&s[b+1].v==="/")||s[o].t==="("&&(l===" "||l==="n"||l===")")||l==="t"&&(s[b].v==="/"||s[b].v===" "&&s[b+1]!=null&&s[b+1].t=="?"));)s[o].v+=s[b].v,s[b]={v:"",t:";"},++b;_+=s[o].v,o=b-1;break;case"G":s[o].t="t",s[o].v=Yv(t,r);break}var S="",T,N;if(_.length>0){_.charCodeAt(0)==40?(T=t<0&&_.charCodeAt(0)===45?-t:t,N=ni("n",_,T)):(T=t<0&&n>1?-t:t,N=ni("n",_,T),T<0&&s[0]&&s[0].t=="t"&&(N=N.substr(1),s[0].v="-"+s[0].v)),b=N.length-1;var C=s.length;for(o=0;o<s.length;++o)if(s[o]!=null&&s[o].t!="t"&&s[o].v.indexOf(".")>-1){C=o;break}var E=s.length;if(C===s.length&&N.indexOf("E")===-1){for(o=s.length-1;o>=0;--o)s[o]==null||"n?".indexOf(s[o].t)===-1||(b>=s[o].v.length-1?(b-=s[o].v.length,s[o].v=N.substr(b+1,s[o].v.length)):b<0?s[o].v="":(s[o].v=N.substr(0,b+1),b=-1),s[o].t="t",E=o);b>=0&&E<s.length&&(s[E].v=N.substr(0,b+1)+s[E].v)}else if(C!==s.length&&N.indexOf("E")===-1){for(b=N.indexOf(".")-1,o=C;o>=0;--o)if(!(s[o]==null||"n?".indexOf(s[o].t)===-1)){for(d=s[o].v.indexOf(".")>-1&&o===C?s[o].v.indexOf(".")-1:s[o].v.length-1,S=s[o].v.substr(d+1);d>=0;--d)b>=0&&(s[o].v.charAt(d)==="0"||s[o].v.charAt(d)==="#")&&(S=N.charAt(b--)+S);s[o].v=S,s[o].t="t",E=o}for(b>=0&&E<s.length&&(s[E].v=N.substr(0,b+1)+s[E].v),b=N.indexOf(".")+1,o=C;o<s.length;++o)if(!(s[o]==null||"n?(".indexOf(s[o].t)===-1&&o!==C)){for(d=s[o].v.indexOf(".")>-1&&o===C?s[o].v.indexOf(".")+1:0,S=s[o].v.substr(0,d);d<s[o].v.length;++d)b<N.length&&(S+=N.charAt(b++));s[o].v=S,s[o].t="t",E=o}}}for(o=0;o<s.length;++o)s[o]!=null&&"n?".indexOf(s[o].t)>-1&&(T=n>1&&t<0&&o>0&&s[o-1].v==="-"?-t:t,s[o].v=ni(s[o].t,s[o].v,T),s[o].t="t");var P="";for(o=0;o!==s.length;++o)s[o]!=null&&(P+=s[o].v);return P}var Z2=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function eS(e,t){if(t==null)return!1;var r=parseFloat(t[2]);switch(t[1]){case"=":if(e==r)return!0;break;case">":if(e>r)return!0;break;case"<":if(e<r)return!0;break;case"<>":if(e!=r)return!0;break;case">=":if(e>=r)return!0;break;case"<=":if(e<=r)return!0;break}return!1}function LV(e,t){var r=FV(e),n=r.length,s=r[n-1].indexOf("@");if(n<4&&s>-1&&--n,r.length>4)throw new Error("cannot find right format for |"+r.join("|")+"|");if(typeof t!="number")return[4,r.length===4||s>-1?r[r.length-1]:"@"];switch(r.length){case 1:r=s>-1?["General","General","General",r[0]]:[r[0],r[0],r[0],"@"];break;case 2:r=s>-1?[r[0],r[0],r[0],r[1]]:[r[0],r[1],r[0],"@"];break;case 3:r=s>-1?[r[0],r[1],r[0],r[2]]:[r[0],r[1],r[2],"@"];break}var a=t>0?r[0]:t<0?r[1]:r[2];if(r[0].indexOf("[")===-1&&r[1].indexOf("[")===-1)return[n,a];if(r[0].match(/\[[=<>]/)!=null||r[1].match(/\[[=<>]/)!=null){var o=r[0].match(Z2),l=r[1].match(Z2);return eS(t,o)?[n,r[0]]:eS(t,l)?[n,r[1]]:[n,r[o!=null&&l!=null?2:1]]}return[n,a]}function fo(e,t,r){r==null&&(r={});var n="";switch(typeof e){case"string":e=="m/d/yy"&&r.dateNF?n=r.dateNF:n=e;break;case"number":e==14&&r.dateNF?n=r.dateNF:n=(r.table!=null?r.table:pr)[e],n==null&&(n=r.table&&r.table[X2[e]]||pr[X2[e]]),n==null&&(n=yV[e]||"General");break}if(n0(n,0))return Yv(t,r);t instanceof Date&&(t=P4(t,r.date1904));var s=LV(n,t);if(n0(s[1]))return Yv(t,r);if(t===!0)t="TRUE";else if(t===!1)t="FALSE";else if(t===""||t==null)return"";return IV(s[1],t,r,s[0])}function U4(e,t){if(typeof t!="number"){t=+t||-1;for(var r=0;r<392;++r){if(pr[r]==null){t<0&&(t=r);continue}if(pr[r]==e){t=r;break}}t<0&&(t=391)}return pr[t]=e,t}function Ap(e){for(var t=0;t!=392;++t)e[t]!==void 0&&U4(e[t],t)}function Pp(){pr=vV()}var z4=/[dD]+|[mM]+|[yYeE]+|[Hh]+|[Ss]+/g;function $V(e){var t=typeof e=="number"?pr[e]:e;return t=t.replace(z4,"(\\d+)"),new RegExp("^"+t+"$")}function BV(e,t,r){var n=-1,s=-1,a=-1,o=-1,l=-1,c=-1;(t.match(z4)||[]).forEach(function(f,p){var h=parseInt(r[p+1],10);switch(f.toLowerCase().charAt(0)){case"y":n=h;break;case"d":a=h;break;case"h":o=h;break;case"s":c=h;break;case"m":o>=0?l=h:s=h;break}}),c>=0&&l==-1&&s>=0&&(l=s,s=-1);var u=(""+(n>=0?n:new Date().getFullYear())).slice(-4)+"-"+("00"+(s>=1?s:1)).slice(-2)+"-"+("00"+(a>=1?a:1)).slice(-2);u.length==7&&(u="0"+u),u.length==8&&(u="20"+u);var d=("00"+(o>=0?o:0)).slice(-2)+":"+("00"+(l>=0?l:0)).slice(-2)+":"+("00"+(c>=0?c:0)).slice(-2);return o==-1&&l==-1&&c==-1?u:n==-1&&s==-1&&a==-1?d:u+"T"+d}var UV=function(){var e={};e.version="1.2.0";function t(){for(var N=0,C=new Array(256),E=0;E!=256;++E)N=E,N=N&1?-306674912^N>>>1:N>>>1,N=N&1?-306674912^N>>>1:N>>>1,N=N&1?-306674912^N>>>1:N>>>1,N=N&1?-306674912^N>>>1:N>>>1,N=N&1?-306674912^N>>>1:N>>>1,N=N&1?-306674912^N>>>1:N>>>1,N=N&1?-306674912^N>>>1:N>>>1,N=N&1?-306674912^N>>>1:N>>>1,C[E]=N;return typeof Int32Array<"u"?new Int32Array(C):C}var r=t();function n(N){var C=0,E=0,P=0,R=typeof Int32Array<"u"?new Int32Array(4096):new Array(4096);for(P=0;P!=256;++P)R[P]=N[P];for(P=0;P!=256;++P)for(E=N[P],C=256+P;C<4096;C+=256)E=R[C]=E>>>8^N[E&255];var j=[];for(P=1;P!=16;++P)j[P-1]=typeof Int32Array<"u"?R.subarray(P*256,P*256+256):R.slice(P*256,P*256+256);return j}var s=n(r),a=s[0],o=s[1],l=s[2],c=s[3],u=s[4],d=s[5],f=s[6],p=s[7],h=s[8],g=s[9],m=s[10],x=s[11],w=s[12],v=s[13],_=s[14];function b(N,C){for(var E=C^-1,P=0,R=N.length;P<R;)E=E>>>8^r[(E^N.charCodeAt(P++))&255];return~E}function S(N,C){for(var E=C^-1,P=N.length-15,R=0;R<P;)E=_[N[R++]^E&255]^v[N[R++]^E>>8&255]^w[N[R++]^E>>16&255]^x[N[R++]^E>>>24]^m[N[R++]]^g[N[R++]]^h[N[R++]]^p[N[R++]]^f[N[R++]]^d[N[R++]]^u[N[R++]]^c[N[R++]]^l[N[R++]]^o[N[R++]]^a[N[R++]]^r[N[R++]];for(P+=15;R<P;)E=E>>>8^r[(E^N[R++])&255];return~E}function T(N,C){for(var E=C^-1,P=0,R=N.length,j=0,M=0;P<R;)j=N.charCodeAt(P++),j<128?E=E>>>8^r[(E^j)&255]:j<2048?(E=E>>>8^r[(E^(192|j>>6&31))&255],E=E>>>8^r[(E^(128|j&63))&255]):j>=55296&&j<57344?(j=(j&1023)+64,M=N.charCodeAt(P++)&1023,E=E>>>8^r[(E^(240|j>>8&7))&255],E=E>>>8^r[(E^(128|j>>2&63))&255],E=E>>>8^r[(E^(128|M>>6&15|(j&3)<<4))&255],E=E>>>8^r[(E^(128|M&63))&255]):(E=E>>>8^r[(E^(224|j>>12&15))&255],E=E>>>8^r[(E^(128|j>>6&63))&255],E=E>>>8^r[(E^(128|j&63))&255]);return~E}return e.table=r,e.bstr=b,e.buf=S,e.str=T,e}(),Ut=function(){var t={};t.version="1.2.1";function r(q,te){for(var Z=q.split("/"),ee=te.split("/"),re=0,se=0,ye=Math.min(Z.length,ee.length);re<ye;++re){if(se=Z[re].length-ee[re].length)return se;if(Z[re]!=ee[re])return Z[re]<ee[re]?-1:1}return Z.length-ee.length}function n(q){if(q.charAt(q.length-1)=="/")return q.slice(0,-1).indexOf("/")===-1?q:n(q.slice(0,-1));var te=q.lastIndexOf("/");return te===-1?q:q.slice(0,te+1)}function s(q){if(q.charAt(q.length-1)=="/")return s(q.slice(0,-1));var te=q.lastIndexOf("/");return te===-1?q:q.slice(te+1)}function a(q,te){typeof te=="string"&&(te=new Date(te));var Z=te.getHours();Z=Z<<6|te.getMinutes(),Z=Z<<5|te.getSeconds()>>>1,q.write_shift(2,Z);var ee=te.getFullYear()-1980;ee=ee<<4|te.getMonth()+1,ee=ee<<5|te.getDate(),q.write_shift(2,ee)}function o(q){var te=q.read_shift(2)&65535,Z=q.read_shift(2)&65535,ee=new Date,re=Z&31;Z>>>=5;var se=Z&15;Z>>>=4,ee.setMilliseconds(0),ee.setFullYear(Z+1980),ee.setMonth(se-1),ee.setDate(re);var ye=te&31;te>>>=5;var Ee=te&63;return te>>>=6,ee.setHours(te),ee.setMinutes(Ee),ee.setSeconds(ye<<1),ee}function l(q){es(q,0);for(var te={},Z=0;q.l<=q.length-4;){var ee=q.read_shift(2),re=q.read_shift(2),se=q.l+re,ye={};switch(ee){case 21589:Z=q.read_shift(1),Z&1&&(ye.mtime=q.read_shift(4)),re>5&&(Z&2&&(ye.atime=q.read_shift(4)),Z&4&&(ye.ctime=q.read_shift(4))),ye.mtime&&(ye.mt=new Date(ye.mtime*1e3));break}q.l=se,te[ee]=ye}return te}var c;function u(){return c||(c={})}function d(q,te){if(q[0]==80&&q[1]==75)return Xt(q,te);if((q[0]|32)==109&&(q[1]|32)==105)return on(q,te);if(q.length<512)throw new Error("CFB file size "+q.length+" < 512");var Z=3,ee=512,re=0,se=0,ye=0,Ee=0,ve=0,we=[],_e=q.slice(0,512);es(_e,0);var Me=f(_e);switch(Z=Me[0],Z){case 3:ee=512;break;case 4:ee=4096;break;case 0:if(Me[1]==0)return Xt(q,te);default:throw new Error("Major Version: Expected 3 or 4 saw "+Z)}ee!==512&&(_e=q.slice(0,ee),es(_e,28));var Ue=q.slice(0,ee);p(_e,Z);var Ge=_e.read_shift(4,"i");if(Z===3&&Ge!==0)throw new Error("# Directory Sectors: Expected 0 saw "+Ge);_e.l+=4,ye=_e.read_shift(4,"i"),_e.l+=4,_e.chk("00100000","Mini Stream Cutoff Size: "),Ee=_e.read_shift(4,"i"),re=_e.read_shift(4,"i"),ve=_e.read_shift(4,"i"),se=_e.read_shift(4,"i");for(var Ie=-1,He=0;He<109&&(Ie=_e.read_shift(4,"i"),!(Ie<0));++He)we[He]=Ie;var ot=h(q,ee);x(ve,se,ot,ee,we);var rr=v(ot,ye,we,ee);rr[ye].name="!Directory",re>0&&Ee!==M&&(rr[Ee].name="!MiniFAT"),rr[we[0]].name="!FAT",rr.fat_addrs=we,rr.ssz=ee;var nr={},ln=[],vu=[],yu=[];_(ye,rr,ot,ln,re,nr,vu,Ee),g(vu,yu,ln),ln.shift();var wu={FileIndex:vu,FullPaths:yu};return te&&te.raw&&(wu.raw={header:Ue,sectors:ot}),wu}function f(q){if(q[q.l]==80&&q[q.l+1]==75)return[0,0];q.chk(A,"Header Signature: "),q.l+=16;var te=q.read_shift(2,"u");return[q.read_shift(2,"u"),te]}function p(q,te){var Z=9;switch(q.l+=2,Z=q.read_shift(2)){case 9:if(te!=3)throw new Error("Sector Shift: Expected 9 saw "+Z);break;case 12:if(te!=4)throw new Error("Sector Shift: Expected 12 saw "+Z);break;default:throw new Error("Sector Shift: Expected 9 or 12 saw "+Z)}q.chk("0600","Mini Sector Shift: "),q.chk("000000000000","Reserved: ")}function h(q,te){for(var Z=Math.ceil(q.length/te)-1,ee=[],re=1;re<Z;++re)ee[re-1]=q.slice(re*te,(re+1)*te);return ee[Z-1]=q.slice(Z*te),ee}function g(q,te,Z){for(var ee=0,re=0,se=0,ye=0,Ee=0,ve=Z.length,we=[],_e=[];ee<ve;++ee)we[ee]=_e[ee]=ee,te[ee]=Z[ee];for(;Ee<_e.length;++Ee)ee=_e[Ee],re=q[ee].L,se=q[ee].R,ye=q[ee].C,we[ee]===ee&&(re!==-1&&we[re]!==re&&(we[ee]=we[re]),se!==-1&&we[se]!==se&&(we[ee]=we[se])),ye!==-1&&(we[ye]=ee),re!==-1&&ee!=we[ee]&&(we[re]=we[ee],_e.lastIndexOf(re)<Ee&&_e.push(re)),se!==-1&&ee!=we[ee]&&(we[se]=we[ee],_e.lastIndexOf(se)<Ee&&_e.push(se));for(ee=1;ee<ve;++ee)we[ee]===ee&&(se!==-1&&we[se]!==se?we[ee]=we[se]:re!==-1&&we[re]!==re&&(we[ee]=we[re]));for(ee=1;ee<ve;++ee)if(q[ee].type!==0){if(Ee=ee,Ee!=we[Ee])do Ee=we[Ee],te[ee]=te[Ee]+"/"+te[ee];while(Ee!==0&&we[Ee]!==-1&&Ee!=we[Ee]);we[ee]=-1}for(te[0]+="/",ee=1;ee<ve;++ee)q[ee].type!==2&&(te[ee]+="/")}function m(q,te,Z){for(var ee=q.start,re=q.size,se=[],ye=ee;Z&&re>0&&ye>=0;)se.push(te.slice(ye*j,ye*j+j)),re-=j,ye=Fo(Z,ye*4);return se.length===0?Se(0):Jr(se).slice(0,q.size)}function x(q,te,Z,ee,re){var se=M;if(q===M){if(te!==0)throw new Error("DIFAT chain shorter than expected")}else if(q!==-1){var ye=Z[q],Ee=(ee>>>2)-1;if(!ye)return;for(var ve=0;ve<Ee&&(se=Fo(ye,ve*4))!==M;++ve)re.push(se);x(Fo(ye,ee-4),te-1,Z,ee,re)}}function w(q,te,Z,ee,re){var se=[],ye=[];re||(re=[]);var Ee=ee-1,ve=0,we=0;for(ve=te;ve>=0;){re[ve]=!0,se[se.length]=ve,ye.push(q[ve]);var _e=Z[Math.floor(ve*4/ee)];if(we=ve*4&Ee,ee<4+we)throw new Error("FAT boundary crossed: "+ve+" 4 "+ee);if(!q[_e])break;ve=Fo(q[_e],we)}return{nodes:se,data:lS([ye])}}function v(q,te,Z,ee){var re=q.length,se=[],ye=[],Ee=[],ve=[],we=ee-1,_e=0,Me=0,Ue=0,Ge=0;for(_e=0;_e<re;++_e)if(Ee=[],Ue=_e+te,Ue>=re&&(Ue-=re),!ye[Ue]){ve=[];var Ie=[];for(Me=Ue;Me>=0;){Ie[Me]=!0,ye[Me]=!0,Ee[Ee.length]=Me,ve.push(q[Me]);var He=Z[Math.floor(Me*4/ee)];if(Ge=Me*4&we,ee<4+Ge)throw new Error("FAT boundary crossed: "+Me+" 4 "+ee);if(!q[He]||(Me=Fo(q[He],Ge),Ie[Me]))break}se[Ue]={nodes:Ee,data:lS([ve])}}return se}function _(q,te,Z,ee,re,se,ye,Ee){for(var ve=0,we=ee.length?2:0,_e=te[q].data,Me=0,Ue=0,Ge;Me<_e.length;Me+=128){var Ie=_e.slice(Me,Me+128);es(Ie,64),Ue=Ie.read_shift(2),Ge=fw(Ie,0,Ue-we),ee.push(Ge);var He={name:Ge,type:Ie.read_shift(1),color:Ie.read_shift(1),L:Ie.read_shift(4,"i"),R:Ie.read_shift(4,"i"),C:Ie.read_shift(4,"i"),clsid:Ie.read_shift(16),state:Ie.read_shift(4,"i"),start:0,size:0},ot=Ie.read_shift(2)+Ie.read_shift(2)+Ie.read_shift(2)+Ie.read_shift(2);ot!==0&&(He.ct=b(Ie,Ie.l-8));var rr=Ie.read_shift(2)+Ie.read_shift(2)+Ie.read_shift(2)+Ie.read_shift(2);rr!==0&&(He.mt=b(Ie,Ie.l-8)),He.start=Ie.read_shift(4,"i"),He.size=Ie.read_shift(4,"i"),He.size<0&&He.start<0&&(He.size=He.type=0,He.start=M,He.name=""),He.type===5?(ve=He.start,re>0&&ve!==M&&(te[ve].name="!StreamData")):He.size>=4096?(He.storage="fat",te[He.start]===void 0&&(te[He.start]=w(Z,He.start,te.fat_addrs,te.ssz)),te[He.start].name=He.name,He.content=te[He.start].data.slice(0,He.size)):(He.storage="minifat",He.size<0?He.size=0:ve!==M&&He.start!==M&&te[ve]&&(He.content=m(He,te[ve].data,(te[Ee]||{}).data))),He.content&&es(He.content,0),se[Ge]=He,ye.push(He)}}function b(q,te){return new Date((ns(q,te+4)/1e7*Math.pow(2,32)+ns(q,te)/1e7-11644473600)*1e3)}function S(q,te){return u(),d(c.readFileSync(q),te)}function T(q,te){var Z=te&&te.type;switch(Z||At&&Buffer.isBuffer(q)&&(Z="buffer"),Z||"base64"){case"file":return S(q,te);case"base64":return d(qs(pi(q)),te);case"binary":return d(qs(q),te)}return d(q,te)}function N(q,te){var Z=te||{},ee=Z.root||"Root Entry";if(q.FullPaths||(q.FullPaths=[]),q.FileIndex||(q.FileIndex=[]),q.FullPaths.length!==q.FileIndex.length)throw new Error("inconsistent CFB structure");q.FullPaths.length===0&&(q.FullPaths[0]=ee+"/",q.FileIndex[0]={name:ee,type:5}),Z.CLSID&&(q.FileIndex[0].clsid=Z.CLSID),C(q)}function C(q){var te="Sh33tJ5";if(!Ut.find(q,"/"+te)){var Z=Se(4);Z[0]=55,Z[1]=Z[3]=50,Z[2]=54,q.FileIndex.push({name:te,type:2,content:Z,size:4,L:69,R:69,C:69}),q.FullPaths.push(q.FullPaths[0]+te),E(q)}}function E(q,te){N(q);for(var Z=!1,ee=!1,re=q.FullPaths.length-1;re>=0;--re){var se=q.FileIndex[re];switch(se.type){case 0:ee?Z=!0:(q.FileIndex.pop(),q.FullPaths.pop());break;case 1:case 2:case 5:ee=!0,isNaN(se.R*se.L*se.C)&&(Z=!0),se.R>-1&&se.L>-1&&se.R==se.L&&(Z=!0);break;default:Z=!0;break}}if(!(!Z&&!te)){var ye=new Date(1987,1,19),Ee=0,ve=Object.create?Object.create(null):{},we=[];for(re=0;re<q.FullPaths.length;++re)ve[q.FullPaths[re]]=!0,q.FileIndex[re].type!==0&&we.push([q.FullPaths[re],q.FileIndex[re]]);for(re=0;re<we.length;++re){var _e=n(we[re][0]);ee=ve[_e],ee||(we.push([_e,{name:s(_e).replace("/",""),type:1,clsid:X,ct:ye,mt:ye,content:null}]),ve[_e]=!0)}for(we.sort(function(Ge,Ie){return r(Ge[0],Ie[0])}),q.FullPaths=[],q.FileIndex=[],re=0;re<we.length;++re)q.FullPaths[re]=we[re][0],q.FileIndex[re]=we[re][1];for(re=0;re<we.length;++re){var Me=q.FileIndex[re],Ue=q.FullPaths[re];if(Me.name=s(Ue).replace("/",""),Me.L=Me.R=Me.C=-(Me.color=1),Me.size=Me.content?Me.content.length:0,Me.start=0,Me.clsid=Me.clsid||X,re===0)Me.C=we.length>1?1:-1,Me.size=0,Me.type=5;else if(Ue.slice(-1)=="/"){for(Ee=re+1;Ee<we.length&&n(q.FullPaths[Ee])!=Ue;++Ee);for(Me.C=Ee>=we.length?-1:Ee,Ee=re+1;Ee<we.length&&n(q.FullPaths[Ee])!=n(Ue);++Ee);Me.R=Ee>=we.length?-1:Ee,Me.type=1}else n(q.FullPaths[re+1]||"")==n(Ue)&&(Me.R=re+1),Me.type=2}}}function P(q,te){var Z=te||{};if(Z.fileType=="mad")return ms(q,Z);switch(E(q),Z.fileType){case"zip":return Pt(q,Z)}var ee=function(Ge){for(var Ie=0,He=0,ot=0;ot<Ge.FileIndex.length;++ot){var rr=Ge.FileIndex[ot];if(rr.content){var nr=rr.content.length;nr>0&&(nr<4096?Ie+=nr+63>>6:He+=nr+511>>9)}}for(var ln=Ge.FullPaths.length+3>>2,vu=Ie+7>>3,yu=Ie+127>>7,wu=vu+He+ln+yu,Co=wu+127>>7,eg=Co<=109?0:Math.ceil((Co-109)/127);wu+Co+eg+127>>7>Co;)eg=++Co<=109?0:Math.ceil((Co-109)/127);var Ia=[1,eg,Co,yu,ln,He,Ie,0];return Ge.FileIndex[0].size=Ie<<6,Ia[7]=(Ge.FileIndex[0].start=Ia[0]+Ia[1]+Ia[2]+Ia[3]+Ia[4]+Ia[5])+(Ia[6]+7>>3),Ia}(q),re=Se(ee[7]<<9),se=0,ye=0;{for(se=0;se<8;++se)re.write_shift(1,I[se]);for(se=0;se<8;++se)re.write_shift(2,0);for(re.write_shift(2,62),re.write_shift(2,3),re.write_shift(2,65534),re.write_shift(2,9),re.write_shift(2,6),se=0;se<3;++se)re.write_shift(2,0);for(re.write_shift(4,0),re.write_shift(4,ee[2]),re.write_shift(4,ee[0]+ee[1]+ee[2]+ee[3]-1),re.write_shift(4,0),re.write_shift(4,4096),re.write_shift(4,ee[3]?ee[0]+ee[1]+ee[2]-1:M),re.write_shift(4,ee[3]),re.write_shift(-4,ee[1]?ee[0]-1:M),re.write_shift(4,ee[1]),se=0;se<109;++se)re.write_shift(-4,se<ee[2]?ee[1]+se:-1)}if(ee[1])for(ye=0;ye<ee[1];++ye){for(;se<236+ye*127;++se)re.write_shift(-4,se<ee[2]?ee[1]+se:-1);re.write_shift(-4,ye===ee[1]-1?M:ye+1)}var Ee=function(Ge){for(ye+=Ge;se<ye-1;++se)re.write_shift(-4,se+1);Ge&&(++se,re.write_shift(-4,M))};for(ye=se=0,ye+=ee[1];se<ye;++se)re.write_shift(-4,Y.DIFSECT);for(ye+=ee[2];se<ye;++se)re.write_shift(-4,Y.FATSECT);Ee(ee[3]),Ee(ee[4]);for(var ve=0,we=0,_e=q.FileIndex[0];ve<q.FileIndex.length;++ve)_e=q.FileIndex[ve],_e.content&&(we=_e.content.length,!(we<4096)&&(_e.start=ye,Ee(we+511>>9)));for(Ee(ee[6]+7>>3);re.l&511;)re.write_shift(-4,Y.ENDOFCHAIN);for(ye=se=0,ve=0;ve<q.FileIndex.length;++ve)_e=q.FileIndex[ve],_e.content&&(we=_e.content.length,!(!we||we>=4096)&&(_e.start=ye,Ee(we+63>>6)));for(;re.l&511;)re.write_shift(-4,Y.ENDOFCHAIN);for(se=0;se<ee[4]<<2;++se){var Me=q.FullPaths[se];if(!Me||Me.length===0){for(ve=0;ve<17;++ve)re.write_shift(4,0);for(ve=0;ve<3;++ve)re.write_shift(4,-1);for(ve=0;ve<12;++ve)re.write_shift(4,0);continue}_e=q.FileIndex[se],se===0&&(_e.start=_e.size?_e.start-1:M);var Ue=se===0&&Z.root||_e.name;if(we=2*(Ue.length+1),re.write_shift(64,Ue,"utf16le"),re.write_shift(2,we),re.write_shift(1,_e.type),re.write_shift(1,_e.color),re.write_shift(-4,_e.L),re.write_shift(-4,_e.R),re.write_shift(-4,_e.C),_e.clsid)re.write_shift(16,_e.clsid,"hex");else for(ve=0;ve<4;++ve)re.write_shift(4,0);re.write_shift(4,_e.state||0),re.write_shift(4,0),re.write_shift(4,0),re.write_shift(4,0),re.write_shift(4,0),re.write_shift(4,_e.start),re.write_shift(4,_e.size),re.write_shift(4,0)}for(se=1;se<q.FileIndex.length;++se)if(_e=q.FileIndex[se],_e.size>=4096)if(re.l=_e.start+1<<9,At&&Buffer.isBuffer(_e.content))_e.content.copy(re,re.l,0,_e.size),re.l+=_e.size+511&-512;else{for(ve=0;ve<_e.size;++ve)re.write_shift(1,_e.content[ve]);for(;ve&511;++ve)re.write_shift(1,0)}for(se=1;se<q.FileIndex.length;++se)if(_e=q.FileIndex[se],_e.size>0&&_e.size<4096)if(At&&Buffer.isBuffer(_e.content))_e.content.copy(re,re.l,0,_e.size),re.l+=_e.size+63&-64;else{for(ve=0;ve<_e.size;++ve)re.write_shift(1,_e.content[ve]);for(;ve&63;++ve)re.write_shift(1,0)}if(At)re.l=re.length;else for(;re.l<re.length;)re.write_shift(1,0);return re}function R(q,te){var Z=q.FullPaths.map(function(ve){return ve.toUpperCase()}),ee=Z.map(function(ve){var we=ve.split("/");return we[we.length-(ve.slice(-1)=="/"?2:1)]}),re=!1;te.charCodeAt(0)===47?(re=!0,te=Z[0].slice(0,-1)+te):re=te.indexOf("/")!==-1;var se=te.toUpperCase(),ye=re===!0?Z.indexOf(se):ee.indexOf(se);if(ye!==-1)return q.FileIndex[ye];var Ee=!se.match(Mh);for(se=se.replace(fd,""),Ee&&(se=se.replace(Mh,"!")),ye=0;ye<Z.length;++ye)if((Ee?Z[ye].replace(Mh,"!"):Z[ye]).replace(fd,"")==se||(Ee?ee[ye].replace(Mh,"!"):ee[ye]).replace(fd,"")==se)return q.FileIndex[ye];return null}var j=64,M=-2,A="d0cf11e0a1b11ae1",I=[208,207,17,224,161,177,26,225],X="00000000000000000000000000000000",Y={MAXREGSECT:-6,DIFSECT:-4,FATSECT:-3,ENDOFCHAIN:M,FREESECT:-1,HEADER_SIGNATURE:A,HEADER_MINOR_VERSION:"3e00",MAXREGSID:-6,NOSTREAM:-1,HEADER_CLSID:X,EntryTypes:["unknown","storage","stream","lockbytes","property","root"]};function z(q,te,Z){u();var ee=P(q,Z);c.writeFileSync(te,ee)}function U(q){for(var te=new Array(q.length),Z=0;Z<q.length;++Z)te[Z]=String.fromCharCode(q[Z]);return te.join("")}function V(q,te){var Z=P(q,te);switch(te&&te.type||"buffer"){case"file":return u(),c.writeFileSync(te.filename,Z),Z;case"binary":return typeof Z=="string"?Z:U(Z);case"base64":return Xd(typeof Z=="string"?Z:U(Z));case"buffer":if(At)return Buffer.isBuffer(Z)?Z:yi(Z);case"array":return typeof Z=="string"?qs(Z):Z}return Z}var F;function D(q){try{var te=q.InflateRaw,Z=new te;if(Z._processChunk(new Uint8Array([3,0]),Z._finishFlushFlag),Z.bytesRead)F=q;else throw new Error("zlib does not expose bytesRead")}catch(ee){console.error("cannot use native zlib: "+(ee.message||ee))}}function G(q,te){if(!F)return Dt(q,te);var Z=F.InflateRaw,ee=new Z,re=ee._processChunk(q.slice(q.l),ee._finishFlushFlag);return q.l+=ee.bytesRead,re}function O(q){return F?F.deflateRawSync(q):it(q)}var L=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],ie=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258],ne=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577];function me(q){var te=(q<<1|q<<11)&139536|(q<<5|q<<15)&558144;return(te>>16|te>>8|te)&255}for(var pe=typeof Uint8Array<"u",xe=pe?new Uint8Array(256):[],Ae=0;Ae<256;++Ae)xe[Ae]=me(Ae);function ge(q,te){var Z=xe[q&255];return te<=8?Z>>>8-te:(Z=Z<<8|xe[q>>8&255],te<=16?Z>>>16-te:(Z=Z<<8|xe[q>>16&255],Z>>>24-te))}function je(q,te){var Z=te&7,ee=te>>>3;return(q[ee]|(Z<=6?0:q[ee+1]<<8))>>>Z&3}function k(q,te){var Z=te&7,ee=te>>>3;return(q[ee]|(Z<=5?0:q[ee+1]<<8))>>>Z&7}function le(q,te){var Z=te&7,ee=te>>>3;return(q[ee]|(Z<=4?0:q[ee+1]<<8))>>>Z&15}function ce(q,te){var Z=te&7,ee=te>>>3;return(q[ee]|(Z<=3?0:q[ee+1]<<8))>>>Z&31}function H(q,te){var Z=te&7,ee=te>>>3;return(q[ee]|(Z<=1?0:q[ee+1]<<8))>>>Z&127}function K(q,te,Z){var ee=te&7,re=te>>>3,se=(1<<Z)-1,ye=q[re]>>>ee;return Z<8-ee||(ye|=q[re+1]<<8-ee,Z<16-ee)||(ye|=q[re+2]<<16-ee,Z<24-ee)||(ye|=q[re+3]<<24-ee),ye&se}function oe(q,te,Z){var ee=te&7,re=te>>>3;return ee<=5?q[re]|=(Z&7)<<ee:(q[re]|=Z<<ee&255,q[re+1]=(Z&7)>>8-ee),te+3}function W(q,te,Z){var ee=te&7,re=te>>>3;return Z=(Z&1)<<ee,q[re]|=Z,te+1}function J(q,te,Z){var ee=te&7,re=te>>>3;return Z<<=ee,q[re]|=Z&255,Z>>>=8,q[re+1]=Z,te+8}function B(q,te,Z){var ee=te&7,re=te>>>3;return Z<<=ee,q[re]|=Z&255,Z>>>=8,q[re+1]=Z&255,q[re+2]=Z>>>8,te+16}function ae(q,te){var Z=q.length,ee=2*Z>te?2*Z:te+5,re=0;if(Z>=te)return q;if(At){var se=q2(ee);if(q.copy)q.copy(se);else for(;re<q.length;++re)se[re]=q[re];return se}else if(pe){var ye=new Uint8Array(ee);if(ye.set)ye.set(q);else for(;re<Z;++re)ye[re]=q[re];return ye}return q.length=ee,q}function de(q){for(var te=new Array(q),Z=0;Z<q;++Z)te[Z]=0;return te}function Q(q,te,Z){var ee=1,re=0,se=0,ye=0,Ee=0,ve=q.length,we=pe?new Uint16Array(32):de(32);for(se=0;se<32;++se)we[se]=0;for(se=ve;se<Z;++se)q[se]=0;ve=q.length;var _e=pe?new Uint16Array(ve):de(ve);for(se=0;se<ve;++se)we[re=q[se]]++,ee<re&&(ee=re),_e[se]=0;for(we[0]=0,se=1;se<=ee;++se)we[se+16]=Ee=Ee+we[se-1]<<1;for(se=0;se<ve;++se)Ee=q[se],Ee!=0&&(_e[se]=we[Ee+16]++);var Me=0;for(se=0;se<ve;++se)if(Me=q[se],Me!=0)for(Ee=ge(_e[se],ee)>>ee-Me,ye=(1<<ee+4-Me)-1;ye>=0;--ye)te[Ee|ye<<Me]=Me&15|se<<4;return ee}var fe=pe?new Uint16Array(512):de(512),Ce=pe?new Uint16Array(32):de(32);if(!pe){for(var Ne=0;Ne<512;++Ne)fe[Ne]=0;for(Ne=0;Ne<32;++Ne)Ce[Ne]=0}(function(){for(var q=[],te=0;te<32;te++)q.push(5);Q(q,Ce,32);var Z=[];for(te=0;te<=143;te++)Z.push(8);for(;te<=255;te++)Z.push(9);for(;te<=279;te++)Z.push(7);for(;te<=287;te++)Z.push(8);Q(Z,fe,288)})();var Xe=function(){for(var te=pe?new Uint8Array(32768):[],Z=0,ee=0;Z<ne.length-1;++Z)for(;ee<ne[Z+1];++ee)te[ee]=Z;for(;ee<32768;++ee)te[ee]=29;var re=pe?new Uint8Array(259):[];for(Z=0,ee=0;Z<ie.length-1;++Z)for(;ee<ie[Z+1];++ee)re[ee]=Z;function se(Ee,ve){for(var we=0;we<Ee.length;){var _e=Math.min(65535,Ee.length-we),Me=we+_e==Ee.length;for(ve.write_shift(1,+Me),ve.write_shift(2,_e),ve.write_shift(2,~_e&65535);_e-- >0;)ve[ve.l++]=Ee[we++]}return ve.l}function ye(Ee,ve){for(var we=0,_e=0,Me=pe?new Uint16Array(32768):[];_e<Ee.length;){var Ue=Math.min(65535,Ee.length-_e);if(Ue<10){for(we=oe(ve,we,+(_e+Ue==Ee.length)),we&7&&(we+=8-(we&7)),ve.l=we/8|0,ve.write_shift(2,Ue),ve.write_shift(2,~Ue&65535);Ue-- >0;)ve[ve.l++]=Ee[_e++];we=ve.l*8;continue}we=oe(ve,we,+(_e+Ue==Ee.length)+2);for(var Ge=0;Ue-- >0;){var Ie=Ee[_e];Ge=(Ge<<5^Ie)&32767;var He=-1,ot=0;if((He=Me[Ge])&&(He|=_e&-32768,He>_e&&(He-=32768),He<_e))for(;Ee[He+ot]==Ee[_e+ot]&&ot<250;)++ot;if(ot>2){Ie=re[ot],Ie<=22?we=J(ve,we,xe[Ie+1]>>1)-1:(J(ve,we,3),we+=5,J(ve,we,xe[Ie-23]>>5),we+=3);var rr=Ie<8?0:Ie-4>>2;rr>0&&(B(ve,we,ot-ie[Ie]),we+=rr),Ie=te[_e-He],we=J(ve,we,xe[Ie]>>3),we-=3;var nr=Ie<4?0:Ie-2>>1;nr>0&&(B(ve,we,_e-He-ne[Ie]),we+=nr);for(var ln=0;ln<ot;++ln)Me[Ge]=_e&32767,Ge=(Ge<<5^Ee[_e])&32767,++_e;Ue-=ot-1}else Ie<=143?Ie=Ie+48:we=W(ve,we,1),we=J(ve,we,xe[Ie]),Me[Ge]=_e&32767,++_e}we=J(ve,we,0)-1}return ve.l=(we+7)/8|0,ve.l}return function(ve,we){return ve.length<8?se(ve,we):ye(ve,we)}}();function it(q){var te=Se(50+Math.floor(q.length*1.1)),Z=Xe(q,te);return te.slice(0,Z)}var at=pe?new Uint16Array(32768):de(32768),ht=pe?new Uint16Array(32768):de(32768),Ke=pe?new Uint16Array(128):de(128),Bt=1,Te=1;function Re(q,te){var Z=ce(q,te)+257;te+=5;var ee=ce(q,te)+1;te+=5;var re=le(q,te)+4;te+=4;for(var se=0,ye=pe?new Uint8Array(19):de(19),Ee=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],ve=1,we=pe?new Uint8Array(8):de(8),_e=pe?new Uint8Array(8):de(8),Me=ye.length,Ue=0;Ue<re;++Ue)ye[L[Ue]]=se=k(q,te),ve<se&&(ve=se),we[se]++,te+=3;var Ge=0;for(we[0]=0,Ue=1;Ue<=ve;++Ue)_e[Ue]=Ge=Ge+we[Ue-1]<<1;for(Ue=0;Ue<Me;++Ue)(Ge=ye[Ue])!=0&&(Ee[Ue]=_e[Ge]++);var Ie=0;for(Ue=0;Ue<Me;++Ue)if(Ie=ye[Ue],Ie!=0){Ge=xe[Ee[Ue]]>>8-Ie;for(var He=(1<<7-Ie)-1;He>=0;--He)Ke[Ge|He<<Ie]=Ie&7|Ue<<3}var ot=[];for(ve=1;ot.length<Z+ee;)switch(Ge=Ke[H(q,te)],te+=Ge&7,Ge>>>=3){case 16:for(se=3+je(q,te),te+=2,Ge=ot[ot.length-1];se-- >0;)ot.push(Ge);break;case 17:for(se=3+k(q,te),te+=3;se-- >0;)ot.push(0);break;case 18:for(se=11+H(q,te),te+=7;se-- >0;)ot.push(0);break;default:ot.push(Ge),ve<Ge&&(ve=Ge);break}var rr=ot.slice(0,Z),nr=ot.slice(Z);for(Ue=Z;Ue<286;++Ue)rr[Ue]=0;for(Ue=ee;Ue<30;++Ue)nr[Ue]=0;return Bt=Q(rr,at,286),Te=Q(nr,ht,30),te}function tt(q,te){if(q[0]==3&&!(q[1]&3))return[cl(te),2];for(var Z=0,ee=0,re=q2(te||1<<18),se=0,ye=re.length>>>0,Ee=0,ve=0;!(ee&1);){if(ee=k(q,Z),Z+=3,ee>>>1)ee>>1==1?(Ee=9,ve=5):(Z=Re(q,Z),Ee=Bt,ve=Te);else{Z&7&&(Z+=8-(Z&7));var we=q[Z>>>3]|q[(Z>>>3)+1]<<8;if(Z+=32,we>0)for(!te&&ye<se+we&&(re=ae(re,se+we),ye=re.length);we-- >0;)re[se++]=q[Z>>>3],Z+=8;continue}for(;;){!te&&ye<se+32767&&(re=ae(re,se+32767),ye=re.length);var _e=K(q,Z,Ee),Me=ee>>>1==1?fe[_e]:at[_e];if(Z+=Me&15,Me>>>=4,!(Me>>>8&255))re[se++]=Me;else{if(Me==256)break;Me-=257;var Ue=Me<8?0:Me-4>>2;Ue>5&&(Ue=0);var Ge=se+ie[Me];Ue>0&&(Ge+=K(q,Z,Ue),Z+=Ue),_e=K(q,Z,ve),Me=ee>>>1==1?Ce[_e]:ht[_e],Z+=Me&15,Me>>>=4;var Ie=Me<4?0:Me-2>>1,He=ne[Me];for(Ie>0&&(He+=K(q,Z,Ie),Z+=Ie),!te&&ye<Ge&&(re=ae(re,Ge+100),ye=re.length);se<Ge;)re[se]=re[se-He],++se}}}return te?[re,Z+7>>>3]:[re.slice(0,se),Z+7>>>3]}function Dt(q,te){var Z=q.slice(q.l||0),ee=tt(Z,te);return q.l+=ee[1],ee[0]}function or(q,te){if(q)typeof console<"u"&&console.error(te);else throw new Error(te)}function Xt(q,te){var Z=q;es(Z,0);var ee=[],re=[],se={FileIndex:ee,FullPaths:re};N(se,{root:te.root});for(var ye=Z.length-4;(Z[ye]!=80||Z[ye+1]!=75||Z[ye+2]!=5||Z[ye+3]!=6)&&ye>=0;)--ye;Z.l=ye+4,Z.l+=4;var Ee=Z.read_shift(2);Z.l+=6;var ve=Z.read_shift(4);for(Z.l=ve,ye=0;ye<Ee;++ye){Z.l+=20;var we=Z.read_shift(4),_e=Z.read_shift(4),Me=Z.read_shift(2),Ue=Z.read_shift(2),Ge=Z.read_shift(2);Z.l+=8;var Ie=Z.read_shift(4),He=l(Z.slice(Z.l+Me,Z.l+Me+Ue));Z.l+=Me+Ue+Ge;var ot=Z.l;Z.l=Ie+4,Qt(Z,we,_e,se,He),Z.l=ot}return se}function Qt(q,te,Z,ee,re){q.l+=2;var se=q.read_shift(2),ye=q.read_shift(2),Ee=o(q);if(se&8257)throw new Error("Unsupported ZIP encryption");for(var ve=q.read_shift(4),we=q.read_shift(4),_e=q.read_shift(4),Me=q.read_shift(2),Ue=q.read_shift(2),Ge="",Ie=0;Ie<Me;++Ie)Ge+=String.fromCharCode(q[q.l++]);if(Ue){var He=l(q.slice(q.l,q.l+Ue));(He[21589]||{}).mt&&(Ee=He[21589].mt),((re||{})[21589]||{}).mt&&(Ee=re[21589].mt)}q.l+=Ue;var ot=q.slice(q.l,q.l+we);switch(ye){case 8:ot=G(q,_e);break;case 0:break;default:throw new Error("Unsupported ZIP Compression method "+ye)}var rr=!1;se&8&&(ve=q.read_shift(4),ve==134695760&&(ve=q.read_shift(4),rr=!0),we=q.read_shift(4),_e=q.read_shift(4)),we!=te&&or(rr,"Bad compressed size: "+te+" != "+we),_e!=Z&&or(rr,"Bad uncompressed size: "+Z+" != "+_e),wn(ee,Ge,ot,{unsafe:!0,mt:Ee})}function Pt(q,te){var Z=te||{},ee=[],re=[],se=Se(1),ye=Z.compression?8:0,Ee=0,ve=0,we=0,_e=0,Me=0,Ue=q.FullPaths[0],Ge=Ue,Ie=q.FileIndex[0],He=[],ot=0;for(ve=1;ve<q.FullPaths.length;++ve)if(Ge=q.FullPaths[ve].slice(Ue.length),Ie=q.FileIndex[ve],!(!Ie.size||!Ie.content||Ge=="Sh33tJ5")){var rr=_e,nr=Se(Ge.length);for(we=0;we<Ge.length;++we)nr.write_shift(1,Ge.charCodeAt(we)&127);nr=nr.slice(0,nr.l),He[Me]=UV.buf(Ie.content,0);var ln=Ie.content;ye==8&&(ln=O(ln)),se=Se(30),se.write_shift(4,67324752),se.write_shift(2,20),se.write_shift(2,Ee),se.write_shift(2,ye),Ie.mt?a(se,Ie.mt):se.write_shift(4,0),se.write_shift(-4,He[Me]),se.write_shift(4,ln.length),se.write_shift(4,Ie.content.length),se.write_shift(2,nr.length),se.write_shift(2,0),_e+=se.length,ee.push(se),_e+=nr.length,ee.push(nr),_e+=ln.length,ee.push(ln),se=Se(46),se.write_shift(4,33639248),se.write_shift(2,0),se.write_shift(2,20),se.write_shift(2,Ee),se.write_shift(2,ye),se.write_shift(4,0),se.write_shift(-4,He[Me]),se.write_shift(4,ln.length),se.write_shift(4,Ie.content.length),se.write_shift(2,nr.length),se.write_shift(2,0),se.write_shift(2,0),se.write_shift(2,0),se.write_shift(2,0),se.write_shift(4,0),se.write_shift(4,rr),ot+=se.l,re.push(se),ot+=nr.length,re.push(nr),++Me}return se=Se(22),se.write_shift(4,101010256),se.write_shift(2,0),se.write_shift(2,0),se.write_shift(2,Me),se.write_shift(2,Me),se.write_shift(4,ot),se.write_shift(4,_e),se.write_shift(2,0),Jr([Jr(ee),Jr(re),se])}var Jt={htm:"text/html",xml:"text/xml",gif:"image/gif",jpg:"image/jpeg",png:"image/png",mso:"application/x-mso",thmx:"application/vnd.ms-officetheme",sh33tj5:"application/octet-stream"};function yn(q,te){if(q.ctype)return q.ctype;var Z=q.name||"",ee=Z.match(/\.([^\.]+)$/);return ee&&Jt[ee[1]]||te&&(ee=(Z=te).match(/[\.\\]([^\.\\])+$/),ee&&Jt[ee[1]])?Jt[ee[1]]:"application/octet-stream"}function Ze(q){for(var te=Xd(q),Z=[],ee=0;ee<te.length;ee+=76)Z.push(te.slice(ee,ee+76));return Z.join(`\r
`)+`\r
`}function pt(q){var te=q.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF=]/g,function(we){var _e=we.charCodeAt(0).toString(16).toUpperCase();return"="+(_e.length==1?"0"+_e:_e)});te=te.replace(/ $/mg,"=20").replace(/\t$/mg,"=09"),te.charAt(0)==`
`&&(te="=0D"+te.slice(1)),te=te.replace(/\r(?!\n)/mg,"=0D").replace(/\n\n/mg,`
=0A`).replace(/([^\r\n])\n/mg,"$1=0A");for(var Z=[],ee=te.split(`\r
`),re=0;re<ee.length;++re){var se=ee[re];if(se.length==0){Z.push("");continue}for(var ye=0;ye<se.length;){var Ee=76,ve=se.slice(ye,ye+Ee);ve.charAt(Ee-1)=="="?Ee--:ve.charAt(Ee-2)=="="?Ee-=2:ve.charAt(Ee-3)=="="&&(Ee-=3),ve=se.slice(ye,ye+Ee),ye+=Ee,ye<se.length&&(ve+="="),Z.push(ve)}}return Z.join(`\r
`)}function xt(q){for(var te=[],Z=0;Z<q.length;++Z){for(var ee=q[Z];Z<=q.length&&ee.charAt(ee.length-1)=="=";)ee=ee.slice(0,ee.length-1)+q[++Z];te.push(ee)}for(var re=0;re<te.length;++re)te[re]=te[re].replace(/[=][0-9A-Fa-f]{2}/g,function(se){return String.fromCharCode(parseInt(se.slice(1),16))});return qs(te.join(`\r
`))}function _r(q,te,Z){for(var ee="",re="",se="",ye,Ee=0;Ee<10;++Ee){var ve=te[Ee];if(!ve||ve.match(/^\s*$/))break;var we=ve.match(/^(.*?):\s*([^\s].*)$/);if(we)switch(we[1].toLowerCase()){case"content-location":ee=we[2].trim();break;case"content-type":se=we[2].trim();break;case"content-transfer-encoding":re=we[2].trim();break}}switch(++Ee,re.toLowerCase()){case"base64":ye=qs(pi(te.slice(Ee).join("")));break;case"quoted-printable":ye=xt(te.slice(Ee));break;default:throw new Error("Unsupported Content-Transfer-Encoding "+re)}var _e=wn(q,ee.slice(Z.length),ye,{unsafe:!0});se&&(_e.ctype=se)}function on(q,te){if(U(q.slice(0,13)).toLowerCase()!="mime-version:")throw new Error("Unsupported MAD header");var Z=te&&te.root||"",ee=(At&&Buffer.isBuffer(q)?q.toString("binary"):U(q)).split(`\r
`),re=0,se="";for(re=0;re<ee.length;++re)if(se=ee[re],!!/^Content-Location:/i.test(se)&&(se=se.slice(se.indexOf("file")),Z||(Z=se.slice(0,se.lastIndexOf("/")+1)),se.slice(0,Z.length)!=Z))for(;Z.length>0&&(Z=Z.slice(0,Z.length-1),Z=Z.slice(0,Z.lastIndexOf("/")+1),se.slice(0,Z.length)!=Z););var ye=(ee[1]||"").match(/boundary="(.*?)"/);if(!ye)throw new Error("MAD cannot find boundary");var Ee="--"+(ye[1]||""),ve=[],we=[],_e={FileIndex:ve,FullPaths:we};N(_e);var Me,Ue=0;for(re=0;re<ee.length;++re){var Ge=ee[re];Ge!==Ee&&Ge!==Ee+"--"||(Ue++&&_r(_e,ee.slice(Me,re),Z),Me=re)}return _e}function ms(q,te){var Z=te||{},ee=Z.boundary||"SheetJS";ee="------="+ee;for(var re=["MIME-Version: 1.0",'Content-Type: multipart/related; boundary="'+ee.slice(2)+'"',"","",""],se=q.FullPaths[0],ye=se,Ee=q.FileIndex[0],ve=1;ve<q.FullPaths.length;++ve)if(ye=q.FullPaths[ve].slice(se.length),Ee=q.FileIndex[ve],!(!Ee.size||!Ee.content||ye=="Sh33tJ5")){ye=ye.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF]/g,function(ot){return"_x"+ot.charCodeAt(0).toString(16)+"_"}).replace(/[\u0080-\uFFFF]/g,function(ot){return"_u"+ot.charCodeAt(0).toString(16)+"_"});for(var we=Ee.content,_e=At&&Buffer.isBuffer(we)?we.toString("binary"):U(we),Me=0,Ue=Math.min(1024,_e.length),Ge=0,Ie=0;Ie<=Ue;++Ie)(Ge=_e.charCodeAt(Ie))>=32&&Ge<128&&++Me;var He=Me>=Ue*4/5;re.push(ee),re.push("Content-Location: "+(Z.root||"file:///C:/SheetJS/")+ye),re.push("Content-Transfer-Encoding: "+(He?"quoted-printable":"base64")),re.push("Content-Type: "+yn(Ee,ye)),re.push(""),re.push(He?pt(_e):Ze(_e))}return re.push(ee+`--\r
`),re.join(`\r
`)}function Xn(q){var te={};return N(te,q),te}function wn(q,te,Z,ee){var re=ee&&ee.unsafe;re||N(q);var se=!re&&Ut.find(q,te);if(!se){var ye=q.FullPaths[0];te.slice(0,ye.length)==ye?ye=te:(ye.slice(-1)!="/"&&(ye+="/"),ye=(ye+te).replace("//","/")),se={name:s(te),type:2},q.FileIndex.push(se),q.FullPaths.push(ye),re||Ut.utils.cfb_gc(q)}return se.content=Z,se.size=Z?Z.length:0,ee&&(ee.CLSID&&(se.clsid=ee.CLSID),ee.mt&&(se.mt=ee.mt),ee.ct&&(se.ct=ee.ct)),se}function ha(q,te){N(q);var Z=Ut.find(q,te);if(Z){for(var ee=0;ee<q.FileIndex.length;++ee)if(q.FileIndex[ee]==Z)return q.FileIndex.splice(ee,1),q.FullPaths.splice(ee,1),!0}return!1}function HR(q,te,Z){N(q);var ee=Ut.find(q,te);if(ee){for(var re=0;re<q.FileIndex.length;++re)if(q.FileIndex[re]==ee)return q.FileIndex[re].name=s(Z),q.FullPaths[re]=Z,!0}return!1}function GR(q){E(q,!0)}return t.find=R,t.read=T,t.parse=d,t.write=V,t.writeFile=z,t.utils={cfb_new:Xn,cfb_add:wn,cfb_del:ha,cfb_mov:HR,cfb_gc:GR,ReadShift:md,CheckField:iA,prep_blob:es,bconcat:Jr,use_zlib:D,_deflateRaw:it,_inflateRaw:Dt,consts:Y},t}();function zV(e){return typeof e=="string"?Tp(e):Array.isArray(e)?mV(e):e}function Bf(e,t,r){if(typeof Deno<"u"){if(r&&typeof t=="string")switch(r){case"utf8":t=new TextEncoder(r).encode(t);break;case"binary":t=Tp(t);break;default:throw new Error("Unsupported encoding "+r)}return Deno.writeFileSync(e,t)}var n=r=="utf8"?Jd(t):t;if(typeof IE_SaveFile<"u")return IE_SaveFile(n,e);if(typeof Blob<"u"){var s=new Blob([zV(n)],{type:"application/octet-stream"});if(typeof navigator<"u"&&navigator.msSaveBlob)return navigator.msSaveBlob(s,e);if(typeof saveAs<"u")return saveAs(s,e);if(typeof URL<"u"&&typeof document<"u"&&document.createElement&&URL.createObjectURL){var a=URL.createObjectURL(s);if(typeof chrome=="object"&&typeof(chrome.downloads||{}).download=="function")return URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(a)},6e4),chrome.downloads.download({url:a,filename:e,saveAs:!0});var o=document.createElement("a");if(o.download!=null)return o.download=e,o.href=a,document.body.appendChild(o),o.click(),document.body.removeChild(o),URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(a)},6e4),a}}if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var l=File(e);return l.open("w"),l.encoding="binary",Array.isArray(t)&&(t=$f(t)),l.write(t),l.close(),t}catch(c){if(!c.message||!c.message.match(/onstruct/))throw c}throw new Error("cannot save file "+e)}function an(e){for(var t=Object.keys(e),r=[],n=0;n<t.length;++n)Object.prototype.hasOwnProperty.call(e,t[n])&&r.push(t[n]);return r}function tS(e,t){for(var r=[],n=an(e),s=0;s!==n.length;++s)r[e[n[s]][t]]==null&&(r[e[n[s]][t]]=n[s]);return r}function lw(e){for(var t=[],r=an(e),n=0;n!==r.length;++n)t[e[r[n]]]=r[n];return t}function Dp(e){for(var t=[],r=an(e),n=0;n!==r.length;++n)t[e[r[n]]]=parseInt(r[n],10);return t}function VV(e){for(var t=[],r=an(e),n=0;n!==r.length;++n)t[e[r[n]]]==null&&(t[e[r[n]]]=[]),t[e[r[n]]].push(r[n]);return t}var a0=new Date(1899,11,30,0,0,0);function qn(e,t){var r=e.getTime(),n=a0.getTime()+(e.getTimezoneOffset()-a0.getTimezoneOffset())*6e4;return(r-n)/(24*60*60*1e3)}var V4=new Date,WV=a0.getTime()+(V4.getTimezoneOffset()-a0.getTimezoneOffset())*6e4,rS=V4.getTimezoneOffset();function W4(e){var t=new Date;return t.setTime(e*24*60*60*1e3+WV),t.getTimezoneOffset()!==rS&&t.setTime(t.getTime()+(t.getTimezoneOffset()-rS)*6e4),t}var nS=new Date("2017-02-19T19:06:09.000Z"),H4=isNaN(nS.getFullYear())?new Date("2/19/17"):nS,HV=H4.getFullYear()==2017;function kn(e,t){var r=new Date(e);if(HV)return t>0?r.setTime(r.getTime()+r.getTimezoneOffset()*60*1e3):t<0&&r.setTime(r.getTime()-r.getTimezoneOffset()*60*1e3),r;if(e instanceof Date)return e;if(H4.getFullYear()==1917&&!isNaN(r.getFullYear())){var n=r.getFullYear();return e.indexOf(""+n)>-1||r.setFullYear(r.getFullYear()+100),r}var s=e.match(/\d+/g)||["2017","2","19","0","0","0"],a=new Date(+s[0],+s[1]-1,+s[2],+s[3]||0,+s[4]||0,+s[5]||0);return e.indexOf("Z")>-1&&(a=new Date(a.getTime()-a.getTimezoneOffset()*60*1e3)),a}function Rp(e,t){if(At&&Buffer.isBuffer(e))return e.toString("binary");if(typeof TextDecoder<"u")try{var r={"":"","":"",:"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"","":"","":"","":"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"",:""};return Array.isArray(e)&&(e=new Uint8Array(e)),new TextDecoder("latin1").decode(e).replace(/[]/g,function(a){return r[a]||a})}catch{}for(var n=[],s=0;s!=e.length;++s)n.push(String.fromCharCode(e[s]));return n.join("")}function Yn(e){if(typeof JSON<"u"&&!Array.isArray(e))return JSON.parse(JSON.stringify(e));if(typeof e!="object"||e==null)return e;if(e instanceof Date)return new Date(e.getTime());var t={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=Yn(e[r]));return t}function ur(e,t){for(var r="";r.length<t;)r+=e;return r}function si(e){var t=Number(e);if(!isNaN(t))return isFinite(t)?t:NaN;if(!/\d/.test(e))return t;var r=1,n=e.replace(/([\d]),([\d])/g,"$1$2").replace(/[$]/g,"").replace(/[%]/g,function(){return r*=100,""});return!isNaN(t=Number(n))||(n=n.replace(/[(](.*)[)]/,function(s,a){return r=-r,a}),!isNaN(t=Number(n)))?t/r:t}var GV=["january","february","march","april","may","june","july","august","september","october","november","december"];function Qd(e){var t=new Date(e),r=new Date(NaN),n=t.getYear(),s=t.getMonth(),a=t.getDate();if(isNaN(a))return r;var o=e.toLowerCase();if(o.match(/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/)){if(o=o.replace(/[^a-z]/g,"").replace(/([^a-z]|^)[ap]m?([^a-z]|$)/,""),o.length>3&&GV.indexOf(o)==-1)return r}else if(o.match(/[a-z]/))return r;return n<0||n>8099?r:(s>0||a>1)&&n!=101?t:e.match(/[^-0-9:,\/\\]/)?r:t}function mt(e,t,r){if(e.FullPaths){if(typeof r=="string"){var n;return At?n=yi(r):n=pV(r),Ut.utils.cfb_add(e,t,n)}Ut.utils.cfb_add(e,t,r)}else e.file(t,r)}function cw(){return Ut.utils.cfb_new()}var Tr=`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r
`,qV={"&quot;":'"',"&apos;":"'","&gt;":">","&lt;":"<","&amp;":"&"},uw=lw(qV),dw=/[&<>'"]/g,YV=/[\u0000-\u0008\u000b-\u001f]/g;function Ft(e){var t=e+"";return t.replace(dw,function(r){return uw[r]}).replace(YV,function(r){return"_x"+("000"+r.charCodeAt(0).toString(16)).slice(-4)+"_"})}function sS(e){return Ft(e).replace(/ /g,"_x0020_")}var G4=/[\u0000-\u001f]/g;function KV(e){var t=e+"";return t.replace(dw,function(r){return uw[r]}).replace(/\n/g,"<br/>").replace(G4,function(r){return"&#x"+("000"+r.charCodeAt(0).toString(16)).slice(-4)+";"})}function XV(e){var t=e+"";return t.replace(dw,function(r){return uw[r]}).replace(G4,function(r){return"&#x"+r.charCodeAt(0).toString(16).toUpperCase()+";"})}function QV(e){return e.replace(/(\r\n|[\r\n])/g,"&#10;")}function JV(e){switch(e){case 1:case!0:case"1":case"true":case"TRUE":return!0;default:return!1}}function ix(e){for(var t="",r=0,n=0,s=0,a=0,o=0,l=0;r<e.length;){if(n=e.charCodeAt(r++),n<128){t+=String.fromCharCode(n);continue}if(s=e.charCodeAt(r++),n>191&&n<224){o=(n&31)<<6,o|=s&63,t+=String.fromCharCode(o);continue}if(a=e.charCodeAt(r++),n<240){t+=String.fromCharCode((n&15)<<12|(s&63)<<6|a&63);continue}o=e.charCodeAt(r++),l=((n&7)<<18|(s&63)<<12|(a&63)<<6|o&63)-65536,t+=String.fromCharCode(55296+(l>>>10&1023)),t+=String.fromCharCode(56320+(l&1023))}return t}function aS(e){var t=cl(2*e.length),r,n,s=1,a=0,o=0,l;for(n=0;n<e.length;n+=s)s=1,(l=e.charCodeAt(n))<128?r=l:l<224?(r=(l&31)*64+(e.charCodeAt(n+1)&63),s=2):l<240?(r=(l&15)*4096+(e.charCodeAt(n+1)&63)*64+(e.charCodeAt(n+2)&63),s=3):(s=4,r=(l&7)*262144+(e.charCodeAt(n+1)&63)*4096+(e.charCodeAt(n+2)&63)*64+(e.charCodeAt(n+3)&63),r-=65536,o=55296+(r>>>10&1023),r=56320+(r&1023)),o!==0&&(t[a++]=o&255,t[a++]=o>>>8,o=0),t[a++]=r%256,t[a++]=r>>>8;return t.slice(0,a).toString("ucs2")}function iS(e){return yi(e,"binary").toString("utf8")}var Fh="foo bar baz",hd=At&&(iS(Fh)==ix(Fh)&&iS||aS(Fh)==ix(Fh)&&aS)||ix,Jd=At?function(e){return yi(e,"utf8").toString("binary")}:function(e){for(var t=[],r=0,n=0,s=0;r<e.length;)switch(n=e.charCodeAt(r++),!0){case n<128:t.push(String.fromCharCode(n));break;case n<2048:t.push(String.fromCharCode(192+(n>>6))),t.push(String.fromCharCode(128+(n&63)));break;case(n>=55296&&n<57344):n-=55296,s=e.charCodeAt(r++)-56320+(n<<10),t.push(String.fromCharCode(240+(s>>18&7))),t.push(String.fromCharCode(144+(s>>12&63))),t.push(String.fromCharCode(128+(s>>6&63))),t.push(String.fromCharCode(128+(s&63)));break;default:t.push(String.fromCharCode(224+(n>>12))),t.push(String.fromCharCode(128+(n>>6&63))),t.push(String.fromCharCode(128+(n&63)))}return t.join("")},ZV=function(){var e=[["nbsp"," "],["middot",""],["quot",'"'],["apos","'"],["gt",">"],["lt","<"],["amp","&"]].map(function(t){return[new RegExp("&"+t[0]+";","ig"),t[1]]});return function(r){for(var n=r.replace(/^[\t\n\r ]+/,"").replace(/[\t\n\r ]+$/,"").replace(/>\s+/g,">").replace(/\s+</g,"<").replace(/[\t\n\r ]+/g," ").replace(/<\s*[bB][rR]\s*\/?>/g,`
`).replace(/<[^>]*>/g,""),s=0;s<e.length;++s)n=n.replace(e[s][0],e[s][1]);return n}}(),q4=/(^\s|\s$|\n)/;function Zr(e,t){return"<"+e+(t.match(q4)?' xml:space="preserve"':"")+">"+t+"</"+e+">"}function Zd(e){return an(e).map(function(t){return" "+t+'="'+e[t]+'"'}).join("")}function Le(e,t,r){return"<"+e+(r!=null?Zd(r):"")+(t!=null?(t.match(q4)?' xml:space="preserve"':"")+">"+t+"</"+e:"/")+">"}function Kv(e,t){try{return e.toISOString().replace(/\.\d*/,"")}catch(r){if(t)throw r}return""}function eW(e,t){switch(typeof e){case"string":var r=Le("vt:lpwstr",Ft(e));return r=r.replace(/&quot;/g,"_x0022_"),r;case"number":return Le((e|0)==e?"vt:i4":"vt:r8",Ft(String(e)));case"boolean":return Le("vt:bool",e?"true":"false")}if(e instanceof Date)return Le("vt:filetime",Kv(e));throw new Error("Unable to serialize "+e)}var Vr={CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/metadata/core-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/custom-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/extended-properties",CT:"http://schemas.openxmlformats.org/package/2006/content-types",RELS:"http://schemas.openxmlformats.org/package/2006/relationships",TCMNT:"http://schemas.microsoft.com/office/spreadsheetml/2018/threadedcomments",dc:"http://purl.org/dc/elements/1.1/",dcterms:"http://purl.org/dc/terms/",dcmitype:"http://purl.org/dc/dcmitype/",r:"http://schemas.openxmlformats.org/officeDocument/2006/relationships",vt:"http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes",xsi:"http://www.w3.org/2001/XMLSchema-instance",xsd:"http://www.w3.org/2001/XMLSchema"},fu=["http://schemas.openxmlformats.org/spreadsheetml/2006/main","http://purl.oclc.org/ooxml/spreadsheetml/main","http://schemas.microsoft.com/office/excel/2006/main","http://schemas.microsoft.com/office/excel/2006/2"],rs={o:"urn:schemas-microsoft-com:office:office",x:"urn:schemas-microsoft-com:office:excel",ss:"urn:schemas-microsoft-com:office:spreadsheet",dt:"uuid:C2F41010-65B3-11d1-A29F-00AA00C14882",mv:"http://macVmlSchemaUri",v:"urn:schemas-microsoft-com:vml",html:"http://www.w3.org/TR/REC-html40"};function tW(e,t){for(var r=1-2*(e[t+7]>>>7),n=((e[t+7]&127)<<4)+(e[t+6]>>>4&15),s=e[t+6]&15,a=5;a>=0;--a)s=s*256+e[t+a];return n==2047?s==0?r*(1/0):NaN:(n==0?n=-1022:(n-=1023,s+=Math.pow(2,52)),r*Math.pow(2,n-52)*s)}function rW(e,t,r){var n=(t<0||1/t==-1/0?1:0)<<7,s=0,a=0,o=n?-t:t;isFinite(o)?o==0?s=a=0:(s=Math.floor(Math.log(o)/Math.LN2),a=o*Math.pow(2,52-s),s<=-1023&&(!isFinite(a)||a<Math.pow(2,52))?s=-1022:(a-=Math.pow(2,52),s+=1023)):(s=2047,a=isNaN(t)?26985:0);for(var l=0;l<=5;++l,a/=256)e[r+l]=a&255;e[r+6]=(s&15)<<4|a&15,e[r+7]=s>>4|n}var oS=function(e){for(var t=[],r=10240,n=0;n<e[0].length;++n)if(e[0][n])for(var s=0,a=e[0][n].length;s<a;s+=r)t.push.apply(t,e[0][n].slice(s,s+r));return t},lS=At?function(e){return e[0].length>0&&Buffer.isBuffer(e[0][0])?Buffer.concat(e[0].map(function(t){return Buffer.isBuffer(t)?t:yi(t)})):oS(e)}:oS,cS=function(e,t,r){for(var n=[],s=t;s<r;s+=2)n.push(String.fromCharCode(qu(e,s)));return n.join("").replace(fd,"")},fw=At?function(e,t,r){return Buffer.isBuffer(e)?e.toString("utf16le",t,r).replace(fd,""):cS(e,t,r)}:cS,uS=function(e,t,r){for(var n=[],s=t;s<t+r;++s)n.push(("0"+e[s].toString(16)).slice(-2));return n.join("")},Y4=At?function(e,t,r){return Buffer.isBuffer(e)?e.toString("hex",t,t+r):uS(e,t,r)}:uS,dS=function(e,t,r){for(var n=[],s=t;s<r;s++)n.push(String.fromCharCode(Wl(e,s)));return n.join("")},Uf=At?function(t,r,n){return Buffer.isBuffer(t)?t.toString("utf8",r,n):dS(t,r,n)}:dS,K4=function(e,t){var r=ns(e,t);return r>0?Uf(e,t+4,t+4+r-1):""},X4=K4,Q4=function(e,t){var r=ns(e,t);return r>0?Uf(e,t+4,t+4+r-1):""},J4=Q4,Z4=function(e,t){var r=2*ns(e,t);return r>0?Uf(e,t+4,t+4+r-1):""},eA=Z4,tA=function(t,r){var n=ns(t,r);return n>0?fw(t,r+4,r+4+n):""},rA=tA,nA=function(e,t){var r=ns(e,t);return r>0?Uf(e,t+4,t+4+r):""},sA=nA,aA=function(e,t){return tW(e,t)},i0=aA,hw=function(t){return Array.isArray(t)||typeof Uint8Array<"u"&&t instanceof Uint8Array};At&&(X4=function(t,r){if(!Buffer.isBuffer(t))return K4(t,r);var n=t.readUInt32LE(r);return n>0?t.toString("utf8",r+4,r+4+n-1):""},J4=function(t,r){if(!Buffer.isBuffer(t))return Q4(t,r);var n=t.readUInt32LE(r);return n>0?t.toString("utf8",r+4,r+4+n-1):""},eA=function(t,r){if(!Buffer.isBuffer(t))return Z4(t,r);var n=2*t.readUInt32LE(r);return t.toString("utf16le",r+4,r+4+n-1)},rA=function(t,r){if(!Buffer.isBuffer(t))return tA(t,r);var n=t.readUInt32LE(r);return t.toString("utf16le",r+4,r+4+n)},sA=function(t,r){if(!Buffer.isBuffer(t))return nA(t,r);var n=t.readUInt32LE(r);return t.toString("utf8",r+4,r+4+n)},i0=function(t,r){return Buffer.isBuffer(t)?t.readDoubleLE(r):aA(t,r)},hw=function(t){return Buffer.isBuffer(t)||Array.isArray(t)||typeof Uint8Array<"u"&&t instanceof Uint8Array});var Wl=function(e,t){return e[t]},qu=function(e,t){return e[t+1]*256+e[t]},nW=function(e,t){var r=e[t+1]*256+e[t];return r<32768?r:(65535-r+1)*-1},ns=function(e,t){return e[t+3]*(1<<24)+(e[t+2]<<16)+(e[t+1]<<8)+e[t]},Fo=function(e,t){return e[t+3]<<24|e[t+2]<<16|e[t+1]<<8|e[t]},sW=function(e,t){return e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3]};function md(e,t){var r="",n,s,a=[],o,l,c,u;switch(t){case"dbcs":if(u=this.l,At&&Buffer.isBuffer(this))r=this.slice(this.l,this.l+2*e).toString("utf16le");else for(c=0;c<e;++c)r+=String.fromCharCode(qu(this,u)),u+=2;e*=2;break;case"utf8":r=Uf(this,this.l,this.l+e);break;case"utf16le":e*=2,r=fw(this,this.l,this.l+e);break;case"wstr":return md.call(this,e,"dbcs");case"lpstr-ansi":r=X4(this,this.l),e=4+ns(this,this.l);break;case"lpstr-cp":r=J4(this,this.l),e=4+ns(this,this.l);break;case"lpwstr":r=eA(this,this.l),e=4+2*ns(this,this.l);break;case"lpp4":e=4+ns(this,this.l),r=rA(this,this.l),e&2&&(e+=2);break;case"8lpp4":e=4+ns(this,this.l),r=sA(this,this.l),e&3&&(e+=4-(e&3));break;case"cstr":for(e=0,r="";(o=Wl(this,this.l+e++))!==0;)a.push(Rh(o));r=a.join("");break;case"_wstr":for(e=0,r="";(o=qu(this,this.l+e))!==0;)a.push(Rh(o)),e+=2;e+=2,r=a.join("");break;case"dbcs-cont":for(r="",u=this.l,c=0;c<e;++c){if(this.lens&&this.lens.indexOf(u)!==-1)return o=Wl(this,u),this.l=u+1,l=md.call(this,e-c,o?"dbcs-cont":"sbcs-cont"),a.join("")+l;a.push(Rh(qu(this,u))),u+=2}r=a.join(""),e*=2;break;case"cpstr":case"sbcs-cont":for(r="",u=this.l,c=0;c!=e;++c){if(this.lens&&this.lens.indexOf(u)!==-1)return o=Wl(this,u),this.l=u+1,l=md.call(this,e-c,o?"dbcs-cont":"sbcs-cont"),a.join("")+l;a.push(Rh(Wl(this,u))),u+=1}r=a.join("");break;default:switch(e){case 1:return n=Wl(this,this.l),this.l++,n;case 2:return n=(t==="i"?nW:qu)(this,this.l),this.l+=2,n;case 4:case-4:return t==="i"||!(this[this.l+3]&128)?(n=(e>0?Fo:sW)(this,this.l),this.l+=4,n):(s=ns(this,this.l),this.l+=4,s);case 8:case-8:if(t==="f")return e==8?s=i0(this,this.l):s=i0([this[this.l+7],this[this.l+6],this[this.l+5],this[this.l+4],this[this.l+3],this[this.l+2],this[this.l+1],this[this.l+0]],0),this.l+=8,s;e=8;case 16:r=Y4(this,this.l,e);break}}return this.l+=e,r}var aW=function(e,t,r){e[r]=t&255,e[r+1]=t>>>8&255,e[r+2]=t>>>16&255,e[r+3]=t>>>24&255},iW=function(e,t,r){e[r]=t&255,e[r+1]=t>>8&255,e[r+2]=t>>16&255,e[r+3]=t>>24&255},oW=function(e,t,r){e[r]=t&255,e[r+1]=t>>>8&255};function lW(e,t,r){var n=0,s=0;if(r==="dbcs"){for(s=0;s!=t.length;++s)oW(this,t.charCodeAt(s),this.l+2*s);n=2*t.length}else if(r==="sbcs"){for(t=t.replace(/[^\x00-\x7F]/g,"_"),s=0;s!=t.length;++s)this[this.l+s]=t.charCodeAt(s)&255;n=t.length}else if(r==="hex"){for(;s<e;++s)this[this.l++]=parseInt(t.slice(2*s,2*s+2),16)||0;return this}else if(r==="utf16le"){var a=Math.min(this.l+e,this.length);for(s=0;s<Math.min(t.length,e);++s){var o=t.charCodeAt(s);this[this.l++]=o&255,this[this.l++]=o>>8}for(;this.l<a;)this[this.l++]=0;return this}else switch(e){case 1:n=1,this[this.l]=t&255;break;case 2:n=2,this[this.l]=t&255,t>>>=8,this[this.l+1]=t&255;break;case 3:n=3,this[this.l]=t&255,t>>>=8,this[this.l+1]=t&255,t>>>=8,this[this.l+2]=t&255;break;case 4:n=4,aW(this,t,this.l);break;case 8:if(n=8,r==="f"){rW(this,t,this.l);break}case 16:break;case-4:n=4,iW(this,t,this.l);break}return this.l+=n,this}function iA(e,t){var r=Y4(this,this.l,e.length>>1);if(r!==e)throw new Error(t+"Expected "+e+" saw "+r);this.l+=e.length>>1}function es(e,t){e.l=t,e.read_shift=md,e.chk=iA,e.write_shift=lW}function Ra(e,t){e.l+=t}function Se(e){var t=cl(e);return es(t,0),t}function Wn(){var e=[],t=At?256:2048,r=function(u){var d=Se(u);return es(d,0),d},n=r(t),s=function(){n&&(n.length>n.l&&(n=n.slice(0,n.l),n.l=n.length),n.length>0&&e.push(n),n=null)},a=function(u){return n&&u<n.length-n.l?n:(s(),n=r(Math.max(u+1,t)))},o=function(){return s(),Jr(e)},l=function(u){s(),n=u,n.l==null&&(n.l=n.length),a(t)};return{next:a,push:l,end:o,_bufs:e}}function Pe(e,t,r,n){var s=+t,a;if(!isNaN(s)){n||(n=tX[s].p||(r||[]).length||0),a=1+(s>=128?1:0)+1,n>=128&&++a,n>=16384&&++a,n>=2097152&&++a;var o=e.next(a);s<=127?o.write_shift(1,s):(o.write_shift(1,(s&127)+128),o.write_shift(1,s>>7));for(var l=0;l!=4;++l)if(n>=128)o.write_shift(1,(n&127)+128),n>>=7;else{o.write_shift(1,n);break}n>0&&hw(r)&&e.push(r)}}function pd(e,t,r){var n=Yn(e);if(t.s?(n.cRel&&(n.c+=t.s.c),n.rRel&&(n.r+=t.s.r)):(n.cRel&&(n.c+=t.c),n.rRel&&(n.r+=t.r)),!r||r.biff<12){for(;n.c>=256;)n.c-=256;for(;n.r>=65536;)n.r-=65536}return n}function fS(e,t,r){var n=Yn(e);return n.s=pd(n.s,t.s,r),n.e=pd(n.e,t.s,r),n}function gd(e,t){if(e.cRel&&e.c<0)for(e=Yn(e);e.c<0;)e.c+=t>8?16384:256;if(e.rRel&&e.r<0)for(e=Yn(e);e.r<0;)e.r+=t>8?1048576:t>5?65536:16384;var r=Lt(e);return!e.cRel&&e.cRel!=null&&(r=dW(r)),!e.rRel&&e.rRel!=null&&(r=cW(r)),r}function ox(e,t){return e.s.r==0&&!e.s.rRel&&e.e.r==(t.biff>=12?1048575:t.biff>=8?65536:16384)&&!e.e.rRel?(e.s.cRel?"":"$")+gn(e.s.c)+":"+(e.e.cRel?"":"$")+gn(e.e.c):e.s.c==0&&!e.s.cRel&&e.e.c==(t.biff>=12?16383:255)&&!e.e.cRel?(e.s.rRel?"":"$")+nn(e.s.r)+":"+(e.e.rRel?"":"$")+nn(e.e.r):gd(e.s,t.biff)+":"+gd(e.e,t.biff)}function mw(e){return parseInt(uW(e),10)-1}function nn(e){return""+(e+1)}function cW(e){return e.replace(/([A-Z]|^)(\d+)$/,"$1$$$2")}function uW(e){return e.replace(/\$(\d+)$/,"$1")}function pw(e){for(var t=fW(e),r=0,n=0;n!==t.length;++n)r=26*r+t.charCodeAt(n)-64;return r-1}function gn(e){if(e<0)throw new Error("invalid column "+e);var t="";for(++e;e;e=Math.floor((e-1)/26))t=String.fromCharCode((e-1)%26+65)+t;return t}function dW(e){return e.replace(/^([A-Z])/,"$$$1")}function fW(e){return e.replace(/^\$([A-Z])/,"$1")}function hW(e){return e.replace(/(\$?[A-Z]*)(\$?\d*)/,"$1,$2").split(",")}function Wr(e){for(var t=0,r=0,n=0;n<e.length;++n){var s=e.charCodeAt(n);s>=48&&s<=57?t=10*t+(s-48):s>=65&&s<=90&&(r=26*r+(s-64))}return{c:r-1,r:t-1}}function Lt(e){for(var t=e.c+1,r="";t;t=(t-1)/26|0)r=String.fromCharCode((t-1)%26+65)+r;return r+(e.r+1)}function ds(e){var t=e.indexOf(":");return t==-1?{s:Wr(e),e:Wr(e)}:{s:Wr(e.slice(0,t)),e:Wr(e.slice(t+1))}}function Cr(e,t){return typeof t>"u"||typeof t=="number"?Cr(e.s,e.e):(typeof e!="string"&&(e=Lt(e)),typeof t!="string"&&(t=Lt(t)),e==t?e:e+":"+t)}function Kt(e){var t={s:{c:0,r:0},e:{c:0,r:0}},r=0,n=0,s=0,a=e.length;for(r=0;n<a&&!((s=e.charCodeAt(n)-64)<1||s>26);++n)r=26*r+s;for(t.s.c=--r,r=0;n<a&&!((s=e.charCodeAt(n)-48)<0||s>9);++n)r=10*r+s;if(t.s.r=--r,n===a||s!=10)return t.e.c=t.s.c,t.e.r=t.s.r,t;for(++n,r=0;n!=a&&!((s=e.charCodeAt(n)-64)<1||s>26);++n)r=26*r+s;for(t.e.c=--r,r=0;n!=a&&!((s=e.charCodeAt(n)-48)<0||s>9);++n)r=10*r+s;return t.e.r=--r,t}function hS(e,t){var r=e.t=="d"&&t instanceof Date;if(e.z!=null)try{return e.w=fo(e.z,r?qn(t):t)}catch{}try{return e.w=fo((e.XF||{}).numFmtId||(r?14:0),r?qn(t):t)}catch{return""+t}}function gi(e,t,r){return e==null||e.t==null||e.t=="z"?"":e.w!==void 0?e.w:(e.t=="d"&&!e.z&&r&&r.dateNF&&(e.z=r.dateNF),e.t=="e"?zf[e.v]||e.v:t==null?hS(e,e.v):hS(e,t))}function Sl(e,t){var r=t&&t.sheet?t.sheet:"Sheet1",n={};return n[r]=e,{SheetNames:[r],Sheets:n}}function oA(e,t,r){var n=r||{},s=e?Array.isArray(e):n.dense,a=e||(s?[]:{}),o=0,l=0;if(a&&n.origin!=null){if(typeof n.origin=="number")o=n.origin;else{var c=typeof n.origin=="string"?Wr(n.origin):n.origin;o=c.r,l=c.c}a["!ref"]||(a["!ref"]="A1:A1")}var u={s:{c:1e7,r:1e7},e:{c:0,r:0}};if(a["!ref"]){var d=Kt(a["!ref"]);u.s.c=d.s.c,u.s.r=d.s.r,u.e.c=Math.max(u.e.c,d.e.c),u.e.r=Math.max(u.e.r,d.e.r),o==-1&&(u.e.r=o=d.e.r+1)}for(var f=0;f!=t.length;++f)if(t[f]){if(!Array.isArray(t[f]))throw new Error("aoa_to_sheet expects an array of arrays");for(var p=0;p!=t[f].length;++p)if(!(typeof t[f][p]>"u")){var h={v:t[f][p]},g=o+f,m=l+p;if(u.s.r>g&&(u.s.r=g),u.s.c>m&&(u.s.c=m),u.e.r<g&&(u.e.r=g),u.e.c<m&&(u.e.c=m),t[f][p]&&typeof t[f][p]=="object"&&!Array.isArray(t[f][p])&&!(t[f][p]instanceof Date))h=t[f][p];else if(Array.isArray(h.v)&&(h.f=t[f][p][1],h.v=h.v[0]),h.v===null)if(h.f)h.t="n";else if(n.nullError)h.t="e",h.v=0;else if(n.sheetStubs)h.t="z";else continue;else typeof h.v=="number"?h.t="n":typeof h.v=="boolean"?h.t="b":h.v instanceof Date?(h.z=n.dateNF||pr[14],n.cellDates?(h.t="d",h.w=fo(h.z,qn(h.v))):(h.t="n",h.v=qn(h.v),h.w=fo(h.z,h.v))):h.t="s";if(s)a[g]||(a[g]=[]),a[g][m]&&a[g][m].z&&(h.z=a[g][m].z),a[g][m]=h;else{var x=Lt({c:m,r:g});a[x]&&a[x].z&&(h.z=a[x].z),a[x]=h}}}return u.s.c<1e7&&(a["!ref"]=Cr(u)),a}function hu(e,t){return oA(null,e,t)}function mW(e){return e.read_shift(4,"i")}function na(e,t){return t||(t=Se(4)),t.write_shift(4,e),t}function xn(e){var t=e.read_shift(4);return t===0?"":e.read_shift(t,"dbcs")}function Hr(e,t){var r=!1;return t==null&&(r=!0,t=Se(4+2*e.length)),t.write_shift(4,e.length),e.length>0&&t.write_shift(0,e,"dbcs"),r?t.slice(0,t.l):t}function pW(e){return{ich:e.read_shift(2),ifnt:e.read_shift(2)}}function gW(e,t){return t||(t=Se(4)),t.write_shift(2,0),t.write_shift(2,0),t}function gw(e,t){var r=e.l,n=e.read_shift(1),s=xn(e),a=[],o={t:s,h:s};if(n&1){for(var l=e.read_shift(4),c=0;c!=l;++c)a.push(pW(e));o.r=a}else o.r=[{ich:0,ifnt:0}];return e.l=r+t,o}function xW(e,t){var r=!1;return t==null&&(r=!0,t=Se(15+4*e.t.length)),t.write_shift(1,0),Hr(e.t,t),r?t.slice(0,t.l):t}var vW=gw;function yW(e,t){var r=!1;return t==null&&(r=!0,t=Se(23+4*e.t.length)),t.write_shift(1,1),Hr(e.t,t),t.write_shift(4,1),gW({},t),r?t.slice(0,t.l):t}function Ds(e){var t=e.read_shift(4),r=e.read_shift(2);return r+=e.read_shift(1)<<16,e.l++,{c:t,iStyleRef:r}}function Nl(e,t){return t==null&&(t=Se(8)),t.write_shift(-4,e.c),t.write_shift(3,e.iStyleRef||e.s),t.write_shift(1,0),t}function jl(e){var t=e.read_shift(2);return t+=e.read_shift(1)<<16,e.l++,{c:-1,iStyleRef:t}}function El(e,t){return t==null&&(t=Se(4)),t.write_shift(3,e.iStyleRef||e.s),t.write_shift(1,0),t}var wW=xn,lA=Hr;function xw(e){var t=e.read_shift(4);return t===0||t===4294967295?"":e.read_shift(t,"dbcs")}function o0(e,t){var r=!1;return t==null&&(r=!0,t=Se(127)),t.write_shift(4,e.length>0?e.length:4294967295),e.length>0&&t.write_shift(0,e,"dbcs"),r?t.slice(0,t.l):t}var _W=xn,Xv=xw,vw=o0;function cA(e){var t=e.slice(e.l,e.l+4),r=t[0]&1,n=t[0]&2;e.l+=4;var s=n===0?i0([0,0,0,0,t[0]&252,t[1],t[2],t[3]],0):Fo(t,0)>>2;return r?s/100:s}function uA(e,t){t==null&&(t=Se(4));var r=0,n=0,s=e*100;if(e==(e|0)&&e>=-536870912&&e<1<<29?n=1:s==(s|0)&&s>=-536870912&&s<1<<29&&(n=1,r=1),n)t.write_shift(-4,((r?s:e)<<2)+(r+2));else throw new Error("unsupported RkNumber "+e)}function dA(e){var t={s:{},e:{}};return t.s.r=e.read_shift(4),t.e.r=e.read_shift(4),t.s.c=e.read_shift(4),t.e.c=e.read_shift(4),t}function bW(e,t){return t||(t=Se(16)),t.write_shift(4,e.s.r),t.write_shift(4,e.e.r),t.write_shift(4,e.s.c),t.write_shift(4,e.e.c),t}var kl=dA,mu=bW;function pu(e){if(e.length-e.l<8)throw"XLS Xnum Buffer underflow";return e.read_shift(8,"f")}function ul(e,t){return(t||Se(8)).write_shift(8,e,"f")}function SW(e){var t={},r=e.read_shift(1),n=r>>>1,s=e.read_shift(1),a=e.read_shift(2,"i"),o=e.read_shift(1),l=e.read_shift(1),c=e.read_shift(1);switch(e.l++,n){case 0:t.auto=1;break;case 1:t.index=s;var u=DW[s];u&&(t.rgb=NS(u));break;case 2:t.rgb=NS([o,l,c]);break;case 3:t.theme=s;break}return a!=0&&(t.tint=a>0?a/32767:a/32768),t}function l0(e,t){if(t||(t=Se(8)),!e||e.auto)return t.write_shift(4,0),t.write_shift(4,0),t;e.index!=null?(t.write_shift(1,2),t.write_shift(1,e.index)):e.theme!=null?(t.write_shift(1,6),t.write_shift(1,e.theme)):(t.write_shift(1,5),t.write_shift(1,0));var r=e.tint||0;if(r>0?r*=32767:r<0&&(r*=32768),t.write_shift(2,r),!e.rgb||e.theme!=null)t.write_shift(2,0),t.write_shift(1,0),t.write_shift(1,0);else{var n=e.rgb||"FFFFFF";typeof n=="number"&&(n=("000000"+n.toString(16)).slice(-6)),t.write_shift(1,parseInt(n.slice(0,2),16)),t.write_shift(1,parseInt(n.slice(2,4),16)),t.write_shift(1,parseInt(n.slice(4,6),16)),t.write_shift(1,255)}return t}function NW(e){var t=e.read_shift(1);e.l++;var r={fBold:t&1,fItalic:t&2,fUnderline:t&4,fStrikeout:t&8,fOutline:t&16,fShadow:t&32,fCondense:t&64,fExtend:t&128};return r}function jW(e,t){t||(t=Se(2));var r=(e.italic?2:0)|(e.strike?8:0)|(e.outline?16:0)|(e.shadow?32:0)|(e.condense?64:0)|(e.extend?128:0);return t.write_shift(1,r),t.write_shift(1,0),t}var fA=2,Jn=3,Ih=11,c0=19,Lh=64,EW=65,kW=71,CW=4108,TW=4126,Xr=80,mS={1:{n:"CodePage",t:fA},2:{n:"Category",t:Xr},3:{n:"PresentationFormat",t:Xr},4:{n:"ByteCount",t:Jn},5:{n:"LineCount",t:Jn},6:{n:"ParagraphCount",t:Jn},7:{n:"SlideCount",t:Jn},8:{n:"NoteCount",t:Jn},9:{n:"HiddenCount",t:Jn},10:{n:"MultimediaClipCount",t:Jn},11:{n:"ScaleCrop",t:Ih},12:{n:"HeadingPairs",t:CW},13:{n:"TitlesOfParts",t:TW},14:{n:"Manager",t:Xr},15:{n:"Company",t:Xr},16:{n:"LinksUpToDate",t:Ih},17:{n:"CharacterCount",t:Jn},19:{n:"SharedDoc",t:Ih},22:{n:"HyperlinksChanged",t:Ih},23:{n:"AppVersion",t:Jn,p:"version"},24:{n:"DigSig",t:EW},26:{n:"ContentType",t:Xr},27:{n:"ContentStatus",t:Xr},28:{n:"Language",t:Xr},29:{n:"Version",t:Xr},255:{},2147483648:{n:"Locale",t:c0},2147483651:{n:"Behavior",t:c0},1919054434:{}},pS={1:{n:"CodePage",t:fA},2:{n:"Title",t:Xr},3:{n:"Subject",t:Xr},4:{n:"Author",t:Xr},5:{n:"Keywords",t:Xr},6:{n:"Comments",t:Xr},7:{n:"Template",t:Xr},8:{n:"LastAuthor",t:Xr},9:{n:"RevNumber",t:Xr},10:{n:"EditTime",t:Lh},11:{n:"LastPrinted",t:Lh},12:{n:"CreatedDate",t:Lh},13:{n:"ModifiedDate",t:Lh},14:{n:"PageCount",t:Jn},15:{n:"WordCount",t:Jn},16:{n:"CharCount",t:Jn},17:{n:"Thumbnail",t:kW},18:{n:"Application",t:Xr},19:{n:"DocSecurity",t:Jn},255:{},2147483648:{n:"Locale",t:c0},2147483651:{n:"Behavior",t:c0},1919054434:{}};function AW(e){return e.map(function(t){return[t>>16&255,t>>8&255,t&255]})}var PW=AW([0,16777215,16711680,65280,255,16776960,16711935,65535,0,16777215,16711680,65280,255,16776960,16711935,65535,8388608,32768,128,8421376,8388736,32896,12632256,8421504,10066431,10040166,16777164,13434879,6684774,16744576,26316,13421823,128,16711935,16776960,65535,8388736,8388608,32896,255,52479,13434879,13434828,16777113,10079487,16751052,13408767,16764057,3368703,3394764,10079232,16763904,16750848,16737792,6710937,9868950,13158,3381606,13056,3355392,10040064,10040166,3355545,3355443,16777215,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),DW=Yn(PW),zf={0:"#NULL!",7:"#DIV/0!",15:"#VALUE!",23:"#REF!",29:"#NAME?",36:"#NUM!",42:"#N/A",43:"#GETTING_DATA",255:"#WTF?"},RW={"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml":"workbooks","application/vnd.ms-excel.sheet.macroEnabled.main+xml":"workbooks","application/vnd.ms-excel.sheet.binary.macroEnabled.main":"workbooks","application/vnd.ms-excel.addin.macroEnabled.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml":"sheets","application/vnd.ms-excel.worksheet":"sheets","application/vnd.ms-excel.binIndexWs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml":"charts","application/vnd.ms-excel.chartsheet":"charts","application/vnd.ms-excel.macrosheet+xml":"macros","application/vnd.ms-excel.macrosheet":"macros","application/vnd.ms-excel.intlmacrosheet":"TODO","application/vnd.ms-excel.binIndexMs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml":"dialogs","application/vnd.ms-excel.dialogsheet":"dialogs","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml":"strs","application/vnd.ms-excel.sharedStrings":"strs","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml":"styles","application/vnd.ms-excel.styles":"styles","application/vnd.openxmlformats-package.core-properties+xml":"coreprops","application/vnd.openxmlformats-officedocument.custom-properties+xml":"custprops","application/vnd.openxmlformats-officedocument.extended-properties+xml":"extprops","application/vnd.openxmlformats-officedocument.customXmlProperties+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.customProperty":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml":"comments","application/vnd.ms-excel.comments":"comments","application/vnd.ms-excel.threadedcomments+xml":"threadedcomments","application/vnd.ms-excel.person+xml":"people","application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml":"metadata","application/vnd.ms-excel.sheetMetadata":"metadata","application/vnd.ms-excel.pivotTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.chart+xml":"TODO","application/vnd.ms-office.chartcolorstyle+xml":"TODO","application/vnd.ms-office.chartstyle+xml":"TODO","application/vnd.ms-office.chartex+xml":"TODO","application/vnd.ms-excel.calcChain":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings":"TODO","application/vnd.ms-office.activeX":"TODO","application/vnd.ms-office.activeX+xml":"TODO","application/vnd.ms-excel.attachedToolbars":"TODO","application/vnd.ms-excel.connections":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml":"TODO","application/vnd.ms-excel.externalLink":"links","application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml":"links","application/vnd.ms-excel.pivotCacheDefinition":"TODO","application/vnd.ms-excel.pivotCacheRecords":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml":"TODO","application/vnd.ms-excel.queryTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.queryTable+xml":"TODO","application/vnd.ms-excel.userNames":"TODO","application/vnd.ms-excel.revisionHeaders":"TODO","application/vnd.ms-excel.revisionLog":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionHeaders+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionLog+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.userNames+xml":"TODO","application/vnd.ms-excel.tableSingleCells":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.tableSingleCells+xml":"TODO","application/vnd.ms-excel.slicer":"TODO","application/vnd.ms-excel.slicerCache":"TODO","application/vnd.ms-excel.slicer+xml":"TODO","application/vnd.ms-excel.slicerCache+xml":"TODO","application/vnd.ms-excel.wsSortMap":"TODO","application/vnd.ms-excel.table":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml":"TODO","application/vnd.openxmlformats-officedocument.theme+xml":"themes","application/vnd.openxmlformats-officedocument.themeOverride+xml":"TODO","application/vnd.ms-excel.Timeline+xml":"TODO","application/vnd.ms-excel.TimelineCache+xml":"TODO","application/vnd.ms-office.vbaProject":"vba","application/vnd.ms-office.vbaProjectSignature":"TODO","application/vnd.ms-office.volatileDependencies":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.volatileDependencies+xml":"TODO","application/vnd.ms-excel.controlproperties+xml":"TODO","application/vnd.openxmlformats-officedocument.model+data":"TODO","application/vnd.ms-excel.Survey+xml":"TODO","application/vnd.openxmlformats-officedocument.drawing+xml":"drawings","application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml":"TODO","application/vnd.openxmlformats-officedocument.vmlDrawing":"TODO","application/vnd.openxmlformats-package.relationships+xml":"rels","application/vnd.openxmlformats-officedocument.oleObject":"TODO","image/png":"TODO",sheet:"js"},$h={workbooks:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml",xlsm:"application/vnd.ms-excel.sheet.macroEnabled.main+xml",xlsb:"application/vnd.ms-excel.sheet.binary.macroEnabled.main",xlam:"application/vnd.ms-excel.addin.macroEnabled.main+xml",xltx:"application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml"},strs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml",xlsb:"application/vnd.ms-excel.sharedStrings"},comments:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml",xlsb:"application/vnd.ms-excel.comments"},sheets:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml",xlsb:"application/vnd.ms-excel.worksheet"},charts:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml",xlsb:"application/vnd.ms-excel.chartsheet"},dialogs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml",xlsb:"application/vnd.ms-excel.dialogsheet"},macros:{xlsx:"application/vnd.ms-excel.macrosheet+xml",xlsb:"application/vnd.ms-excel.macrosheet"},metadata:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml",xlsb:"application/vnd.ms-excel.sheetMetadata"},styles:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml",xlsb:"application/vnd.ms-excel.styles"}};function hA(){return{workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""}}function mA(e,t){var r=VV(RW),n=[],s;n[n.length]=Tr,n[n.length]=Le("Types",null,{xmlns:Vr.CT,"xmlns:xsd":Vr.xsd,"xmlns:xsi":Vr.xsi}),n=n.concat([["xml","application/xml"],["bin","application/vnd.ms-excel.sheet.binary.macroEnabled.main"],["vml","application/vnd.openxmlformats-officedocument.vmlDrawing"],["data","application/vnd.openxmlformats-officedocument.model+data"],["bmp","image/bmp"],["png","image/png"],["gif","image/gif"],["emf","image/x-emf"],["wmf","image/x-wmf"],["jpg","image/jpeg"],["jpeg","image/jpeg"],["tif","image/tiff"],["tiff","image/tiff"],["pdf","application/pdf"],["rels","application/vnd.openxmlformats-package.relationships+xml"]].map(function(c){return Le("Default",null,{Extension:c[0],ContentType:c[1]})}));var a=function(c){e[c]&&e[c].length>0&&(s=e[c][0],n[n.length]=Le("Override",null,{PartName:(s[0]=="/"?"":"/")+s,ContentType:$h[c][t.bookType]||$h[c].xlsx}))},o=function(c){(e[c]||[]).forEach(function(u){n[n.length]=Le("Override",null,{PartName:(u[0]=="/"?"":"/")+u,ContentType:$h[c][t.bookType]||$h[c].xlsx})})},l=function(c){(e[c]||[]).forEach(function(u){n[n.length]=Le("Override",null,{PartName:(u[0]=="/"?"":"/")+u,ContentType:r[c][0]})})};return a("workbooks"),o("sheets"),o("charts"),l("themes"),["strs","styles"].forEach(a),["coreprops","extprops","custprops"].forEach(l),l("vba"),l("comments"),l("threadedcomments"),l("drawings"),o("metadata"),l("people"),n.length>2&&(n[n.length]="</Types>",n[1]=n[1].replace("/>",">")),n.join("")}var Tt={WB:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",HLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",VML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",XPATH:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLinkPath",XMISS:"http://schemas.microsoft.com/office/2006/relationships/xlExternalLinkPath/xlPathMissing",CMNT:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties",SST:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",STY:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",THEME:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",WS:["http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet","http://purl.oclc.org/ooxml/officeDocument/relationships/worksheet"],DRAW:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",XLMETA:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sheetMetadata",TCMNT:"http://schemas.microsoft.com/office/2017/10/relationships/threadedComment",PEOPLE:"http://schemas.microsoft.com/office/2017/10/relationships/person",VBA:"http://schemas.microsoft.com/office/2006/relationships/vbaProject"};function pA(e){var t=e.lastIndexOf("/");return e.slice(0,t+1)+"_rels/"+e.slice(t+1)+".rels"}function yc(e){var t=[Tr,Le("Relationships",null,{xmlns:Vr.RELS})];return an(e["!id"]).forEach(function(r){t[t.length]=Le("Relationship",null,e["!id"][r])}),t.length>2&&(t[t.length]="</Relationships>",t[1]=t[1].replace("/>",">")),t.join("")}function Ot(e,t,r,n,s,a){if(s||(s={}),e["!id"]||(e["!id"]={}),e["!idx"]||(e["!idx"]=1),t<0)for(t=e["!idx"];e["!id"]["rId"+t];++t);if(e["!idx"]=t+1,s.Id="rId"+t,s.Type=n,s.Target=r,[Tt.HLINK,Tt.XPATH,Tt.XMISS].indexOf(s.Type)>-1&&(s.TargetMode="External"),e["!id"][s.Id])throw new Error("Cannot rewrite rId "+t);return e["!id"][s.Id]=s,e[("/"+s.Target).replace("//","/")]=s,t}function MW(e){var t=[Tr];t.push(`<manifest:manifest xmlns:manifest="urn:oasis:names:tc:opendocument:xmlns:manifest:1.0" manifest:version="1.2">
`),t.push(`  <manifest:file-entry manifest:full-path="/" manifest:version="1.2" manifest:media-type="application/vnd.oasis.opendocument.spreadsheet"/>
`);for(var r=0;r<e.length;++r)t.push('  <manifest:file-entry manifest:full-path="'+e[r][0]+'" manifest:media-type="'+e[r][1]+`"/>
`);return t.push("</manifest:manifest>"),t.join("")}function gS(e,t,r){return['  <rdf:Description rdf:about="'+e+`">
`,'    <rdf:type rdf:resource="http://docs.oasis-open.org/ns/office/1.2/meta/'+(r||"odf")+"#"+t+`"/>
`,`  </rdf:Description>
`].join("")}function OW(e,t){return['  <rdf:Description rdf:about="'+e+`">
`,'    <ns0:hasPart xmlns:ns0="http://docs.oasis-open.org/ns/office/1.2/meta/pkg#" rdf:resource="'+t+`"/>
`,`  </rdf:Description>
`].join("")}function FW(e){var t=[Tr];t.push(`<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#">
`);for(var r=0;r!=e.length;++r)t.push(gS(e[r][0],e[r][1])),t.push(OW("",e[r][0]));return t.push(gS("","Document","pkg")),t.push("</rdf:RDF>"),t.join("")}function gA(){return'<office:document-meta xmlns:office="urn:oasis:names:tc:opendocument:xmlns:office:1.0" xmlns:meta="urn:oasis:names:tc:opendocument:xmlns:meta:1.0" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:xlink="http://www.w3.org/1999/xlink" office:version="1.2"><office:meta><meta:generator>SheetJS '+e0.version+"</meta:generator></office:meta></office:document-meta>"}var Qo=[["cp:category","Category"],["cp:contentStatus","ContentStatus"],["cp:keywords","Keywords"],["cp:lastModifiedBy","LastAuthor"],["cp:lastPrinted","LastPrinted"],["cp:revision","RevNumber"],["cp:version","Version"],["dc:creator","Author"],["dc:description","Comments"],["dc:identifier","Identifier"],["dc:language","Language"],["dc:subject","Subject"],["dc:title","Title"],["dcterms:created","CreatedDate","date"],["dcterms:modified","ModifiedDate","date"]];function lx(e,t,r,n,s){s[e]!=null||t==null||t===""||(s[e]=t,t=Ft(t),n[n.length]=r?Le(e,t,r):Zr(e,t))}function xA(e,t){var r=t||{},n=[Tr,Le("cp:coreProperties",null,{"xmlns:cp":Vr.CORE_PROPS,"xmlns:dc":Vr.dc,"xmlns:dcterms":Vr.dcterms,"xmlns:dcmitype":Vr.dcmitype,"xmlns:xsi":Vr.xsi})],s={};if(!e&&!r.Props)return n.join("");e&&(e.CreatedDate!=null&&lx("dcterms:created",typeof e.CreatedDate=="string"?e.CreatedDate:Kv(e.CreatedDate,r.WTF),{"xsi:type":"dcterms:W3CDTF"},n,s),e.ModifiedDate!=null&&lx("dcterms:modified",typeof e.ModifiedDate=="string"?e.ModifiedDate:Kv(e.ModifiedDate,r.WTF),{"xsi:type":"dcterms:W3CDTF"},n,s));for(var a=0;a!=Qo.length;++a){var o=Qo[a],l=r.Props&&r.Props[o[1]]!=null?r.Props[o[1]]:e?e[o[1]]:null;l===!0?l="1":l===!1?l="0":typeof l=="number"&&(l=String(l)),l!=null&&lx(o[0],l,null,n,s)}return n.length>2&&(n[n.length]="</cp:coreProperties>",n[1]=n[1].replace("/>",">")),n.join("")}var wc=[["Application","Application","string"],["AppVersion","AppVersion","string"],["Company","Company","string"],["DocSecurity","DocSecurity","string"],["Manager","Manager","string"],["HyperlinksChanged","HyperlinksChanged","bool"],["SharedDoc","SharedDoc","bool"],["LinksUpToDate","LinksUpToDate","bool"],["ScaleCrop","ScaleCrop","bool"],["HeadingPairs","HeadingPairs","raw"],["TitlesOfParts","TitlesOfParts","raw"]],vA=["Worksheets","SheetNames","NamedRanges","DefinedNames","Chartsheets","ChartNames"];function yA(e){var t=[],r=Le;return e||(e={}),e.Application="SheetJS",t[t.length]=Tr,t[t.length]=Le("Properties",null,{xmlns:Vr.EXT_PROPS,"xmlns:vt":Vr.vt}),wc.forEach(function(n){if(e[n[1]]!==void 0){var s;switch(n[2]){case"string":s=Ft(String(e[n[1]]));break;case"bool":s=e[n[1]]?"true":"false";break}s!==void 0&&(t[t.length]=r(n[0],s))}}),t[t.length]=r("HeadingPairs",r("vt:vector",r("vt:variant","<vt:lpstr>Worksheets</vt:lpstr>")+r("vt:variant",r("vt:i4",String(e.Worksheets))),{size:2,baseType:"variant"})),t[t.length]=r("TitlesOfParts",r("vt:vector",e.SheetNames.map(function(n){return"<vt:lpstr>"+Ft(n)+"</vt:lpstr>"}).join(""),{size:e.Worksheets,baseType:"lpstr"})),t.length>2&&(t[t.length]="</Properties>",t[1]=t[1].replace("/>",">")),t.join("")}function wA(e){var t=[Tr,Le("Properties",null,{xmlns:Vr.CUST_PROPS,"xmlns:vt":Vr.vt})];if(!e)return t.join("");var r=1;return an(e).forEach(function(s){++r,t[t.length]=Le("property",eW(e[s]),{fmtid:"{D5CDD505-2E9C-101B-9397-08002B2CF9AE}",pid:r,name:Ft(s)})}),t.length>2&&(t[t.length]="</Properties>",t[1]=t[1].replace("/>",">")),t.join("")}var xS={Title:"Title",Subject:"Subject",Author:"Author",Keywords:"Keywords",Comments:"Description",LastAuthor:"LastAuthor",RevNumber:"Revision",Application:"AppName",LastPrinted:"LastPrinted",CreatedDate:"Created",ModifiedDate:"LastSaved",Category:"Category",Manager:"Manager",Company:"Company",AppVersion:"Version",ContentStatus:"ContentStatus",Identifier:"Identifier",Language:"Language"};function IW(e,t){var r=[];return an(xS).map(function(n){for(var s=0;s<Qo.length;++s)if(Qo[s][1]==n)return Qo[s];for(s=0;s<wc.length;++s)if(wc[s][1]==n)return wc[s];throw n}).forEach(function(n){if(e[n[1]]!=null){var s=t&&t.Props&&t.Props[n[1]]!=null?t.Props[n[1]]:e[n[1]];switch(n[2]){case"date":s=new Date(s).toISOString().replace(/\.\d*Z/,"Z");break}typeof s=="number"?s=String(s):s===!0||s===!1?s=s?"1":"0":s instanceof Date&&(s=new Date(s).toISOString().replace(/\.\d*Z/,"")),r.push(Zr(xS[n[1]]||n[1],s))}}),Le("DocumentProperties",r.join(""),{xmlns:rs.o})}function LW(e,t){var r=["Worksheets","SheetNames"],n="CustomDocumentProperties",s=[];return e&&an(e).forEach(function(a){if(Object.prototype.hasOwnProperty.call(e,a)){for(var o=0;o<Qo.length;++o)if(a==Qo[o][1])return;for(o=0;o<wc.length;++o)if(a==wc[o][1])return;for(o=0;o<r.length;++o)if(a==r[o])return;var l=e[a],c="string";typeof l=="number"?(c="float",l=String(l)):l===!0||l===!1?(c="boolean",l=l?"1":"0"):l=String(l),s.push(Le(sS(a),l,{"dt:dt":c}))}}),t&&an(t).forEach(function(a){if(Object.prototype.hasOwnProperty.call(t,a)&&!(e&&Object.prototype.hasOwnProperty.call(e,a))){var o=t[a],l="string";typeof o=="number"?(l="float",o=String(o)):o===!0||o===!1?(l="boolean",o=o?"1":"0"):o instanceof Date?(l="dateTime.tz",o=o.toISOString()):o=String(o),s.push(Le(sS(a),o,{"dt:dt":l}))}}),"<"+n+' xmlns="'+rs.o+'">'+s.join("")+"</"+n+">"}function $W(e){var t=typeof e=="string"?new Date(Date.parse(e)):e,r=t.getTime()/1e3+11644473600,n=r%Math.pow(2,32),s=(r-n)/Math.pow(2,32);n*=1e7,s*=1e7;var a=n/Math.pow(2,32)|0;a>0&&(n=n%Math.pow(2,32),s+=a);var o=Se(8);return o.write_shift(4,n),o.write_shift(4,s),o}function vS(e,t){var r=Se(4),n=Se(4);switch(r.write_shift(4,e==80?31:e),e){case 3:n.write_shift(-4,t);break;case 5:n=Se(8),n.write_shift(8,t,"f");break;case 11:n.write_shift(4,t?1:0);break;case 64:n=$W(t);break;case 31:case 80:for(n=Se(4+2*(t.length+1)+(t.length%2?0:2)),n.write_shift(4,t.length+1),n.write_shift(0,t,"dbcs");n.l!=n.length;)n.write_shift(1,0);break;default:throw new Error("TypedPropertyValue unrecognized type "+e+" "+t)}return Jr([r,n])}var _A=["CodePage","Thumbnail","_PID_LINKBASE","_PID_HLINKS","SystemIdentifier","FMTID"];function BW(e){switch(typeof e){case"boolean":return 11;case"number":return(e|0)==e?3:5;case"string":return 31;case"object":if(e instanceof Date)return 64;break}return-1}function yS(e,t,r){var n=Se(8),s=[],a=[],o=8,l=0,c=Se(8),u=Se(8);if(c.write_shift(4,2),c.write_shift(4,1200),u.write_shift(4,1),a.push(c),s.push(u),o+=8+c.length,!t){u=Se(8),u.write_shift(4,0),s.unshift(u);var d=[Se(4)];for(d[0].write_shift(4,e.length),l=0;l<e.length;++l){var f=e[l][0];for(c=Se(8+2*(f.length+1)+(f.length%2?0:2)),c.write_shift(4,l+2),c.write_shift(4,f.length+1),c.write_shift(0,f,"dbcs");c.l!=c.length;)c.write_shift(1,0);d.push(c)}c=Jr(d),a.unshift(c),o+=8+c.length}for(l=0;l<e.length;++l)if(!(t&&!t[e[l][0]])&&!(_A.indexOf(e[l][0])>-1||vA.indexOf(e[l][0])>-1)&&e[l][1]!=null){var p=e[l][1],h=0;if(t){h=+t[e[l][0]];var g=r[h];if(g.p=="version"&&typeof p=="string"){var m=p.split(".");p=(+m[0]<<16)+(+m[1]||0)}c=vS(g.t,p)}else{var x=BW(p);x==-1&&(x=31,p=String(p)),c=vS(x,p)}a.push(c),u=Se(8),u.write_shift(4,t?h:2+l),s.push(u),o+=8+c.length}var w=8*(a.length+1);for(l=0;l<a.length;++l)s[l].write_shift(4,w),w+=a[l].length;return n.write_shift(4,o),n.write_shift(4,a.length),Jr([n].concat(s).concat(a))}function wS(e,t,r,n,s,a){var o=Se(s?68:48),l=[o];o.write_shift(2,65534),o.write_shift(2,0),o.write_shift(4,842412599),o.write_shift(16,Ut.utils.consts.HEADER_CLSID,"hex"),o.write_shift(4,s?2:1),o.write_shift(16,t,"hex"),o.write_shift(4,s?68:48);var c=yS(e,r,n);if(l.push(c),s){var u=yS(s,null,null);o.write_shift(16,a,"hex"),o.write_shift(4,68+c.length),l.push(u)}return Jr(l)}function UW(e,t){t||(t=Se(e));for(var r=0;r<e;++r)t.write_shift(1,0);return t}function zW(e,t){return e.read_shift(t)===1}function Nn(e,t){return t||(t=Se(2)),t.write_shift(2,+!!e),t}function bA(e){return e.read_shift(2,"u")}function ys(e,t){return t||(t=Se(2)),t.write_shift(2,e),t}function SA(e,t,r){return r||(r=Se(2)),r.write_shift(1,t=="e"?+e:+!!e),r.write_shift(1,t=="e"?1:0),r}function NA(e,t,r){var n=e.read_shift(r&&r.biff>=12?2:1),s="sbcs-cont";if(r&&r.biff>=8,!r||r.biff==8){var a=e.read_shift(1);a&&(s="dbcs-cont")}else r.biff==12&&(s="wstr");r.biff>=2&&r.biff<=5&&(s="cpstr");var o=n?e.read_shift(n,s):"";return o}function VW(e){var t=e.t||"",r=Se(3);r.write_shift(2,t.length),r.write_shift(1,1);var n=Se(2*t.length);n.write_shift(2*t.length,t,"utf16le");var s=[r,n];return Jr(s)}function WW(e,t,r){var n;if(r){if(r.biff>=2&&r.biff<=5)return e.read_shift(t,"cpstr");if(r.biff>=12)return e.read_shift(t,"dbcs-cont")}var s=e.read_shift(1);return s===0?n=e.read_shift(t,"sbcs-cont"):n=e.read_shift(t,"dbcs-cont"),n}function HW(e,t,r){var n=e.read_shift(r&&r.biff==2?1:2);return n===0?(e.l++,""):WW(e,n,r)}function GW(e,t,r){if(r.biff>5)return HW(e,t,r);var n=e.read_shift(1);return n===0?(e.l++,""):e.read_shift(n,r.biff<=4||!e.lens?"cpstr":"sbcs-cont")}function jA(e,t,r){return r||(r=Se(3+2*e.length)),r.write_shift(2,e.length),r.write_shift(1,1),r.write_shift(31,e,"utf16le"),r}function _S(e,t){t||(t=Se(6+e.length*2)),t.write_shift(4,1+e.length);for(var r=0;r<e.length;++r)t.write_shift(2,e.charCodeAt(r));return t.write_shift(2,0),t}function qW(e){var t=Se(512),r=0,n=e.Target;n.slice(0,7)=="file://"&&(n=n.slice(7));var s=n.indexOf("#"),a=s>-1?31:23;switch(n.charAt(0)){case"#":a=28;break;case".":a&=-3;break}t.write_shift(4,2),t.write_shift(4,a);var o=[8,6815827,6619237,4849780,83];for(r=0;r<o.length;++r)t.write_shift(4,o[r]);if(a==28)n=n.slice(1),_S(n,t);else if(a&2){for(o="e0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),r=0;r<o.length;++r)t.write_shift(1,parseInt(o[r],16));var l=s>-1?n.slice(0,s):n;for(t.write_shift(4,2*(l.length+1)),r=0;r<l.length;++r)t.write_shift(2,l.charCodeAt(r));t.write_shift(2,0),a&8&&_S(s>-1?n.slice(s+1):"",t)}else{for(o="03 03 00 00 00 00 00 00 c0 00 00 00 00 00 00 46".split(" "),r=0;r<o.length;++r)t.write_shift(1,parseInt(o[r],16));for(var c=0;n.slice(c*3,c*3+3)=="../"||n.slice(c*3,c*3+3)=="..\\";)++c;for(t.write_shift(2,c),t.write_shift(4,n.length-3*c+1),r=0;r<n.length-3*c;++r)t.write_shift(1,n.charCodeAt(r+3*c)&255);for(t.write_shift(1,0),t.write_shift(2,65535),t.write_shift(2,57005),r=0;r<6;++r)t.write_shift(4,0)}return t.slice(0,t.l)}function dl(e,t,r,n){return n||(n=Se(6)),n.write_shift(2,e),n.write_shift(2,t),n.write_shift(2,r||0),n}function YW(e,t,r){var n=r.biff>8?4:2,s=e.read_shift(n),a=e.read_shift(n,"i"),o=e.read_shift(n,"i");return[s,a,o]}function KW(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(2),s=e.read_shift(2);return{s:{c:n,r:t},e:{c:s,r}}}function EA(e,t){return t||(t=Se(8)),t.write_shift(2,e.s.r),t.write_shift(2,e.e.r),t.write_shift(2,e.s.c),t.write_shift(2,e.e.c),t}function yw(e,t,r){var n=1536,s=16;switch(r.bookType){case"biff8":break;case"biff5":n=1280,s=8;break;case"biff4":n=4,s=6;break;case"biff3":n=3,s=6;break;case"biff2":n=2,s=4;break;case"xla":break;default:throw new Error("unsupported BIFF version")}var a=Se(s);return a.write_shift(2,n),a.write_shift(2,t),s>4&&a.write_shift(2,29282),s>6&&a.write_shift(2,1997),s>8&&(a.write_shift(2,49161),a.write_shift(2,1),a.write_shift(2,1798),a.write_shift(2,0)),a}function XW(e,t){var r=!t||t.biff==8,n=Se(r?112:54);for(n.write_shift(t.biff==8?2:1,7),r&&n.write_shift(1,0),n.write_shift(4,859007059),n.write_shift(4,5458548|(r?0:536870912));n.l<n.length;)n.write_shift(1,r?0:32);return n}function QW(e,t){var r=!t||t.biff>=8?2:1,n=Se(8+r*e.name.length);n.write_shift(4,e.pos),n.write_shift(1,e.hs||0),n.write_shift(1,e.dt),n.write_shift(1,e.name.length),t.biff>=8&&n.write_shift(1,1),n.write_shift(r*e.name.length,e.name,t.biff<8?"sbcs":"utf16le");var s=n.slice(0,n.l);return s.l=n.l,s}function JW(e,t){var r=Se(8);r.write_shift(4,e.Count),r.write_shift(4,e.Unique);for(var n=[],s=0;s<e.length;++s)n[s]=VW(e[s]);var a=Jr([r].concat(n));return a.parts=[r.length].concat(n.map(function(o){return o.length})),a}function ZW(){var e=Se(18);return e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,29280),e.write_shift(2,17600),e.write_shift(2,56),e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,1),e.write_shift(2,500),e}function eH(e){var t=Se(18),r=1718;return e&&e.RTL&&(r|=64),t.write_shift(2,r),t.write_shift(4,0),t.write_shift(4,64),t.write_shift(4,0),t.write_shift(4,0),t}function tH(e,t){var r=e.name||"Arial",n=t&&t.biff==5,s=n?15+r.length:16+2*r.length,a=Se(s);return a.write_shift(2,e.sz*20),a.write_shift(4,0),a.write_shift(2,400),a.write_shift(4,0),a.write_shift(2,0),a.write_shift(1,r.length),n||a.write_shift(1,1),a.write_shift((n?1:2)*r.length,r,n?"sbcs":"utf16le"),a}function rH(e,t,r,n){var s=Se(10);return dl(e,t,n,s),s.write_shift(4,r),s}function nH(e,t,r,n,s){var a=!s||s.biff==8,o=Se(8+ +a+(1+a)*r.length);return dl(e,t,n,o),o.write_shift(2,r.length),a&&o.write_shift(1,1),o.write_shift((1+a)*r.length,r,a?"utf16le":"sbcs"),o}function sH(e,t,r,n){var s=r&&r.biff==5;n||(n=Se(s?3+t.length:5+2*t.length)),n.write_shift(2,e),n.write_shift(s?1:2,t.length),s||n.write_shift(1,1),n.write_shift((s?1:2)*t.length,t,s?"sbcs":"utf16le");var a=n.length>n.l?n.slice(0,n.l):n;return a.l==null&&(a.l=a.length),a}function aH(e,t){var r=t.biff==8||!t.biff?4:2,n=Se(2*r+6);return n.write_shift(r,e.s.r),n.write_shift(r,e.e.r+1),n.write_shift(2,e.s.c),n.write_shift(2,e.e.c+1),n.write_shift(2,0),n}function bS(e,t,r,n){var s=r&&r.biff==5;n||(n=Se(s?16:20)),n.write_shift(2,0),e.style?(n.write_shift(2,e.numFmtId||0),n.write_shift(2,65524)):(n.write_shift(2,e.numFmtId||0),n.write_shift(2,t<<4));var a=0;return e.numFmtId>0&&s&&(a|=1024),n.write_shift(4,a),n.write_shift(4,0),s||n.write_shift(4,0),n.write_shift(2,0),n}function iH(e){var t=Se(8);return t.write_shift(4,0),t.write_shift(2,0),t.write_shift(2,0),t}function oH(e,t,r,n,s,a){var o=Se(8);return dl(e,t,n,o),SA(r,a,o),o}function lH(e,t,r,n){var s=Se(14);return dl(e,t,n,s),ul(r,s),s}function cH(e,t,r){if(r.biff<8)return uH(e,t,r);for(var n=[],s=e.l+t,a=e.read_shift(r.biff>8?4:2);a--!==0;)n.push(YW(e,r.biff>8?12:6,r));if(e.l!=s)throw new Error("Bad ExternSheet: "+e.l+" != "+s);return n}function uH(e,t,r){e[e.l+1]==3&&e[e.l]++;var n=NA(e,t,r);return n.charCodeAt(0)==3?n.slice(1):n}function dH(e){var t=Se(2+e.length*8);t.write_shift(2,e.length);for(var r=0;r<e.length;++r)EA(e[r],t);return t}function fH(e){var t=Se(24),r=Wr(e[0]);t.write_shift(2,r.r),t.write_shift(2,r.r),t.write_shift(2,r.c),t.write_shift(2,r.c);for(var n="d0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),s=0;s<16;++s)t.write_shift(1,parseInt(n[s],16));return Jr([t,qW(e[1])])}function hH(e){var t=e[1].Tooltip,r=Se(10+2*(t.length+1));r.write_shift(2,2048);var n=Wr(e[0]);r.write_shift(2,n.r),r.write_shift(2,n.r),r.write_shift(2,n.c),r.write_shift(2,n.c);for(var s=0;s<t.length;++s)r.write_shift(2,t.charCodeAt(s));return r.write_shift(2,0),r}function mH(e){return e||(e=Se(4)),e.write_shift(2,1),e.write_shift(2,1),e}function pH(e,t,r){if(!r.cellStyles)return Ra(e,t);var n=r&&r.biff>=12?4:2,s=e.read_shift(n),a=e.read_shift(n),o=e.read_shift(n),l=e.read_shift(n),c=e.read_shift(2);n==2&&(e.l+=2);var u={s,e:a,w:o,ixfe:l,flags:c};return(r.biff>=5||!r.biff)&&(u.level=c>>8&7),u}function gH(e,t){var r=Se(12);r.write_shift(2,t),r.write_shift(2,t),r.write_shift(2,e.width*256),r.write_shift(2,0);var n=0;return e.hidden&&(n|=1),r.write_shift(1,n),n=e.level||0,r.write_shift(1,n),r.write_shift(2,0),r}function xH(e){for(var t=Se(2*e),r=0;r<e;++r)t.write_shift(2,r+1);return t}function vH(e,t,r){var n=Se(15);return Wf(n,e,t),n.write_shift(8,r,"f"),n}function yH(e,t,r){var n=Se(9);return Wf(n,e,t),n.write_shift(2,r),n}var wH=function(){var e={1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127,8:865,9:437,10:850,11:437,13:437,14:850,15:437,16:850,17:437,18:850,19:932,20:850,21:437,22:850,23:865,24:437,25:437,26:850,27:437,28:863,29:850,31:852,34:852,35:852,36:860,37:850,38:866,55:850,64:852,77:936,78:949,79:950,80:874,87:1252,88:1252,89:1252,108:863,134:737,135:852,136:857,204:1257,255:16969},t=lw({1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127});function r(l,c){var u=[],d=cl(1);switch(c.type){case"base64":d=qs(pi(l));break;case"binary":d=qs(l);break;case"buffer":case"array":d=l;break}es(d,0);var f=d.read_shift(1),p=!!(f&136),h=!1,g=!1;switch(f){case 2:break;case 3:break;case 48:h=!0,p=!0;break;case 49:h=!0,p=!0;break;case 131:break;case 139:break;case 140:g=!0;break;case 245:break;default:throw new Error("DBF Unsupported Version: "+f.toString(16))}var m=0,x=521;f==2&&(m=d.read_shift(2)),d.l+=3,f!=2&&(m=d.read_shift(4)),m>1048576&&(m=1e6),f!=2&&(x=d.read_shift(2));var w=d.read_shift(2),v=c.codepage||1252;f!=2&&(d.l+=16,d.read_shift(1),d[d.l]!==0&&(v=e[d[d.l]]),d.l+=1,d.l+=2),g&&(d.l+=36);for(var _=[],b={},S=Math.min(d.length,f==2?521:x-10-(h?264:0)),T=g?32:11;d.l<S&&d[d.l]!=13;)switch(b={},b.name=t0.utils.decode(v,d.slice(d.l,d.l+T)).replace(/[\u0000\r\n].*$/g,""),d.l+=T,b.type=String.fromCharCode(d.read_shift(1)),f!=2&&!g&&(b.offset=d.read_shift(4)),b.len=d.read_shift(1),f==2&&(b.offset=d.read_shift(2)),b.dec=d.read_shift(1),b.name.length&&_.push(b),f!=2&&(d.l+=g?13:14),b.type){case"B":(!h||b.len!=8)&&c.WTF&&console.log("Skipping "+b.name+":"+b.type);break;case"G":case"P":c.WTF&&console.log("Skipping "+b.name+":"+b.type);break;case"+":case"0":case"@":case"C":case"D":case"F":case"I":case"L":case"M":case"N":case"O":case"T":case"Y":break;default:throw new Error("Unknown Field Type: "+b.type)}if(d[d.l]!==13&&(d.l=x-1),d.read_shift(1)!==13)throw new Error("DBF Terminator not found "+d.l+" "+d[d.l]);d.l=x;var N=0,C=0;for(u[0]=[],C=0;C!=_.length;++C)u[0][C]=_[C].name;for(;m-- >0;){if(d[d.l]===42){d.l+=w;continue}for(++d.l,u[++N]=[],C=0,C=0;C!=_.length;++C){var E=d.slice(d.l,d.l+_[C].len);d.l+=_[C].len,es(E,0);var P=t0.utils.decode(v,E);switch(_[C].type){case"C":P.trim().length&&(u[N][C]=P.replace(/\s+$/,""));break;case"D":P.length===8?u[N][C]=new Date(+P.slice(0,4),+P.slice(4,6)-1,+P.slice(6,8)):u[N][C]=P;break;case"F":u[N][C]=parseFloat(P.trim());break;case"+":case"I":u[N][C]=g?E.read_shift(-4,"i")^2147483648:E.read_shift(4,"i");break;case"L":switch(P.trim().toUpperCase()){case"Y":case"T":u[N][C]=!0;break;case"N":case"F":u[N][C]=!1;break;case"":case"?":break;default:throw new Error("DBF Unrecognized L:|"+P+"|")}break;case"M":if(!p)throw new Error("DBF Unexpected MEMO for type "+f.toString(16));u[N][C]="##MEMO##"+(g?parseInt(P.trim(),10):E.read_shift(4));break;case"N":P=P.replace(/\u0000/g,"").trim(),P&&P!="."&&(u[N][C]=+P||0);break;case"@":u[N][C]=new Date(E.read_shift(-8,"f")-621356832e5);break;case"T":u[N][C]=new Date((E.read_shift(4)-2440588)*864e5+E.read_shift(4));break;case"Y":u[N][C]=E.read_shift(4,"i")/1e4+E.read_shift(4,"i")/1e4*Math.pow(2,32);break;case"O":u[N][C]=-E.read_shift(-8,"f");break;case"B":if(h&&_[C].len==8){u[N][C]=E.read_shift(8,"f");break}case"G":case"P":E.l+=_[C].len;break;case"0":if(_[C].name==="_NullFlags")break;default:throw new Error("DBF Unsupported data type "+_[C].type)}}}if(f!=2&&d.l<d.length&&d[d.l++]!=26)throw new Error("DBF EOF Marker missing "+(d.l-1)+" of "+d.length+" "+d[d.l-1].toString(16));return c&&c.sheetRows&&(u=u.slice(0,c.sheetRows)),c.DBF=_,u}function n(l,c){var u=c||{};u.dateNF||(u.dateNF="yyyymmdd");var d=hu(r(l,u),u);return d["!cols"]=u.DBF.map(function(f){return{wch:f.len,DBF:f}}),delete u.DBF,d}function s(l,c){try{return Sl(n(l,c),c)}catch(u){if(c&&c.WTF)throw u}return{SheetNames:[],Sheets:{}}}var a={B:8,C:250,L:1,D:8,"?":0,"":0};function o(l,c){var u=c||{};if(+u.codepage>=0&&Kd(+u.codepage),u.type=="string")throw new Error("Cannot write DBF to JS string");var d=Wn(),f=m0(l,{header:1,raw:!0,cellDates:!0}),p=f[0],h=f.slice(1),g=l["!cols"]||[],m=0,x=0,w=0,v=1;for(m=0;m<p.length;++m){if(((g[m]||{}).DBF||{}).name){p[m]=g[m].DBF.name,++w;continue}if(p[m]!=null){if(++w,typeof p[m]=="number"&&(p[m]=p[m].toString(10)),typeof p[m]!="string")throw new Error("DBF Invalid column name "+p[m]+" |"+typeof p[m]+"|");if(p.indexOf(p[m])!==m){for(x=0;x<1024;++x)if(p.indexOf(p[m]+"_"+x)==-1){p[m]+="_"+x;break}}}}var _=Kt(l["!ref"]),b=[],S=[],T=[];for(m=0;m<=_.e.c-_.s.c;++m){var N="",C="",E=0,P=[];for(x=0;x<h.length;++x)h[x][m]!=null&&P.push(h[x][m]);if(P.length==0||p[m]==null){b[m]="?";continue}for(x=0;x<P.length;++x){switch(typeof P[x]){case"number":C="B";break;case"string":C="C";break;case"boolean":C="L";break;case"object":C=P[x]instanceof Date?"D":"C";break;default:C="C"}E=Math.max(E,String(P[x]).length),N=N&&N!=C?"C":C}E>250&&(E=250),C=((g[m]||{}).DBF||{}).type,C=="C"&&g[m].DBF.len>E&&(E=g[m].DBF.len),N=="B"&&C=="N"&&(N="N",T[m]=g[m].DBF.dec,E=g[m].DBF.len),S[m]=N=="C"||C=="N"?E:a[N]||0,v+=S[m],b[m]=N}var R=d.next(32);for(R.write_shift(4,318902576),R.write_shift(4,h.length),R.write_shift(2,296+32*w),R.write_shift(2,v),m=0;m<4;++m)R.write_shift(4,0);for(R.write_shift(4,0|(+t[C4]||3)<<8),m=0,x=0;m<p.length;++m)if(p[m]!=null){var j=d.next(32),M=(p[m].slice(-10)+"\0\0\0\0\0\0\0\0\0\0\0").slice(0,11);j.write_shift(1,M,"sbcs"),j.write_shift(1,b[m]=="?"?"C":b[m],"sbcs"),j.write_shift(4,x),j.write_shift(1,S[m]||a[b[m]]||0),j.write_shift(1,T[m]||0),j.write_shift(1,2),j.write_shift(4,0),j.write_shift(1,0),j.write_shift(4,0),j.write_shift(4,0),x+=S[m]||a[b[m]]||0}var A=d.next(264);for(A.write_shift(4,13),m=0;m<65;++m)A.write_shift(4,0);for(m=0;m<h.length;++m){var I=d.next(v);for(I.write_shift(1,0),x=0;x<p.length;++x)if(p[x]!=null)switch(b[x]){case"L":I.write_shift(1,h[m][x]==null?63:h[m][x]?84:70);break;case"B":I.write_shift(8,h[m][x]||0,"f");break;case"N":var X="0";for(typeof h[m][x]=="number"&&(X=h[m][x].toFixed(T[x]||0)),w=0;w<S[x]-X.length;++w)I.write_shift(1,32);I.write_shift(1,X,"sbcs");break;case"D":h[m][x]?(I.write_shift(4,("0000"+h[m][x].getFullYear()).slice(-4),"sbcs"),I.write_shift(2,("00"+(h[m][x].getMonth()+1)).slice(-2),"sbcs"),I.write_shift(2,("00"+h[m][x].getDate()).slice(-2),"sbcs")):I.write_shift(8,"00000000","sbcs");break;case"C":var Y=String(h[m][x]!=null?h[m][x]:"").slice(0,S[x]);for(I.write_shift(1,Y,"sbcs"),w=0;w<S[x]-Y.length;++w)I.write_shift(1,32);break}}return d.next(1).write_shift(1,26),d.end()}return{to_workbook:s,to_sheet:n,from_sheet:o}}(),_H=function(){var e={AA:"",BA:"",CA:"",DA:195,HA:"",JA:197,AE:"",BE:"",CE:"",HE:"",AI:"",BI:"",CI:"",HI:"",AO:"",BO:"",CO:"",DO:213,HO:"",AU:"",BU:"",CU:"",HU:"",Aa:"",Ba:"",Ca:"",Da:227,Ha:"",Ja:229,Ae:"",Be:"",Ce:"",He:"",Ai:"",Bi:"",Ci:"",Hi:"",Ao:"",Bo:"",Co:"",Do:245,Ho:"",Au:"",Bu:"",Cu:"",Hu:"",KC:"",Kc:"",q:"",z:"",a:"",j:"",DN:209,Dn:241,Hy:255,S:169,c:170,R:174,"B ":180,0:176,1:177,2:178,3:179,5:181,6:182,7:183,Q:185,k:186,b:208,i:216,l:222,s:240,y:248,"!":161,'"':162,"#":163,"(":164,"%":165,"'":167,"H ":168,"+":171,";":187,"<":188,"=":189,">":190,"?":191,"{":223},t=new RegExp("\x1BN("+an(e).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1")+"|\\|)","gm"),r=function(p,h){var g=e[h];return typeof g=="number"?G2(g):g},n=function(p,h,g){var m=h.charCodeAt(0)-32<<4|g.charCodeAt(0)-48;return m==59?p:G2(m)};e["|"]=254;function s(p,h){switch(h.type){case"base64":return a(pi(p),h);case"binary":return a(p,h);case"buffer":return a(At&&Buffer.isBuffer(p)?p.toString("binary"):$f(p),h);case"array":return a(Rp(p),h)}throw new Error("Unrecognized type "+h.type)}function a(p,h){var g=p.split(/[\n\r]+/),m=-1,x=-1,w=0,v=0,_=[],b=[],S=null,T={},N=[],C=[],E=[],P=0,R;for(+h.codepage>=0&&Kd(+h.codepage);w!==g.length;++w){P=0;var j=g[w].trim().replace(/\x1B([\x20-\x2F])([\x30-\x3F])/g,n).replace(t,r),M=j.replace(/;;/g,"\0").split(";").map(function(L){return L.replace(/\u0000/g,";")}),A=M[0],I;if(j.length>0)switch(A){case"ID":break;case"E":break;case"B":break;case"O":break;case"W":break;case"P":M[1].charAt(0)=="P"&&b.push(j.slice(3).replace(/;;/g,";"));break;case"C":var X=!1,Y=!1,z=!1,U=!1,V=-1,F=-1;for(v=1;v<M.length;++v)switch(M[v].charAt(0)){case"A":break;case"X":x=parseInt(M[v].slice(1))-1,Y=!0;break;case"Y":for(m=parseInt(M[v].slice(1))-1,Y||(x=0),R=_.length;R<=m;++R)_[R]=[];break;case"K":I=M[v].slice(1),I.charAt(0)==='"'?I=I.slice(1,I.length-1):I==="TRUE"?I=!0:I==="FALSE"?I=!1:isNaN(si(I))?isNaN(Qd(I).getDate())||(I=kn(I)):(I=si(I),S!==null&&B4(S)&&(I=W4(I))),X=!0;break;case"E":U=!0;var D=yG(M[v].slice(1),{r:m,c:x});_[m][x]=[_[m][x],D];break;case"S":z=!0,_[m][x]=[_[m][x],"S5S"];break;case"G":break;case"R":V=parseInt(M[v].slice(1))-1;break;case"C":F=parseInt(M[v].slice(1))-1;break;default:if(h&&h.WTF)throw new Error("SYLK bad record "+j)}if(X&&(_[m][x]&&_[m][x].length==2?_[m][x][0]=I:_[m][x]=I,S=null),z){if(U)throw new Error("SYLK shared formula cannot have own formula");var G=V>-1&&_[V][F];if(!G||!G[1])throw new Error("SYLK shared formula cannot find base");_[m][x][1]=wG(G[1],{r:m-V,c:x-F})}break;case"F":var O=0;for(v=1;v<M.length;++v)switch(M[v].charAt(0)){case"X":x=parseInt(M[v].slice(1))-1,++O;break;case"Y":for(m=parseInt(M[v].slice(1))-1,R=_.length;R<=m;++R)_[R]=[];break;case"M":P=parseInt(M[v].slice(1))/20;break;case"F":break;case"G":break;case"P":S=b[parseInt(M[v].slice(1))];break;case"S":break;case"D":break;case"N":break;case"W":for(E=M[v].slice(1).split(" "),R=parseInt(E[0],10);R<=parseInt(E[1],10);++R)P=parseInt(E[2],10),C[R-1]=P===0?{hidden:!0}:{wch:P},ww(C[R-1]);break;case"C":x=parseInt(M[v].slice(1))-1,C[x]||(C[x]={});break;case"R":m=parseInt(M[v].slice(1))-1,N[m]||(N[m]={}),P>0?(N[m].hpt=P,N[m].hpx=PA(P)):P===0&&(N[m].hidden=!0);break;default:if(h&&h.WTF)throw new Error("SYLK bad record "+j)}O<1&&(S=null);break;default:if(h&&h.WTF)throw new Error("SYLK bad record "+j)}}return N.length>0&&(T["!rows"]=N),C.length>0&&(T["!cols"]=C),h&&h.sheetRows&&(_=_.slice(0,h.sheetRows)),[_,T]}function o(p,h){var g=s(p,h),m=g[0],x=g[1],w=hu(m,h);return an(x).forEach(function(v){w[v]=x[v]}),w}function l(p,h){return Sl(o(p,h),h)}function c(p,h,g,m){var x="C;Y"+(g+1)+";X"+(m+1)+";K";switch(p.t){case"n":x+=p.v||0,p.f&&!p.F&&(x+=";E"+bw(p.f,{r:g,c:m}));break;case"b":x+=p.v?"TRUE":"FALSE";break;case"e":x+=p.w||p.v;break;case"d":x+='"'+(p.w||p.v)+'"';break;case"s":x+='"'+p.v.replace(/"/g,"").replace(/;/g,";;")+'"';break}return x}function u(p,h){h.forEach(function(g,m){var x="F;W"+(m+1)+" "+(m+1)+" ";g.hidden?x+="0":(typeof g.width=="number"&&!g.wpx&&(g.wpx=u0(g.width)),typeof g.wpx=="number"&&!g.wch&&(g.wch=d0(g.wpx)),typeof g.wch=="number"&&(x+=Math.round(g.wch))),x.charAt(x.length-1)!=" "&&p.push(x)})}function d(p,h){h.forEach(function(g,m){var x="F;";g.hidden?x+="M0;":g.hpt?x+="M"+20*g.hpt+";":g.hpx&&(x+="M"+20*f0(g.hpx)+";"),x.length>2&&p.push(x+"R"+(m+1))})}function f(p,h){var g=["ID;PWXL;N;E"],m=[],x=Kt(p["!ref"]),w,v=Array.isArray(p),_=`\r
`;g.push("P;PGeneral"),g.push("F;P0;DG0G8;M255"),p["!cols"]&&u(g,p["!cols"]),p["!rows"]&&d(g,p["!rows"]),g.push("B;Y"+(x.e.r-x.s.r+1)+";X"+(x.e.c-x.s.c+1)+";D"+[x.s.c,x.s.r,x.e.c,x.e.r].join(" "));for(var b=x.s.r;b<=x.e.r;++b)for(var S=x.s.c;S<=x.e.c;++S){var T=Lt({r:b,c:S});w=v?(p[b]||[])[S]:p[T],!(!w||w.v==null&&(!w.f||w.F))&&m.push(c(w,p,b,S))}return g.join(_)+_+m.join(_)+_+"E"+_}return{to_workbook:l,to_sheet:o,from_sheet:f}}(),bH=function(){function e(a,o){switch(o.type){case"base64":return t(pi(a),o);case"binary":return t(a,o);case"buffer":return t(At&&Buffer.isBuffer(a)?a.toString("binary"):$f(a),o);case"array":return t(Rp(a),o)}throw new Error("Unrecognized type "+o.type)}function t(a,o){for(var l=a.split(`
`),c=-1,u=-1,d=0,f=[];d!==l.length;++d){if(l[d].trim()==="BOT"){f[++c]=[],u=0;continue}if(!(c<0)){var p=l[d].trim().split(","),h=p[0],g=p[1];++d;for(var m=l[d]||"";(m.match(/["]/g)||[]).length&1&&d<l.length-1;)m+=`
`+l[++d];switch(m=m.trim(),+h){case-1:if(m==="BOT"){f[++c]=[],u=0;continue}else if(m!=="EOD")throw new Error("Unrecognized DIF special command "+m);break;case 0:m==="TRUE"?f[c][u]=!0:m==="FALSE"?f[c][u]=!1:isNaN(si(g))?isNaN(Qd(g).getDate())?f[c][u]=g:f[c][u]=kn(g):f[c][u]=si(g),++u;break;case 1:m=m.slice(1,m.length-1),m=m.replace(/""/g,'"'),m&&m.match(/^=".*"$/)&&(m=m.slice(2,-1)),f[c][u++]=m!==""?m:null;break}if(m==="EOD")break}}return o&&o.sheetRows&&(f=f.slice(0,o.sheetRows)),f}function r(a,o){return hu(e(a,o),o)}function n(a,o){return Sl(r(a,o),o)}var s=function(){var a=function(c,u,d,f,p){c.push(u),c.push(d+","+f),c.push('"'+p.replace(/"/g,'""')+'"')},o=function(c,u,d,f){c.push(u+","+d),c.push(u==1?'"'+f.replace(/"/g,'""')+'"':f)};return function(c){var u=[],d=Kt(c["!ref"]),f,p=Array.isArray(c);a(u,"TABLE",0,1,"sheetjs"),a(u,"VECTORS",0,d.e.r-d.s.r+1,""),a(u,"TUPLES",0,d.e.c-d.s.c+1,""),a(u,"DATA",0,0,"");for(var h=d.s.r;h<=d.e.r;++h){o(u,-1,0,"BOT");for(var g=d.s.c;g<=d.e.c;++g){var m=Lt({r:h,c:g});if(f=p?(c[h]||[])[g]:c[m],!f){o(u,1,0,"");continue}switch(f.t){case"n":var x=f.w;!x&&f.v!=null&&(x=f.v),x==null?f.f&&!f.F?o(u,1,0,"="+f.f):o(u,1,0,""):o(u,0,x,"V");break;case"b":o(u,0,f.v?1:0,f.v?"TRUE":"FALSE");break;case"s":o(u,1,0,isNaN(f.v)?f.v:'="'+f.v+'"');break;case"d":f.w||(f.w=fo(f.z||pr[14],qn(kn(f.v)))),o(u,0,f.w,"V");break;default:o(u,1,0,"")}}}o(u,-1,0,"EOD");var w=`\r
`,v=u.join(w);return v}}();return{to_workbook:n,to_sheet:r,from_sheet:s}}(),kA=function(){function e(f){return f.replace(/\\b/g,"\\").replace(/\\c/g,":").replace(/\\n/g,`
`)}function t(f){return f.replace(/\\/g,"\\b").replace(/:/g,"\\c").replace(/\n/g,"\\n")}function r(f,p){for(var h=f.split(`
`),g=-1,m=-1,x=0,w=[];x!==h.length;++x){var v=h[x].trim().split(":");if(v[0]==="cell"){var _=Wr(v[1]);if(w.length<=_.r)for(g=w.length;g<=_.r;++g)w[g]||(w[g]=[]);switch(g=_.r,m=_.c,v[2]){case"t":w[g][m]=e(v[3]);break;case"v":w[g][m]=+v[3];break;case"vtf":var b=v[v.length-1];case"vtc":switch(v[3]){case"nl":w[g][m]=!!+v[4];break;default:w[g][m]=+v[4];break}v[2]=="vtf"&&(w[g][m]=[w[g][m],b])}}}return p&&p.sheetRows&&(w=w.slice(0,p.sheetRows)),w}function n(f,p){return hu(r(f,p),p)}function s(f,p){return Sl(n(f,p),p)}var a=["socialcalc:version:1.5","MIME-Version: 1.0","Content-Type: multipart/mixed; boundary=SocialCalcSpreadsheetControlSave"].join(`
`),o=["--SocialCalcSpreadsheetControlSave","Content-type: text/plain; charset=UTF-8"].join(`
`)+`
`,l=["# SocialCalc Spreadsheet Control Save","part:sheet"].join(`
`),c="--SocialCalcSpreadsheetControlSave--";function u(f){if(!f||!f["!ref"])return"";for(var p=[],h=[],g,m="",x=ds(f["!ref"]),w=Array.isArray(f),v=x.s.r;v<=x.e.r;++v)for(var _=x.s.c;_<=x.e.c;++_)if(m=Lt({r:v,c:_}),g=w?(f[v]||[])[_]:f[m],!(!g||g.v==null||g.t==="z")){switch(h=["cell",m,"t"],g.t){case"s":case"str":h.push(t(g.v));break;case"n":g.f?(h[2]="vtf",h[3]="n",h[4]=g.v,h[5]=t(g.f)):(h[2]="v",h[3]=g.v);break;case"b":h[2]="vt"+(g.f?"f":"c"),h[3]="nl",h[4]=g.v?"1":"0",h[5]=t(g.f||(g.v?"TRUE":"FALSE"));break;case"d":var b=qn(kn(g.v));h[2]="vtc",h[3]="nd",h[4]=""+b,h[5]=g.w||fo(g.z||pr[14],b);break;case"e":continue}p.push(h.join(":"))}return p.push("sheet:c:"+(x.e.c-x.s.c+1)+":r:"+(x.e.r-x.s.r+1)+":tvf:1"),p.push("valueformat:1:text-wiki"),p.join(`
`)}function d(f){return[a,o,l,o,u(f),c].join(`
`)}return{to_workbook:s,to_sheet:n,from_sheet:d}}(),SH=function(){function e(d,f,p,h,g){g.raw?f[p][h]=d:d===""||(d==="TRUE"?f[p][h]=!0:d==="FALSE"?f[p][h]=!1:isNaN(si(d))?isNaN(Qd(d).getDate())?f[p][h]=d:f[p][h]=kn(d):f[p][h]=si(d))}function t(d,f){var p=f||{},h=[];if(!d||d.length===0)return h;for(var g=d.split(/[\r\n]/),m=g.length-1;m>=0&&g[m].length===0;)--m;for(var x=10,w=0,v=0;v<=m;++v)w=g[v].indexOf(" "),w==-1?w=g[v].length:w++,x=Math.max(x,w);for(v=0;v<=m;++v){h[v]=[];var _=0;for(e(g[v].slice(0,x).trim(),h,v,_,p),_=1;_<=(g[v].length-x)/10+1;++_)e(g[v].slice(x+(_-1)*10,x+_*10).trim(),h,v,_,p)}return p.sheetRows&&(h=h.slice(0,p.sheetRows)),h}var r={44:",",9:"	",59:";",124:"|"},n={44:3,9:2,59:1,124:0};function s(d){for(var f={},p=!1,h=0,g=0;h<d.length;++h)(g=d.charCodeAt(h))==34?p=!p:!p&&g in r&&(f[g]=(f[g]||0)+1);g=[];for(h in f)Object.prototype.hasOwnProperty.call(f,h)&&g.push([f[h],h]);if(!g.length){f=n;for(h in f)Object.prototype.hasOwnProperty.call(f,h)&&g.push([f[h],h])}return g.sort(function(m,x){return m[0]-x[0]||n[m[1]]-n[x[1]]}),r[g.pop()[1]]||44}function a(d,f){var p=f||{},h="",g=p.dense?[]:{},m={s:{c:0,r:0},e:{c:0,r:0}};d.slice(0,4)=="sep="?d.charCodeAt(5)==13&&d.charCodeAt(6)==10?(h=d.charAt(4),d=d.slice(7)):d.charCodeAt(5)==13||d.charCodeAt(5)==10?(h=d.charAt(4),d=d.slice(6)):h=s(d.slice(0,1024)):p&&p.FS?h=p.FS:h=s(d.slice(0,1024));var x=0,w=0,v=0,_=0,b=0,S=h.charCodeAt(0),T=!1,N=0,C=d.charCodeAt(0);d=d.replace(/\r\n/mg,`
`);var E=p.dateNF!=null?$V(p.dateNF):null;function P(){var R=d.slice(_,b),j={};if(R.charAt(0)=='"'&&R.charAt(R.length-1)=='"'&&(R=R.slice(1,-1).replace(/""/g,'"')),R.length===0)j.t="z";else if(p.raw)j.t="s",j.v=R;else if(R.trim().length===0)j.t="s",j.v=R;else if(R.charCodeAt(0)==61)R.charCodeAt(1)==34&&R.charCodeAt(R.length-1)==34?(j.t="s",j.v=R.slice(2,-1).replace(/""/g,'"')):_G(R)?(j.t="n",j.f=R.slice(1)):(j.t="s",j.v=R);else if(R=="TRUE")j.t="b",j.v=!0;else if(R=="FALSE")j.t="b",j.v=!1;else if(!isNaN(v=si(R)))j.t="n",p.cellText!==!1&&(j.w=R),j.v=v;else if(!isNaN(Qd(R).getDate())||E&&R.match(E)){j.z=p.dateNF||pr[14];var M=0;E&&R.match(E)&&(R=BV(R,p.dateNF,R.match(E)||[]),M=1),p.cellDates?(j.t="d",j.v=kn(R,M)):(j.t="n",j.v=qn(kn(R,M))),p.cellText!==!1&&(j.w=fo(j.z,j.v instanceof Date?qn(j.v):j.v)),p.cellNF||delete j.z}else j.t="s",j.v=R;if(j.t=="z"||(p.dense?(g[x]||(g[x]=[]),g[x][w]=j):g[Lt({c:w,r:x})]=j),_=b+1,C=d.charCodeAt(_),m.e.c<w&&(m.e.c=w),m.e.r<x&&(m.e.r=x),N==S)++w;else if(w=0,++x,p.sheetRows&&p.sheetRows<=x)return!0}e:for(;b<d.length;++b)switch(N=d.charCodeAt(b)){case 34:C===34&&(T=!T);break;case S:case 10:case 13:if(!T&&P())break e;break}return b-_>0&&P(),g["!ref"]=Cr(m),g}function o(d,f){return!(f&&f.PRN)||f.FS||d.slice(0,4)=="sep="||d.indexOf("	")>=0||d.indexOf(",")>=0||d.indexOf(";")>=0?a(d,f):hu(t(d,f),f)}function l(d,f){var p="",h=f.type=="string"?[0,0,0,0]:OX(d,f);switch(f.type){case"base64":p=pi(d);break;case"binary":p=d;break;case"buffer":f.codepage==65001?p=d.toString("utf8"):f.codepage&&typeof t0<"u"||(p=At&&Buffer.isBuffer(d)?d.toString("binary"):$f(d));break;case"array":p=Rp(d);break;case"string":p=d;break;default:throw new Error("Unrecognized type "+f.type)}return h[0]==239&&h[1]==187&&h[2]==191?p=hd(p.slice(3)):f.type!="string"&&f.type!="buffer"&&f.codepage==65001?p=hd(p):f.type=="binary"&&typeof t0<"u",p.slice(0,19)=="socialcalc:version:"?kA.to_sheet(f.type=="string"?p:hd(p),f):o(p,f)}function c(d,f){return Sl(l(d,f),f)}function u(d){for(var f=[],p=Kt(d["!ref"]),h,g=Array.isArray(d),m=p.s.r;m<=p.e.r;++m){for(var x=[],w=p.s.c;w<=p.e.c;++w){var v=Lt({r:m,c:w});if(h=g?(d[m]||[])[w]:d[v],!h||h.v==null){x.push("          ");continue}for(var _=(h.w||(gi(h),h.w)||"").slice(0,10);_.length<10;)_+=" ";x.push(_+(w===0?" ":""))}f.push(x.join(""))}return f.join(`
`)}return{to_workbook:c,to_sheet:l,from_sheet:u}}(),SS=function(){function e(D,G,O){if(D){es(D,D.l||0);for(var L=O.Enum||V;D.l<D.length;){var ie=D.read_shift(2),ne=L[ie]||L[65535],me=D.read_shift(2),pe=D.l+me,xe=ne.f&&ne.f(D,me,O);if(D.l=pe,G(xe,ne,ie))return}}}function t(D,G){switch(G.type){case"base64":return r(qs(pi(D)),G);case"binary":return r(qs(D),G);case"buffer":case"array":return r(D,G)}throw"Unsupported type "+G.type}function r(D,G){if(!D)return D;var O=G||{},L=O.dense?[]:{},ie="Sheet1",ne="",me=0,pe={},xe=[],Ae=[],ge={s:{r:0,c:0},e:{r:0,c:0}},je=O.sheetRows||0;if(D[2]==0&&(D[3]==8||D[3]==9)&&D.length>=16&&D[14]==5&&D[15]===108)throw new Error("Unsupported Works 3 for Mac file");if(D[2]==2)O.Enum=V,e(D,function(H,K,oe){switch(oe){case 0:O.vers=H,H>=4096&&(O.qpro=!0);break;case 6:ge=H;break;case 204:H&&(ne=H);break;case 222:ne=H;break;case 15:case 51:O.qpro||(H[1].v=H[1].v.slice(1));case 13:case 14:case 16:oe==14&&(H[2]&112)==112&&(H[2]&15)>1&&(H[2]&15)<15&&(H[1].z=O.dateNF||pr[14],O.cellDates&&(H[1].t="d",H[1].v=W4(H[1].v))),O.qpro&&H[3]>me&&(L["!ref"]=Cr(ge),pe[ie]=L,xe.push(ie),L=O.dense?[]:{},ge={s:{r:0,c:0},e:{r:0,c:0}},me=H[3],ie=ne||"Sheet"+(me+1),ne="");var W=O.dense?(L[H[0].r]||[])[H[0].c]:L[Lt(H[0])];if(W){W.t=H[1].t,W.v=H[1].v,H[1].z!=null&&(W.z=H[1].z),H[1].f!=null&&(W.f=H[1].f);break}O.dense?(L[H[0].r]||(L[H[0].r]=[]),L[H[0].r][H[0].c]=H[1]):L[Lt(H[0])]=H[1];break}},O);else if(D[2]==26||D[2]==14)O.Enum=F,D[2]==14&&(O.qpro=!0,D.l=0),e(D,function(H,K,oe){switch(oe){case 204:ie=H;break;case 22:H[1].v=H[1].v.slice(1);case 23:case 24:case 25:case 37:case 39:case 40:if(H[3]>me&&(L["!ref"]=Cr(ge),pe[ie]=L,xe.push(ie),L=O.dense?[]:{},ge={s:{r:0,c:0},e:{r:0,c:0}},me=H[3],ie="Sheet"+(me+1)),je>0&&H[0].r>=je)break;O.dense?(L[H[0].r]||(L[H[0].r]=[]),L[H[0].r][H[0].c]=H[1]):L[Lt(H[0])]=H[1],ge.e.c<H[0].c&&(ge.e.c=H[0].c),ge.e.r<H[0].r&&(ge.e.r=H[0].r);break;case 27:H[14e3]&&(Ae[H[14e3][0]]=H[14e3][1]);break;case 1537:Ae[H[0]]=H[1],H[0]==me&&(ie=H[1]);break}},O);else throw new Error("Unrecognized LOTUS BOF "+D[2]);if(L["!ref"]=Cr(ge),pe[ne||ie]=L,xe.push(ne||ie),!Ae.length)return{SheetNames:xe,Sheets:pe};for(var k={},le=[],ce=0;ce<Ae.length;++ce)pe[xe[ce]]?(le.push(Ae[ce]||xe[ce]),k[Ae[ce]]=pe[Ae[ce]]||pe[xe[ce]]):(le.push(Ae[ce]),k[Ae[ce]]={"!ref":"A1"});return{SheetNames:le,Sheets:k}}function n(D,G){var O=G||{};if(+O.codepage>=0&&Kd(+O.codepage),O.type=="string")throw new Error("Cannot write WK1 to JS string");var L=Wn(),ie=Kt(D["!ref"]),ne=Array.isArray(D),me=[];$e(L,0,a(1030)),$e(L,6,c(ie));for(var pe=Math.min(ie.e.r,8191),xe=ie.s.r;xe<=pe;++xe)for(var Ae=nn(xe),ge=ie.s.c;ge<=ie.e.c;++ge){xe===ie.s.r&&(me[ge]=gn(ge));var je=me[ge]+Ae,k=ne?(D[xe]||[])[ge]:D[je];if(!(!k||k.t=="z"))if(k.t=="n")(k.v|0)==k.v&&k.v>=-32768&&k.v<=32767?$e(L,13,h(xe,ge,k.v)):$e(L,14,m(xe,ge,k.v));else{var le=gi(k);$e(L,15,f(xe,ge,le.slice(0,239)))}}return $e(L,1),L.end()}function s(D,G){var O=G||{};if(+O.codepage>=0&&Kd(+O.codepage),O.type=="string")throw new Error("Cannot write WK3 to JS string");var L=Wn();$e(L,0,o(D));for(var ie=0,ne=0;ie<D.SheetNames.length;++ie)(D.Sheets[D.SheetNames[ie]]||{})["!ref"]&&$e(L,27,U(D.SheetNames[ie],ne++));var me=0;for(ie=0;ie<D.SheetNames.length;++ie){var pe=D.Sheets[D.SheetNames[ie]];if(!(!pe||!pe["!ref"])){for(var xe=Kt(pe["!ref"]),Ae=Array.isArray(pe),ge=[],je=Math.min(xe.e.r,8191),k=xe.s.r;k<=je;++k)for(var le=nn(k),ce=xe.s.c;ce<=xe.e.c;++ce){k===xe.s.r&&(ge[ce]=gn(ce));var H=ge[ce]+le,K=Ae?(pe[k]||[])[ce]:pe[H];if(!(!K||K.t=="z"))if(K.t=="n")$e(L,23,P(k,ce,me,K.v));else{var oe=gi(K);$e(L,22,N(k,ce,me,oe.slice(0,239)))}}++me}}return $e(L,1),L.end()}function a(D){var G=Se(2);return G.write_shift(2,D),G}function o(D){var G=Se(26);G.write_shift(2,4096),G.write_shift(2,4),G.write_shift(4,0);for(var O=0,L=0,ie=0,ne=0;ne<D.SheetNames.length;++ne){var me=D.SheetNames[ne],pe=D.Sheets[me];if(!(!pe||!pe["!ref"])){++ie;var xe=ds(pe["!ref"]);O<xe.e.r&&(O=xe.e.r),L<xe.e.c&&(L=xe.e.c)}}return O>8191&&(O=8191),G.write_shift(2,O),G.write_shift(1,ie),G.write_shift(1,L),G.write_shift(2,0),G.write_shift(2,0),G.write_shift(1,1),G.write_shift(1,2),G.write_shift(4,0),G.write_shift(4,0),G}function l(D,G,O){var L={s:{c:0,r:0},e:{c:0,r:0}};return G==8&&O.qpro?(L.s.c=D.read_shift(1),D.l++,L.s.r=D.read_shift(2),L.e.c=D.read_shift(1),D.l++,L.e.r=D.read_shift(2),L):(L.s.c=D.read_shift(2),L.s.r=D.read_shift(2),G==12&&O.qpro&&(D.l+=2),L.e.c=D.read_shift(2),L.e.r=D.read_shift(2),G==12&&O.qpro&&(D.l+=2),L.s.c==65535&&(L.s.c=L.e.c=L.s.r=L.e.r=0),L)}function c(D){var G=Se(8);return G.write_shift(2,D.s.c),G.write_shift(2,D.s.r),G.write_shift(2,D.e.c),G.write_shift(2,D.e.r),G}function u(D,G,O){var L=[{c:0,r:0},{t:"n",v:0},0,0];return O.qpro&&O.vers!=20768?(L[0].c=D.read_shift(1),L[3]=D.read_shift(1),L[0].r=D.read_shift(2),D.l+=2):(L[2]=D.read_shift(1),L[0].c=D.read_shift(2),L[0].r=D.read_shift(2)),L}function d(D,G,O){var L=D.l+G,ie=u(D,G,O);if(ie[1].t="s",O.vers==20768){D.l++;var ne=D.read_shift(1);return ie[1].v=D.read_shift(ne,"utf8"),ie}return O.qpro&&D.l++,ie[1].v=D.read_shift(L-D.l,"cstr"),ie}function f(D,G,O){var L=Se(7+O.length);L.write_shift(1,255),L.write_shift(2,G),L.write_shift(2,D),L.write_shift(1,39);for(var ie=0;ie<L.length;++ie){var ne=O.charCodeAt(ie);L.write_shift(1,ne>=128?95:ne)}return L.write_shift(1,0),L}function p(D,G,O){var L=u(D,G,O);return L[1].v=D.read_shift(2,"i"),L}function h(D,G,O){var L=Se(7);return L.write_shift(1,255),L.write_shift(2,G),L.write_shift(2,D),L.write_shift(2,O,"i"),L}function g(D,G,O){var L=u(D,G,O);return L[1].v=D.read_shift(8,"f"),L}function m(D,G,O){var L=Se(13);return L.write_shift(1,255),L.write_shift(2,G),L.write_shift(2,D),L.write_shift(8,O,"f"),L}function x(D,G,O){var L=D.l+G,ie=u(D,G,O);if(ie[1].v=D.read_shift(8,"f"),O.qpro)D.l=L;else{var ne=D.read_shift(2);b(D.slice(D.l,D.l+ne),ie),D.l+=ne}return ie}function w(D,G,O){var L=G&32768;return G&=-32769,G=(L?D:0)+(G>=8192?G-16384:G),(L?"":"$")+(O?gn(G):nn(G))}var v={51:["FALSE",0],52:["TRUE",0],70:["LEN",1],80:["SUM",69],81:["AVERAGEA",69],82:["COUNTA",69],83:["MINA",69],84:["MAXA",69],111:["T",1]},_=["","","","","","","","","","+","-","*","/","^","=","<>","<=",">=","<",">","","","","","&","","","","","","",""];function b(D,G){es(D,0);for(var O=[],L=0,ie="",ne="",me="",pe="";D.l<D.length;){var xe=D[D.l++];switch(xe){case 0:O.push(D.read_shift(8,"f"));break;case 1:ne=w(G[0].c,D.read_shift(2),!0),ie=w(G[0].r,D.read_shift(2),!1),O.push(ne+ie);break;case 2:{var Ae=w(G[0].c,D.read_shift(2),!0),ge=w(G[0].r,D.read_shift(2),!1);ne=w(G[0].c,D.read_shift(2),!0),ie=w(G[0].r,D.read_shift(2),!1),O.push(Ae+ge+":"+ne+ie)}break;case 3:if(D.l<D.length){console.error("WK1 premature formula end");return}break;case 4:O.push("("+O.pop()+")");break;case 5:O.push(D.read_shift(2));break;case 6:{for(var je="";xe=D[D.l++];)je+=String.fromCharCode(xe);O.push('"'+je.replace(/"/g,'""')+'"')}break;case 8:O.push("-"+O.pop());break;case 23:O.push("+"+O.pop());break;case 22:O.push("NOT("+O.pop()+")");break;case 20:case 21:pe=O.pop(),me=O.pop(),O.push(["AND","OR"][xe-20]+"("+me+","+pe+")");break;default:if(xe<32&&_[xe])pe=O.pop(),me=O.pop(),O.push(me+_[xe]+pe);else if(v[xe]){if(L=v[xe][1],L==69&&(L=D[D.l++]),L>O.length){console.error("WK1 bad formula parse 0x"+xe.toString(16)+":|"+O.join("|")+"|");return}var k=O.slice(-L);O.length-=L,O.push(v[xe][0]+"("+k.join(",")+")")}else return xe<=7?console.error("WK1 invalid opcode "+xe.toString(16)):xe<=24?console.error("WK1 unsupported op "+xe.toString(16)):xe<=30?console.error("WK1 invalid opcode "+xe.toString(16)):xe<=115?console.error("WK1 unsupported function opcode "+xe.toString(16)):console.error("WK1 unrecognized opcode "+xe.toString(16))}}O.length==1?G[1].f=""+O[0]:console.error("WK1 bad formula parse |"+O.join("|")+"|")}function S(D){var G=[{c:0,r:0},{t:"n",v:0},0];return G[0].r=D.read_shift(2),G[3]=D[D.l++],G[0].c=D[D.l++],G}function T(D,G){var O=S(D);return O[1].t="s",O[1].v=D.read_shift(G-4,"cstr"),O}function N(D,G,O,L){var ie=Se(6+L.length);ie.write_shift(2,D),ie.write_shift(1,O),ie.write_shift(1,G),ie.write_shift(1,39);for(var ne=0;ne<L.length;++ne){var me=L.charCodeAt(ne);ie.write_shift(1,me>=128?95:me)}return ie.write_shift(1,0),ie}function C(D,G){var O=S(D);O[1].v=D.read_shift(2);var L=O[1].v>>1;if(O[1].v&1)switch(L&7){case 0:L=(L>>3)*5e3;break;case 1:L=(L>>3)*500;break;case 2:L=(L>>3)/20;break;case 3:L=(L>>3)/200;break;case 4:L=(L>>3)/2e3;break;case 5:L=(L>>3)/2e4;break;case 6:L=(L>>3)/16;break;case 7:L=(L>>3)/64;break}return O[1].v=L,O}function E(D,G){var O=S(D),L=D.read_shift(4),ie=D.read_shift(4),ne=D.read_shift(2);if(ne==65535)return L===0&&ie===3221225472?(O[1].t="e",O[1].v=15):L===0&&ie===3489660928?(O[1].t="e",O[1].v=42):O[1].v=0,O;var me=ne&32768;return ne=(ne&32767)-16446,O[1].v=(1-me*2)*(ie*Math.pow(2,ne+32)+L*Math.pow(2,ne)),O}function P(D,G,O,L){var ie=Se(14);if(ie.write_shift(2,D),ie.write_shift(1,O),ie.write_shift(1,G),L==0)return ie.write_shift(4,0),ie.write_shift(4,0),ie.write_shift(2,65535),ie;var ne=0,me=0,pe=0,xe=0;return L<0&&(ne=1,L=-L),me=Math.log2(L)|0,L/=Math.pow(2,me-31),xe=L>>>0,xe&2147483648||(L/=2,++me,xe=L>>>0),L-=xe,xe|=2147483648,xe>>>=0,L*=Math.pow(2,32),pe=L>>>0,ie.write_shift(4,pe),ie.write_shift(4,xe),me+=16383+(ne?32768:0),ie.write_shift(2,me),ie}function R(D,G){var O=E(D);return D.l+=G-14,O}function j(D,G){var O=S(D),L=D.read_shift(4);return O[1].v=L>>6,O}function M(D,G){var O=S(D),L=D.read_shift(8,"f");return O[1].v=L,O}function A(D,G){var O=M(D);return D.l+=G-10,O}function I(D,G){return D[D.l+G-1]==0?D.read_shift(G,"cstr"):""}function X(D,G){var O=D[D.l++];O>G-1&&(O=G-1);for(var L="";L.length<O;)L+=String.fromCharCode(D[D.l++]);return L}function Y(D,G,O){if(!(!O.qpro||G<21)){var L=D.read_shift(1);D.l+=17,D.l+=1,D.l+=2;var ie=D.read_shift(G-21,"cstr");return[L,ie]}}function z(D,G){for(var O={},L=D.l+G;D.l<L;){var ie=D.read_shift(2);if(ie==14e3){for(O[ie]=[0,""],O[ie][0]=D.read_shift(2);D[D.l];)O[ie][1]+=String.fromCharCode(D[D.l]),D.l++;D.l++}}return O}function U(D,G){var O=Se(5+D.length);O.write_shift(2,14e3),O.write_shift(2,G);for(var L=0;L<D.length;++L){var ie=D.charCodeAt(L);O[O.l++]=ie>127?95:ie}return O[O.l++]=0,O}var V={0:{n:"BOF",f:bA},1:{n:"EOF"},2:{n:"CALCMODE"},3:{n:"CALCORDER"},4:{n:"SPLIT"},5:{n:"SYNC"},6:{n:"RANGE",f:l},7:{n:"WINDOW1"},8:{n:"COLW1"},9:{n:"WINTWO"},10:{n:"COLW2"},11:{n:"NAME"},12:{n:"BLANK"},13:{n:"INTEGER",f:p},14:{n:"NUMBER",f:g},15:{n:"LABEL",f:d},16:{n:"FORMULA",f:x},24:{n:"TABLE"},25:{n:"ORANGE"},26:{n:"PRANGE"},27:{n:"SRANGE"},28:{n:"FRANGE"},29:{n:"KRANGE1"},32:{n:"HRANGE"},35:{n:"KRANGE2"},36:{n:"PROTEC"},37:{n:"FOOTER"},38:{n:"HEADER"},39:{n:"SETUP"},40:{n:"MARGINS"},41:{n:"LABELFMT"},42:{n:"TITLES"},43:{n:"SHEETJS"},45:{n:"GRAPH"},46:{n:"NGRAPH"},47:{n:"CALCCOUNT"},48:{n:"UNFORMATTED"},49:{n:"CURSORW12"},50:{n:"WINDOW"},51:{n:"STRING",f:d},55:{n:"PASSWORD"},56:{n:"LOCKED"},60:{n:"QUERY"},61:{n:"QUERYNAME"},62:{n:"PRINT"},63:{n:"PRINTNAME"},64:{n:"GRAPH2"},65:{n:"GRAPHNAME"},66:{n:"ZOOM"},67:{n:"SYMSPLIT"},68:{n:"NSROWS"},69:{n:"NSCOLS"},70:{n:"RULER"},71:{n:"NNAME"},72:{n:"ACOMM"},73:{n:"AMACRO"},74:{n:"PARSE"},102:{n:"PRANGES??"},103:{n:"RRANGES??"},104:{n:"FNAME??"},105:{n:"MRANGES??"},204:{n:"SHEETNAMECS",f:I},222:{n:"SHEETNAMELP",f:X},65535:{n:""}},F={0:{n:"BOF"},1:{n:"EOF"},2:{n:"PASSWORD"},3:{n:"CALCSET"},4:{n:"WINDOWSET"},5:{n:"SHEETCELLPTR"},6:{n:"SHEETLAYOUT"},7:{n:"COLUMNWIDTH"},8:{n:"HIDDENCOLUMN"},9:{n:"USERRANGE"},10:{n:"SYSTEMRANGE"},11:{n:"ZEROFORCE"},12:{n:"SORTKEYDIR"},13:{n:"FILESEAL"},14:{n:"DATAFILLNUMS"},15:{n:"PRINTMAIN"},16:{n:"PRINTSTRING"},17:{n:"GRAPHMAIN"},18:{n:"GRAPHSTRING"},19:{n:"??"},20:{n:"ERRCELL"},21:{n:"NACELL"},22:{n:"LABEL16",f:T},23:{n:"NUMBER17",f:E},24:{n:"NUMBER18",f:C},25:{n:"FORMULA19",f:R},26:{n:"FORMULA1A"},27:{n:"XFORMAT",f:z},28:{n:"DTLABELMISC"},29:{n:"DTLABELCELL"},30:{n:"GRAPHWINDOW"},31:{n:"CPA"},32:{n:"LPLAUTO"},33:{n:"QUERY"},34:{n:"HIDDENSHEET"},35:{n:"??"},37:{n:"NUMBER25",f:j},38:{n:"??"},39:{n:"NUMBER27",f:M},40:{n:"FORMULA28",f:A},142:{n:"??"},147:{n:"??"},150:{n:"??"},151:{n:"??"},152:{n:"??"},153:{n:"??"},154:{n:"??"},155:{n:"??"},156:{n:"??"},163:{n:"??"},174:{n:"??"},175:{n:"??"},176:{n:"??"},177:{n:"??"},184:{n:"??"},185:{n:"??"},186:{n:"??"},187:{n:"??"},188:{n:"??"},195:{n:"??"},201:{n:"??"},204:{n:"SHEETNAMECS",f:I},205:{n:"??"},206:{n:"??"},207:{n:"??"},208:{n:"??"},256:{n:"??"},259:{n:"??"},260:{n:"??"},261:{n:"??"},262:{n:"??"},263:{n:"??"},265:{n:"??"},266:{n:"??"},267:{n:"??"},268:{n:"??"},270:{n:"??"},271:{n:"??"},384:{n:"??"},389:{n:"??"},390:{n:"??"},393:{n:"??"},396:{n:"??"},512:{n:"??"},514:{n:"??"},513:{n:"??"},516:{n:"??"},517:{n:"??"},640:{n:"??"},641:{n:"??"},642:{n:"??"},643:{n:"??"},644:{n:"??"},645:{n:"??"},646:{n:"??"},647:{n:"??"},648:{n:"??"},658:{n:"??"},659:{n:"??"},660:{n:"??"},661:{n:"??"},662:{n:"??"},665:{n:"??"},666:{n:"??"},768:{n:"??"},772:{n:"??"},1537:{n:"SHEETINFOQP",f:Y},1600:{n:"??"},1602:{n:"??"},1793:{n:"??"},1794:{n:"??"},1795:{n:"??"},1796:{n:"??"},1920:{n:"??"},2048:{n:"??"},2049:{n:"??"},2052:{n:"??"},2688:{n:"??"},10998:{n:"??"},12849:{n:"??"},28233:{n:"??"},28484:{n:"??"},65535:{n:""}};return{sheet_to_wk1:n,book_to_wk3:s,to_workbook:t}}(),NH=/^\s|\s$|[\t\n\r]/;function CA(e,t){if(!t.bookSST)return"";var r=[Tr];r[r.length]=Le("sst",null,{xmlns:fu[0],count:e.Count,uniqueCount:e.Unique});for(var n=0;n!=e.length;++n)if(e[n]!=null){var s=e[n],a="<si>";s.r?a+=s.r:(a+="<t",s.t||(s.t=""),s.t.match(NH)&&(a+=' xml:space="preserve"'),a+=">"+Ft(s.t)+"</t>"),a+="</si>",r[r.length]=a}return r.length>2&&(r[r.length]="</sst>",r[1]=r[1].replace("/>",">")),r.join("")}function jH(e){return[e.read_shift(4),e.read_shift(4)]}function EH(e,t){return t||(t=Se(8)),t.write_shift(4,e.Count),t.write_shift(4,e.Unique),t}var kH=xW;function CH(e){var t=Wn();Pe(t,159,EH(e));for(var r=0;r<e.length;++r)Pe(t,19,kH(e[r]));return Pe(t,160),t.end()}function TH(e){for(var t=[],r=e.split(""),n=0;n<r.length;++n)t[n]=r[n].charCodeAt(0);return t}function TA(e){var t=0,r,n=TH(e),s=n.length+1,a,o,l,c,u;for(r=cl(s),r[0]=n.length,a=1;a!=s;++a)r[a]=n[a-1];for(a=s-1;a>=0;--a)o=r[a],l=t&16384?1:0,c=t<<1&32767,u=l|c,t=u^o;return t^52811}var AH=function(){function e(s,a){switch(a.type){case"base64":return t(pi(s),a);case"binary":return t(s,a);case"buffer":return t(At&&Buffer.isBuffer(s)?s.toString("binary"):$f(s),a);case"array":return t(Rp(s),a)}throw new Error("Unrecognized type "+a.type)}function t(s,a){var o=a||{},l=o.dense?[]:{},c=s.match(/\\trowd.*?\\row\b/g);if(!c.length)throw new Error("RTF missing table");var u={s:{c:0,r:0},e:{c:0,r:c.length-1}};return c.forEach(function(d,f){Array.isArray(l)&&(l[f]=[]);for(var p=/\\\w+\b/g,h=0,g,m=-1;g=p.exec(d);){switch(g[0]){case"\\cell":var x=d.slice(h,p.lastIndex-g[0].length);if(x[0]==" "&&(x=x.slice(1)),++m,x.length){var w={v:x,t:"s"};Array.isArray(l)?l[f][m]=w:l[Lt({r:f,c:m})]=w}break}h=p.lastIndex}m>u.e.c&&(u.e.c=m)}),l["!ref"]=Cr(u),l}function r(s,a){return Sl(e(s,a),a)}function n(s){for(var a=["{\\rtf1\\ansi"],o=Kt(s["!ref"]),l,c=Array.isArray(s),u=o.s.r;u<=o.e.r;++u){a.push("\\trowd\\trautofit1");for(var d=o.s.c;d<=o.e.c;++d)a.push("\\cellx"+(d+1));for(a.push("\\pard\\intbl"),d=o.s.c;d<=o.e.c;++d){var f=Lt({r:u,c:d});l=c?(s[u]||[])[d]:s[f],!(!l||l.v==null&&(!l.f||l.F))&&(a.push(" "+(l.w||(gi(l),l.w))),a.push("\\cell"))}a.push("\\pard\\intbl\\row")}return a.join("")+"}"}return{to_workbook:r,to_sheet:e,from_sheet:n}}();function NS(e){for(var t=0,r=1;t!=3;++t)r=r*256+(e[t]>255?255:e[t]<0?0:e[t]);return r.toString(16).toUpperCase().slice(1)}var PH=6,ai=PH;function u0(e){return Math.floor((e+Math.round(128/ai)/256)*ai)}function d0(e){return Math.floor((e-5)/ai*100+.5)/100}function Qv(e){return Math.round((e*ai+5)/ai*256)/256}function ww(e){e.width?(e.wpx=u0(e.width),e.wch=d0(e.wpx),e.MDW=ai):e.wpx?(e.wch=d0(e.wpx),e.width=Qv(e.wch),e.MDW=ai):typeof e.wch=="number"&&(e.width=Qv(e.wch),e.wpx=u0(e.width),e.MDW=ai),e.customWidth&&delete e.customWidth}var DH=96,AA=DH;function f0(e){return e*96/AA}function PA(e){return e*AA/96}function RH(e){var t=["<numFmts>"];return[[5,8],[23,26],[41,44],[50,392]].forEach(function(r){for(var n=r[0];n<=r[1];++n)e[n]!=null&&(t[t.length]=Le("numFmt",null,{numFmtId:n,formatCode:Ft(e[n])}))}),t.length===1?"":(t[t.length]="</numFmts>",t[0]=Le("numFmts",null,{count:t.length-2}).replace("/>",">"),t.join(""))}function MH(e){var t=[];return t[t.length]=Le("cellXfs",null),e.forEach(function(r){t[t.length]=Le("xf",null,r)}),t[t.length]="</cellXfs>",t.length===2?"":(t[0]=Le("cellXfs",null,{count:t.length-2}).replace("/>",">"),t.join(""))}function DA(e,t){var r=[Tr,Le("styleSheet",null,{xmlns:fu[0],"xmlns:vt":Vr.vt})],n;return e.SSF&&(n=RH(e.SSF))!=null&&(r[r.length]=n),r[r.length]='<fonts count="1"><font><sz val="12"/><color theme="1"/><name val="Calibri"/><family val="2"/><scheme val="minor"/></font></fonts>',r[r.length]='<fills count="2"><fill><patternFill patternType="none"/></fill><fill><patternFill patternType="gray125"/></fill></fills>',r[r.length]='<borders count="1"><border><left/><right/><top/><bottom/><diagonal/></border></borders>',r[r.length]='<cellStyleXfs count="1"><xf numFmtId="0" fontId="0" fillId="0" borderId="0"/></cellStyleXfs>',(n=MH(t.cellXfs))&&(r[r.length]=n),r[r.length]='<cellStyles count="1"><cellStyle name="Normal" xfId="0" builtinId="0"/></cellStyles>',r[r.length]='<dxfs count="0"/>',r[r.length]='<tableStyles count="0" defaultTableStyle="TableStyleMedium9" defaultPivotStyle="PivotStyleMedium4"/>',r.length>2&&(r[r.length]="</styleSheet>",r[1]=r[1].replace("/>",">")),r.join("")}function OH(e,t){var r=e.read_shift(2),n=xn(e);return[r,n]}function FH(e,t,r){r||(r=Se(6+4*t.length)),r.write_shift(2,e),Hr(t,r);var n=r.length>r.l?r.slice(0,r.l):r;return r.l==null&&(r.l=r.length),n}function IH(e,t,r){var n={};n.sz=e.read_shift(2)/20;var s=NW(e);s.fItalic&&(n.italic=1),s.fCondense&&(n.condense=1),s.fExtend&&(n.extend=1),s.fShadow&&(n.shadow=1),s.fOutline&&(n.outline=1),s.fStrikeout&&(n.strike=1);var a=e.read_shift(2);switch(a===700&&(n.bold=1),e.read_shift(2)){case 1:n.vertAlign="superscript";break;case 2:n.vertAlign="subscript";break}var o=e.read_shift(1);o!=0&&(n.underline=o);var l=e.read_shift(1);l>0&&(n.family=l);var c=e.read_shift(1);switch(c>0&&(n.charset=c),e.l++,n.color=SW(e),e.read_shift(1)){case 1:n.scheme="major";break;case 2:n.scheme="minor";break}return n.name=xn(e),n}function LH(e,t){t||(t=Se(25+4*32)),t.write_shift(2,e.sz*20),jW(e,t),t.write_shift(2,e.bold?700:400);var r=0;e.vertAlign=="superscript"?r=1:e.vertAlign=="subscript"&&(r=2),t.write_shift(2,r),t.write_shift(1,e.underline||0),t.write_shift(1,e.family||0),t.write_shift(1,e.charset||0),t.write_shift(1,0),l0(e.color,t);var n=0;return n=2,t.write_shift(1,n),Hr(e.name,t),t.length>t.l?t.slice(0,t.l):t}var $H=["none","solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"],cx,BH=Ra;function jS(e,t){t||(t=Se(4*3+8*7+16*1)),cx||(cx=lw($H));var r=cx[e.patternType];r==null&&(r=40),t.write_shift(4,r);var n=0;if(r!=40)for(l0({auto:1},t),l0({auto:1},t);n<12;++n)t.write_shift(4,0);else{for(;n<4;++n)t.write_shift(4,0);for(;n<12;++n)t.write_shift(4,0)}return t.length>t.l?t.slice(0,t.l):t}function UH(e,t){var r=e.l+t,n=e.read_shift(2),s=e.read_shift(2);return e.l=r,{ixfe:n,numFmtId:s}}function RA(e,t,r){r||(r=Se(16)),r.write_shift(2,t||0),r.write_shift(2,e.numFmtId||0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(1,0),r.write_shift(1,0);var n=0;return r.write_shift(1,n),r.write_shift(1,0),r.write_shift(1,0),r.write_shift(1,0),r}function Fu(e,t){return t||(t=Se(10)),t.write_shift(1,0),t.write_shift(1,0),t.write_shift(4,0),t.write_shift(4,0),t}var zH=Ra;function VH(e,t){return t||(t=Se(51)),t.write_shift(1,0),Fu(null,t),Fu(null,t),Fu(null,t),Fu(null,t),Fu(null,t),t.length>t.l?t.slice(0,t.l):t}function WH(e,t){return t||(t=Se(12+4*10)),t.write_shift(4,e.xfId),t.write_shift(2,1),t.write_shift(1,0),t.write_shift(1,0),o0(e.name||"",t),t.length>t.l?t.slice(0,t.l):t}function HH(e,t,r){var n=Se(2052);return n.write_shift(4,e),o0(t,n),o0(r,n),n.length>n.l?n.slice(0,n.l):n}function GH(e,t){if(t){var r=0;[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var s=n[0];s<=n[1];++s)t[s]!=null&&++r}),r!=0&&(Pe(e,615,na(r)),[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var s=n[0];s<=n[1];++s)t[s]!=null&&Pe(e,44,FH(s,t[s]))}),Pe(e,616))}}function qH(e){var t=1;Pe(e,611,na(t)),Pe(e,43,LH({sz:12,color:{theme:1},name:"Calibri",family:2})),Pe(e,612)}function YH(e){var t=2;Pe(e,603,na(t)),Pe(e,45,jS({patternType:"none"})),Pe(e,45,jS({patternType:"gray125"})),Pe(e,604)}function KH(e){var t=1;Pe(e,613,na(t)),Pe(e,46,VH()),Pe(e,614)}function XH(e){var t=1;Pe(e,626,na(t)),Pe(e,47,RA({numFmtId:0},65535)),Pe(e,627)}function QH(e,t){Pe(e,617,na(t.length)),t.forEach(function(r){Pe(e,47,RA(r,0))}),Pe(e,618)}function JH(e){var t=1;Pe(e,619,na(t)),Pe(e,48,WH({xfId:0,name:"Normal"})),Pe(e,620)}function ZH(e){var t=0;Pe(e,505,na(t)),Pe(e,506)}function eG(e){var t=0;Pe(e,508,HH(t,"TableStyleMedium9","PivotStyleMedium4")),Pe(e,509)}function tG(e,t){var r=Wn();return Pe(r,278),GH(r,e.SSF),qH(r),YH(r),KH(r),XH(r),QH(r,t.cellXfs),JH(r),ZH(r),eG(r),Pe(r,279),r.end()}function MA(e,t){if(t&&t.themeXLSX)return t.themeXLSX;if(e&&typeof e.raw=="string")return e.raw;var r=[Tr];return r[r.length]='<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme">',r[r.length]="<a:themeElements>",r[r.length]='<a:clrScheme name="Office">',r[r.length]='<a:dk1><a:sysClr val="windowText" lastClr="000000"/></a:dk1>',r[r.length]='<a:lt1><a:sysClr val="window" lastClr="FFFFFF"/></a:lt1>',r[r.length]='<a:dk2><a:srgbClr val="1F497D"/></a:dk2>',r[r.length]='<a:lt2><a:srgbClr val="EEECE1"/></a:lt2>',r[r.length]='<a:accent1><a:srgbClr val="4F81BD"/></a:accent1>',r[r.length]='<a:accent2><a:srgbClr val="C0504D"/></a:accent2>',r[r.length]='<a:accent3><a:srgbClr val="9BBB59"/></a:accent3>',r[r.length]='<a:accent4><a:srgbClr val="8064A2"/></a:accent4>',r[r.length]='<a:accent5><a:srgbClr val="4BACC6"/></a:accent5>',r[r.length]='<a:accent6><a:srgbClr val="F79646"/></a:accent6>',r[r.length]='<a:hlink><a:srgbClr val="0000FF"/></a:hlink>',r[r.length]='<a:folHlink><a:srgbClr val="800080"/></a:folHlink>',r[r.length]="</a:clrScheme>",r[r.length]='<a:fontScheme name="Office">',r[r.length]="<a:majorFont>",r[r.length]='<a:latin typeface="Cambria"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface=" "/>',r[r.length]='<a:font script="Hang" typeface=" "/>',r[r.length]='<a:font script="Hans" typeface=""/>',r[r.length]='<a:font script="Hant" typeface=""/>',r[r.length]='<a:font script="Arab" typeface="Times New Roman"/>',r[r.length]='<a:font script="Hebr" typeface="Times New Roman"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="MoolBoran"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Times New Roman"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:majorFont>",r[r.length]="<a:minorFont>",r[r.length]='<a:latin typeface="Calibri"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface=" "/>',r[r.length]='<a:font script="Hang" typeface=" "/>',r[r.length]='<a:font script="Hans" typeface=""/>',r[r.length]='<a:font script="Hant" typeface=""/>',r[r.length]='<a:font script="Arab" typeface="Arial"/>',r[r.length]='<a:font script="Hebr" typeface="Arial"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="DaunPenh"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Arial"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:minorFont>",r[r.length]="</a:fontScheme>",r[r.length]='<a:fmtScheme name="Office">',r[r.length]="<a:fillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="50000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="15000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="1"/>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="100000"/><a:shade val="100000"/><a:satMod val="130000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="50000"/><a:shade val="100000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="0"/>',r[r.length]="</a:gradFill>",r[r.length]="</a:fillStyleLst>",r[r.length]="<a:lnStyleLst>",r[r.length]='<a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"><a:shade val="95000"/><a:satMod val="105000"/></a:schemeClr></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]="</a:lnStyleLst>",r[r.length]="<a:effectStyleLst>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="38000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]='<a:scene3d><a:camera prst="orthographicFront"><a:rot lat="0" lon="0" rev="0"/></a:camera><a:lightRig rig="threePt" dir="t"><a:rot lat="0" lon="0" rev="1200000"/></a:lightRig></a:scene3d>',r[r.length]='<a:sp3d><a:bevelT w="63500" h="25400"/></a:sp3d>',r[r.length]="</a:effectStyle>",r[r.length]="</a:effectStyleLst>",r[r.length]="<a:bgFillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000"/><a:shade val="99000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="20000"/><a:satMod val="255000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="80000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="30000"/><a:satMod val="200000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]="</a:bgFillStyleLst>",r[r.length]="</a:fmtScheme>",r[r.length]="</a:themeElements>",r[r.length]="<a:objectDefaults>",r[r.length]="<a:spDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="1"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="3"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="2"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="lt1"/></a:fontRef></a:style>',r[r.length]="</a:spDef>",r[r.length]="<a:lnDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="2"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="0"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="1"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="tx1"/></a:fontRef></a:style>',r[r.length]="</a:lnDef>",r[r.length]="</a:objectDefaults>",r[r.length]="<a:extraClrSchemeLst/>",r[r.length]="</a:theme>",r.join("")}function rG(e,t){return{flags:e.read_shift(4),version:e.read_shift(4),name:xn(e)}}function nG(e){var t=Se(12+2*e.name.length);return t.write_shift(4,e.flags),t.write_shift(4,e.version),Hr(e.name,t),t.slice(0,t.l)}function sG(e){for(var t=[],r=e.read_shift(4);r-- >0;)t.push([e.read_shift(4),e.read_shift(4)]);return t}function aG(e){var t=Se(4+8*e.length);t.write_shift(4,e.length);for(var r=0;r<e.length;++r)t.write_shift(4,e[r][0]),t.write_shift(4,e[r][1]);return t}function iG(e,t){var r=Se(8+2*t.length);return r.write_shift(4,e),Hr(t,r),r.slice(0,r.l)}function oG(e){return e.l+=4,e.read_shift(4)!=0}function lG(e,t){var r=Se(8);return r.write_shift(4,e),r.write_shift(4,1),r}function cG(){var e=Wn();return Pe(e,332),Pe(e,334,na(1)),Pe(e,335,nG({name:"XLDAPR",version:12e4,flags:3496657072})),Pe(e,336),Pe(e,339,iG(1,"XLDAPR")),Pe(e,52),Pe(e,35,na(514)),Pe(e,4096,na(0)),Pe(e,4097,ys(1)),Pe(e,36),Pe(e,53),Pe(e,340),Pe(e,337,lG(1)),Pe(e,51,aG([[1,0]])),Pe(e,338),Pe(e,333),e.end()}function OA(){var e=[Tr];return e.push(`<metadata xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main" xmlns:xlrd="http://schemas.microsoft.com/office/spreadsheetml/2017/richdata" xmlns:xda="http://schemas.microsoft.com/office/spreadsheetml/2017/dynamicarray">
  <metadataTypes count="1">
    <metadataType name="XLDAPR" minSupportedVersion="120000" copy="1" pasteAll="1" pasteValues="1" merge="1" splitFirst="1" rowColShift="1" clearFormats="1" clearComments="1" assign="1" coerce="1" cellMeta="1"/>
  </metadataTypes>
  <futureMetadata name="XLDAPR" count="1">
    <bk>
      <extLst>
        <ext uri="{bdbb8cdc-fa1e-496e-a857-3c3f30c029c3}">
          <xda:dynamicArrayProperties fDynamic="1" fCollapsed="0"/>
        </ext>
      </extLst>
    </bk>
  </futureMetadata>
  <cellMetadata count="1">
    <bk>
      <rc t="1" v="0"/>
    </bk>
  </cellMetadata>
</metadata>`),e.join("")}function uG(e){var t={};t.i=e.read_shift(4);var r={};r.r=e.read_shift(4),r.c=e.read_shift(4),t.r=Lt(r);var n=e.read_shift(1);return n&2&&(t.l="1"),n&8&&(t.a="1"),t}var ic=1024;function FA(e,t){for(var r=[21600,21600],n=["m0,0l0",r[1],r[0],r[1],r[0],"0xe"].join(","),s=[Le("xml",null,{"xmlns:v":rs.v,"xmlns:o":rs.o,"xmlns:x":rs.x,"xmlns:mv":rs.mv}).replace(/\/>/,">"),Le("o:shapelayout",Le("o:idmap",null,{"v:ext":"edit",data:e}),{"v:ext":"edit"}),Le("v:shapetype",[Le("v:stroke",null,{joinstyle:"miter"}),Le("v:path",null,{gradientshapeok:"t","o:connecttype":"rect"})].join(""),{id:"_x0000_t202","o:spt":202,coordsize:r.join(","),path:n})];ic<e*1e3;)ic+=1e3;return t.forEach(function(a){var o=Wr(a[0]),l={color2:"#BEFF82",type:"gradient"};l.type=="gradient"&&(l.angle="-180");var c=l.type=="gradient"?Le("o:fill",null,{type:"gradientUnscaled","v:ext":"view"}):null,u=Le("v:fill",c,l),d={on:"t",obscured:"t"};++ic,s=s.concat(["<v:shape"+Zd({id:"_x0000_s"+ic,type:"#_x0000_t202",style:"position:absolute; margin-left:80pt;margin-top:5pt;width:104pt;height:64pt;z-index:10"+(a[1].hidden?";visibility:hidden":""),fillcolor:"#ECFAD4",strokecolor:"#edeaa1"})+">",u,Le("v:shadow",null,d),Le("v:path",null,{"o:connecttype":"none"}),'<v:textbox><div style="text-align:left"></div></v:textbox>','<x:ClientData ObjectType="Note">',"<x:MoveWithCells/>","<x:SizeWithCells/>",Zr("x:Anchor",[o.c+1,0,o.r+1,0,o.c+3,20,o.r+5,20].join(",")),Zr("x:AutoFill","False"),Zr("x:Row",String(o.r)),Zr("x:Column",String(o.c)),a[1].hidden?"":"<x:Visible/>","</x:ClientData>","</v:shape>"])}),s.push("</xml>"),s.join("")}function IA(e){var t=[Tr,Le("comments",null,{xmlns:fu[0]})],r=[];return t.push("<authors>"),e.forEach(function(n){n[1].forEach(function(s){var a=Ft(s.a);r.indexOf(a)==-1&&(r.push(a),t.push("<author>"+a+"</author>")),s.T&&s.ID&&r.indexOf("tc="+s.ID)==-1&&(r.push("tc="+s.ID),t.push("<author>tc="+s.ID+"</author>"))})}),r.length==0&&(r.push("SheetJ5"),t.push("<author>SheetJ5</author>")),t.push("</authors>"),t.push("<commentList>"),e.forEach(function(n){var s=0,a=[];if(n[1][0]&&n[1][0].T&&n[1][0].ID?s=r.indexOf("tc="+n[1][0].ID):n[1].forEach(function(c){c.a&&(s=r.indexOf(Ft(c.a))),a.push(c.t||"")}),t.push('<comment ref="'+n[0]+'" authorId="'+s+'"><text>'),a.length<=1)t.push(Zr("t",Ft(a[0]||"")));else{for(var o=`Comment:
    `+a[0]+`
`,l=1;l<a.length;++l)o+=`Reply:
    `+a[l]+`
`;t.push(Zr("t",Ft(o)))}t.push("</text></comment>")}),t.push("</commentList>"),t.length>2&&(t[t.length]="</comments>",t[1]=t[1].replace("/>",">")),t.join("")}function dG(e,t,r){var n=[Tr,Le("ThreadedComments",null,{xmlns:Vr.TCMNT}).replace(/[\/]>/,">")];return e.forEach(function(s){var a="";(s[1]||[]).forEach(function(o,l){if(!o.T){delete o.ID;return}o.a&&t.indexOf(o.a)==-1&&t.push(o.a);var c={ref:s[0],id:"{54EE7951-7262-4200-6969-"+("000000000000"+r.tcid++).slice(-12)+"}"};l==0?a=c.id:c.parentId=a,o.ID=c.id,o.a&&(c.personId="{54EE7950-7262-4200-6969-"+("000000000000"+t.indexOf(o.a)).slice(-12)+"}"),n.push(Le("threadedComment",Zr("text",o.t||""),c))})}),n.push("</ThreadedComments>"),n.join("")}function fG(e){var t=[Tr,Le("personList",null,{xmlns:Vr.TCMNT,"xmlns:x":fu[0]}).replace(/[\/]>/,">")];return e.forEach(function(r,n){t.push(Le("person",null,{displayName:r,id:"{54EE7950-7262-4200-6969-"+("000000000000"+n).slice(-12)+"}",userId:r,providerId:"None"}))}),t.push("</personList>"),t.join("")}function hG(e){var t={};t.iauthor=e.read_shift(4);var r=kl(e);return t.rfx=r.s,t.ref=Lt(r.s),e.l+=16,t}function mG(e,t){return t==null&&(t=Se(36)),t.write_shift(4,e[1].iauthor),mu(e[0],t),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(4,0),t}var pG=xn;function gG(e){return Hr(e.slice(0,54))}function xG(e){var t=Wn(),r=[];return Pe(t,628),Pe(t,630),e.forEach(function(n){n[1].forEach(function(s){r.indexOf(s.a)>-1||(r.push(s.a.slice(0,54)),Pe(t,632,gG(s.a)))})}),Pe(t,631),Pe(t,633),e.forEach(function(n){n[1].forEach(function(s){s.iauthor=r.indexOf(s.a);var a={s:Wr(n[0]),e:Wr(n[0])};Pe(t,635,mG([a,s])),s.t&&s.t.length>0&&Pe(t,637,yW(s)),Pe(t,636),delete s.iauthor})}),Pe(t,634),Pe(t,629),t.end()}function vG(e,t){t.FullPaths.forEach(function(r,n){if(n!=0){var s=r.replace(/[^\/]*[\/]/,"/_VBA_PROJECT_CUR/");s.slice(-1)!=="/"&&Ut.utils.cfb_add(e,s,t.FileIndex[n].content)}})}var LA=["xlsb","xlsm","xlam","biff8","xla"],yG=function(){var e=/(^|[^A-Za-z_])R(\[?-?\d+\]|[1-9]\d*|)C(\[?-?\d+\]|[1-9]\d*|)(?![A-Za-z0-9_])/g,t={r:0,c:0};function r(n,s,a,o){var l=!1,c=!1;a.length==0?c=!0:a.charAt(0)=="["&&(c=!0,a=a.slice(1,-1)),o.length==0?l=!0:o.charAt(0)=="["&&(l=!0,o=o.slice(1,-1));var u=a.length>0?parseInt(a,10)|0:0,d=o.length>0?parseInt(o,10)|0:0;return l?d+=t.c:--d,c?u+=t.r:--u,s+(l?"":"$")+gn(d)+(c?"":"$")+nn(u)}return function(s,a){return t=a,s.replace(e,r)}}(),_w=/(^|[^._A-Z0-9])([$]?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])([$]?)(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})(?![_.\(A-Za-z0-9])/g,bw=function(){return function(t,r){return t.replace(_w,function(n,s,a,o,l,c){var u=pw(o)-(a?0:r.c),d=mw(c)-(l?0:r.r),f=d==0?"":l?d+1:"["+d+"]",p=u==0?"":a?u+1:"["+u+"]";return s+"R"+f+"C"+p})}}();function wG(e,t){return e.replace(_w,function(r,n,s,a,o,l){return n+(s=="$"?s+a:gn(pw(a)+t.c))+(o=="$"?o+l:nn(mw(l)+t.r))})}function _G(e){return e.length!=1}function br(e){e.l+=1}function ho(e,t){var r=e.read_shift(2);return[r&16383,r>>14&1,r>>15&1]}function $A(e,t,r){var n=2;if(r){if(r.biff>=2&&r.biff<=5)return BA(e);r.biff==12&&(n=4)}var s=e.read_shift(n),a=e.read_shift(n),o=ho(e),l=ho(e);return{s:{r:s,c:o[0],cRel:o[1],rRel:o[2]},e:{r:a,c:l[0],cRel:l[1],rRel:l[2]}}}function BA(e){var t=ho(e),r=ho(e),n=e.read_shift(1),s=e.read_shift(1);return{s:{r:t[0],c:n,cRel:t[1],rRel:t[2]},e:{r:r[0],c:s,cRel:r[1],rRel:r[2]}}}function bG(e,t,r){if(r.biff<8)return BA(e);var n=e.read_shift(r.biff==12?4:2),s=e.read_shift(r.biff==12?4:2),a=ho(e),o=ho(e);return{s:{r:n,c:a[0],cRel:a[1],rRel:a[2]},e:{r:s,c:o[0],cRel:o[1],rRel:o[2]}}}function UA(e,t,r){if(r&&r.biff>=2&&r.biff<=5)return SG(e);var n=e.read_shift(r&&r.biff==12?4:2),s=ho(e);return{r:n,c:s[0],cRel:s[1],rRel:s[2]}}function SG(e){var t=ho(e),r=e.read_shift(1);return{r:t[0],c:r,cRel:t[1],rRel:t[2]}}function NG(e){var t=e.read_shift(2),r=e.read_shift(2);return{r:t,c:r&255,fQuoted:!!(r&16384),cRel:r>>15,rRel:r>>15}}function jG(e,t,r){var n=r&&r.biff?r.biff:8;if(n>=2&&n<=5)return EG(e);var s=e.read_shift(n>=12?4:2),a=e.read_shift(2),o=(a&16384)>>14,l=(a&32768)>>15;if(a&=16383,l==1)for(;s>524287;)s-=1048576;if(o==1)for(;a>8191;)a=a-16384;return{r:s,c:a,cRel:o,rRel:l}}function EG(e){var t=e.read_shift(2),r=e.read_shift(1),n=(t&32768)>>15,s=(t&16384)>>14;return t&=16383,n==1&&t>=8192&&(t=t-16384),s==1&&r>=128&&(r=r-256),{r:t,c:r,cRel:s,rRel:n}}function kG(e,t,r){var n=(e[e.l++]&96)>>5,s=$A(e,r.biff>=2&&r.biff<=5?6:8,r);return[n,s]}function CG(e,t,r){var n=(e[e.l++]&96)>>5,s=e.read_shift(2,"i"),a=8;if(r)switch(r.biff){case 5:e.l+=12,a=6;break;case 12:a=12;break}var o=$A(e,a,r);return[n,s,o]}function TG(e,t,r){var n=(e[e.l++]&96)>>5;return e.l+=r&&r.biff>8?12:r.biff<8?6:8,[n]}function AG(e,t,r){var n=(e[e.l++]&96)>>5,s=e.read_shift(2),a=8;if(r)switch(r.biff){case 5:e.l+=12,a=6;break;case 12:a=12;break}return e.l+=a,[n,s]}function PG(e,t,r){var n=(e[e.l++]&96)>>5,s=bG(e,t-1,r);return[n,s]}function DG(e,t,r){var n=(e[e.l++]&96)>>5;return e.l+=r.biff==2?6:r.biff==12?14:7,[n]}function ES(e){var t=e[e.l+1]&1,r=1;return e.l+=4,[t,r]}function RG(e,t,r){e.l+=2;for(var n=e.read_shift(r&&r.biff==2?1:2),s=[],a=0;a<=n;++a)s.push(e.read_shift(r&&r.biff==2?1:2));return s}function MG(e,t,r){var n=e[e.l+1]&255?1:0;return e.l+=2,[n,e.read_shift(r&&r.biff==2?1:2)]}function OG(e,t,r){var n=e[e.l+1]&255?1:0;return e.l+=2,[n,e.read_shift(r&&r.biff==2?1:2)]}function FG(e){var t=e[e.l+1]&255?1:0;return e.l+=2,[t,e.read_shift(2)]}function IG(e,t,r){var n=e[e.l+1]&255?1:0;return e.l+=r&&r.biff==2?3:4,[n]}function zA(e){var t=e.read_shift(1),r=e.read_shift(1);return[t,r]}function LG(e){return e.read_shift(2),zA(e)}function $G(e){return e.read_shift(2),zA(e)}function BG(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var s=UA(e,0,r);return[n,s]}function UG(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var s=jG(e,0,r);return[n,s]}function zG(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var s=e.read_shift(2);r&&r.biff==5&&(e.l+=12);var a=UA(e,0,r);return[n,s,a]}function VG(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var s=e.read_shift(r&&r.biff<=3?1:2);return[Vq[s],HA[s],n]}function WG(e,t,r){var n=e[e.l++],s=e.read_shift(1),a=r&&r.biff<=3?[n==88?-1:0,e.read_shift(1)]:HG(e);return[s,(a[0]===0?HA:zq)[a[1]]]}function HG(e){return[e[e.l+1]>>7,e.read_shift(2)&32767]}function GG(e,t,r){e.l+=r&&r.biff==2?3:4}function qG(e,t,r){if(e.l++,r&&r.biff==12)return[e.read_shift(4,"i"),0];var n=e.read_shift(2),s=e.read_shift(r&&r.biff==2?1:2);return[n,s]}function YG(e){return e.l++,zf[e.read_shift(1)]}function KG(e){return e.l++,e.read_shift(2)}function XG(e){return e.l++,e.read_shift(1)!==0}function QG(e){return e.l++,pu(e)}function JG(e,t,r){return e.l++,NA(e,t-1,r)}function ZG(e,t){var r=[e.read_shift(1)];if(t==12)switch(r[0]){case 2:r[0]=4;break;case 4:r[0]=16;break;case 0:r[0]=1;break;case 1:r[0]=2;break}switch(r[0]){case 4:r[1]=zW(e,1)?"TRUE":"FALSE",t!=12&&(e.l+=7);break;case 37:case 16:r[1]=zf[e[e.l]],e.l+=t==12?4:8;break;case 0:e.l+=8;break;case 1:r[1]=pu(e);break;case 2:r[1]=GW(e,0,{biff:t>0&&t<8?2:t});break;default:throw new Error("Bad SerAr: "+r[0])}return r}function eq(e,t,r){for(var n=e.read_shift(r.biff==12?4:2),s=[],a=0;a!=n;++a)s.push((r.biff==12?kl:KW)(e));return s}function tq(e,t,r){var n=0,s=0;r.biff==12?(n=e.read_shift(4),s=e.read_shift(4)):(s=1+e.read_shift(1),n=1+e.read_shift(2)),r.biff>=2&&r.biff<8&&(--n,--s==0&&(s=256));for(var a=0,o=[];a!=n&&(o[a]=[]);++a)for(var l=0;l!=s;++l)o[a][l]=ZG(e,r.biff);return o}function rq(e,t,r){var n=e.read_shift(1)>>>5&3,s=!r||r.biff>=8?4:2,a=e.read_shift(s);switch(r.biff){case 2:e.l+=5;break;case 3:case 4:e.l+=8;break;case 5:e.l+=12;break}return[n,0,a]}function nq(e,t,r){if(r.biff==5)return sq(e);var n=e.read_shift(1)>>>5&3,s=e.read_shift(2),a=e.read_shift(4);return[n,s,a]}function sq(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2,"i");e.l+=8;var n=e.read_shift(2);return e.l+=12,[t,r,n]}function aq(e,t,r){var n=e.read_shift(1)>>>5&3;e.l+=r&&r.biff==2?3:4;var s=e.read_shift(r&&r.biff==2?1:2);return[n,s]}function iq(e,t,r){var n=e.read_shift(1)>>>5&3,s=e.read_shift(r&&r.biff==2?1:2);return[n,s]}function oq(e,t,r){var n=e.read_shift(1)>>>5&3;return e.l+=4,r.biff<8&&e.l--,r.biff==12&&(e.l+=2),[n]}function lq(e,t,r){var n=(e[e.l++]&96)>>5,s=e.read_shift(2),a=4;if(r)switch(r.biff){case 5:a=15;break;case 12:a=6;break}return e.l+=a,[n,s]}var cq=Ra,uq=Ra,dq=Ra;function Vf(e,t,r){return e.l+=2,[NG(e)]}function Sw(e){return e.l+=6,[]}var fq=Vf,hq=Sw,mq=Sw,pq=Vf;function VA(e){return e.l+=2,[bA(e),e.read_shift(2)&1]}var gq=Vf,xq=VA,vq=Sw,yq=Vf,wq=Vf,_q=["Data","All","Headers","??","?Data2","??","?DataHeaders","??","Totals","??","??","??","?DataTotals","??","??","??","?Current"];function bq(e){e.l+=2;var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(4),s=e.read_shift(2),a=e.read_shift(2),o=_q[r>>2&31];return{ixti:t,coltype:r&3,rt:o,idx:n,c:s,C:a}}function Sq(e){return e.l+=2,[e.read_shift(4)]}function Nq(e,t,r){return e.l+=5,e.l+=2,e.l+=r.biff==2?1:4,["PTGSHEET"]}function jq(e,t,r){return e.l+=r.biff==2?4:5,["PTGENDSHEET"]}function Eq(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2);return[t,r]}function kq(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2);return[t,r]}function Cq(e){return e.l+=4,[0,0]}var kS={1:{n:"PtgExp",f:qG},2:{n:"PtgTbl",f:dq},3:{n:"PtgAdd",f:br},4:{n:"PtgSub",f:br},5:{n:"PtgMul",f:br},6:{n:"PtgDiv",f:br},7:{n:"PtgPower",f:br},8:{n:"PtgConcat",f:br},9:{n:"PtgLt",f:br},10:{n:"PtgLe",f:br},11:{n:"PtgEq",f:br},12:{n:"PtgGe",f:br},13:{n:"PtgGt",f:br},14:{n:"PtgNe",f:br},15:{n:"PtgIsect",f:br},16:{n:"PtgUnion",f:br},17:{n:"PtgRange",f:br},18:{n:"PtgUplus",f:br},19:{n:"PtgUminus",f:br},20:{n:"PtgPercent",f:br},21:{n:"PtgParen",f:br},22:{n:"PtgMissArg",f:br},23:{n:"PtgStr",f:JG},26:{n:"PtgSheet",f:Nq},27:{n:"PtgEndSheet",f:jq},28:{n:"PtgErr",f:YG},29:{n:"PtgBool",f:XG},30:{n:"PtgInt",f:KG},31:{n:"PtgNum",f:QG},32:{n:"PtgArray",f:DG},33:{n:"PtgFunc",f:VG},34:{n:"PtgFuncVar",f:WG},35:{n:"PtgName",f:rq},36:{n:"PtgRef",f:BG},37:{n:"PtgArea",f:kG},38:{n:"PtgMemArea",f:aq},39:{n:"PtgMemErr",f:cq},40:{n:"PtgMemNoMem",f:uq},41:{n:"PtgMemFunc",f:iq},42:{n:"PtgRefErr",f:oq},43:{n:"PtgAreaErr",f:TG},44:{n:"PtgRefN",f:UG},45:{n:"PtgAreaN",f:PG},46:{n:"PtgMemAreaN",f:Eq},47:{n:"PtgMemNoMemN",f:kq},57:{n:"PtgNameX",f:nq},58:{n:"PtgRef3d",f:zG},59:{n:"PtgArea3d",f:CG},60:{n:"PtgRefErr3d",f:lq},61:{n:"PtgAreaErr3d",f:AG},255:{}},Tq={64:32,96:32,65:33,97:33,66:34,98:34,67:35,99:35,68:36,100:36,69:37,101:37,70:38,102:38,71:39,103:39,72:40,104:40,73:41,105:41,74:42,106:42,75:43,107:43,76:44,108:44,77:45,109:45,78:46,110:46,79:47,111:47,88:34,120:34,89:57,121:57,90:58,122:58,91:59,123:59,92:60,124:60,93:61,125:61},Aq={1:{n:"PtgElfLel",f:VA},2:{n:"PtgElfRw",f:yq},3:{n:"PtgElfCol",f:fq},6:{n:"PtgElfRwV",f:wq},7:{n:"PtgElfColV",f:pq},10:{n:"PtgElfRadical",f:gq},11:{n:"PtgElfRadicalS",f:vq},13:{n:"PtgElfColS",f:hq},15:{n:"PtgElfColSV",f:mq},16:{n:"PtgElfRadicalLel",f:xq},25:{n:"PtgList",f:bq},29:{n:"PtgSxName",f:Sq},255:{}},Pq={0:{n:"PtgAttrNoop",f:Cq},1:{n:"PtgAttrSemi",f:IG},2:{n:"PtgAttrIf",f:OG},4:{n:"PtgAttrChoose",f:RG},8:{n:"PtgAttrGoto",f:MG},16:{n:"PtgAttrSum",f:GG},32:{n:"PtgAttrBaxcel",f:ES},33:{n:"PtgAttrBaxcel",f:ES},64:{n:"PtgAttrSpace",f:LG},65:{n:"PtgAttrSpaceSemi",f:$G},128:{n:"PtgAttrIfError",f:FG},255:{}};function Dq(e,t,r,n){if(n.biff<8)return Ra(e,t);for(var s=e.l+t,a=[],o=0;o!==r.length;++o)switch(r[o][0]){case"PtgArray":r[o][1]=tq(e,0,n),a.push(r[o][1]);break;case"PtgMemArea":r[o][2]=eq(e,r[o][1],n),a.push(r[o][2]);break;case"PtgExp":n&&n.biff==12&&(r[o][1][1]=e.read_shift(4),a.push(r[o][1]));break;case"PtgList":case"PtgElfRadicalS":case"PtgElfColS":case"PtgElfColSV":throw"Unsupported "+r[o][0]}return t=s-e.l,t!==0&&a.push(Ra(e,t)),a}function Rq(e,t,r){for(var n=e.l+t,s,a,o=[];n!=e.l;)t=n-e.l,a=e[e.l],s=kS[a]||kS[Tq[a]],(a===24||a===25)&&(s=(a===24?Aq:Pq)[e[e.l+1]]),!s||!s.f?Ra(e,t):o.push([s.n,s.f(e,t,r)]);return o}function Mq(e){for(var t=[],r=0;r<e.length;++r){for(var n=e[r],s=[],a=0;a<n.length;++a){var o=n[a];if(o)switch(o[0]){case 2:s.push('"'+o[1].replace(/"/g,'""')+'"');break;default:s.push(o[1])}else s.push("")}t.push(s.join(","))}return t.join(";")}var Oq={PtgAdd:"+",PtgConcat:"&",PtgDiv:"/",PtgEq:"=",PtgGe:">=",PtgGt:">",PtgLe:"<=",PtgLt:"<",PtgMul:"*",PtgNe:"<>",PtgPower:"^",PtgSub:"-"};function Fq(e,t){if(!e&&!(t&&t.biff<=5&&t.biff>=2))throw new Error("empty sheet name");return/[^\w\u4E00-\u9FFF\u3040-\u30FF]/.test(e)?"'"+e+"'":e}function WA(e,t,r){if(!e)return"SH33TJSERR0";if(r.biff>8&&(!e.XTI||!e.XTI[t]))return e.SheetNames[t];if(!e.XTI)return"SH33TJSERR6";var n=e.XTI[t];if(r.biff<8)return t>1e4&&(t-=65536),t<0&&(t=-t),t==0?"":e.XTI[t-1];if(!n)return"SH33TJSERR1";var s="";if(r.biff>8)switch(e[n[0]][0]){case 357:return s=n[1]==-1?"#REF":e.SheetNames[n[1]],n[1]==n[2]?s:s+":"+e.SheetNames[n[2]];case 358:return r.SID!=null?e.SheetNames[r.SID]:"SH33TJSSAME"+e[n[0]][0];case 355:default:return"SH33TJSSRC"+e[n[0]][0]}switch(e[n[0]][0][0]){case 1025:return s=n[1]==-1?"#REF":e.SheetNames[n[1]]||"SH33TJSERR3",n[1]==n[2]?s:s+":"+e.SheetNames[n[2]];case 14849:return e[n[0]].slice(1).map(function(a){return a.Name}).join(";;");default:return e[n[0]][0][3]?(s=n[1]==-1?"#REF":e[n[0]][0][3][n[1]]||"SH33TJSERR4",n[1]==n[2]?s:s+":"+e[n[0]][0][3][n[2]]):"SH33TJSERR2"}}function CS(e,t,r){var n=WA(e,t,r);return n=="#REF"?n:Fq(n,r)}function Wc(e,t,r,n,s){var a=s&&s.biff||8,o={s:{c:0,r:0}},l=[],c,u,d,f=0,p=0,h,g="";if(!e[0]||!e[0][0])return"";for(var m=-1,x="",w=0,v=e[0].length;w<v;++w){var _=e[0][w];switch(_[0]){case"PtgUminus":l.push("-"+l.pop());break;case"PtgUplus":l.push("+"+l.pop());break;case"PtgPercent":l.push(l.pop()+"%");break;case"PtgAdd":case"PtgConcat":case"PtgDiv":case"PtgEq":case"PtgGe":case"PtgGt":case"PtgLe":case"PtgLt":case"PtgMul":case"PtgNe":case"PtgPower":case"PtgSub":if(c=l.pop(),u=l.pop(),m>=0){switch(e[0][m][1][0]){case 0:x=ur(" ",e[0][m][1][1]);break;case 1:x=ur("\r",e[0][m][1][1]);break;default:if(x="",s.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][m][1][0])}u=u+x,m=-1}l.push(u+Oq[_[0]]+c);break;case"PtgIsect":c=l.pop(),u=l.pop(),l.push(u+" "+c);break;case"PtgUnion":c=l.pop(),u=l.pop(),l.push(u+","+c);break;case"PtgRange":c=l.pop(),u=l.pop(),l.push(u+":"+c);break;case"PtgAttrChoose":break;case"PtgAttrGoto":break;case"PtgAttrIf":break;case"PtgAttrIfError":break;case"PtgRef":d=pd(_[1][1],o,s),l.push(gd(d,a));break;case"PtgRefN":d=r?pd(_[1][1],r,s):_[1][1],l.push(gd(d,a));break;case"PtgRef3d":f=_[1][1],d=pd(_[1][2],o,s),g=CS(n,f,s),l.push(g+"!"+gd(d,a));break;case"PtgFunc":case"PtgFuncVar":var b=_[1][0],S=_[1][1];b||(b=0),b&=127;var T=b==0?[]:l.slice(-b);l.length-=b,S==="User"&&(S=T.shift()),l.push(S+"("+T.join(",")+")");break;case"PtgBool":l.push(_[1]?"TRUE":"FALSE");break;case"PtgInt":l.push(_[1]);break;case"PtgNum":l.push(String(_[1]));break;case"PtgStr":l.push('"'+_[1].replace(/"/g,'""')+'"');break;case"PtgErr":l.push(_[1]);break;case"PtgAreaN":h=fS(_[1][1],r?{s:r}:o,s),l.push(ox(h,s));break;case"PtgArea":h=fS(_[1][1],o,s),l.push(ox(h,s));break;case"PtgArea3d":f=_[1][1],h=_[1][2],g=CS(n,f,s),l.push(g+"!"+ox(h,s));break;case"PtgAttrSum":l.push("SUM("+l.pop()+")");break;case"PtgAttrBaxcel":case"PtgAttrSemi":break;case"PtgName":p=_[1][2];var N=(n.names||[])[p-1]||(n[0]||[])[p],C=N?N.Name:"SH33TJSNAME"+String(p);C&&C.slice(0,6)=="_xlfn."&&!s.xlfn&&(C=C.slice(6)),l.push(C);break;case"PtgNameX":var E=_[1][1];p=_[1][2];var P;if(s.biff<=5)E<0&&(E=-E),n[E]&&(P=n[E][p]);else{var R="";if(((n[E]||[])[0]||[])[0]==14849||(((n[E]||[])[0]||[])[0]==1025?n[E][p]&&n[E][p].itab>0&&(R=n.SheetNames[n[E][p].itab-1]+"!"):R=n.SheetNames[p-1]+"!"),n[E]&&n[E][p])R+=n[E][p].Name;else if(n[0]&&n[0][p])R+=n[0][p].Name;else{var j=(WA(n,E,s)||"").split(";;");j[p-1]?R=j[p-1]:R+="SH33TJSERRX"}l.push(R);break}P||(P={Name:"SH33TJSERRY"}),l.push(P.Name);break;case"PtgParen":var M="(",A=")";if(m>=0){switch(x="",e[0][m][1][0]){case 2:M=ur(" ",e[0][m][1][1])+M;break;case 3:M=ur("\r",e[0][m][1][1])+M;break;case 4:A=ur(" ",e[0][m][1][1])+A;break;case 5:A=ur("\r",e[0][m][1][1])+A;break;default:if(s.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][m][1][0])}m=-1}l.push(M+l.pop()+A);break;case"PtgRefErr":l.push("#REF!");break;case"PtgRefErr3d":l.push("#REF!");break;case"PtgExp":d={c:_[1][1],r:_[1][0]};var I={c:r.c,r:r.r};if(n.sharedf[Lt(d)]){var X=n.sharedf[Lt(d)];l.push(Wc(X,o,I,n,s))}else{var Y=!1;for(c=0;c!=n.arrayf.length;++c)if(u=n.arrayf[c],!(d.c<u[0].s.c||d.c>u[0].e.c)&&!(d.r<u[0].s.r||d.r>u[0].e.r)){l.push(Wc(u[1],o,I,n,s)),Y=!0;break}Y||l.push(_[1])}break;case"PtgArray":l.push("{"+Mq(_[1])+"}");break;case"PtgMemArea":break;case"PtgAttrSpace":case"PtgAttrSpaceSemi":m=w;break;case"PtgTbl":break;case"PtgMemErr":break;case"PtgMissArg":l.push("");break;case"PtgAreaErr":l.push("#REF!");break;case"PtgAreaErr3d":l.push("#REF!");break;case"PtgList":l.push("Table"+_[1].idx+"[#"+_[1].rt+"]");break;case"PtgMemAreaN":case"PtgMemNoMemN":case"PtgAttrNoop":case"PtgSheet":case"PtgEndSheet":break;case"PtgMemFunc":break;case"PtgMemNoMem":break;case"PtgElfCol":case"PtgElfColS":case"PtgElfColSV":case"PtgElfColV":case"PtgElfLel":case"PtgElfRadical":case"PtgElfRadicalLel":case"PtgElfRadicalS":case"PtgElfRw":case"PtgElfRwV":throw new Error("Unsupported ELFs");case"PtgSxName":throw new Error("Unrecognized Formula Token: "+String(_));default:throw new Error("Unrecognized Formula Token: "+String(_))}var z=["PtgAttrSpace","PtgAttrSpaceSemi","PtgAttrGoto"];if(s.biff!=3&&m>=0&&z.indexOf(e[0][w][0])==-1){_=e[0][m];var U=!0;switch(_[1][0]){case 4:U=!1;case 0:x=ur(" ",_[1][1]);break;case 5:U=!1;case 1:x=ur("\r",_[1][1]);break;default:if(x="",s.WTF)throw new Error("Unexpected PtgAttrSpaceType "+_[1][0])}l.push((U?x:"")+l.pop()+(U?"":x)),m=-1}}if(l.length>1&&s.WTF)throw new Error("bad formula stack");return l[0]}function Iq(e){if(e==null){var t=Se(8);return t.write_shift(1,3),t.write_shift(1,0),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(2,65535),t}else if(typeof e=="number")return ul(e);return ul(0)}function Lq(e,t,r,n,s){var a=dl(t,r,s),o=Iq(e.v),l=Se(6),c=33;l.write_shift(2,c),l.write_shift(4,0);for(var u=Se(e.bf.length),d=0;d<e.bf.length;++d)u[d]=e.bf[d];var f=Jr([a,o,l,u]);return f}function Mp(e,t,r){var n=e.read_shift(4),s=Rq(e,n,r),a=e.read_shift(4),o=a>0?Dq(e,a,s,r):null;return[s,o]}var $q=Mp,Op=Mp,Bq=Mp,Uq=Mp,zq={0:"BEEP",1:"OPEN",2:"OPEN.LINKS",3:"CLOSE.ALL",4:"SAVE",5:"SAVE.AS",6:"FILE.DELETE",7:"PAGE.SETUP",8:"PRINT",9:"PRINTER.SETUP",10:"QUIT",11:"NEW.WINDOW",12:"ARRANGE.ALL",13:"WINDOW.SIZE",14:"WINDOW.MOVE",15:"FULL",16:"CLOSE",17:"RUN",22:"SET.PRINT.AREA",23:"SET.PRINT.TITLES",24:"SET.PAGE.BREAK",25:"REMOVE.PAGE.BREAK",26:"FONT",27:"DISPLAY",28:"PROTECT.DOCUMENT",29:"PRECISION",30:"A1.R1C1",31:"CALCULATE.NOW",32:"CALCULATION",34:"DATA.FIND",35:"EXTRACT",36:"DATA.DELETE",37:"SET.DATABASE",38:"SET.CRITERIA",39:"SORT",40:"DATA.SERIES",41:"TABLE",42:"FORMAT.NUMBER",43:"ALIGNMENT",44:"STYLE",45:"BORDER",46:"CELL.PROTECTION",47:"COLUMN.WIDTH",48:"UNDO",49:"CUT",50:"COPY",51:"PASTE",52:"CLEAR",53:"PASTE.SPECIAL",54:"EDIT.DELETE",55:"INSERT",56:"FILL.RIGHT",57:"FILL.DOWN",61:"DEFINE.NAME",62:"CREATE.NAMES",63:"FORMULA.GOTO",64:"FORMULA.FIND",65:"SELECT.LAST.CELL",66:"SHOW.ACTIVE.CELL",67:"GALLERY.AREA",68:"GALLERY.BAR",69:"GALLERY.COLUMN",70:"GALLERY.LINE",71:"GALLERY.PIE",72:"GALLERY.SCATTER",73:"COMBINATION",74:"PREFERRED",75:"ADD.OVERLAY",76:"GRIDLINES",77:"SET.PREFERRED",78:"AXES",79:"LEGEND",80:"ATTACH.TEXT",81:"ADD.ARROW",82:"SELECT.CHART",83:"SELECT.PLOT.AREA",84:"PATTERNS",85:"MAIN.CHART",86:"OVERLAY",87:"SCALE",88:"FORMAT.LEGEND",89:"FORMAT.TEXT",90:"EDIT.REPEAT",91:"PARSE",92:"JUSTIFY",93:"HIDE",94:"UNHIDE",95:"WORKSPACE",96:"FORMULA",97:"FORMULA.FILL",98:"FORMULA.ARRAY",99:"DATA.FIND.NEXT",100:"DATA.FIND.PREV",101:"FORMULA.FIND.NEXT",102:"FORMULA.FIND.PREV",103:"ACTIVATE",104:"ACTIVATE.NEXT",105:"ACTIVATE.PREV",106:"UNLOCKED.NEXT",107:"UNLOCKED.PREV",108:"COPY.PICTURE",109:"SELECT",110:"DELETE.NAME",111:"DELETE.FORMAT",112:"VLINE",113:"HLINE",114:"VPAGE",115:"HPAGE",116:"VSCROLL",117:"HSCROLL",118:"ALERT",119:"NEW",120:"CANCEL.COPY",121:"SHOW.CLIPBOARD",122:"MESSAGE",124:"PASTE.LINK",125:"APP.ACTIVATE",126:"DELETE.ARROW",127:"ROW.HEIGHT",128:"FORMAT.MOVE",129:"FORMAT.SIZE",130:"FORMULA.REPLACE",131:"SEND.KEYS",132:"SELECT.SPECIAL",133:"APPLY.NAMES",134:"REPLACE.FONT",135:"FREEZE.PANES",136:"SHOW.INFO",137:"SPLIT",138:"ON.WINDOW",139:"ON.DATA",140:"DISABLE.INPUT",142:"OUTLINE",143:"LIST.NAMES",144:"FILE.CLOSE",145:"SAVE.WORKBOOK",146:"DATA.FORM",147:"COPY.CHART",148:"ON.TIME",149:"WAIT",150:"FORMAT.FONT",151:"FILL.UP",152:"FILL.LEFT",153:"DELETE.OVERLAY",155:"SHORT.MENUS",159:"SET.UPDATE.STATUS",161:"COLOR.PALETTE",162:"DELETE.STYLE",163:"WINDOW.RESTORE",164:"WINDOW.MAXIMIZE",166:"CHANGE.LINK",167:"CALCULATE.DOCUMENT",168:"ON.KEY",169:"APP.RESTORE",170:"APP.MOVE",171:"APP.SIZE",172:"APP.MINIMIZE",173:"APP.MAXIMIZE",174:"BRING.TO.FRONT",175:"SEND.TO.BACK",185:"MAIN.CHART.TYPE",186:"OVERLAY.CHART.TYPE",187:"SELECT.END",188:"OPEN.MAIL",189:"SEND.MAIL",190:"STANDARD.FONT",191:"CONSOLIDATE",192:"SORT.SPECIAL",193:"GALLERY.3D.AREA",194:"GALLERY.3D.COLUMN",195:"GALLERY.3D.LINE",196:"GALLERY.3D.PIE",197:"VIEW.3D",198:"GOAL.SEEK",199:"WORKGROUP",200:"FILL.GROUP",201:"UPDATE.LINK",202:"PROMOTE",203:"DEMOTE",204:"SHOW.DETAIL",206:"UNGROUP",207:"OBJECT.PROPERTIES",208:"SAVE.NEW.OBJECT",209:"SHARE",210:"SHARE.NAME",211:"DUPLICATE",212:"APPLY.STYLE",213:"ASSIGN.TO.OBJECT",214:"OBJECT.PROTECTION",215:"HIDE.OBJECT",216:"SET.EXTRACT",217:"CREATE.PUBLISHER",218:"SUBSCRIBE.TO",219:"ATTRIBUTES",220:"SHOW.TOOLBAR",222:"PRINT.PREVIEW",223:"EDIT.COLOR",224:"SHOW.LEVELS",225:"FORMAT.MAIN",226:"FORMAT.OVERLAY",227:"ON.RECALC",228:"EDIT.SERIES",229:"DEFINE.STYLE",240:"LINE.PRINT",243:"ENTER.DATA",249:"GALLERY.RADAR",250:"MERGE.STYLES",251:"EDITION.OPTIONS",252:"PASTE.PICTURE",253:"PASTE.PICTURE.LINK",254:"SPELLING",256:"ZOOM",259:"INSERT.OBJECT",260:"WINDOW.MINIMIZE",265:"SOUND.NOTE",266:"SOUND.PLAY",267:"FORMAT.SHAPE",268:"EXTEND.POLYGON",269:"FORMAT.AUTO",272:"GALLERY.3D.BAR",273:"GALLERY.3D.SURFACE",274:"FILL.AUTO",276:"CUSTOMIZE.TOOLBAR",277:"ADD.TOOL",278:"EDIT.OBJECT",279:"ON.DOUBLECLICK",280:"ON.ENTRY",281:"WORKBOOK.ADD",282:"WORKBOOK.MOVE",283:"WORKBOOK.COPY",284:"WORKBOOK.OPTIONS",285:"SAVE.WORKSPACE",288:"CHART.WIZARD",289:"DELETE.TOOL",290:"MOVE.TOOL",291:"WORKBOOK.SELECT",292:"WORKBOOK.ACTIVATE",293:"ASSIGN.TO.TOOL",295:"COPY.TOOL",296:"RESET.TOOL",297:"CONSTRAIN.NUMERIC",298:"PASTE.TOOL",302:"WORKBOOK.NEW",305:"SCENARIO.CELLS",306:"SCENARIO.DELETE",307:"SCENARIO.ADD",308:"SCENARIO.EDIT",309:"SCENARIO.SHOW",310:"SCENARIO.SHOW.NEXT",311:"SCENARIO.SUMMARY",312:"PIVOT.TABLE.WIZARD",313:"PIVOT.FIELD.PROPERTIES",314:"PIVOT.FIELD",315:"PIVOT.ITEM",316:"PIVOT.ADD.FIELDS",318:"OPTIONS.CALCULATION",319:"OPTIONS.EDIT",320:"OPTIONS.VIEW",321:"ADDIN.MANAGER",322:"MENU.EDITOR",323:"ATTACH.TOOLBARS",324:"VBAActivate",325:"OPTIONS.CHART",328:"VBA.INSERT.FILE",330:"VBA.PROCEDURE.DEFINITION",336:"ROUTING.SLIP",338:"ROUTE.DOCUMENT",339:"MAIL.LOGON",342:"INSERT.PICTURE",343:"EDIT.TOOL",344:"GALLERY.DOUGHNUT",350:"CHART.TREND",352:"PIVOT.ITEM.PROPERTIES",354:"WORKBOOK.INSERT",355:"OPTIONS.TRANSITION",356:"OPTIONS.GENERAL",370:"FILTER.ADVANCED",373:"MAIL.ADD.MAILER",374:"MAIL.DELETE.MAILER",375:"MAIL.REPLY",376:"MAIL.REPLY.ALL",377:"MAIL.FORWARD",378:"MAIL.NEXT.LETTER",379:"DATA.LABEL",380:"INSERT.TITLE",381:"FONT.PROPERTIES",382:"MACRO.OPTIONS",383:"WORKBOOK.HIDE",384:"WORKBOOK.UNHIDE",385:"WORKBOOK.DELETE",386:"WORKBOOK.NAME",388:"GALLERY.CUSTOM",390:"ADD.CHART.AUTOFORMAT",391:"DELETE.CHART.AUTOFORMAT",392:"CHART.ADD.DATA",393:"AUTO.OUTLINE",394:"TAB.ORDER",395:"SHOW.DIALOG",396:"SELECT.ALL",397:"UNGROUP.SHEETS",398:"SUBTOTAL.CREATE",399:"SUBTOTAL.REMOVE",400:"RENAME.OBJECT",412:"WORKBOOK.SCROLL",413:"WORKBOOK.NEXT",414:"WORKBOOK.PREV",415:"WORKBOOK.TAB.SPLIT",416:"FULL.SCREEN",417:"WORKBOOK.PROTECT",420:"SCROLLBAR.PROPERTIES",421:"PIVOT.SHOW.PAGES",422:"TEXT.TO.COLUMNS",423:"FORMAT.CHARTTYPE",424:"LINK.FORMAT",425:"TRACER.DISPLAY",430:"TRACER.NAVIGATE",431:"TRACER.CLEAR",432:"TRACER.ERROR",433:"PIVOT.FIELD.GROUP",434:"PIVOT.FIELD.UNGROUP",435:"CHECKBOX.PROPERTIES",436:"LABEL.PROPERTIES",437:"LISTBOX.PROPERTIES",438:"EDITBOX.PROPERTIES",439:"PIVOT.REFRESH",440:"LINK.COMBO",441:"OPEN.TEXT",442:"HIDE.DIALOG",443:"SET.DIALOG.FOCUS",444:"ENABLE.OBJECT",445:"PUSHBUTTON.PROPERTIES",446:"SET.DIALOG.DEFAULT",447:"FILTER",448:"FILTER.SHOW.ALL",449:"CLEAR.OUTLINE",450:"FUNCTION.WIZARD",451:"ADD.LIST.ITEM",452:"SET.LIST.ITEM",453:"REMOVE.LIST.ITEM",454:"SELECT.LIST.ITEM",455:"SET.CONTROL.VALUE",456:"SAVE.COPY.AS",458:"OPTIONS.LISTS.ADD",459:"OPTIONS.LISTS.DELETE",460:"SERIES.AXES",461:"SERIES.X",462:"SERIES.Y",463:"ERRORBAR.X",464:"ERRORBAR.Y",465:"FORMAT.CHART",466:"SERIES.ORDER",467:"MAIL.LOGOFF",468:"CLEAR.ROUTING.SLIP",469:"APP.ACTIVATE.MICROSOFT",470:"MAIL.EDIT.MAILER",471:"ON.SHEET",472:"STANDARD.WIDTH",473:"SCENARIO.MERGE",474:"SUMMARY.INFO",475:"FIND.FILE",476:"ACTIVE.CELL.FONT",477:"ENABLE.TIPWIZARD",478:"VBA.MAKE.ADDIN",480:"INSERTDATATABLE",481:"WORKGROUP.OPTIONS",482:"MAIL.SEND.MAILER",485:"AUTOCORRECT",489:"POST.DOCUMENT",491:"PICKLIST",493:"VIEW.SHOW",494:"VIEW.DEFINE",495:"VIEW.DELETE",509:"SHEET.BACKGROUND",510:"INSERT.MAP.OBJECT",511:"OPTIONS.MENONO",517:"MSOCHECKS",518:"NORMAL",519:"LAYOUT",520:"RM.PRINT.AREA",521:"CLEAR.PRINT.AREA",522:"ADD.PRINT.AREA",523:"MOVE.BRK",545:"HIDECURR.NOTE",546:"HIDEALL.NOTES",547:"DELETE.NOTE",548:"TRAVERSE.NOTES",549:"ACTIVATE.NOTES",620:"PROTECT.REVISIONS",621:"UNPROTECT.REVISIONS",647:"OPTIONS.ME",653:"WEB.PUBLISH",667:"NEWWEBQUERY",673:"PIVOT.TABLE.CHART",753:"OPTIONS.SAVE",755:"OPTIONS.SPELL",808:"HIDEALL.INKANNOTS"},HA={0:"COUNT",1:"IF",2:"ISNA",3:"ISERROR",4:"SUM",5:"AVERAGE",6:"MIN",7:"MAX",8:"ROW",9:"COLUMN",10:"NA",11:"NPV",12:"STDEV",13:"DOLLAR",14:"FIXED",15:"SIN",16:"COS",17:"TAN",18:"ATAN",19:"PI",20:"SQRT",21:"EXP",22:"LN",23:"LOG10",24:"ABS",25:"INT",26:"SIGN",27:"ROUND",28:"LOOKUP",29:"INDEX",30:"REPT",31:"MID",32:"LEN",33:"VALUE",34:"TRUE",35:"FALSE",36:"AND",37:"OR",38:"NOT",39:"MOD",40:"DCOUNT",41:"DSUM",42:"DAVERAGE",43:"DMIN",44:"DMAX",45:"DSTDEV",46:"VAR",47:"DVAR",48:"TEXT",49:"LINEST",50:"TREND",51:"LOGEST",52:"GROWTH",53:"GOTO",54:"HALT",55:"RETURN",56:"PV",57:"FV",58:"NPER",59:"PMT",60:"RATE",61:"MIRR",62:"IRR",63:"RAND",64:"MATCH",65:"DATE",66:"TIME",67:"DAY",68:"MONTH",69:"YEAR",70:"WEEKDAY",71:"HOUR",72:"MINUTE",73:"SECOND",74:"NOW",75:"AREAS",76:"ROWS",77:"COLUMNS",78:"OFFSET",79:"ABSREF",80:"RELREF",81:"ARGUMENT",82:"SEARCH",83:"TRANSPOSE",84:"ERROR",85:"STEP",86:"TYPE",87:"ECHO",88:"SET.NAME",89:"CALLER",90:"DEREF",91:"WINDOWS",92:"SERIES",93:"DOCUMENTS",94:"ACTIVE.CELL",95:"SELECTION",96:"RESULT",97:"ATAN2",98:"ASIN",99:"ACOS",100:"CHOOSE",101:"HLOOKUP",102:"VLOOKUP",103:"LINKS",104:"INPUT",105:"ISREF",106:"GET.FORMULA",107:"GET.NAME",108:"SET.VALUE",109:"LOG",110:"EXEC",111:"CHAR",112:"LOWER",113:"UPPER",114:"PROPER",115:"LEFT",116:"RIGHT",117:"EXACT",118:"TRIM",119:"REPLACE",120:"SUBSTITUTE",121:"CODE",122:"NAMES",123:"DIRECTORY",124:"FIND",125:"CELL",126:"ISERR",127:"ISTEXT",128:"ISNUMBER",129:"ISBLANK",130:"T",131:"N",132:"FOPEN",133:"FCLOSE",134:"FSIZE",135:"FREADLN",136:"FREAD",137:"FWRITELN",138:"FWRITE",139:"FPOS",140:"DATEVALUE",141:"TIMEVALUE",142:"SLN",143:"SYD",144:"DDB",145:"GET.DEF",146:"REFTEXT",147:"TEXTREF",148:"INDIRECT",149:"REGISTER",150:"CALL",151:"ADD.BAR",152:"ADD.MENU",153:"ADD.COMMAND",154:"ENABLE.COMMAND",155:"CHECK.COMMAND",156:"RENAME.COMMAND",157:"SHOW.BAR",158:"DELETE.MENU",159:"DELETE.COMMAND",160:"GET.CHART.ITEM",161:"DIALOG.BOX",162:"CLEAN",163:"MDETERM",164:"MINVERSE",165:"MMULT",166:"FILES",167:"IPMT",168:"PPMT",169:"COUNTA",170:"CANCEL.KEY",171:"FOR",172:"WHILE",173:"BREAK",174:"NEXT",175:"INITIATE",176:"REQUEST",177:"POKE",178:"EXECUTE",179:"TERMINATE",180:"RESTART",181:"HELP",182:"GET.BAR",183:"PRODUCT",184:"FACT",185:"GET.CELL",186:"GET.WORKSPACE",187:"GET.WINDOW",188:"GET.DOCUMENT",189:"DPRODUCT",190:"ISNONTEXT",191:"GET.NOTE",192:"NOTE",193:"STDEVP",194:"VARP",195:"DSTDEVP",196:"DVARP",197:"TRUNC",198:"ISLOGICAL",199:"DCOUNTA",200:"DELETE.BAR",201:"UNREGISTER",204:"USDOLLAR",205:"FINDB",206:"SEARCHB",207:"REPLACEB",208:"LEFTB",209:"RIGHTB",210:"MIDB",211:"LENB",212:"ROUNDUP",213:"ROUNDDOWN",214:"ASC",215:"DBCS",216:"RANK",219:"ADDRESS",220:"DAYS360",221:"TODAY",222:"VDB",223:"ELSE",224:"ELSE.IF",225:"END.IF",226:"FOR.CELL",227:"MEDIAN",228:"SUMPRODUCT",229:"SINH",230:"COSH",231:"TANH",232:"ASINH",233:"ACOSH",234:"ATANH",235:"DGET",236:"CREATE.OBJECT",237:"VOLATILE",238:"LAST.ERROR",239:"CUSTOM.UNDO",240:"CUSTOM.REPEAT",241:"FORMULA.CONVERT",242:"GET.LINK.INFO",243:"TEXT.BOX",244:"INFO",245:"GROUP",246:"GET.OBJECT",247:"DB",248:"PAUSE",251:"RESUME",252:"FREQUENCY",253:"ADD.TOOLBAR",254:"DELETE.TOOLBAR",255:"User",256:"RESET.TOOLBAR",257:"EVALUATE",258:"GET.TOOLBAR",259:"GET.TOOL",260:"SPELLING.CHECK",261:"ERROR.TYPE",262:"APP.TITLE",263:"WINDOW.TITLE",264:"SAVE.TOOLBAR",265:"ENABLE.TOOL",266:"PRESS.TOOL",267:"REGISTER.ID",268:"GET.WORKBOOK",269:"AVEDEV",270:"BETADIST",271:"GAMMALN",272:"BETAINV",273:"BINOMDIST",274:"CHIDIST",275:"CHIINV",276:"COMBIN",277:"CONFIDENCE",278:"CRITBINOM",279:"EVEN",280:"EXPONDIST",281:"FDIST",282:"FINV",283:"FISHER",284:"FISHERINV",285:"FLOOR",286:"GAMMADIST",287:"GAMMAINV",288:"CEILING",289:"HYPGEOMDIST",290:"LOGNORMDIST",291:"LOGINV",292:"NEGBINOMDIST",293:"NORMDIST",294:"NORMSDIST",295:"NORMINV",296:"NORMSINV",297:"STANDARDIZE",298:"ODD",299:"PERMUT",300:"POISSON",301:"TDIST",302:"WEIBULL",303:"SUMXMY2",304:"SUMX2MY2",305:"SUMX2PY2",306:"CHITEST",307:"CORREL",308:"COVAR",309:"FORECAST",310:"FTEST",311:"INTERCEPT",312:"PEARSON",313:"RSQ",314:"STEYX",315:"SLOPE",316:"TTEST",317:"PROB",318:"DEVSQ",319:"GEOMEAN",320:"HARMEAN",321:"SUMSQ",322:"KURT",323:"SKEW",324:"ZTEST",325:"LARGE",326:"SMALL",327:"QUARTILE",328:"PERCENTILE",329:"PERCENTRANK",330:"MODE",331:"TRIMMEAN",332:"TINV",334:"MOVIE.COMMAND",335:"GET.MOVIE",336:"CONCATENATE",337:"POWER",338:"PIVOT.ADD.DATA",339:"GET.PIVOT.TABLE",340:"GET.PIVOT.FIELD",341:"GET.PIVOT.ITEM",342:"RADIANS",343:"DEGREES",344:"SUBTOTAL",345:"SUMIF",346:"COUNTIF",347:"COUNTBLANK",348:"SCENARIO.GET",349:"OPTIONS.LISTS.GET",350:"ISPMT",351:"DATEDIF",352:"DATESTRING",353:"NUMBERSTRING",354:"ROMAN",355:"OPEN.DIALOG",356:"SAVE.DIALOG",357:"VIEW.GET",358:"GETPIVOTDATA",359:"HYPERLINK",360:"PHONETIC",361:"AVERAGEA",362:"MAXA",363:"MINA",364:"STDEVPA",365:"VARPA",366:"STDEVA",367:"VARA",368:"BAHTTEXT",369:"THAIDAYOFWEEK",370:"THAIDIGIT",371:"THAIMONTHOFYEAR",372:"THAINUMSOUND",373:"THAINUMSTRING",374:"THAISTRINGLENGTH",375:"ISTHAIDIGIT",376:"ROUNDBAHTDOWN",377:"ROUNDBAHTUP",378:"THAIYEAR",379:"RTD",380:"CUBEVALUE",381:"CUBEMEMBER",382:"CUBEMEMBERPROPERTY",383:"CUBERANKEDMEMBER",384:"HEX2BIN",385:"HEX2DEC",386:"HEX2OCT",387:"DEC2BIN",388:"DEC2HEX",389:"DEC2OCT",390:"OCT2BIN",391:"OCT2HEX",392:"OCT2DEC",393:"BIN2DEC",394:"BIN2OCT",395:"BIN2HEX",396:"IMSUB",397:"IMDIV",398:"IMPOWER",399:"IMABS",400:"IMSQRT",401:"IMLN",402:"IMLOG2",403:"IMLOG10",404:"IMSIN",405:"IMCOS",406:"IMEXP",407:"IMARGUMENT",408:"IMCONJUGATE",409:"IMAGINARY",410:"IMREAL",411:"COMPLEX",412:"IMSUM",413:"IMPRODUCT",414:"SERIESSUM",415:"FACTDOUBLE",416:"SQRTPI",417:"QUOTIENT",418:"DELTA",419:"GESTEP",420:"ISEVEN",421:"ISODD",422:"MROUND",423:"ERF",424:"ERFC",425:"BESSELJ",426:"BESSELK",427:"BESSELY",428:"BESSELI",429:"XIRR",430:"XNPV",431:"PRICEMAT",432:"YIELDMAT",433:"INTRATE",434:"RECEIVED",435:"DISC",436:"PRICEDISC",437:"YIELDDISC",438:"TBILLEQ",439:"TBILLPRICE",440:"TBILLYIELD",441:"PRICE",442:"YIELD",443:"DOLLARDE",444:"DOLLARFR",445:"NOMINAL",446:"EFFECT",447:"CUMPRINC",448:"CUMIPMT",449:"EDATE",450:"EOMONTH",451:"YEARFRAC",452:"COUPDAYBS",453:"COUPDAYS",454:"COUPDAYSNC",455:"COUPNCD",456:"COUPNUM",457:"COUPPCD",458:"DURATION",459:"MDURATION",460:"ODDLPRICE",461:"ODDLYIELD",462:"ODDFPRICE",463:"ODDFYIELD",464:"RANDBETWEEN",465:"WEEKNUM",466:"AMORDEGRC",467:"AMORLINC",468:"CONVERT",724:"SHEETJS",469:"ACCRINT",470:"ACCRINTM",471:"WORKDAY",472:"NETWORKDAYS",473:"GCD",474:"MULTINOMIAL",475:"LCM",476:"FVSCHEDULE",477:"CUBEKPIMEMBER",478:"CUBESET",479:"CUBESETCOUNT",480:"IFERROR",481:"COUNTIFS",482:"SUMIFS",483:"AVERAGEIF",484:"AVERAGEIFS"},Vq={2:1,3:1,10:0,15:1,16:1,17:1,18:1,19:0,20:1,21:1,22:1,23:1,24:1,25:1,26:1,27:2,30:2,31:3,32:1,33:1,34:0,35:0,38:1,39:2,40:3,41:3,42:3,43:3,44:3,45:3,47:3,48:2,53:1,61:3,63:0,65:3,66:3,67:1,68:1,69:1,70:1,71:1,72:1,73:1,74:0,75:1,76:1,77:1,79:2,80:2,83:1,85:0,86:1,89:0,90:1,94:0,95:0,97:2,98:1,99:1,101:3,102:3,105:1,106:1,108:2,111:1,112:1,113:1,114:1,117:2,118:1,119:4,121:1,126:1,127:1,128:1,129:1,130:1,131:1,133:1,134:1,135:1,136:2,137:2,138:2,140:1,141:1,142:3,143:4,144:4,161:1,162:1,163:1,164:1,165:2,172:1,175:2,176:2,177:3,178:2,179:1,184:1,186:1,189:3,190:1,195:3,196:3,197:1,198:1,199:3,201:1,207:4,210:3,211:1,212:2,213:2,214:1,215:1,225:0,229:1,230:1,231:1,232:1,233:1,234:1,235:3,244:1,247:4,252:2,257:1,261:1,271:1,273:4,274:2,275:2,276:2,277:3,278:3,279:1,280:3,281:3,282:3,283:1,284:1,285:2,286:4,287:3,288:2,289:4,290:3,291:3,292:3,293:4,294:1,295:3,296:1,297:3,298:1,299:2,300:3,301:3,302:4,303:2,304:2,305:2,306:2,307:2,308:2,309:3,310:2,311:2,312:2,313:2,314:2,315:2,316:4,325:2,326:2,327:2,328:2,331:2,332:2,337:2,342:1,343:1,346:2,347:1,350:4,351:3,352:1,353:2,360:1,368:1,369:1,370:1,371:1,372:1,373:1,374:1,375:1,376:1,377:1,378:1,382:3,385:1,392:1,393:1,396:2,397:2,398:2,399:1,400:1,401:1,402:1,403:1,404:1,405:1,406:1,407:1,408:1,409:1,410:1,414:4,415:1,416:1,417:2,420:1,421:1,422:2,424:1,425:2,426:2,427:2,428:2,430:3,438:3,439:3,440:3,443:2,444:2,445:2,446:2,447:6,448:6,449:2,450:2,464:2,468:3,476:2,479:1,480:2,65535:0};function Wq(e){var t="of:="+e.replace(_w,"$1[.$2$3$4$5]").replace(/\]:\[/g,":");return t.replace(/;/g,"|").replace(/,/g,";")}function Hq(e){return e.replace(/\./,"!")}var xd=typeof Map<"u";function Nw(e,t,r){var n=0,s=e.length;if(r){if(xd?r.has(t):Object.prototype.hasOwnProperty.call(r,t)){for(var a=xd?r.get(t):r[t];n<a.length;++n)if(e[a[n]].t===t)return e.Count++,a[n]}}else for(;n<s;++n)if(e[n].t===t)return e.Count++,n;return e[s]={t},e.Count++,e.Unique++,r&&(xd?(r.has(t)||r.set(t,[]),r.get(t).push(s)):(Object.prototype.hasOwnProperty.call(r,t)||(r[t]=[]),r[t].push(s))),s}function Fp(e,t){var r={min:e+1,max:e+1},n=-1;return t.MDW&&(ai=t.MDW),t.width!=null?r.customWidth=1:t.wpx!=null?n=d0(t.wpx):t.wch!=null&&(n=t.wch),n>-1?(r.width=Qv(n),r.customWidth=1):t.width!=null&&(r.width=t.width),t.hidden&&(r.hidden=!0),t.level!=null&&(r.outlineLevel=r.level=t.level),r}function GA(e,t){if(e){var r=[.7,.7,.75,.75,.3,.3];e.left==null&&(e.left=r[0]),e.right==null&&(e.right=r[1]),e.top==null&&(e.top=r[2]),e.bottom==null&&(e.bottom=r[3]),e.header==null&&(e.header=r[4]),e.footer==null&&(e.footer=r[5])}}function No(e,t,r){var n=r.revssf[t.z!=null?t.z:"General"],s=60,a=e.length;if(n==null&&r.ssf){for(;s<392;++s)if(r.ssf[s]==null){U4(t.z,s),r.ssf[s]=t.z,r.revssf[t.z]=n=s;break}}for(s=0;s!=a;++s)if(e[s].numFmtId===n)return s;return e[a]={numFmtId:n,fontId:0,fillId:0,borderId:0,xfId:0,applyNumberFormat:1},a}function Gq(e,t,r){if(e&&e["!ref"]){var n=Kt(e["!ref"]);if(n.e.c<n.s.c||n.e.r<n.s.r)throw new Error("Bad range ("+r+"): "+e["!ref"])}}function qq(e){if(e.length===0)return"";for(var t='<mergeCells count="'+e.length+'">',r=0;r!=e.length;++r)t+='<mergeCell ref="'+Cr(e[r])+'"/>';return t+"</mergeCells>"}function Yq(e,t,r,n,s){var a=!1,o={},l=null;if(n.bookType!=="xlsx"&&t.vbaraw){var c=t.SheetNames[r];try{t.Workbook&&(c=t.Workbook.Sheets[r].CodeName||c)}catch{}a=!0,o.codeName=Jd(Ft(c))}if(e&&e["!outline"]){var u={summaryBelow:1,summaryRight:1};e["!outline"].above&&(u.summaryBelow=0),e["!outline"].left&&(u.summaryRight=0),l=(l||"")+Le("outlinePr",null,u)}!a&&!l||(s[s.length]=Le("sheetPr",l,o))}var Kq=["objects","scenarios","selectLockedCells","selectUnlockedCells"],Xq=["formatColumns","formatRows","formatCells","insertColumns","insertRows","insertHyperlinks","deleteColumns","deleteRows","sort","autoFilter","pivotTables"];function Qq(e){var t={sheet:1};return Kq.forEach(function(r){e[r]!=null&&e[r]&&(t[r]="1")}),Xq.forEach(function(r){e[r]!=null&&!e[r]&&(t[r]="0")}),e.password&&(t.password=TA(e.password).toString(16).toUpperCase()),Le("sheetProtection",null,t)}function Jq(e){return GA(e),Le("pageMargins",null,e)}function Zq(e,t){for(var r=["<cols>"],n,s=0;s!=t.length;++s)(n=t[s])&&(r[r.length]=Le("col",null,Fp(s,n)));return r[r.length]="</cols>",r.join("")}function eY(e,t,r,n){var s=typeof e.ref=="string"?e.ref:Cr(e.ref);r.Workbook||(r.Workbook={Sheets:[]}),r.Workbook.Names||(r.Workbook.Names=[]);var a=r.Workbook.Names,o=ds(s);o.s.r==o.e.r&&(o.e.r=ds(t["!ref"]).e.r,s=Cr(o));for(var l=0;l<a.length;++l){var c=a[l];if(c.Name=="_xlnm._FilterDatabase"&&c.Sheet==n){c.Ref="'"+r.SheetNames[n]+"'!"+s;break}}return l==a.length&&a.push({Name:"_xlnm._FilterDatabase",Sheet:n,Ref:"'"+r.SheetNames[n]+"'!"+s}),Le("autoFilter",null,{ref:s})}function tY(e,t,r,n){var s={workbookViewId:"0"};return(((n||{}).Workbook||{}).Views||[])[0]&&(s.rightToLeft=n.Workbook.Views[0].RTL?"1":"0"),Le("sheetViews",Le("sheetView",null,s),{})}function rY(e,t,r,n){if(e.c&&r["!comments"].push([t,e.c]),e.v===void 0&&typeof e.f!="string"||e.t==="z"&&!e.f)return"";var s="",a=e.t,o=e.v;if(e.t!=="z")switch(e.t){case"b":s=e.v?"1":"0";break;case"n":s=""+e.v;break;case"e":s=zf[e.v];break;case"d":n&&n.cellDates?s=kn(e.v,-1).toISOString():(e=Yn(e),e.t="n",s=""+(e.v=qn(kn(e.v)))),typeof e.z>"u"&&(e.z=pr[14]);break;default:s=e.v;break}var l=Zr("v",Ft(s)),c={r:t},u=No(n.cellXfs,e,n);switch(u!==0&&(c.s=u),e.t){case"n":break;case"d":c.t="d";break;case"b":c.t="b";break;case"e":c.t="e";break;case"z":break;default:if(e.v==null){delete e.t;break}if(e.v.length>32767)throw new Error("Text length must not exceed 32767 characters");if(n&&n.bookSST){l=Zr("v",""+Nw(n.Strings,e.v,n.revStrings)),c.t="s";break}c.t="str";break}if(e.t!=a&&(e.t=a,e.v=o),typeof e.f=="string"&&e.f){var d=e.F&&e.F.slice(0,t.length)==t?{t:"array",ref:e.F}:null;l=Le("f",Ft(e.f),d)+(e.v!=null?l:"")}return e.l&&r["!links"].push([t,e.l]),e.D&&(c.cm=1),Le("c",l,c)}function nY(e,t,r,n){var s=[],a=[],o=Kt(e["!ref"]),l="",c,u="",d=[],f=0,p=0,h=e["!rows"],g=Array.isArray(e),m={r:u},x,w=-1;for(p=o.s.c;p<=o.e.c;++p)d[p]=gn(p);for(f=o.s.r;f<=o.e.r;++f){for(a=[],u=nn(f),p=o.s.c;p<=o.e.c;++p){c=d[p]+u;var v=g?(e[f]||[])[p]:e[c];v!==void 0&&(l=rY(v,c,e,t))!=null&&a.push(l)}(a.length>0||h&&h[f])&&(m={r:u},h&&h[f]&&(x=h[f],x.hidden&&(m.hidden=1),w=-1,x.hpx?w=f0(x.hpx):x.hpt&&(w=x.hpt),w>-1&&(m.ht=w,m.customHeight=1),x.level&&(m.outlineLevel=x.level)),s[s.length]=Le("row",a.join(""),m))}if(h)for(;f<h.length;++f)h&&h[f]&&(m={r:f+1},x=h[f],x.hidden&&(m.hidden=1),w=-1,x.hpx?w=f0(x.hpx):x.hpt&&(w=x.hpt),w>-1&&(m.ht=w,m.customHeight=1),x.level&&(m.outlineLevel=x.level),s[s.length]=Le("row","",m));return s.join("")}function qA(e,t,r,n){var s=[Tr,Le("worksheet",null,{xmlns:fu[0],"xmlns:r":Vr.r})],a=r.SheetNames[e],o=0,l="",c=r.Sheets[a];c==null&&(c={});var u=c["!ref"]||"A1",d=Kt(u);if(d.e.c>16383||d.e.r>1048575){if(t.WTF)throw new Error("Range "+u+" exceeds format limit A1:XFD1048576");d.e.c=Math.min(d.e.c,16383),d.e.r=Math.min(d.e.c,1048575),u=Cr(d)}n||(n={}),c["!comments"]=[];var f=[];Yq(c,r,e,t,s),s[s.length]=Le("dimension",null,{ref:u}),s[s.length]=tY(c,t,e,r),t.sheetFormat&&(s[s.length]=Le("sheetFormatPr",null,{defaultRowHeight:t.sheetFormat.defaultRowHeight||"16",baseColWidth:t.sheetFormat.baseColWidth||"10",outlineLevelRow:t.sheetFormat.outlineLevelRow||"7"})),c["!cols"]!=null&&c["!cols"].length>0&&(s[s.length]=Zq(c,c["!cols"])),s[o=s.length]="<sheetData/>",c["!links"]=[],c["!ref"]!=null&&(l=nY(c,t),l.length>0&&(s[s.length]=l)),s.length>o+1&&(s[s.length]="</sheetData>",s[o]=s[o].replace("/>",">")),c["!protect"]&&(s[s.length]=Qq(c["!protect"])),c["!autofilter"]!=null&&(s[s.length]=eY(c["!autofilter"],c,r,e)),c["!merges"]!=null&&c["!merges"].length>0&&(s[s.length]=qq(c["!merges"]));var p=-1,h,g=-1;return c["!links"].length>0&&(s[s.length]="<hyperlinks>",c["!links"].forEach(function(m){m[1].Target&&(h={ref:m[0]},m[1].Target.charAt(0)!="#"&&(g=Ot(n,-1,Ft(m[1].Target).replace(/#.*$/,""),Tt.HLINK),h["r:id"]="rId"+g),(p=m[1].Target.indexOf("#"))>-1&&(h.location=Ft(m[1].Target.slice(p+1))),m[1].Tooltip&&(h.tooltip=Ft(m[1].Tooltip)),s[s.length]=Le("hyperlink",null,h))}),s[s.length]="</hyperlinks>"),delete c["!links"],c["!margins"]!=null&&(s[s.length]=Jq(c["!margins"])),(!t||t.ignoreEC||t.ignoreEC==null)&&(s[s.length]=Zr("ignoredErrors",Le("ignoredError",null,{numberStoredAsText:1,sqref:u}))),f.length>0&&(g=Ot(n,-1,"../drawings/drawing"+(e+1)+".xml",Tt.DRAW),s[s.length]=Le("drawing",null,{"r:id":"rId"+g}),c["!drawing"]=f),c["!comments"].length>0&&(g=Ot(n,-1,"../drawings/vmlDrawing"+(e+1)+".vml",Tt.VML),s[s.length]=Le("legacyDrawing",null,{"r:id":"rId"+g}),c["!legacy"]=g),s.length>1&&(s[s.length]="</worksheet>",s[1]=s[1].replace("/>",">")),s.join("")}function sY(e,t){var r={},n=e.l+t;r.r=e.read_shift(4),e.l+=4;var s=e.read_shift(2);e.l+=1;var a=e.read_shift(1);return e.l=n,a&7&&(r.level=a&7),a&16&&(r.hidden=!0),a&32&&(r.hpt=s/20),r}function aY(e,t,r){var n=Se(145),s=(r["!rows"]||[])[e]||{};n.write_shift(4,e),n.write_shift(4,0);var a=320;s.hpx?a=f0(s.hpx)*20:s.hpt&&(a=s.hpt*20),n.write_shift(2,a),n.write_shift(1,0);var o=0;s.level&&(o|=s.level),s.hidden&&(o|=16),(s.hpx||s.hpt)&&(o|=32),n.write_shift(1,o),n.write_shift(1,0);var l=0,c=n.l;n.l+=4;for(var u={r:e,c:0},d=0;d<16;++d)if(!(t.s.c>d+1<<10||t.e.c<d<<10)){for(var f=-1,p=-1,h=d<<10;h<d+1<<10;++h){u.c=h;var g=Array.isArray(r)?(r[u.r]||[])[u.c]:r[Lt(u)];g&&(f<0&&(f=h),p=h)}f<0||(++l,n.write_shift(4,f),n.write_shift(4,p))}var m=n.l;return n.l=c,n.write_shift(4,l),n.l=m,n.length>n.l?n.slice(0,n.l):n}function iY(e,t,r,n){var s=aY(n,r,t);(s.length>17||(t["!rows"]||[])[n])&&Pe(e,0,s)}var oY=kl,lY=mu;function cY(){}function uY(e,t){var r={},n=e[e.l];return++e.l,r.above=!(n&64),r.left=!(n&128),e.l+=18,r.name=wW(e),r}function dY(e,t,r){r==null&&(r=Se(84+4*e.length));var n=192;t&&(t.above&&(n&=-65),t.left&&(n&=-129)),r.write_shift(1,n);for(var s=1;s<3;++s)r.write_shift(1,0);return l0({auto:1},r),r.write_shift(-4,-1),r.write_shift(-4,-1),lA(e,r),r.slice(0,r.l)}function fY(e){var t=Ds(e);return[t]}function hY(e,t,r){return r==null&&(r=Se(8)),Nl(t,r)}function mY(e){var t=jl(e);return[t]}function pY(e,t,r){return r==null&&(r=Se(4)),El(t,r)}function gY(e){var t=Ds(e),r=e.read_shift(1);return[t,r,"b"]}function xY(e,t,r){return r==null&&(r=Se(9)),Nl(t,r),r.write_shift(1,e.v?1:0),r}function vY(e){var t=jl(e),r=e.read_shift(1);return[t,r,"b"]}function yY(e,t,r){return r==null&&(r=Se(5)),El(t,r),r.write_shift(1,e.v?1:0),r}function wY(e){var t=Ds(e),r=e.read_shift(1);return[t,r,"e"]}function _Y(e,t,r){return r==null&&(r=Se(9)),Nl(t,r),r.write_shift(1,e.v),r}function bY(e){var t=jl(e),r=e.read_shift(1);return[t,r,"e"]}function SY(e,t,r){return r==null&&(r=Se(8)),El(t,r),r.write_shift(1,e.v),r.write_shift(2,0),r.write_shift(1,0),r}function NY(e){var t=Ds(e),r=e.read_shift(4);return[t,r,"s"]}function jY(e,t,r){return r==null&&(r=Se(12)),Nl(t,r),r.write_shift(4,t.v),r}function EY(e){var t=jl(e),r=e.read_shift(4);return[t,r,"s"]}function kY(e,t,r){return r==null&&(r=Se(8)),El(t,r),r.write_shift(4,t.v),r}function CY(e){var t=Ds(e),r=pu(e);return[t,r,"n"]}function TY(e,t,r){return r==null&&(r=Se(16)),Nl(t,r),ul(e.v,r),r}function AY(e){var t=jl(e),r=pu(e);return[t,r,"n"]}function PY(e,t,r){return r==null&&(r=Se(12)),El(t,r),ul(e.v,r),r}function DY(e){var t=Ds(e),r=cA(e);return[t,r,"n"]}function RY(e,t,r){return r==null&&(r=Se(12)),Nl(t,r),uA(e.v,r),r}function MY(e){var t=jl(e),r=cA(e);return[t,r,"n"]}function OY(e,t,r){return r==null&&(r=Se(8)),El(t,r),uA(e.v,r),r}function FY(e){var t=Ds(e),r=gw(e);return[t,r,"is"]}function IY(e){var t=Ds(e),r=xn(e);return[t,r,"str"]}function LY(e,t,r){return r==null&&(r=Se(12+4*e.v.length)),Nl(t,r),Hr(e.v,r),r.length>r.l?r.slice(0,r.l):r}function $Y(e){var t=jl(e),r=xn(e);return[t,r,"str"]}function BY(e,t,r){return r==null&&(r=Se(8+4*e.v.length)),El(t,r),Hr(e.v,r),r.length>r.l?r.slice(0,r.l):r}function UY(e,t,r){var n=e.l+t,s=Ds(e);s.r=r["!row"];var a=e.read_shift(1),o=[s,a,"b"];if(r.cellFormula){e.l+=2;var l=Op(e,n-e.l,r);o[3]=Wc(l,null,s,r.supbooks,r)}else e.l=n;return o}function zY(e,t,r){var n=e.l+t,s=Ds(e);s.r=r["!row"];var a=e.read_shift(1),o=[s,a,"e"];if(r.cellFormula){e.l+=2;var l=Op(e,n-e.l,r);o[3]=Wc(l,null,s,r.supbooks,r)}else e.l=n;return o}function VY(e,t,r){var n=e.l+t,s=Ds(e);s.r=r["!row"];var a=pu(e),o=[s,a,"n"];if(r.cellFormula){e.l+=2;var l=Op(e,n-e.l,r);o[3]=Wc(l,null,s,r.supbooks,r)}else e.l=n;return o}function WY(e,t,r){var n=e.l+t,s=Ds(e);s.r=r["!row"];var a=xn(e),o=[s,a,"str"];if(r.cellFormula){e.l+=2;var l=Op(e,n-e.l,r);o[3]=Wc(l,null,s,r.supbooks,r)}else e.l=n;return o}var HY=kl,GY=mu;function qY(e,t){return t==null&&(t=Se(4)),t.write_shift(4,e),t}function YY(e,t){var r=e.l+t,n=kl(e),s=xw(e),a=xn(e),o=xn(e),l=xn(e);e.l=r;var c={rfx:n,relId:s,loc:a,display:l};return o&&(c.Tooltip=o),c}function KY(e,t){var r=Se(50+4*(e[1].Target.length+(e[1].Tooltip||"").length));mu({s:Wr(e[0]),e:Wr(e[0])},r),vw("rId"+t,r);var n=e[1].Target.indexOf("#"),s=n==-1?"":e[1].Target.slice(n+1);return Hr(s||"",r),Hr(e[1].Tooltip||"",r),Hr("",r),r.slice(0,r.l)}function XY(){}function QY(e,t,r){var n=e.l+t,s=dA(e),a=e.read_shift(1),o=[s];if(o[2]=a,r.cellFormula){var l=$q(e,n-e.l,r);o[1]=l}else e.l=n;return o}function JY(e,t,r){var n=e.l+t,s=kl(e),a=[s];if(r.cellFormula){var o=Uq(e,n-e.l,r);a[1]=o,e.l=n}else e.l=n;return a}function ZY(e,t,r){r==null&&(r=Se(18));var n=Fp(e,t);r.write_shift(-4,e),r.write_shift(-4,e),r.write_shift(4,(n.width||10)*256),r.write_shift(4,0);var s=0;return t.hidden&&(s|=1),typeof n.width=="number"&&(s|=2),t.level&&(s|=t.level<<8),r.write_shift(2,s),r}var YA=["left","right","top","bottom","header","footer"];function eK(e){var t={};return YA.forEach(function(r){t[r]=pu(e)}),t}function tK(e,t){return t==null&&(t=Se(6*8)),GA(e),YA.forEach(function(r){ul(e[r],t)}),t}function rK(e){var t=e.read_shift(2);return e.l+=28,{RTL:t&32}}function nK(e,t,r){r==null&&(r=Se(30));var n=924;return(((t||{}).Views||[])[0]||{}).RTL&&(n|=32),r.write_shift(2,n),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(1,0),r.write_shift(1,0),r.write_shift(2,0),r.write_shift(2,100),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(4,0),r}function sK(e){var t=Se(24);return t.write_shift(4,4),t.write_shift(4,1),mu(e,t),t}function aK(e,t){return t==null&&(t=Se(16*4+2)),t.write_shift(2,e.password?TA(e.password):0),t.write_shift(4,1),[["objects",!1],["scenarios",!1],["formatCells",!0],["formatColumns",!0],["formatRows",!0],["insertColumns",!0],["insertRows",!0],["insertHyperlinks",!0],["deleteColumns",!0],["deleteRows",!0],["selectLockedCells",!1],["sort",!0],["autoFilter",!0],["pivotTables",!0],["selectUnlockedCells",!1]].forEach(function(r){r[1]?t.write_shift(4,e[r[0]]!=null&&!e[r[0]]?1:0):t.write_shift(4,e[r[0]]!=null&&e[r[0]]?0:1)}),t}function iK(){}function oK(){}function lK(e,t,r,n,s,a,o){if(t.v===void 0)return!1;var l="";switch(t.t){case"b":l=t.v?"1":"0";break;case"d":t=Yn(t),t.z=t.z||pr[14],t.v=qn(kn(t.v)),t.t="n";break;case"n":case"e":l=""+t.v;break;default:l=t.v;break}var c={r,c:n};switch(c.s=No(s.cellXfs,t,s),t.l&&a["!links"].push([Lt(c),t.l]),t.c&&a["!comments"].push([Lt(c),t.c]),t.t){case"s":case"str":return s.bookSST?(l=Nw(s.Strings,t.v,s.revStrings),c.t="s",c.v=l,o?Pe(e,18,kY(t,c)):Pe(e,7,jY(t,c))):(c.t="str",o?Pe(e,17,BY(t,c)):Pe(e,6,LY(t,c))),!0;case"n":return t.v==(t.v|0)&&t.v>-1e3&&t.v<1e3?o?Pe(e,13,OY(t,c)):Pe(e,2,RY(t,c)):o?Pe(e,16,PY(t,c)):Pe(e,5,TY(t,c)),!0;case"b":return c.t="b",o?Pe(e,15,yY(t,c)):Pe(e,4,xY(t,c)),!0;case"e":return c.t="e",o?Pe(e,14,SY(t,c)):Pe(e,3,_Y(t,c)),!0}return o?Pe(e,12,pY(t,c)):Pe(e,1,hY(t,c)),!0}function cK(e,t,r,n){var s=Kt(t["!ref"]||"A1"),a,o="",l=[];Pe(e,145);var c=Array.isArray(t),u=s.e.r;t["!rows"]&&(u=Math.max(s.e.r,t["!rows"].length-1));for(var d=s.s.r;d<=u;++d){o=nn(d),iY(e,t,s,d);var f=!1;if(d<=s.e.r)for(var p=s.s.c;p<=s.e.c;++p){d===s.s.r&&(l[p]=gn(p)),a=l[p]+o;var h=c?(t[d]||[])[p]:t[a];if(!h){f=!1;continue}f=lK(e,h,d,p,n,t,f)}}Pe(e,146)}function uK(e,t){!t||!t["!merges"]||(Pe(e,177,qY(t["!merges"].length)),t["!merges"].forEach(function(r){Pe(e,176,GY(r))}),Pe(e,178))}function dK(e,t){!t||!t["!cols"]||(Pe(e,390),t["!cols"].forEach(function(r,n){r&&Pe(e,60,ZY(n,r))}),Pe(e,391))}function fK(e,t){!t||!t["!ref"]||(Pe(e,648),Pe(e,649,sK(Kt(t["!ref"]))),Pe(e,650))}function hK(e,t,r){t["!links"].forEach(function(n){if(n[1].Target){var s=Ot(r,-1,n[1].Target.replace(/#.*$/,""),Tt.HLINK);Pe(e,494,KY(n,s))}}),delete t["!links"]}function mK(e,t,r,n){if(t["!comments"].length>0){var s=Ot(n,-1,"../drawings/vmlDrawing"+(r+1)+".vml",Tt.VML);Pe(e,551,vw("rId"+s)),t["!legacy"]=s}}function pK(e,t,r,n){if(t["!autofilter"]){var s=t["!autofilter"],a=typeof s.ref=="string"?s.ref:Cr(s.ref);r.Workbook||(r.Workbook={Sheets:[]}),r.Workbook.Names||(r.Workbook.Names=[]);var o=r.Workbook.Names,l=ds(a);l.s.r==l.e.r&&(l.e.r=ds(t["!ref"]).e.r,a=Cr(l));for(var c=0;c<o.length;++c){var u=o[c];if(u.Name=="_xlnm._FilterDatabase"&&u.Sheet==n){u.Ref="'"+r.SheetNames[n]+"'!"+a;break}}c==o.length&&o.push({Name:"_xlnm._FilterDatabase",Sheet:n,Ref:"'"+r.SheetNames[n]+"'!"+a}),Pe(e,161,mu(Kt(a))),Pe(e,162)}}function gK(e,t,r){Pe(e,133),Pe(e,137,nK(t,r)),Pe(e,138),Pe(e,134)}function xK(e,t){t["!protect"]&&Pe(e,535,aK(t["!protect"]))}function vK(e,t,r,n){var s=Wn(),a=r.SheetNames[e],o=r.Sheets[a]||{},l=a;try{r&&r.Workbook&&(l=r.Workbook.Sheets[e].CodeName||l)}catch{}var c=Kt(o["!ref"]||"A1");if(c.e.c>16383||c.e.r>1048575){if(t.WTF)throw new Error("Range "+(o["!ref"]||"A1")+" exceeds format limit A1:XFD1048576");c.e.c=Math.min(c.e.c,16383),c.e.r=Math.min(c.e.c,1048575)}return o["!links"]=[],o["!comments"]=[],Pe(s,129),(r.vbaraw||o["!outline"])&&Pe(s,147,dY(l,o["!outline"])),Pe(s,148,lY(c)),gK(s,o,r.Workbook),dK(s,o),cK(s,o,e,t),xK(s,o),pK(s,o,r,e),uK(s,o),hK(s,o,n),o["!margins"]&&Pe(s,476,tK(o["!margins"])),(!t||t.ignoreEC||t.ignoreEC==null)&&fK(s,o),mK(s,o,e,n),Pe(s,130),s.end()}function yK(e,t){e.l+=10;var r=xn(e);return{name:r}}var wK=[["allowRefreshQuery",!1,"bool"],["autoCompressPictures",!0,"bool"],["backupFile",!1,"bool"],["checkCompatibility",!1,"bool"],["CodeName",""],["date1904",!1,"bool"],["defaultThemeVersion",0,"int"],["filterPrivacy",!1,"bool"],["hidePivotFieldList",!1,"bool"],["promptedSolutions",!1,"bool"],["publishItems",!1,"bool"],["refreshAllConnections",!1,"bool"],["saveExternalLinkValues",!0,"bool"],["showBorderUnselectedTables",!0,"bool"],["showInkAnnotation",!0,"bool"],["showObjects","all"],["showPivotChartFilter",!1,"bool"],["updateLinks","userSet"]];function _K(e){return!e.Workbook||!e.Workbook.WBProps?"false":JV(e.Workbook.WBProps.date1904)?"true":"false"}var bK="][*?/\\".split("");function KA(e,t){if(e.length>31)throw new Error("Sheet names cannot exceed 31 chars");var r=!0;return bK.forEach(function(n){if(e.indexOf(n)!=-1)throw new Error("Sheet name cannot contain : \\ / ? * [ ]")}),r}function SK(e,t,r){e.forEach(function(n,s){KA(n);for(var a=0;a<s;++a)if(n==e[a])throw new Error("Duplicate Sheet Name: "+n);if(r){var o=t&&t[s]&&t[s].CodeName||n;if(o.charCodeAt(0)==95&&o.length>22)throw new Error("Bad Code Name: Worksheet"+o)}})}function NK(e){if(!e||!e.SheetNames||!e.Sheets)throw new Error("Invalid Workbook");if(!e.SheetNames.length)throw new Error("Workbook is empty");var t=e.Workbook&&e.Workbook.Sheets||[];SK(e.SheetNames,t,!!e.vbaraw);for(var r=0;r<e.SheetNames.length;++r)Gq(e.Sheets[e.SheetNames[r]],e.SheetNames[r],r)}function XA(e){var t=[Tr];t[t.length]=Le("workbook",null,{xmlns:fu[0],"xmlns:r":Vr.r});var r=e.Workbook&&(e.Workbook.Names||[]).length>0,n={codeName:"ThisWorkbook"};e.Workbook&&e.Workbook.WBProps&&(wK.forEach(function(l){e.Workbook.WBProps[l[0]]!=null&&e.Workbook.WBProps[l[0]]!=l[1]&&(n[l[0]]=e.Workbook.WBProps[l[0]])}),e.Workbook.WBProps.CodeName&&(n.codeName=e.Workbook.WBProps.CodeName,delete n.CodeName)),t[t.length]=Le("workbookPr",null,n);var s=e.Workbook&&e.Workbook.Sheets||[],a=0;if(s&&s[0]&&s[0].Hidden){for(t[t.length]="<bookViews>",a=0;a!=e.SheetNames.length&&!(!s[a]||!s[a].Hidden);++a);a==e.SheetNames.length&&(a=0),t[t.length]='<workbookView firstSheet="'+a+'" activeTab="'+a+'"/>',t[t.length]="</bookViews>"}for(t[t.length]="<sheets>",a=0;a!=e.SheetNames.length;++a){var o={name:Ft(e.SheetNames[a].slice(0,31))};if(o.sheetId=""+(a+1),o["r:id"]="rId"+(a+1),s[a])switch(s[a].Hidden){case 1:o.state="hidden";break;case 2:o.state="veryHidden";break}t[t.length]=Le("sheet",null,o)}return t[t.length]="</sheets>",r&&(t[t.length]="<definedNames>",e.Workbook&&e.Workbook.Names&&e.Workbook.Names.forEach(function(l){var c={name:l.Name};l.Comment&&(c.comment=l.Comment),l.Sheet!=null&&(c.localSheetId=""+l.Sheet),l.Hidden&&(c.hidden="1"),l.Ref&&(t[t.length]=Le("definedName",Ft(l.Ref),c))}),t[t.length]="</definedNames>"),t.length>2&&(t[t.length]="</workbook>",t[1]=t[1].replace("/>",">")),t.join("")}function jK(e,t){var r={};return r.Hidden=e.read_shift(4),r.iTabID=e.read_shift(4),r.strRelID=Xv(e),r.name=xn(e),r}function EK(e,t){return t||(t=Se(127)),t.write_shift(4,e.Hidden),t.write_shift(4,e.iTabID),vw(e.strRelID,t),Hr(e.name.slice(0,31),t),t.length>t.l?t.slice(0,t.l):t}function kK(e,t){var r={},n=e.read_shift(4);r.defaultThemeVersion=e.read_shift(4);var s=t>8?xn(e):"";return s.length>0&&(r.CodeName=s),r.autoCompressPictures=!!(n&65536),r.backupFile=!!(n&64),r.checkCompatibility=!!(n&4096),r.date1904=!!(n&1),r.filterPrivacy=!!(n&8),r.hidePivotFieldList=!!(n&1024),r.promptedSolutions=!!(n&16),r.publishItems=!!(n&2048),r.refreshAllConnections=!!(n&262144),r.saveExternalLinkValues=!!(n&128),r.showBorderUnselectedTables=!!(n&4),r.showInkAnnotation=!!(n&32),r.showObjects=["all","placeholders","none"][n>>13&3],r.showPivotChartFilter=!!(n&32768),r.updateLinks=["userSet","never","always"][n>>8&3],r}function CK(e,t){t||(t=Se(72));var r=0;return e&&e.filterPrivacy&&(r|=8),t.write_shift(4,r),t.write_shift(4,0),lA(e&&e.CodeName||"ThisWorkbook",t),t.slice(0,t.l)}function TK(e,t,r){var n=e.l+t;e.l+=4,e.l+=1;var s=e.read_shift(4),a=_W(e),o=Bq(e,0,r),l=xw(e);e.l=n;var c={Name:a,Ptg:o};return s<268435455&&(c.Sheet=s),l&&(c.Comment=l),c}function AK(e,t){Pe(e,143);for(var r=0;r!=t.SheetNames.length;++r){var n=t.Workbook&&t.Workbook.Sheets&&t.Workbook.Sheets[r]&&t.Workbook.Sheets[r].Hidden||0,s={Hidden:n,iTabID:r+1,strRelID:"rId"+(r+1),name:t.SheetNames[r]};Pe(e,156,EK(s))}Pe(e,144)}function PK(e,t){t||(t=Se(127));for(var r=0;r!=4;++r)t.write_shift(4,0);return Hr("SheetJS",t),Hr(e0.version,t),Hr(e0.version,t),Hr("7262",t),t.length>t.l?t.slice(0,t.l):t}function DK(e,t){t||(t=Se(29)),t.write_shift(-4,0),t.write_shift(-4,460),t.write_shift(4,28800),t.write_shift(4,17600),t.write_shift(4,500),t.write_shift(4,e),t.write_shift(4,e);var r=120;return t.write_shift(1,r),t.length>t.l?t.slice(0,t.l):t}function RK(e,t){if(!(!t.Workbook||!t.Workbook.Sheets)){for(var r=t.Workbook.Sheets,n=0,s=-1,a=-1;n<r.length;++n)!r[n]||!r[n].Hidden&&s==-1?s=n:r[n].Hidden==1&&a==-1&&(a=n);a>s||(Pe(e,135),Pe(e,158,DK(s)),Pe(e,136))}}function MK(e,t){var r=Wn();return Pe(r,131),Pe(r,128,PK()),Pe(r,153,CK(e.Workbook&&e.Workbook.WBProps||null)),RK(r,e),AK(r,e),Pe(r,132),r.end()}function OK(e,t,r){return(t.slice(-4)===".bin"?MK:XA)(e)}function FK(e,t,r,n,s){return(t.slice(-4)===".bin"?vK:qA)(e,r,n,s)}function IK(e,t,r){return(t.slice(-4)===".bin"?tG:DA)(e,r)}function LK(e,t,r){return(t.slice(-4)===".bin"?CH:CA)(e,r)}function $K(e,t,r){return(t.slice(-4)===".bin"?xG:IA)(e)}function BK(e){return(e.slice(-4)===".bin"?cG:OA)()}function UK(e,t){var r=[];return e.Props&&r.push(IW(e.Props,t)),e.Custprops&&r.push(LW(e.Props,e.Custprops)),r.join("")}function zK(){return""}function VK(e,t){var r=['<Style ss:ID="Default" ss:Name="Normal"><NumberFormat/></Style>'];return t.cellXfs.forEach(function(n,s){var a=[];a.push(Le("NumberFormat",null,{"ss:Format":Ft(pr[n.numFmtId])}));var o={"ss:ID":"s"+(21+s)};r.push(Le("Style",a.join(""),o))}),Le("Styles",r.join(""))}function QA(e){return Le("NamedRange",null,{"ss:Name":e.Name,"ss:RefersTo":"="+bw(e.Ref,{r:0,c:0})})}function WK(e){if(!((e||{}).Workbook||{}).Names)return"";for(var t=e.Workbook.Names,r=[],n=0;n<t.length;++n){var s=t[n];s.Sheet==null&&(s.Name.match(/^_xlfn\./)||r.push(QA(s)))}return Le("Names",r.join(""))}function HK(e,t,r,n){if(!e||!((n||{}).Workbook||{}).Names)return"";for(var s=n.Workbook.Names,a=[],o=0;o<s.length;++o){var l=s[o];l.Sheet==r&&(l.Name.match(/^_xlfn\./)||a.push(QA(l)))}return a.join("")}function GK(e,t,r,n){if(!e)return"";var s=[];if(e["!margins"]&&(s.push("<PageSetup>"),e["!margins"].header&&s.push(Le("Header",null,{"x:Margin":e["!margins"].header})),e["!margins"].footer&&s.push(Le("Footer",null,{"x:Margin":e["!margins"].footer})),s.push(Le("PageMargins",null,{"x:Bottom":e["!margins"].bottom||"0.75","x:Left":e["!margins"].left||"0.7","x:Right":e["!margins"].right||"0.7","x:Top":e["!margins"].top||"0.75"})),s.push("</PageSetup>")),n&&n.Workbook&&n.Workbook.Sheets&&n.Workbook.Sheets[r])if(n.Workbook.Sheets[r].Hidden)s.push(Le("Visible",n.Workbook.Sheets[r].Hidden==1?"SheetHidden":"SheetVeryHidden",{}));else{for(var a=0;a<r&&!(n.Workbook.Sheets[a]&&!n.Workbook.Sheets[a].Hidden);++a);a==r&&s.push("<Selected/>")}return((((n||{}).Workbook||{}).Views||[])[0]||{}).RTL&&s.push("<DisplayRightToLeft/>"),e["!protect"]&&(s.push(Zr("ProtectContents","True")),e["!protect"].objects&&s.push(Zr("ProtectObjects","True")),e["!protect"].scenarios&&s.push(Zr("ProtectScenarios","True")),e["!protect"].selectLockedCells!=null&&!e["!protect"].selectLockedCells?s.push(Zr("EnableSelection","NoSelection")):e["!protect"].selectUnlockedCells!=null&&!e["!protect"].selectUnlockedCells&&s.push(Zr("EnableSelection","UnlockedCells")),[["formatCells","AllowFormatCells"],["formatColumns","AllowSizeCols"],["formatRows","AllowSizeRows"],["insertColumns","AllowInsertCols"],["insertRows","AllowInsertRows"],["insertHyperlinks","AllowInsertHyperlinks"],["deleteColumns","AllowDeleteCols"],["deleteRows","AllowDeleteRows"],["sort","AllowSort"],["autoFilter","AllowFilter"],["pivotTables","AllowUsePivotTables"]].forEach(function(o){e["!protect"][o[0]]&&s.push("<"+o[1]+"/>")})),s.length==0?"":Le("WorksheetOptions",s.join(""),{xmlns:rs.x})}function qK(e){return e.map(function(t){var r=QV(t.t||""),n=Le("ss:Data",r,{xmlns:"http://www.w3.org/TR/REC-html40"});return Le("Comment",n,{"ss:Author":t.a})}).join("")}function YK(e,t,r,n,s,a,o){if(!e||e.v==null&&e.f==null)return"";var l={};if(e.f&&(l["ss:Formula"]="="+Ft(bw(e.f,o))),e.F&&e.F.slice(0,t.length)==t){var c=Wr(e.F.slice(t.length+1));l["ss:ArrayRange"]="RC:R"+(c.r==o.r?"":"["+(c.r-o.r)+"]")+"C"+(c.c==o.c?"":"["+(c.c-o.c)+"]")}if(e.l&&e.l.Target&&(l["ss:HRef"]=Ft(e.l.Target),e.l.Tooltip&&(l["x:HRefScreenTip"]=Ft(e.l.Tooltip))),r["!merges"])for(var u=r["!merges"],d=0;d!=u.length;++d)u[d].s.c!=o.c||u[d].s.r!=o.r||(u[d].e.c>u[d].s.c&&(l["ss:MergeAcross"]=u[d].e.c-u[d].s.c),u[d].e.r>u[d].s.r&&(l["ss:MergeDown"]=u[d].e.r-u[d].s.r));var f="",p="";switch(e.t){case"z":if(!n.sheetStubs)return"";break;case"n":f="Number",p=String(e.v);break;case"b":f="Boolean",p=e.v?"1":"0";break;case"e":f="Error",p=zf[e.v];break;case"d":f="DateTime",p=new Date(e.v).toISOString(),e.z==null&&(e.z=e.z||pr[14]);break;case"s":f="String",p=XV(e.v||"");break}var h=No(n.cellXfs,e,n);l["ss:StyleID"]="s"+(21+h),l["ss:Index"]=o.c+1;var g=e.v!=null?p:"",m=e.t=="z"?"":'<Data ss:Type="'+f+'">'+g+"</Data>";return(e.c||[]).length>0&&(m+=qK(e.c)),Le("Cell",m,l)}function KK(e,t){var r='<Row ss:Index="'+(e+1)+'"';return t&&(t.hpt&&!t.hpx&&(t.hpx=PA(t.hpt)),t.hpx&&(r+=' ss:AutoFitHeight="0" ss:Height="'+t.hpx+'"'),t.hidden&&(r+=' ss:Hidden="1"')),r+">"}function XK(e,t,r,n){if(!e["!ref"])return"";var s=Kt(e["!ref"]),a=e["!merges"]||[],o=0,l=[];e["!cols"]&&e["!cols"].forEach(function(x,w){ww(x);var v=!!x.width,_=Fp(w,x),b={"ss:Index":w+1};v&&(b["ss:Width"]=u0(_.width)),x.hidden&&(b["ss:Hidden"]="1"),l.push(Le("Column",null,b))});for(var c=Array.isArray(e),u=s.s.r;u<=s.e.r;++u){for(var d=[KK(u,(e["!rows"]||[])[u])],f=s.s.c;f<=s.e.c;++f){var p=!1;for(o=0;o!=a.length;++o)if(!(a[o].s.c>f)&&!(a[o].s.r>u)&&!(a[o].e.c<f)&&!(a[o].e.r<u)){(a[o].s.c!=f||a[o].s.r!=u)&&(p=!0);break}if(!p){var h={r:u,c:f},g=Lt(h),m=c?(e[u]||[])[f]:e[g];d.push(YK(m,g,e,t,r,n,h))}}d.push("</Row>"),d.length>2&&l.push(d.join(""))}return l.join("")}function QK(e,t,r){var n=[],s=r.SheetNames[e],a=r.Sheets[s],o=a?HK(a,t,e,r):"";return o.length>0&&n.push("<Names>"+o+"</Names>"),o=a?XK(a,t,e,r):"",o.length>0&&n.push("<Table>"+o+"</Table>"),n.push(GK(a,t,e,r)),n.join("")}function JK(e,t){t||(t={}),e.SSF||(e.SSF=Yn(pr)),e.SSF&&(Pp(),Ap(e.SSF),t.revssf=Dp(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF,t.cellXfs=[],No(t.cellXfs,{},{revssf:{General:0}}));var r=[];r.push(UK(e,t)),r.push(zK()),r.push(""),r.push("");for(var n=0;n<e.SheetNames.length;++n)r.push(Le("Worksheet",QK(n,t,e),{"ss:Name":Ft(e.SheetNames[n])}));return r[2]=VK(e,t),r[3]=WK(e),Tr+Le("Workbook",r.join(""),{xmlns:rs.ss,"xmlns:o":rs.o,"xmlns:x":rs.x,"xmlns:ss":rs.ss,"xmlns:dt":rs.dt,"xmlns:html":rs.html})}var ux={SI:"e0859ff2f94f6810ab9108002b27b3d9",DSI:"02d5cdd59c2e1b10939708002b2cf9ae",UDI:"05d5cdd59c2e1b10939708002b2cf9ae"};function ZK(e,t){var r=[],n=[],s=[],a=0,o,l=tS(mS,"n"),c=tS(pS,"n");if(e.Props)for(o=an(e.Props),a=0;a<o.length;++a)(Object.prototype.hasOwnProperty.call(l,o[a])?r:Object.prototype.hasOwnProperty.call(c,o[a])?n:s).push([o[a],e.Props[o[a]]]);if(e.Custprops)for(o=an(e.Custprops),a=0;a<o.length;++a)Object.prototype.hasOwnProperty.call(e.Props||{},o[a])||(Object.prototype.hasOwnProperty.call(l,o[a])?r:Object.prototype.hasOwnProperty.call(c,o[a])?n:s).push([o[a],e.Custprops[o[a]]]);var u=[];for(a=0;a<s.length;++a)_A.indexOf(s[a][0])>-1||vA.indexOf(s[a][0])>-1||s[a][1]!=null&&u.push(s[a]);n.length&&Ut.utils.cfb_add(t,"/SummaryInformation",wS(n,ux.SI,c,pS)),(r.length||u.length)&&Ut.utils.cfb_add(t,"/DocumentSummaryInformation",wS(r,ux.DSI,l,mS,u.length?u:null,ux.UDI))}function eX(e,t){var r=t||{},n=Ut.utils.cfb_new({root:"R"}),s="/Workbook";switch(r.bookType||"xls"){case"xls":r.bookType="biff8";case"xla":r.bookType||(r.bookType="xla");case"biff8":s="/Workbook",r.biff=8;break;case"biff5":s="/Book",r.biff=5;break;default:throw new Error("invalid type "+r.bookType+" for XLS CFB")}return Ut.utils.cfb_add(n,s,JA(e,r)),r.biff==8&&(e.Props||e.Custprops)&&ZK(e,n),r.biff==8&&e.vbaraw&&vG(n,Ut.read(e.vbaraw,{type:typeof e.vbaraw=="string"?"binary":"buffer"})),n}var tX={0:{f:sY},1:{f:fY},2:{f:DY},3:{f:wY},4:{f:gY},5:{f:CY},6:{f:IY},7:{f:NY},8:{f:WY},9:{f:VY},10:{f:UY},11:{f:zY},12:{f:mY},13:{f:MY},14:{f:bY},15:{f:vY},16:{f:AY},17:{f:$Y},18:{f:EY},19:{f:gw},20:{},21:{},22:{},23:{},24:{},25:{},26:{},27:{},28:{},29:{},30:{},31:{},32:{},33:{},34:{},35:{T:1},36:{T:-1},37:{T:1},38:{T:-1},39:{f:TK},40:{},42:{},43:{f:IH},44:{f:OH},45:{f:BH},46:{f:zH},47:{f:UH},48:{},49:{f:mW},50:{},51:{f:sG},52:{T:1},53:{T:-1},54:{T:1},55:{T:-1},56:{T:1},57:{T:-1},58:{},59:{},60:{f:pH},62:{f:FY},63:{f:uG},64:{f:iK},65:{},66:{},67:{},68:{},69:{},70:{},128:{},129:{T:1},130:{T:-1},131:{T:1,f:Ra,p:0},132:{T:-1},133:{T:1},134:{T:-1},135:{T:1},136:{T:-1},137:{T:1,f:rK},138:{T:-1},139:{T:1},140:{T:-1},141:{T:1},142:{T:-1},143:{T:1},144:{T:-1},145:{T:1},146:{T:-1},147:{f:uY},148:{f:oY,p:16},151:{f:XY},152:{},153:{f:kK},154:{},155:{},156:{f:jK},157:{},158:{},159:{T:1,f:jH},160:{T:-1},161:{T:1,f:kl},162:{T:-1},163:{T:1},164:{T:-1},165:{T:1},166:{T:-1},167:{},168:{},169:{},170:{},171:{},172:{T:1},173:{T:-1},174:{},175:{},176:{f:HY},177:{T:1},178:{T:-1},179:{T:1},180:{T:-1},181:{T:1},182:{T:-1},183:{T:1},184:{T:-1},185:{T:1},186:{T:-1},187:{T:1},188:{T:-1},189:{T:1},190:{T:-1},191:{T:1},192:{T:-1},193:{T:1},194:{T:-1},195:{T:1},196:{T:-1},197:{T:1},198:{T:-1},199:{T:1},200:{T:-1},201:{T:1},202:{T:-1},203:{T:1},204:{T:-1},205:{T:1},206:{T:-1},207:{T:1},208:{T:-1},209:{T:1},210:{T:-1},211:{T:1},212:{T:-1},213:{T:1},214:{T:-1},215:{T:1},216:{T:-1},217:{T:1},218:{T:-1},219:{T:1},220:{T:-1},221:{T:1},222:{T:-1},223:{T:1},224:{T:-1},225:{T:1},226:{T:-1},227:{T:1},228:{T:-1},229:{T:1},230:{T:-1},231:{T:1},232:{T:-1},233:{T:1},234:{T:-1},235:{T:1},236:{T:-1},237:{T:1},238:{T:-1},239:{T:1},240:{T:-1},241:{T:1},242:{T:-1},243:{T:1},244:{T:-1},245:{T:1},246:{T:-1},247:{T:1},248:{T:-1},249:{T:1},250:{T:-1},251:{T:1},252:{T:-1},253:{T:1},254:{T:-1},255:{T:1},256:{T:-1},257:{T:1},258:{T:-1},259:{T:1},260:{T:-1},261:{T:1},262:{T:-1},263:{T:1},264:{T:-1},265:{T:1},266:{T:-1},267:{T:1},268:{T:-1},269:{T:1},270:{T:-1},271:{T:1},272:{T:-1},273:{T:1},274:{T:-1},275:{T:1},276:{T:-1},277:{},278:{T:1},279:{T:-1},280:{T:1},281:{T:-1},282:{T:1},283:{T:1},284:{T:-1},285:{T:1},286:{T:-1},287:{T:1},288:{T:-1},289:{T:1},290:{T:-1},291:{T:1},292:{T:-1},293:{T:1},294:{T:-1},295:{T:1},296:{T:-1},297:{T:1},298:{T:-1},299:{T:1},300:{T:-1},301:{T:1},302:{T:-1},303:{T:1},304:{T:-1},305:{T:1},306:{T:-1},307:{T:1},308:{T:-1},309:{T:1},310:{T:-1},311:{T:1},312:{T:-1},313:{T:-1},314:{T:1},315:{T:-1},316:{T:1},317:{T:-1},318:{T:1},319:{T:-1},320:{T:1},321:{T:-1},322:{T:1},323:{T:-1},324:{T:1},325:{T:-1},326:{T:1},327:{T:-1},328:{T:1},329:{T:-1},330:{T:1},331:{T:-1},332:{T:1},333:{T:-1},334:{T:1},335:{f:rG},336:{T:-1},337:{f:oG,T:1},338:{T:-1},339:{T:1},340:{T:-1},341:{T:1},342:{T:-1},343:{T:1},344:{T:-1},345:{T:1},346:{T:-1},347:{T:1},348:{T:-1},349:{T:1},350:{T:-1},351:{},352:{},353:{T:1},354:{T:-1},355:{f:Xv},357:{},358:{},359:{},360:{T:1},361:{},362:{f:cH},363:{},364:{},366:{},367:{},368:{},369:{},370:{},371:{},372:{T:1},373:{T:-1},374:{T:1},375:{T:-1},376:{T:1},377:{T:-1},378:{T:1},379:{T:-1},380:{T:1},381:{T:-1},382:{T:1},383:{T:-1},384:{T:1},385:{T:-1},386:{T:1},387:{T:-1},388:{T:1},389:{T:-1},390:{T:1},391:{T:-1},392:{T:1},393:{T:-1},394:{T:1},395:{T:-1},396:{},397:{},398:{},399:{},400:{},401:{T:1},403:{},404:{},405:{},406:{},407:{},408:{},409:{},410:{},411:{},412:{},413:{},414:{},415:{},416:{},417:{},418:{},419:{},420:{},421:{},422:{T:1},423:{T:1},424:{T:-1},425:{T:-1},426:{f:QY},427:{f:JY},428:{},429:{T:1},430:{T:-1},431:{T:1},432:{T:-1},433:{T:1},434:{T:-1},435:{T:1},436:{T:-1},437:{T:1},438:{T:-1},439:{T:1},440:{T:-1},441:{T:1},442:{T:-1},443:{T:1},444:{T:-1},445:{T:1},446:{T:-1},447:{T:1},448:{T:-1},449:{T:1},450:{T:-1},451:{T:1},452:{T:-1},453:{T:1},454:{T:-1},455:{T:1},456:{T:-1},457:{T:1},458:{T:-1},459:{T:1},460:{T:-1},461:{T:1},462:{T:-1},463:{T:1},464:{T:-1},465:{T:1},466:{T:-1},467:{T:1},468:{T:-1},469:{T:1},470:{T:-1},471:{},472:{},473:{T:1},474:{T:-1},475:{},476:{f:eK},477:{},478:{},479:{T:1},480:{T:-1},481:{T:1},482:{T:-1},483:{T:1},484:{T:-1},485:{f:cY},486:{T:1},487:{T:-1},488:{T:1},489:{T:-1},490:{T:1},491:{T:-1},492:{T:1},493:{T:-1},494:{f:YY},495:{T:1},496:{T:-1},497:{T:1},498:{T:-1},499:{},500:{T:1},501:{T:-1},502:{T:1},503:{T:-1},504:{},505:{T:1},506:{T:-1},507:{},508:{T:1},509:{T:-1},510:{T:1},511:{T:-1},512:{},513:{},514:{T:1},515:{T:-1},516:{T:1},517:{T:-1},518:{T:1},519:{T:-1},520:{T:1},521:{T:-1},522:{},523:{},524:{},525:{},526:{},527:{},528:{T:1},529:{T:-1},530:{T:1},531:{T:-1},532:{T:1},533:{T:-1},534:{},535:{},536:{},537:{},538:{T:1},539:{T:-1},540:{T:1},541:{T:-1},542:{T:1},548:{},549:{},550:{f:Xv},551:{},552:{},553:{},554:{T:1},555:{T:-1},556:{T:1},557:{T:-1},558:{T:1},559:{T:-1},560:{T:1},561:{T:-1},562:{},564:{},565:{T:1},566:{T:-1},569:{T:1},570:{T:-1},572:{},573:{T:1},574:{T:-1},577:{},578:{},579:{},580:{},581:{},582:{},583:{},584:{},585:{},586:{},587:{},588:{T:-1},589:{},590:{T:1},591:{T:-1},592:{T:1},593:{T:-1},594:{T:1},595:{T:-1},596:{},597:{T:1},598:{T:-1},599:{T:1},600:{T:-1},601:{T:1},602:{T:-1},603:{T:1},604:{T:-1},605:{T:1},606:{T:-1},607:{},608:{T:1},609:{T:-1},610:{},611:{T:1},612:{T:-1},613:{T:1},614:{T:-1},615:{T:1},616:{T:-1},617:{T:1},618:{T:-1},619:{T:1},620:{T:-1},625:{},626:{T:1},627:{T:-1},628:{T:1},629:{T:-1},630:{T:1},631:{T:-1},632:{f:pG},633:{T:1},634:{T:-1},635:{T:1,f:hG},636:{T:-1},637:{f:vW},638:{T:1},639:{},640:{T:-1},641:{T:1},642:{T:-1},643:{T:1},644:{},645:{T:-1},646:{T:1},648:{T:1},649:{},650:{T:-1},651:{f:yK},652:{},653:{T:1},654:{T:-1},655:{T:1},656:{T:-1},657:{T:1},658:{T:-1},659:{},660:{T:1},661:{},662:{T:-1},663:{},664:{T:1},665:{},666:{T:-1},667:{},668:{},669:{},671:{T:1},672:{T:-1},673:{T:1},674:{T:-1},675:{},676:{},677:{},678:{},679:{},680:{},681:{},1024:{},1025:{},1026:{T:1},1027:{T:-1},1028:{T:1},1029:{T:-1},1030:{},1031:{T:1},1032:{T:-1},1033:{T:1},1034:{T:-1},1035:{},1036:{},1037:{},1038:{T:1},1039:{T:-1},1040:{},1041:{T:1},1042:{T:-1},1043:{},1044:{},1045:{},1046:{T:1},1047:{T:-1},1048:{T:1},1049:{T:-1},1050:{},1051:{T:1},1052:{T:1},1053:{f:oK},1054:{T:1},1055:{},1056:{T:1},1057:{T:-1},1058:{T:1},1059:{T:-1},1061:{},1062:{T:1},1063:{T:-1},1064:{T:1},1065:{T:-1},1066:{T:1},1067:{T:-1},1068:{T:1},1069:{T:-1},1070:{T:1},1071:{T:-1},1072:{T:1},1073:{T:-1},1075:{T:1},1076:{T:-1},1077:{T:1},1078:{T:-1},1079:{T:1},1080:{T:-1},1081:{T:1},1082:{T:-1},1083:{T:1},1084:{T:-1},1085:{},1086:{T:1},1087:{T:-1},1088:{T:1},1089:{T:-1},1090:{T:1},1091:{T:-1},1092:{T:1},1093:{T:-1},1094:{T:1},1095:{T:-1},1096:{},1097:{T:1},1098:{},1099:{T:-1},1100:{T:1},1101:{T:-1},1102:{},1103:{},1104:{},1105:{},1111:{},1112:{},1113:{T:1},1114:{T:-1},1115:{T:1},1116:{T:-1},1117:{},1118:{T:1},1119:{T:-1},1120:{T:1},1121:{T:-1},1122:{T:1},1123:{T:-1},1124:{T:1},1125:{T:-1},1126:{},1128:{T:1},1129:{T:-1},1130:{},1131:{T:1},1132:{T:-1},1133:{T:1},1134:{T:-1},1135:{T:1},1136:{T:-1},1137:{T:1},1138:{T:-1},1139:{T:1},1140:{T:-1},1141:{},1142:{T:1},1143:{T:-1},1144:{T:1},1145:{T:-1},1146:{},1147:{T:1},1148:{T:-1},1149:{T:1},1150:{T:-1},1152:{T:1},1153:{T:-1},1154:{T:-1},1155:{T:-1},1156:{T:-1},1157:{T:1},1158:{T:-1},1159:{T:1},1160:{T:-1},1161:{T:1},1162:{T:-1},1163:{T:1},1164:{T:-1},1165:{T:1},1166:{T:-1},1167:{T:1},1168:{T:-1},1169:{T:1},1170:{T:-1},1171:{},1172:{T:1},1173:{T:-1},1177:{},1178:{T:1},1180:{},1181:{},1182:{},2048:{T:1},2049:{T:-1},2050:{},2051:{T:1},2052:{T:-1},2053:{},2054:{},2055:{T:1},2056:{T:-1},2057:{T:1},2058:{T:-1},2060:{},2067:{},2068:{T:1},2069:{T:-1},2070:{},2071:{},2072:{T:1},2073:{T:-1},2075:{},2076:{},2077:{T:1},2078:{T:-1},2079:{},2080:{T:1},2081:{T:-1},2082:{},2083:{T:1},2084:{T:-1},2085:{T:1},2086:{T:-1},2087:{T:1},2088:{T:-1},2089:{T:1},2090:{T:-1},2091:{},2092:{},2093:{T:1},2094:{T:-1},2095:{},2096:{T:1},2097:{T:-1},2098:{T:1},2099:{T:-1},2100:{T:1},2101:{T:-1},2102:{},2103:{T:1},2104:{T:-1},2105:{},2106:{T:1},2107:{T:-1},2108:{},2109:{T:1},2110:{T:-1},2111:{T:1},2112:{T:-1},2113:{T:1},2114:{T:-1},2115:{},2116:{},2117:{},2118:{T:1},2119:{T:-1},2120:{},2121:{T:1},2122:{T:-1},2123:{T:1},2124:{T:-1},2125:{},2126:{T:1},2127:{T:-1},2128:{},2129:{T:1},2130:{T:-1},2131:{T:1},2132:{T:-1},2133:{T:1},2134:{},2135:{},2136:{},2137:{T:1},2138:{T:-1},2139:{T:1},2140:{T:-1},2141:{},3072:{},3073:{},4096:{T:1},4097:{T:-1},5002:{T:1},5003:{T:-1},5081:{T:1},5082:{T:-1},5083:{},5084:{T:1},5085:{T:-1},5086:{T:1},5087:{T:-1},5088:{},5089:{},5090:{},5092:{T:1},5093:{T:-1},5094:{},5095:{T:1},5096:{T:-1},5097:{},5099:{},65535:{n:""}};function $e(e,t,r,n){var s=t;if(!isNaN(s)){var a=n||(r||[]).length||0,o=e.next(4);o.write_shift(2,s),o.write_shift(2,a),a>0&&hw(r)&&e.push(r)}}function rX(e,t,r,n){var s=(r||[]).length||0;if(s<=8224)return $e(e,t,r,s);var a=t;if(!isNaN(a)){for(var o=r.parts||[],l=0,c=0,u=0;u+(o[l]||8224)<=8224;)u+=o[l]||8224,l++;var d=e.next(4);for(d.write_shift(2,a),d.write_shift(2,u),e.push(r.slice(c,c+u)),c+=u;c<s;){for(d=e.next(4),d.write_shift(2,60),u=0;u+(o[l]||8224)<=8224;)u+=o[l]||8224,l++;d.write_shift(2,u),e.push(r.slice(c,c+u)),c+=u}}}function Wf(e,t,r){return e||(e=Se(7)),e.write_shift(2,t),e.write_shift(2,r),e.write_shift(2,0),e.write_shift(1,0),e}function nX(e,t,r,n){var s=Se(9);return Wf(s,e,t),SA(r,n||"b",s),s}function sX(e,t,r){var n=Se(8+2*r.length);return Wf(n,e,t),n.write_shift(1,r.length),n.write_shift(r.length,r,"sbcs"),n.l<n.length?n.slice(0,n.l):n}function aX(e,t,r,n){if(t.v!=null)switch(t.t){case"d":case"n":var s=t.t=="d"?qn(kn(t.v)):t.v;s==(s|0)&&s>=0&&s<65536?$e(e,2,yH(r,n,s)):$e(e,3,vH(r,n,s));return;case"b":case"e":$e(e,5,nX(r,n,t.v,t.t));return;case"s":case"str":$e(e,4,sX(r,n,(t.v||"").slice(0,255)));return}$e(e,1,Wf(null,r,n))}function iX(e,t,r,n){var s=Array.isArray(t),a=Kt(t["!ref"]||"A1"),o,l="",c=[];if(a.e.c>255||a.e.r>16383){if(n.WTF)throw new Error("Range "+(t["!ref"]||"A1")+" exceeds format limit A1:IV16384");a.e.c=Math.min(a.e.c,255),a.e.r=Math.min(a.e.c,16383),o=Cr(a)}for(var u=a.s.r;u<=a.e.r;++u){l=nn(u);for(var d=a.s.c;d<=a.e.c;++d){u===a.s.r&&(c[d]=gn(d)),o=c[d]+l;var f=s?(t[u]||[])[d]:t[o];f&&aX(e,f,u,d)}}}function oX(e,t){for(var r=t||{},n=Wn(),s=0,a=0;a<e.SheetNames.length;++a)e.SheetNames[a]==r.sheet&&(s=a);if(s==0&&r.sheet&&e.SheetNames[0]!=r.sheet)throw new Error("Sheet not found: "+r.sheet);return $e(n,r.biff==4?1033:r.biff==3?521:9,yw(e,16,r)),iX(n,e.Sheets[e.SheetNames[s]],s,r),$e(n,10),n.end()}function lX(e,t,r){$e(e,49,tH({sz:12,name:"Arial"},r))}function cX(e,t,r){t&&[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var s=n[0];s<=n[1];++s)t[s]!=null&&$e(e,1054,sH(s,t[s],r))})}function uX(e,t){var r=Se(19);r.write_shift(4,2151),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(2,3),r.write_shift(1,1),r.write_shift(4,0),$e(e,2151,r),r=Se(39),r.write_shift(4,2152),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(2,3),r.write_shift(1,0),r.write_shift(4,0),r.write_shift(2,1),r.write_shift(4,4),r.write_shift(2,0),EA(Kt(t["!ref"]||"A1"),r),r.write_shift(4,4),$e(e,2152,r)}function dX(e,t){for(var r=0;r<16;++r)$e(e,224,bS({numFmtId:0,style:!0},0,t));t.cellXfs.forEach(function(n){$e(e,224,bS(n,0,t))})}function fX(e,t){for(var r=0;r<t["!links"].length;++r){var n=t["!links"][r];$e(e,440,fH(n)),n[1].Tooltip&&$e(e,2048,hH(n))}delete t["!links"]}function hX(e,t){if(t){var r=0;t.forEach(function(n,s){++r<=256&&n&&$e(e,125,gH(Fp(s,n),s))})}}function mX(e,t,r,n,s){var a=16+No(s.cellXfs,t,s);if(t.v==null&&!t.bf){$e(e,513,dl(r,n,a));return}if(t.bf)$e(e,6,Lq(t,r,n,s,a));else switch(t.t){case"d":case"n":var o=t.t=="d"?qn(kn(t.v)):t.v;$e(e,515,lH(r,n,o,a));break;case"b":case"e":$e(e,517,oH(r,n,t.v,a,s,t.t));break;case"s":case"str":if(s.bookSST){var l=Nw(s.Strings,t.v,s.revStrings);$e(e,253,rH(r,n,l,a))}else $e(e,516,nH(r,n,(t.v||"").slice(0,255),a,s));break;default:$e(e,513,dl(r,n,a))}}function pX(e,t,r){var n=Wn(),s=r.SheetNames[e],a=r.Sheets[s]||{},o=(r||{}).Workbook||{},l=(o.Sheets||[])[e]||{},c=Array.isArray(a),u=t.biff==8,d,f="",p=[],h=Kt(a["!ref"]||"A1"),g=u?65536:16384;if(h.e.c>255||h.e.r>=g){if(t.WTF)throw new Error("Range "+(a["!ref"]||"A1")+" exceeds format limit A1:IV16384");h.e.c=Math.min(h.e.c,255),h.e.r=Math.min(h.e.c,g-1)}$e(n,2057,yw(r,16,t)),$e(n,13,ys(1)),$e(n,12,ys(100)),$e(n,15,Nn(!0)),$e(n,17,Nn(!1)),$e(n,16,ul(.001)),$e(n,95,Nn(!0)),$e(n,42,Nn(!1)),$e(n,43,Nn(!1)),$e(n,130,ys(1)),$e(n,128,iH()),$e(n,131,Nn(!1)),$e(n,132,Nn(!1)),u&&hX(n,a["!cols"]),$e(n,512,aH(h,t)),u&&(a["!links"]=[]);for(var m=h.s.r;m<=h.e.r;++m){f=nn(m);for(var x=h.s.c;x<=h.e.c;++x){m===h.s.r&&(p[x]=gn(x)),d=p[x]+f;var w=c?(a[m]||[])[x]:a[d];w&&(mX(n,w,m,x,t),u&&w.l&&a["!links"].push([d,w.l]))}}var v=l.CodeName||l.name||s;return u&&$e(n,574,eH((o.Views||[])[0])),u&&(a["!merges"]||[]).length&&$e(n,229,dH(a["!merges"])),u&&fX(n,a),$e(n,442,jA(v)),u&&uX(n,a),$e(n,10),n.end()}function gX(e,t,r){var n=Wn(),s=(e||{}).Workbook||{},a=s.Sheets||[],o=s.WBProps||{},l=r.biff==8,c=r.biff==5;if($e(n,2057,yw(e,5,r)),r.bookType=="xla"&&$e(n,135),$e(n,225,l?ys(1200):null),$e(n,193,UW(2)),c&&$e(n,191),c&&$e(n,192),$e(n,226),$e(n,92,XW("SheetJS",r)),$e(n,66,ys(l?1200:1252)),l&&$e(n,353,ys(0)),l&&$e(n,448),$e(n,317,xH(e.SheetNames.length)),l&&e.vbaraw&&$e(n,211),l&&e.vbaraw){var u=o.CodeName||"ThisWorkbook";$e(n,442,jA(u))}$e(n,156,ys(17)),$e(n,25,Nn(!1)),$e(n,18,Nn(!1)),$e(n,19,ys(0)),l&&$e(n,431,Nn(!1)),l&&$e(n,444,ys(0)),$e(n,61,ZW()),$e(n,64,Nn(!1)),$e(n,141,ys(0)),$e(n,34,Nn(_K(e)=="true")),$e(n,14,Nn(!0)),l&&$e(n,439,Nn(!1)),$e(n,218,ys(0)),lX(n,e,r),cX(n,e.SSF,r),dX(n,r),l&&$e(n,352,Nn(!1));var d=n.end(),f=Wn();l&&$e(f,140,mH()),l&&r.Strings&&rX(f,252,JW(r.Strings)),$e(f,10);var p=f.end(),h=Wn(),g=0,m=0;for(m=0;m<e.SheetNames.length;++m)g+=(l?12:11)+(l?2:1)*e.SheetNames[m].length;var x=d.length+g+p.length;for(m=0;m<e.SheetNames.length;++m){var w=a[m]||{};$e(h,133,QW({pos:x,hs:w.Hidden||0,dt:0,name:e.SheetNames[m]},r)),x+=t[m].length}var v=h.end();if(g!=v.length)throw new Error("BS8 "+g+" != "+v.length);var _=[];return d.length&&_.push(d),v.length&&_.push(v),p.length&&_.push(p),Jr(_)}function xX(e,t){var r=t||{},n=[];e&&!e.SSF&&(e.SSF=Yn(pr)),e&&e.SSF&&(Pp(),Ap(e.SSF),r.revssf=Dp(e.SSF),r.revssf[e.SSF[65535]]=0,r.ssf=e.SSF),r.Strings=[],r.Strings.Count=0,r.Strings.Unique=0,jw(r),r.cellXfs=[],No(r.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={});for(var s=0;s<e.SheetNames.length;++s)n[n.length]=pX(s,r,e);return n.unshift(gX(e,n,r)),Jr(n)}function JA(e,t){for(var r=0;r<=e.SheetNames.length;++r){var n=e.Sheets[e.SheetNames[r]];if(!(!n||!n["!ref"])){var s=ds(n["!ref"]);s.e.c>255&&typeof console<"u"&&console.error&&console.error("Worksheet '"+e.SheetNames[r]+"' extends beyond column IV (255).  Data may be lost.")}}var a=t||{};switch(a.biff||2){case 8:case 5:return xX(e,t);case 4:case 3:case 2:return oX(e,t)}throw new Error("invalid type "+a.bookType+" for BIFF")}function vX(e,t,r,n){for(var s=e["!merges"]||[],a=[],o=t.s.c;o<=t.e.c;++o){for(var l=0,c=0,u=0;u<s.length;++u)if(!(s[u].s.r>r||s[u].s.c>o)&&!(s[u].e.r<r||s[u].e.c<o)){if(s[u].s.r<r||s[u].s.c<o){l=-1;break}l=s[u].e.r-s[u].s.r+1,c=s[u].e.c-s[u].s.c+1;break}if(!(l<0)){var d=Lt({r,c:o}),f=n.dense?(e[r]||[])[o]:e[d],p=f&&f.v!=null&&(f.h||KV(f.w||(gi(f),f.w)||""))||"",h={};l>1&&(h.rowspan=l),c>1&&(h.colspan=c),n.editable?p='<span contenteditable="true">'+p+"</span>":f&&(h["data-t"]=f&&f.t||"z",f.v!=null&&(h["data-v"]=f.v),f.z!=null&&(h["data-z"]=f.z),f.l&&(f.l.Target||"#").charAt(0)!="#"&&(p='<a href="'+f.l.Target+'">'+p+"</a>")),h.id=(n.id||"sjs")+"-"+d,a.push(Le("td",p,h))}}var g="<tr>";return g+a.join("")+"</tr>"}var yX='<html><head><meta charset="utf-8"/><title>SheetJS Table Export</title></head><body>',wX="</body></html>";function _X(e,t,r){var n=[];return n.join("")+"<table"+(r&&r.id?' id="'+r.id+'"':"")+">"}function ZA(e,t){var r=t||{},n=r.header!=null?r.header:yX,s=r.footer!=null?r.footer:wX,a=[n],o=ds(e["!ref"]);r.dense=Array.isArray(e),a.push(_X(e,o,r));for(var l=o.s.r;l<=o.e.r;++l)a.push(vX(e,o,l,r));return a.push("</table>"+s),a.join("")}function eP(e,t,r){var n=r||{},s=0,a=0;if(n.origin!=null)if(typeof n.origin=="number")s=n.origin;else{var o=typeof n.origin=="string"?Wr(n.origin):n.origin;s=o.r,a=o.c}var l=t.getElementsByTagName("tr"),c=Math.min(n.sheetRows||1e7,l.length),u={s:{r:0,c:0},e:{r:s,c:a}};if(e["!ref"]){var d=ds(e["!ref"]);u.s.r=Math.min(u.s.r,d.s.r),u.s.c=Math.min(u.s.c,d.s.c),u.e.r=Math.max(u.e.r,d.e.r),u.e.c=Math.max(u.e.c,d.e.c),s==-1&&(u.e.r=s=d.e.r+1)}var f=[],p=0,h=e["!rows"]||(e["!rows"]=[]),g=0,m=0,x=0,w=0,v=0,_=0;for(e["!cols"]||(e["!cols"]=[]);g<l.length&&m<c;++g){var b=l[g];if(TS(b)){if(n.display)continue;h[m]={hidden:!0}}var S=b.children;for(x=w=0;x<S.length;++x){var T=S[x];if(!(n.display&&TS(T))){var N=T.hasAttribute("data-v")?T.getAttribute("data-v"):T.hasAttribute("v")?T.getAttribute("v"):ZV(T.innerHTML),C=T.getAttribute("data-z")||T.getAttribute("z");for(p=0;p<f.length;++p){var E=f[p];E.s.c==w+a&&E.s.r<m+s&&m+s<=E.e.r&&(w=E.e.c+1-a,p=-1)}_=+T.getAttribute("colspan")||1,((v=+T.getAttribute("rowspan")||1)>1||_>1)&&f.push({s:{r:m+s,c:w+a},e:{r:m+s+(v||1)-1,c:w+a+(_||1)-1}});var P={t:"s",v:N},R=T.getAttribute("data-t")||T.getAttribute("t")||"";N!=null&&(N.length==0?P.t=R||"z":n.raw||N.trim().length==0||R=="s"||(N==="TRUE"?P={t:"b",v:!0}:N==="FALSE"?P={t:"b",v:!1}:isNaN(si(N))?isNaN(Qd(N).getDate())||(P={t:"d",v:kn(N)},n.cellDates||(P={t:"n",v:qn(P.v)}),P.z=n.dateNF||pr[14]):P={t:"n",v:si(N)})),P.z===void 0&&C!=null&&(P.z=C);var j="",M=T.getElementsByTagName("A");if(M&&M.length)for(var A=0;A<M.length&&!(M[A].hasAttribute("href")&&(j=M[A].getAttribute("href"),j.charAt(0)!="#"));++A);j&&j.charAt(0)!="#"&&(P.l={Target:j}),n.dense?(e[m+s]||(e[m+s]=[]),e[m+s][w+a]=P):e[Lt({c:w+a,r:m+s})]=P,u.e.c<w+a&&(u.e.c=w+a),w+=_}}++m}return f.length&&(e["!merges"]=(e["!merges"]||[]).concat(f)),u.e.r=Math.max(u.e.r,m-1+s),e["!ref"]=Cr(u),m>=c&&(e["!fullref"]=Cr((u.e.r=l.length-g+m-1+s,u))),e}function tP(e,t){var r=t||{},n=r.dense?[]:{};return eP(n,e,t)}function bX(e,t){return Sl(tP(e,t),t)}function TS(e){var t="",r=SX(e);return r&&(t=r(e).getPropertyValue("display")),t||(t=e.style&&e.style.display),t==="none"}function SX(e){return e.ownerDocument.defaultView&&typeof e.ownerDocument.defaultView.getComputedStyle=="function"?e.ownerDocument.defaultView.getComputedStyle:typeof getComputedStyle=="function"?getComputedStyle:null}var NX=function(){var e=["<office:master-styles>",'<style:master-page style:name="mp1" style:page-layout-name="mp1">',"<style:header/>",'<style:header-left style:display="false"/>',"<style:footer/>",'<style:footer-left style:display="false"/>',"</style:master-page>","</office:master-styles>"].join(""),t="<office:document-styles "+Zd({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","office:version":"1.2"})+">"+e+"</office:document-styles>";return function(){return Tr+t}}(),AS=function(){var e=function(a){return Ft(a).replace(/  +/g,function(o){return'<text:s text:c="'+o.length+'"/>'}).replace(/\t/g,"<text:tab/>").replace(/\n/g,"</text:p><text:p>").replace(/^ /,"<text:s/>").replace(/ $/,"<text:s/>")},t=`          <table:table-cell />
`,r=`          <table:covered-table-cell/>
`,n=function(a,o,l){var c=[];c.push('      <table:table table:name="'+Ft(o.SheetNames[l])+`" table:style-name="ta1">
`);var u=0,d=0,f=ds(a["!ref"]||"A1"),p=a["!merges"]||[],h=0,g=Array.isArray(a);if(a["!cols"])for(d=0;d<=f.e.c;++d)c.push("        <table:table-column"+(a["!cols"][d]?' table:style-name="co'+a["!cols"][d].ods+'"':"")+`></table:table-column>
`);var m="",x=a["!rows"]||[];for(u=0;u<f.s.r;++u)m=x[u]?' table:style-name="ro'+x[u].ods+'"':"",c.push("        <table:table-row"+m+`></table:table-row>
`);for(;u<=f.e.r;++u){for(m=x[u]?' table:style-name="ro'+x[u].ods+'"':"",c.push("        <table:table-row"+m+`>
`),d=0;d<f.s.c;++d)c.push(t);for(;d<=f.e.c;++d){var w=!1,v={},_="";for(h=0;h!=p.length;++h)if(!(p[h].s.c>d)&&!(p[h].s.r>u)&&!(p[h].e.c<d)&&!(p[h].e.r<u)){(p[h].s.c!=d||p[h].s.r!=u)&&(w=!0),v["table:number-columns-spanned"]=p[h].e.c-p[h].s.c+1,v["table:number-rows-spanned"]=p[h].e.r-p[h].s.r+1;break}if(w){c.push(r);continue}var b=Lt({r:u,c:d}),S=g?(a[u]||[])[d]:a[b];if(S&&S.f&&(v["table:formula"]=Ft(Wq(S.f)),S.F&&S.F.slice(0,b.length)==b)){var T=ds(S.F);v["table:number-matrix-columns-spanned"]=T.e.c-T.s.c+1,v["table:number-matrix-rows-spanned"]=T.e.r-T.s.r+1}if(!S){c.push(t);continue}switch(S.t){case"b":_=S.v?"TRUE":"FALSE",v["office:value-type"]="boolean",v["office:boolean-value"]=S.v?"true":"false";break;case"n":_=S.w||String(S.v||0),v["office:value-type"]="float",v["office:value"]=S.v||0;break;case"s":case"str":_=S.v==null?"":S.v,v["office:value-type"]="string";break;case"d":_=S.w||kn(S.v).toISOString(),v["office:value-type"]="date",v["office:date-value"]=kn(S.v).toISOString(),v["table:style-name"]="ce1";break;default:c.push(t);continue}var N=e(_);if(S.l&&S.l.Target){var C=S.l.Target;C=C.charAt(0)=="#"?"#"+Hq(C.slice(1)):C,C.charAt(0)!="#"&&!C.match(/^\w+:/)&&(C="../"+C),N=Le("text:a",N,{"xlink:href":C.replace(/&/g,"&amp;")})}c.push("          "+Le("table:table-cell",Le("text:p",N,{}),v)+`
`)}c.push(`        </table:table-row>
`)}return c.push(`      </table:table>
`),c.join("")},s=function(a,o){a.push(` <office:automatic-styles>
`),a.push(`  <number:date-style style:name="N37" number:automatic-order="true">
`),a.push(`   <number:month number:style="long"/>
`),a.push(`   <number:text>/</number:text>
`),a.push(`   <number:day number:style="long"/>
`),a.push(`   <number:text>/</number:text>
`),a.push(`   <number:year/>
`),a.push(`  </number:date-style>
`);var l=0;o.SheetNames.map(function(u){return o.Sheets[u]}).forEach(function(u){if(u&&u["!cols"]){for(var d=0;d<u["!cols"].length;++d)if(u["!cols"][d]){var f=u["!cols"][d];if(f.width==null&&f.wpx==null&&f.wch==null)continue;ww(f),f.ods=l;var p=u["!cols"][d].wpx+"px";a.push('  <style:style style:name="co'+l+`" style:family="table-column">
`),a.push('   <style:table-column-properties fo:break-before="auto" style:column-width="'+p+`"/>
`),a.push(`  </style:style>
`),++l}}});var c=0;o.SheetNames.map(function(u){return o.Sheets[u]}).forEach(function(u){if(u&&u["!rows"]){for(var d=0;d<u["!rows"].length;++d)if(u["!rows"][d]){u["!rows"][d].ods=c;var f=u["!rows"][d].hpx+"px";a.push('  <style:style style:name="ro'+c+`" style:family="table-row">
`),a.push('   <style:table-row-properties fo:break-before="auto" style:row-height="'+f+`"/>
`),a.push(`  </style:style>
`),++c}}}),a.push(`  <style:style style:name="ta1" style:family="table" style:master-page-name="mp1">
`),a.push(`   <style:table-properties table:display="true" style:writing-mode="lr-tb"/>
`),a.push(`  </style:style>
`),a.push(`  <style:style style:name="ce1" style:family="table-cell" style:parent-style-name="Default" style:data-style-name="N37"/>
`),a.push(` </office:automatic-styles>
`)};return function(o,l){var c=[Tr],u=Zd({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:meta":"urn:oasis:names:tc:opendocument:xmlns:meta:1.0","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:presentation":"urn:oasis:names:tc:opendocument:xmlns:presentation:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:chart":"urn:oasis:names:tc:opendocument:xmlns:chart:1.0","xmlns:dr3d":"urn:oasis:names:tc:opendocument:xmlns:dr3d:1.0","xmlns:math":"http://www.w3.org/1998/Math/MathML","xmlns:form":"urn:oasis:names:tc:opendocument:xmlns:form:1.0","xmlns:script":"urn:oasis:names:tc:opendocument:xmlns:script:1.0","xmlns:ooo":"http://openoffice.org/2004/office","xmlns:ooow":"http://openoffice.org/2004/writer","xmlns:oooc":"http://openoffice.org/2004/calc","xmlns:dom":"http://www.w3.org/2001/xml-events","xmlns:xforms":"http://www.w3.org/2002/xforms","xmlns:xsd":"http://www.w3.org/2001/XMLSchema","xmlns:xsi":"http://www.w3.org/2001/XMLSchema-instance","xmlns:sheet":"urn:oasis:names:tc:opendocument:sh33tjs:1.0","xmlns:rpt":"http://openoffice.org/2005/report","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","xmlns:xhtml":"http://www.w3.org/1999/xhtml","xmlns:grddl":"http://www.w3.org/2003/g/data-view#","xmlns:tableooo":"http://openoffice.org/2009/table","xmlns:drawooo":"http://openoffice.org/2010/draw","xmlns:calcext":"urn:org:documentfoundation:names:experimental:calc:xmlns:calcext:1.0","xmlns:loext":"urn:org:documentfoundation:names:experimental:office:xmlns:loext:1.0","xmlns:field":"urn:openoffice:names:experimental:ooo-ms-interop:xmlns:field:1.0","xmlns:formx":"urn:openoffice:names:experimental:ooxml-odf-interop:xmlns:form:1.0","xmlns:css3t":"http://www.w3.org/TR/css3-text/","office:version":"1.2"}),d=Zd({"xmlns:config":"urn:oasis:names:tc:opendocument:xmlns:config:1.0","office:mimetype":"application/vnd.oasis.opendocument.spreadsheet"});l.bookType=="fods"?(c.push("<office:document"+u+d+`>
`),c.push(gA().replace(/office:document-meta/g,"office:meta"))):c.push("<office:document-content"+u+`>
`),s(c,o),c.push(`  <office:body>
`),c.push(`    <office:spreadsheet>
`);for(var f=0;f!=o.SheetNames.length;++f)c.push(n(o.Sheets[o.SheetNames[f]],o,f));return c.push(`    </office:spreadsheet>
`),c.push(`  </office:body>
`),l.bookType=="fods"?c.push("</office:document>"):c.push("</office:document-content>"),c.join("")}}();function rP(e,t){if(t.bookType=="fods")return AS(e,t);var r=cw(),n="",s=[],a=[];return n="mimetype",mt(r,n,"application/vnd.oasis.opendocument.spreadsheet"),n="content.xml",mt(r,n,AS(e,t)),s.push([n,"text/xml"]),a.push([n,"ContentFile"]),n="styles.xml",mt(r,n,NX(e,t)),s.push([n,"text/xml"]),a.push([n,"StylesFile"]),n="meta.xml",mt(r,n,Tr+gA()),s.push([n,"text/xml"]),a.push([n,"MetadataFile"]),n="manifest.rdf",mt(r,n,FW(a)),s.push([n,"application/rdf+xml"]),n="META-INF/manifest.xml",mt(r,n,MW(s)),r}/*! sheetjs (C) 2013-present SheetJS -- http://sheetjs.com */function h0(e){return new DataView(e.buffer,e.byteOffset,e.byteLength)}function jX(e){return typeof TextEncoder<"u"?new TextEncoder().encode(e):qs(Jd(e))}function EX(e,t){e:for(var r=0;r<=e.length-t.length;++r){for(var n=0;n<t.length;++n)if(e[r+n]!=t[n])continue e;return!0}return!1}function mo(e){var t=e.reduce(function(s,a){return s+a.length},0),r=new Uint8Array(t),n=0;return e.forEach(function(s){r.set(s,n),n+=s.length}),r}function kX(e,t,r){var n=Math.floor(r==0?0:Math.LOG10E*Math.log(Math.abs(r)))+6176-20,s=r/Math.pow(10,n-6176);e[t+15]|=n>>7,e[t+14]|=(n&127)<<1;for(var a=0;s>=1;++a,s/=256)e[t+a]=s&255;e[t+15]|=r>=0?0:128}function ef(e,t){var r=t?t[0]:0,n=e[r]&127;e:if(e[r++]>=128&&(n|=(e[r]&127)<<7,e[r++]<128||(n|=(e[r]&127)<<14,e[r++]<128)||(n|=(e[r]&127)<<21,e[r++]<128)||(n+=(e[r]&127)*Math.pow(2,28),++r,e[r++]<128)||(n+=(e[r]&127)*Math.pow(2,35),++r,e[r++]<128)||(n+=(e[r]&127)*Math.pow(2,42),++r,e[r++]<128)))break e;return t&&(t[0]=r),n}function Rt(e){var t=new Uint8Array(7);t[0]=e&127;var r=1;e:if(e>127){if(t[r-1]|=128,t[r]=e>>7&127,++r,e<=16383||(t[r-1]|=128,t[r]=e>>14&127,++r,e<=2097151)||(t[r-1]|=128,t[r]=e>>21&127,++r,e<=268435455)||(t[r-1]|=128,t[r]=e/256>>>21&127,++r,e<=34359738367)||(t[r-1]|=128,t[r]=e/65536>>>21&127,++r,e<=4398046511103))break e;t[r-1]|=128,t[r]=e/16777216>>>21&127,++r}return t.slice(0,r)}function _c(e){var t=0,r=e[t]&127;e:if(e[t++]>=128){if(r|=(e[t]&127)<<7,e[t++]<128||(r|=(e[t]&127)<<14,e[t++]<128)||(r|=(e[t]&127)<<21,e[t++]<128))break e;r|=(e[t]&127)<<28}return r}function Ar(e){for(var t=[],r=[0];r[0]<e.length;){var n=r[0],s=ef(e,r),a=s&7;s=Math.floor(s/8);var o=0,l;if(s==0)break;switch(a){case 0:{for(var c=r[0];e[r[0]++]>=128;);l=e.slice(c,r[0])}break;case 5:o=4,l=e.slice(r[0],r[0]+o),r[0]+=o;break;case 1:o=8,l=e.slice(r[0],r[0]+o),r[0]+=o;break;case 2:o=ef(e,r),l=e.slice(r[0],r[0]+o),r[0]+=o;break;case 3:case 4:default:throw new Error("PB Type ".concat(a," for Field ").concat(s," at offset ").concat(n))}var u={data:l,type:a};t[s]==null?t[s]=[u]:t[s].push(u)}return t}function Yr(e){var t=[];return e.forEach(function(r,n){r.forEach(function(s){s.data&&(t.push(Rt(n*8+s.type)),s.type==2&&t.push(Rt(s.data.length)),t.push(s.data))})}),mo(t)}function Fs(e){for(var t,r=[],n=[0];n[0]<e.length;){var s=ef(e,n),a=Ar(e.slice(n[0],n[0]+s));n[0]+=s;var o={id:_c(a[1][0].data),messages:[]};a[2].forEach(function(l){var c=Ar(l.data),u=_c(c[3][0].data);o.messages.push({meta:c,data:e.slice(n[0],n[0]+u)}),n[0]+=u}),(t=a[3])!=null&&t[0]&&(o.merge=_c(a[3][0].data)>>>0>0),r.push(o)}return r}function Bl(e){var t=[];return e.forEach(function(r){var n=[];n[1]=[{data:Rt(r.id),type:0}],n[2]=[],r.merge!=null&&(n[3]=[{data:Rt(+!!r.merge),type:0}]);var s=[];r.messages.forEach(function(o){s.push(o.data),o.meta[3]=[{type:0,data:Rt(o.data.length)}],n[2].push({data:Yr(o.meta),type:2})});var a=Yr(n);t.push(Rt(a.length)),t.push(a),s.forEach(function(o){return t.push(o)})}),mo(t)}function CX(e,t){if(e!=0)throw new Error("Unexpected Snappy chunk type ".concat(e));for(var r=[0],n=ef(t,r),s=[];r[0]<t.length;){var a=t[r[0]]&3;if(a==0){var o=t[r[0]++]>>2;if(o<60)++o;else{var l=o-59;o=t[r[0]],l>1&&(o|=t[r[0]+1]<<8),l>2&&(o|=t[r[0]+2]<<16),l>3&&(o|=t[r[0]+3]<<24),o>>>=0,o++,r[0]+=l}s.push(t.slice(r[0],r[0]+o)),r[0]+=o;continue}else{var c=0,u=0;if(a==1?(u=(t[r[0]]>>2&7)+4,c=(t[r[0]++]&224)<<3,c|=t[r[0]++]):(u=(t[r[0]++]>>2)+1,a==2?(c=t[r[0]]|t[r[0]+1]<<8,r[0]+=2):(c=(t[r[0]]|t[r[0]+1]<<8|t[r[0]+2]<<16|t[r[0]+3]<<24)>>>0,r[0]+=4)),s=[mo(s)],c==0)throw new Error("Invalid offset 0");if(c>s[0].length)throw new Error("Invalid offset beyond length");if(u>=c)for(s.push(s[0].slice(-c)),u-=c;u>=s[s.length-1].length;)s.push(s[s.length-1]),u-=s[s.length-1].length;s.push(s[0].slice(-c,-c+u))}}var d=mo(s);if(d.length!=n)throw new Error("Unexpected length: ".concat(d.length," != ").concat(n));return d}function Is(e){for(var t=[],r=0;r<e.length;){var n=e[r++],s=e[r]|e[r+1]<<8|e[r+2]<<16;r+=3,t.push(CX(n,e.slice(r,r+s))),r+=s}if(r!==e.length)throw new Error("data is not a valid framed stream!");return mo(t)}function Ul(e){for(var t=[],r=0;r<e.length;){var n=Math.min(e.length-r,268435455),s=new Uint8Array(4);t.push(s);var a=Rt(n),o=a.length;t.push(a),n<=60?(o++,t.push(new Uint8Array([n-1<<2]))):n<=256?(o+=2,t.push(new Uint8Array([240,n-1&255]))):n<=65536?(o+=3,t.push(new Uint8Array([244,n-1&255,n-1>>8&255]))):n<=16777216?(o+=4,t.push(new Uint8Array([248,n-1&255,n-1>>8&255,n-1>>16&255]))):n<=4294967296&&(o+=5,t.push(new Uint8Array([252,n-1&255,n-1>>8&255,n-1>>16&255,n-1>>>24&255]))),t.push(e.slice(r,r+n)),o+=n,s[0]=0,s[1]=o&255,s[2]=o>>8&255,s[3]=o>>16&255,r+=n}return mo(t)}function dx(e,t){var r=new Uint8Array(32),n=h0(r),s=12,a=0;switch(r[0]=5,e.t){case"n":r[1]=2,kX(r,s,e.v),a|=1,s+=16;break;case"b":r[1]=6,n.setFloat64(s,e.v?1:0,!0),a|=2,s+=8;break;case"s":if(t.indexOf(e.v)==-1)throw new Error("Value ".concat(e.v," missing from SST!"));r[1]=3,n.setUint32(s,t.indexOf(e.v),!0),a|=8,s+=4;break;default:throw"unsupported cell type "+e.t}return n.setUint32(8,a,!0),r.slice(0,s)}function fx(e,t){var r=new Uint8Array(32),n=h0(r),s=12,a=0;switch(r[0]=3,e.t){case"n":r[2]=2,n.setFloat64(s,e.v,!0),a|=32,s+=8;break;case"b":r[2]=6,n.setFloat64(s,e.v?1:0,!0),a|=32,s+=8;break;case"s":if(t.indexOf(e.v)==-1)throw new Error("Value ".concat(e.v," missing from SST!"));r[2]=3,n.setUint32(s,t.indexOf(e.v),!0),a|=16,s+=4;break;default:throw"unsupported cell type "+e.t}return n.setUint32(4,a,!0),r.slice(0,s)}function Ni(e){var t=Ar(e);return ef(t[1][0].data)}function TX(e,t,r){var n,s,a,o;if(!((n=e[6])!=null&&n[0])||!((s=e[7])!=null&&s[0]))throw"Mutation only works on post-BNC storages!";var l=((o=(a=e[8])==null?void 0:a[0])==null?void 0:o.data)&&_c(e[8][0].data)>0||!1;if(l)throw"Math only works with normal offsets";for(var c=0,u=h0(e[7][0].data),d=0,f=[],p=h0(e[4][0].data),h=0,g=[],m=0;m<t.length;++m){if(t[m]==null){u.setUint16(m*2,65535,!0),p.setUint16(m*2,65535);continue}u.setUint16(m*2,d,!0),p.setUint16(m*2,h,!0);var x,w;switch(typeof t[m]){case"string":x=dx({t:"s",v:t[m]},r),w=fx({t:"s",v:t[m]},r);break;case"number":x=dx({t:"n",v:t[m]},r),w=fx({t:"n",v:t[m]},r);break;case"boolean":x=dx({t:"b",v:t[m]},r),w=fx({t:"b",v:t[m]},r);break;default:throw new Error("Unsupported value "+t[m])}f.push(x),d+=x.length,g.push(w),h+=w.length,++c}for(e[2][0].data=Rt(c);m<e[7][0].data.length/2;++m)u.setUint16(m*2,65535,!0),p.setUint16(m*2,65535,!0);return e[6][0].data=mo(f),e[3][0].data=mo(g),c}function AX(e,t){if(!t||!t.numbers)throw new Error("Must pass a `numbers` option -- check the README");var r=e.Sheets[e.SheetNames[0]];e.SheetNames.length>1&&console.error("The Numbers writer currently writes only the first table");var n=ds(r["!ref"]);n.s.r=n.s.c=0;var s=!1;n.e.c>9&&(s=!0,n.e.c=9),n.e.r>49&&(s=!0,n.e.r=49),s&&console.error("The Numbers writer is currently limited to ".concat(Cr(n)));var a=m0(r,{range:n,header:1}),o=["~Sh33tJ5~"];a.forEach(function(G){return G.forEach(function(O){typeof O=="string"&&o.push(O)})});var l={},c=[],u=Ut.read(t.numbers,{type:"base64"});u.FileIndex.map(function(G,O){return[G,u.FullPaths[O]]}).forEach(function(G){var O=G[0],L=G[1];if(O.type==2&&O.name.match(/\.iwa/)){var ie=O.content,ne=Is(ie),me=Fs(ne);me.forEach(function(pe){c.push(pe.id),l[pe.id]={deps:[],location:L,type:_c(pe.messages[0].meta[1][0].data)}})}}),c.sort(function(G,O){return G-O});var d=c.filter(function(G){return G>1}).map(function(G){return[G,Rt(G)]});u.FileIndex.map(function(G,O){return[G,u.FullPaths[O]]}).forEach(function(G){var O=G[0];if(G[1],!!O.name.match(/\.iwa/)){var L=Fs(Is(O.content));L.forEach(function(ie){ie.messages.forEach(function(ne){d.forEach(function(me){ie.messages.some(function(pe){return _c(pe.meta[1][0].data)!=11006&&EX(pe.data,me[1])})&&l[me[0]].deps.push(ie.id)})})})}});for(var f=Ut.find(u,l[1].location),p=Fs(Is(f.content)),h,g=0;g<p.length;++g){var m=p[g];m.id==1&&(h=m)}var x=Ni(Ar(h.messages[0].data)[1][0].data);for(f=Ut.find(u,l[x].location),p=Fs(Is(f.content)),g=0;g<p.length;++g)m=p[g],m.id==x&&(h=m);for(x=Ni(Ar(h.messages[0].data)[2][0].data),f=Ut.find(u,l[x].location),p=Fs(Is(f.content)),g=0;g<p.length;++g)m=p[g],m.id==x&&(h=m);for(x=Ni(Ar(h.messages[0].data)[2][0].data),f=Ut.find(u,l[x].location),p=Fs(Is(f.content)),g=0;g<p.length;++g)m=p[g],m.id==x&&(h=m);var w=Ar(h.messages[0].data);{w[6][0].data=Rt(n.e.r+1),w[7][0].data=Rt(n.e.c+1);var v=Ni(w[46][0].data),_=Ut.find(u,l[v].location),b=Fs(Is(_.content));{for(var S=0;S<b.length&&b[S].id!=v;++S);if(b[S].id!=v)throw"Bad ColumnRowUIDMapArchive";var T=Ar(b[S].messages[0].data);T[1]=[],T[2]=[],T[3]=[];for(var N=0;N<=n.e.c;++N){var C=[];C[1]=C[2]=[{type:0,data:Rt(N+420690)}],T[1].push({type:2,data:Yr(C)}),T[2].push({type:0,data:Rt(N)}),T[3].push({type:0,data:Rt(N)})}T[4]=[],T[5]=[],T[6]=[];for(var E=0;E<=n.e.r;++E)C=[],C[1]=C[2]=[{type:0,data:Rt(E+726270)}],T[4].push({type:2,data:Yr(C)}),T[5].push({type:0,data:Rt(E)}),T[6].push({type:0,data:Rt(E)});b[S].messages[0].data=Yr(T)}_.content=Ul(Bl(b)),_.size=_.content.length,delete w[46];var P=Ar(w[4][0].data);{P[7][0].data=Rt(n.e.r+1);var R=Ar(P[1][0].data),j=Ni(R[2][0].data);_=Ut.find(u,l[j].location),b=Fs(Is(_.content));{if(b[0].id!=j)throw"Bad HeaderStorageBucket";var M=Ar(b[0].messages[0].data);for(E=0;E<a.length;++E){var A=Ar(M[2][0].data);A[1][0].data=Rt(E),A[4][0].data=Rt(a[E].length),M[2][E]={type:M[2][0].type,data:Yr(A)}}b[0].messages[0].data=Yr(M)}_.content=Ul(Bl(b)),_.size=_.content.length;var I=Ni(P[2][0].data);_=Ut.find(u,l[I].location),b=Fs(Is(_.content));{if(b[0].id!=I)throw"Bad HeaderStorageBucket";for(M=Ar(b[0].messages[0].data),N=0;N<=n.e.c;++N)A=Ar(M[2][0].data),A[1][0].data=Rt(N),A[4][0].data=Rt(n.e.r+1),M[2][N]={type:M[2][0].type,data:Yr(A)};b[0].messages[0].data=Yr(M)}_.content=Ul(Bl(b)),_.size=_.content.length;var X=Ni(P[4][0].data);(function(){for(var G=Ut.find(u,l[X].location),O=Fs(Is(G.content)),L,ie=0;ie<O.length;++ie){var ne=O[ie];ne.id==X&&(L=ne)}var me=Ar(L.messages[0].data);{me[3]=[];var pe=[];o.forEach(function(ge,je){pe[1]=[{type:0,data:Rt(je)}],pe[2]=[{type:0,data:Rt(1)}],pe[3]=[{type:2,data:jX(ge)}],me[3].push({type:2,data:Yr(pe)})})}L.messages[0].data=Yr(me);var xe=Bl(O),Ae=Ul(xe);G.content=Ae,G.size=G.content.length})();var Y=Ar(P[3][0].data);{var z=Y[1][0];delete Y[2];var U=Ar(z.data);{var V=Ni(U[2][0].data);(function(){for(var G=Ut.find(u,l[V].location),O=Fs(Is(G.content)),L,ie=0;ie<O.length;++ie){var ne=O[ie];ne.id==V&&(L=ne)}var me=Ar(L.messages[0].data);{delete me[6],delete Y[7];var pe=new Uint8Array(me[5][0].data);me[5]=[];for(var xe=0,Ae=0;Ae<=n.e.r;++Ae){var ge=Ar(pe);xe+=TX(ge,a[Ae],o),ge[1][0].data=Rt(Ae),me[5].push({data:Yr(ge),type:2})}me[1]=[{type:0,data:Rt(n.e.c+1)}],me[2]=[{type:0,data:Rt(n.e.r+1)}],me[3]=[{type:0,data:Rt(xe)}],me[4]=[{type:0,data:Rt(n.e.r+1)}]}L.messages[0].data=Yr(me);var je=Bl(O),k=Ul(je);G.content=k,G.size=G.content.length})()}z.data=Yr(U)}P[3][0].data=Yr(Y)}w[4][0].data=Yr(P)}h.messages[0].data=Yr(w);var F=Bl(p),D=Ul(F);return f.content=D,f.size=f.content.length,u}function PX(e){return function(r){for(var n=0;n!=e.length;++n){var s=e[n];r[s[0]]===void 0&&(r[s[0]]=s[1]),s[2]==="n"&&(r[s[0]]=Number(r[s[0]]))}}}function jw(e){PX([["cellDates",!1],["bookSST",!1],["bookType","xlsx"],["compression",!1],["WTF",!1]])(e)}function DX(e,t){return t.bookType=="ods"?rP(e,t):t.bookType=="numbers"?AX(e,t):t.bookType=="xlsb"?RX(e,t):MX(e,t)}function RX(e,t){ic=1024,e&&!e.SSF&&(e.SSF=Yn(pr)),e&&e.SSF&&(Pp(),Ap(e.SSF),t.revssf=Dp(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF),t.rels={},t.wbrels={},t.Strings=[],t.Strings.Count=0,t.Strings.Unique=0,xd?t.revStrings=new Map:(t.revStrings={},t.revStrings.foo=[],delete t.revStrings.foo);var r=t.bookType=="xlsb"?"bin":"xml",n=LA.indexOf(t.bookType)>-1,s=hA();jw(t=t||{});var a=cw(),o="",l=0;if(t.cellXfs=[],No(t.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={}),o="docProps/core.xml",mt(a,o,xA(e.Props,t)),s.coreprops.push(o),Ot(t.rels,2,o,Tt.CORE_PROPS),o="docProps/app.xml",!(e.Props&&e.Props.SheetNames))if(!e.Workbook||!e.Workbook.Sheets)e.Props.SheetNames=e.SheetNames;else{for(var c=[],u=0;u<e.SheetNames.length;++u)(e.Workbook.Sheets[u]||{}).Hidden!=2&&c.push(e.SheetNames[u]);e.Props.SheetNames=c}for(e.Props.Worksheets=e.Props.SheetNames.length,mt(a,o,yA(e.Props)),s.extprops.push(o),Ot(t.rels,3,o,Tt.EXT_PROPS),e.Custprops!==e.Props&&an(e.Custprops||{}).length>0&&(o="docProps/custom.xml",mt(a,o,wA(e.Custprops)),s.custprops.push(o),Ot(t.rels,4,o,Tt.CUST_PROPS)),l=1;l<=e.SheetNames.length;++l){var d={"!id":{}},f=e.Sheets[e.SheetNames[l-1]],p=(f||{})["!type"]||"sheet";switch(p){case"chart":default:o="xl/worksheets/sheet"+l+"."+r,mt(a,o,FK(l-1,o,t,e,d)),s.sheets.push(o),Ot(t.wbrels,-1,"worksheets/sheet"+l+"."+r,Tt.WS[0])}if(f){var h=f["!comments"],g=!1,m="";h&&h.length>0&&(m="xl/comments"+l+"."+r,mt(a,m,$K(h,m)),s.comments.push(m),Ot(d,-1,"../comments"+l+"."+r,Tt.CMNT),g=!0),f["!legacy"]&&g&&mt(a,"xl/drawings/vmlDrawing"+l+".vml",FA(l,f["!comments"])),delete f["!comments"],delete f["!legacy"]}d["!id"].rId1&&mt(a,pA(o),yc(d))}return t.Strings!=null&&t.Strings.length>0&&(o="xl/sharedStrings."+r,mt(a,o,LK(t.Strings,o,t)),s.strs.push(o),Ot(t.wbrels,-1,"sharedStrings."+r,Tt.SST)),o="xl/workbook."+r,mt(a,o,OK(e,o)),s.workbooks.push(o),Ot(t.rels,1,o,Tt.WB),o="xl/theme/theme1.xml",mt(a,o,MA(e.Themes,t)),s.themes.push(o),Ot(t.wbrels,-1,"theme/theme1.xml",Tt.THEME),o="xl/styles."+r,mt(a,o,IK(e,o,t)),s.styles.push(o),Ot(t.wbrels,-1,"styles."+r,Tt.STY),e.vbaraw&&n&&(o="xl/vbaProject.bin",mt(a,o,e.vbaraw),s.vba.push(o),Ot(t.wbrels,-1,"vbaProject.bin",Tt.VBA)),o="xl/metadata."+r,mt(a,o,BK(o)),s.metadata.push(o),Ot(t.wbrels,-1,"metadata."+r,Tt.XLMETA),mt(a,"[Content_Types].xml",mA(s,t)),mt(a,"_rels/.rels",yc(t.rels)),mt(a,"xl/_rels/workbook."+r+".rels",yc(t.wbrels)),delete t.revssf,delete t.ssf,a}function MX(e,t){ic=1024,e&&!e.SSF&&(e.SSF=Yn(pr)),e&&e.SSF&&(Pp(),Ap(e.SSF),t.revssf=Dp(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF),t.rels={},t.wbrels={},t.Strings=[],t.Strings.Count=0,t.Strings.Unique=0,xd?t.revStrings=new Map:(t.revStrings={},t.revStrings.foo=[],delete t.revStrings.foo);var r="xml",n=LA.indexOf(t.bookType)>-1,s=hA();jw(t=t||{});var a=cw(),o="",l=0;if(t.cellXfs=[],No(t.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={}),o="docProps/core.xml",mt(a,o,xA(e.Props,t)),s.coreprops.push(o),Ot(t.rels,2,o,Tt.CORE_PROPS),o="docProps/app.xml",!(e.Props&&e.Props.SheetNames))if(!e.Workbook||!e.Workbook.Sheets)e.Props.SheetNames=e.SheetNames;else{for(var c=[],u=0;u<e.SheetNames.length;++u)(e.Workbook.Sheets[u]||{}).Hidden!=2&&c.push(e.SheetNames[u]);e.Props.SheetNames=c}e.Props.Worksheets=e.Props.SheetNames.length,mt(a,o,yA(e.Props)),s.extprops.push(o),Ot(t.rels,3,o,Tt.EXT_PROPS),e.Custprops!==e.Props&&an(e.Custprops||{}).length>0&&(o="docProps/custom.xml",mt(a,o,wA(e.Custprops)),s.custprops.push(o),Ot(t.rels,4,o,Tt.CUST_PROPS));var d=["SheetJ5"];for(t.tcid=0,l=1;l<=e.SheetNames.length;++l){var f={"!id":{}},p=e.Sheets[e.SheetNames[l-1]],h=(p||{})["!type"]||"sheet";switch(h){case"chart":default:o="xl/worksheets/sheet"+l+"."+r,mt(a,o,qA(l-1,t,e,f)),s.sheets.push(o),Ot(t.wbrels,-1,"worksheets/sheet"+l+"."+r,Tt.WS[0])}if(p){var g=p["!comments"],m=!1,x="";if(g&&g.length>0){var w=!1;g.forEach(function(v){v[1].forEach(function(_){_.T==!0&&(w=!0)})}),w&&(x="xl/threadedComments/threadedComment"+l+"."+r,mt(a,x,dG(g,d,t)),s.threadedcomments.push(x),Ot(f,-1,"../threadedComments/threadedComment"+l+"."+r,Tt.TCMNT)),x="xl/comments"+l+"."+r,mt(a,x,IA(g)),s.comments.push(x),Ot(f,-1,"../comments"+l+"."+r,Tt.CMNT),m=!0}p["!legacy"]&&m&&mt(a,"xl/drawings/vmlDrawing"+l+".vml",FA(l,p["!comments"])),delete p["!comments"],delete p["!legacy"]}f["!id"].rId1&&mt(a,pA(o),yc(f))}return t.Strings!=null&&t.Strings.length>0&&(o="xl/sharedStrings."+r,mt(a,o,CA(t.Strings,t)),s.strs.push(o),Ot(t.wbrels,-1,"sharedStrings."+r,Tt.SST)),o="xl/workbook."+r,mt(a,o,XA(e)),s.workbooks.push(o),Ot(t.rels,1,o,Tt.WB),o="xl/theme/theme1.xml",mt(a,o,MA(e.Themes,t)),s.themes.push(o),Ot(t.wbrels,-1,"theme/theme1.xml",Tt.THEME),o="xl/styles."+r,mt(a,o,DA(e,t)),s.styles.push(o),Ot(t.wbrels,-1,"styles."+r,Tt.STY),e.vbaraw&&n&&(o="xl/vbaProject.bin",mt(a,o,e.vbaraw),s.vba.push(o),Ot(t.wbrels,-1,"vbaProject.bin",Tt.VBA)),o="xl/metadata."+r,mt(a,o,OA()),s.metadata.push(o),Ot(t.wbrels,-1,"metadata."+r,Tt.XLMETA),d.length>1&&(o="xl/persons/person.xml",mt(a,o,fG(d)),s.people.push(o),Ot(t.wbrels,-1,"persons/person.xml",Tt.PEOPLE)),mt(a,"[Content_Types].xml",mA(s,t)),mt(a,"_rels/.rels",yc(t.rels)),mt(a,"xl/_rels/workbook."+r+".rels",yc(t.wbrels)),delete t.revssf,delete t.ssf,a}function OX(e,t){var r="";switch((t||{}).type||"base64"){case"buffer":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];case"base64":r=pi(e.slice(0,12));break;case"binary":r=e;break;case"array":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];default:throw new Error("Unrecognized type "+(t&&t.type||"undefined"))}return[r.charCodeAt(0),r.charCodeAt(1),r.charCodeAt(2),r.charCodeAt(3),r.charCodeAt(4),r.charCodeAt(5),r.charCodeAt(6),r.charCodeAt(7)]}function nP(e,t){switch(t.type){case"base64":case"binary":break;case"buffer":case"array":t.type="";break;case"file":return Bf(t.file,Ut.write(e,{type:At?"buffer":""}));case"string":throw new Error("'string' output type invalid for '"+t.bookType+"' files");default:throw new Error("Unrecognized type "+t.type)}return Ut.write(e,t)}function FX(e,t){var r=Yn(t||{}),n=DX(e,r);return IX(n,r)}function IX(e,t){var r={},n=At?"nodebuffer":typeof Uint8Array<"u"?"array":"string";if(t.compression&&(r.compression="DEFLATE"),t.password)r.type=n;else switch(t.type){case"base64":r.type="base64";break;case"binary":r.type="string";break;case"string":throw new Error("'string' output type invalid for '"+t.bookType+"' files");case"buffer":case"file":r.type=n;break;default:throw new Error("Unrecognized type "+t.type)}var s=e.FullPaths?Ut.write(e,{fileType:"zip",type:{nodebuffer:"buffer",string:"binary"}[r.type]||r.type,compression:!!t.compression}):e.generate(r);if(typeof Deno<"u"&&typeof s=="string"){if(t.type=="binary"||t.type=="base64")return s;s=new Uint8Array(Tp(s))}return t.password&&typeof encrypt_agile<"u"?nP(encrypt_agile(s,t.password),t):t.type==="file"?Bf(t.file,s):t.type=="string"?hd(s):s}function LX(e,t){var r=t||{},n=eX(e,r);return nP(n,r)}function xa(e,t,r){r||(r="");var n=r+e;switch(t.type){case"base64":return Xd(Jd(n));case"binary":return Jd(n);case"string":return e;case"file":return Bf(t.file,n,"utf8");case"buffer":return At?yi(n,"utf8"):typeof TextEncoder<"u"?new TextEncoder().encode(n):xa(n,{type:"binary"}).split("").map(function(s){return s.charCodeAt(0)})}throw new Error("Unrecognized type "+t.type)}function $X(e,t){switch(t.type){case"base64":return Xd(e);case"binary":return e;case"string":return e;case"file":return Bf(t.file,e,"binary");case"buffer":return At?yi(e,"binary"):e.split("").map(function(r){return r.charCodeAt(0)})}throw new Error("Unrecognized type "+t.type)}function Bh(e,t){switch(t.type){case"string":case"base64":case"binary":for(var r="",n=0;n<e.length;++n)r+=String.fromCharCode(e[n]);return t.type=="base64"?Xd(r):t.type=="string"?hd(r):r;case"file":return Bf(t.file,e);case"buffer":return e;default:throw new Error("Unrecognized type "+t.type)}}function sP(e,t){hV(),NK(e);var r=Yn(t||{});if(r.cellStyles&&(r.cellNF=!0,r.sheetStubs=!0),r.type=="array"){r.type="binary";var n=sP(e,r);return r.type="array",Tp(n)}var s=0;if(r.sheet&&(typeof r.sheet=="number"?s=r.sheet:s=e.SheetNames.indexOf(r.sheet),!e.SheetNames[s]))throw new Error("Sheet not found: "+r.sheet+" : "+typeof r.sheet);switch(r.bookType||"xlsb"){case"xml":case"xlml":return xa(JK(e,r),r);case"slk":case"sylk":return xa(_H.from_sheet(e.Sheets[e.SheetNames[s]],r),r);case"htm":case"html":return xa(ZA(e.Sheets[e.SheetNames[s]],r),r);case"txt":return $X(aP(e.Sheets[e.SheetNames[s]],r),r);case"csv":return xa(Ew(e.Sheets[e.SheetNames[s]],r),r,"\uFEFF");case"dif":return xa(bH.from_sheet(e.Sheets[e.SheetNames[s]],r),r);case"dbf":return Bh(wH.from_sheet(e.Sheets[e.SheetNames[s]],r),r);case"prn":return xa(SH.from_sheet(e.Sheets[e.SheetNames[s]],r),r);case"rtf":return xa(AH.from_sheet(e.Sheets[e.SheetNames[s]],r),r);case"eth":return xa(kA.from_sheet(e.Sheets[e.SheetNames[s]],r),r);case"fods":return xa(rP(e,r),r);case"wk1":return Bh(SS.sheet_to_wk1(e.Sheets[e.SheetNames[s]],r),r);case"wk3":return Bh(SS.book_to_wk3(e,r),r);case"biff2":r.biff||(r.biff=2);case"biff3":r.biff||(r.biff=3);case"biff4":return r.biff||(r.biff=4),Bh(JA(e,r),r);case"biff5":r.biff||(r.biff=5);case"biff8":case"xla":case"xls":return r.biff||(r.biff=8),LX(e,r);case"xlsx":case"xlsm":case"xlam":case"xlsb":case"numbers":case"ods":return FX(e,r);default:throw new Error("Unrecognized bookType |"+r.bookType+"|")}}function BX(e){if(!e.bookType){var t={xls:"biff8",htm:"html",slk:"sylk",socialcalc:"eth",Sh33tJS:"WTF"},r=e.file.slice(e.file.lastIndexOf(".")).toLowerCase();r.match(/^\.[a-z]+$/)&&(e.bookType=r.slice(1)),e.bookType=t[e.bookType]||e.bookType}}function fm(e,t,r){var n={};return n.type="file",n.file=t,BX(n),sP(e,n)}function UX(e,t,r,n,s,a,o,l){var c=nn(r),u=l.defval,d=l.raw||!Object.prototype.hasOwnProperty.call(l,"raw"),f=!0,p=s===1?[]:{};if(s!==1)if(Object.defineProperty)try{Object.defineProperty(p,"__rowNum__",{value:r,enumerable:!1})}catch{p.__rowNum__=r}else p.__rowNum__=r;if(!o||e[r])for(var h=t.s.c;h<=t.e.c;++h){var g=o?e[r][h]:e[n[h]+c];if(g===void 0||g.t===void 0){if(u===void 0)continue;a[h]!=null&&(p[a[h]]=u);continue}var m=g.v;switch(g.t){case"z":if(m==null)break;continue;case"e":m=m==0?null:void 0;break;case"s":case"d":case"b":case"n":break;default:throw new Error("unrecognized type "+g.t)}if(a[h]!=null){if(m==null)if(g.t=="e"&&m===null)p[a[h]]=null;else if(u!==void 0)p[a[h]]=u;else if(d&&m===null)p[a[h]]=null;else continue;else p[a[h]]=d&&(g.t!=="n"||g.t==="n"&&l.rawNumbers!==!1)?m:gi(g,m,l);m!=null&&(f=!1)}}return{row:p,isempty:f}}function m0(e,t){if(e==null||e["!ref"]==null)return[];var r={t:"n",v:0},n=0,s=1,a=[],o=0,l="",c={s:{r:0,c:0},e:{r:0,c:0}},u=t||{},d=u.range!=null?u.range:e["!ref"];switch(u.header===1?n=1:u.header==="A"?n=2:Array.isArray(u.header)?n=3:u.header==null&&(n=0),typeof d){case"string":c=Kt(d);break;case"number":c=Kt(e["!ref"]),c.s.r=d;break;default:c=d}n>0&&(s=0);var f=nn(c.s.r),p=[],h=[],g=0,m=0,x=Array.isArray(e),w=c.s.r,v=0,_={};x&&!e[w]&&(e[w]=[]);var b=u.skipHidden&&e["!cols"]||[],S=u.skipHidden&&e["!rows"]||[];for(v=c.s.c;v<=c.e.c;++v)if(!(b[v]||{}).hidden)switch(p[v]=gn(v),r=x?e[w][v]:e[p[v]+f],n){case 1:a[v]=v-c.s.c;break;case 2:a[v]=p[v];break;case 3:a[v]=u.header[v-c.s.c];break;default:if(r==null&&(r={w:"__EMPTY",t:"s"}),l=o=gi(r,null,u),m=_[o]||0,!m)_[o]=1;else{do l=o+"_"+m++;while(_[l]);_[o]=m,_[l]=1}a[v]=l}for(w=c.s.r+s;w<=c.e.r;++w)if(!(S[w]||{}).hidden){var T=UX(e,c,w,p,n,a,x,u);(T.isempty===!1||(n===1?u.blankrows!==!1:u.blankrows))&&(h[g++]=T.row)}return h.length=g,h}var PS=/"/g;function zX(e,t,r,n,s,a,o,l){for(var c=!0,u=[],d="",f=nn(r),p=t.s.c;p<=t.e.c;++p)if(n[p]){var h=l.dense?(e[r]||[])[p]:e[n[p]+f];if(h==null)d="";else if(h.v!=null){c=!1,d=""+(l.rawNumbers&&h.t=="n"?h.v:gi(h,null,l));for(var g=0,m=0;g!==d.length;++g)if((m=d.charCodeAt(g))===s||m===a||m===34||l.forceQuotes){d='"'+d.replace(PS,'""')+'"';break}d=="ID"&&(d='"ID"')}else h.f!=null&&!h.F?(c=!1,d="="+h.f,d.indexOf(",")>=0&&(d='"'+d.replace(PS,'""')+'"')):d="";u.push(d)}return l.blankrows===!1&&c?null:u.join(o)}function Ew(e,t){var r=[],n=t??{};if(e==null||e["!ref"]==null)return"";var s=Kt(e["!ref"]),a=n.FS!==void 0?n.FS:",",o=a.charCodeAt(0),l=n.RS!==void 0?n.RS:`
`,c=l.charCodeAt(0),u=new RegExp((a=="|"?"\\|":a)+"+$"),d="",f=[];n.dense=Array.isArray(e);for(var p=n.skipHidden&&e["!cols"]||[],h=n.skipHidden&&e["!rows"]||[],g=s.s.c;g<=s.e.c;++g)(p[g]||{}).hidden||(f[g]=gn(g));for(var m=0,x=s.s.r;x<=s.e.r;++x)(h[x]||{}).hidden||(d=zX(e,s,x,f,o,c,a,n),d!=null&&(n.strip&&(d=d.replace(u,"")),(d||n.blankrows!==!1)&&r.push((m++?l:"")+d)));return delete n.dense,r.join("")}function aP(e,t){t||(t={}),t.FS="	",t.RS=`
`;var r=Ew(e,t);return r}function VX(e){var t="",r,n="";if(e==null||e["!ref"]==null)return[];var s=Kt(e["!ref"]),a="",o=[],l,c=[],u=Array.isArray(e);for(l=s.s.c;l<=s.e.c;++l)o[l]=gn(l);for(var d=s.s.r;d<=s.e.r;++d)for(a=nn(d),l=s.s.c;l<=s.e.c;++l)if(t=o[l]+a,r=u?(e[d]||[])[l]:e[t],n="",r!==void 0){if(r.F!=null){if(t=r.F,!r.f)continue;n=r.f,t.indexOf(":")==-1&&(t=t+":"+t)}if(r.f!=null)n=r.f;else{if(r.t=="z")continue;if(r.t=="n"&&r.v!=null)n=""+r.v;else if(r.t=="b")n=r.v?"TRUE":"FALSE";else if(r.w!==void 0)n="'"+r.w;else{if(r.v===void 0)continue;r.t=="s"?n="'"+r.v:n=""+r.v}}c[c.length]=t+"="+n}return c}function iP(e,t,r){var n=r||{},s=+!n.skipHeader,a=e||{},o=0,l=0;if(a&&n.origin!=null)if(typeof n.origin=="number")o=n.origin;else{var c=typeof n.origin=="string"?Wr(n.origin):n.origin;o=c.r,l=c.c}var u,d={s:{c:0,r:0},e:{c:l,r:o+t.length-1+s}};if(a["!ref"]){var f=Kt(a["!ref"]);d.e.c=Math.max(d.e.c,f.e.c),d.e.r=Math.max(d.e.r,f.e.r),o==-1&&(o=f.e.r+1,d.e.r=o+t.length-1+s)}else o==-1&&(o=0,d.e.r=t.length-1+s);var p=n.header||[],h=0;t.forEach(function(m,x){an(m).forEach(function(w){(h=p.indexOf(w))==-1&&(p[h=p.length]=w);var v=m[w],_="z",b="",S=Lt({c:l+h,r:o+x+s});u=tf(a,S),v&&typeof v=="object"&&!(v instanceof Date)?a[S]=v:(typeof v=="number"?_="n":typeof v=="boolean"?_="b":typeof v=="string"?_="s":v instanceof Date?(_="d",n.cellDates||(_="n",v=qn(v)),b=n.dateNF||pr[14]):v===null&&n.nullError&&(_="e",v=0),u?(u.t=_,u.v=v,delete u.w,delete u.R,b&&(u.z=b)):a[S]=u={t:_,v},b&&(u.z=b))})}),d.e.c=Math.max(d.e.c,l+p.length-1);var g=nn(o);if(s)for(h=0;h<p.length;++h)a[gn(h+l)+g]={t:"s",v:p[h]};return a["!ref"]=Cr(d),a}function WX(e,t){return iP(null,e,t)}function tf(e,t,r){if(typeof t=="string"){if(Array.isArray(e)){var n=Wr(t);return e[n.r]||(e[n.r]=[]),e[n.r][n.c]||(e[n.r][n.c]={t:"z"})}return e[t]||(e[t]={t:"z"})}return typeof t!="number"?tf(e,Lt(t)):tf(e,Lt({r:t,c:r||0}))}function HX(e,t){if(typeof t=="number"){if(t>=0&&e.SheetNames.length>t)return t;throw new Error("Cannot find sheet # "+t)}else if(typeof t=="string"){var r=e.SheetNames.indexOf(t);if(r>-1)return r;throw new Error("Cannot find sheet name |"+t+"|")}else throw new Error("Cannot find sheet |"+t+"|")}function GX(){return{SheetNames:[],Sheets:{}}}function qX(e,t,r,n){var s=1;if(!r)for(;s<=65535&&e.SheetNames.indexOf(r="Sheet"+s)!=-1;++s,r=void 0);if(!r||e.SheetNames.length>=65535)throw new Error("Too many worksheets");if(n&&e.SheetNames.indexOf(r)>=0){var a=r.match(/(^.*?)(\d+)$/);s=a&&+a[2]||0;var o=a&&a[1]||r;for(++s;s<=65535&&e.SheetNames.indexOf(r=o+s)!=-1;++s);}if(KA(r),e.SheetNames.indexOf(r)>=0)throw new Error("Worksheet with name |"+r+"| already exists!");return e.SheetNames.push(r),e.Sheets[r]=t,r}function YX(e,t,r){e.Workbook||(e.Workbook={}),e.Workbook.Sheets||(e.Workbook.Sheets=[]);var n=HX(e,t);switch(e.Workbook.Sheets[n]||(e.Workbook.Sheets[n]={}),r){case 0:case 1:case 2:break;default:throw new Error("Bad sheet visibility setting "+r)}e.Workbook.Sheets[n].Hidden=r}function KX(e,t){return e.z=t,e}function oP(e,t,r){return t?(e.l={Target:t},r&&(e.l.Tooltip=r)):delete e.l,e}function XX(e,t,r){return oP(e,"#"+t,r)}function QX(e,t,r){e.c||(e.c=[]),e.c.push({t,a:r||"SheetJS"})}function JX(e,t,r,n){for(var s=typeof t!="string"?t:Kt(t),a=typeof t=="string"?t:Cr(t),o=s.s.r;o<=s.e.r;++o)for(var l=s.s.c;l<=s.e.c;++l){var c=tf(e,o,l);c.t="n",c.F=a,delete c.v,o==s.s.r&&l==s.s.c&&(c.f=r,n&&(c.D=!0))}return e}var gs={encode_col:gn,encode_row:nn,encode_cell:Lt,encode_range:Cr,decode_col:pw,decode_row:mw,split_cell:hW,decode_cell:Wr,decode_range:ds,format_cell:gi,sheet_add_aoa:oA,sheet_add_json:iP,sheet_add_dom:eP,aoa_to_sheet:hu,json_to_sheet:WX,table_to_sheet:tP,table_to_book:bX,sheet_to_csv:Ew,sheet_to_txt:aP,sheet_to_json:m0,sheet_to_html:ZA,sheet_to_formulae:VX,sheet_to_row_object_array:m0,sheet_get_cell:tf,book_new:GX,book_append_sheet:qX,book_set_sheet_visibility:YX,cell_set_number_format:KX,cell_set_hyperlink:oP,cell_set_internal_link:XX,cell_add_comment:QX,sheet_set_array_formula:JX,consts:{SHEET_VISIBLE:0,SHEET_HIDDEN:1,SHEET_VERY_HIDDEN:2}};const kw=({documentId:e,documentName:t,documentType:r="document",buttonClassName:n="",iconOnly:s=!1})=>{const[a,o]=y.useState(null),[l,c]=y.useState(!1),[u,d]=y.useState(!1),f=async()=>{c(!0);try{console.log("Fetching analytics for:",r,e);let m={view_count:0,download_count:0};if(r==="meeting_attachment"){const{data:C}=await he.from("meeting_attachments").select("view_count, download_count").eq("id",e).single();C&&(m={view_count:C.view_count??0,download_count:C.download_count??0})}else if(r==="poll_attachment"){const{data:C}=await he.from("poll_attachments").select("view_count, download_count").eq("id",e).single();C&&(m={view_count:C.view_count??0,download_count:C.download_count??0})}const{data:x,error:w}=await he.from("document_analytics").select(`
          user_id,
          action_type,
          created_at,
          profiles(
            first_name,
            last_name,
            email
          )
        `).eq("document_id",e).eq("document_type",r).order("created_at",{ascending:!1});if(w)throw console.error("Error fetching analytics with profiles:",w),new Error(`Analytics fetch failed: ${w.message}`);console.log("Analytics data with profiles:",x);let v=[];if(r==="document"){const{data:C,error:E}=await he.from("document_views").select(`
            user_id,
            time_spent_seconds,
            profiles(
              first_name,
              last_name,
              email
            )
          `).eq("document_id",e);E?console.error("Error fetching time data:",E):C&&(v=C,console.log("Time spent data:",v))}const _={};x&&x.length>0&&x.forEach(C=>{const E=C.user_id,P=C.profiles;let R="Unknown User";P&&typeof P=="object"?P.first_name&&P.last_name?R=`${P.first_name} ${P.last_name}`.trim():P.first_name?R=P.first_name:P.last_name?R=P.last_name:P.email&&(R=P.email.split("@")[0]):(console.warn(`No profile found for user ${E} in analytics record`),R=`User ${E.substring(0,8)}...`),_[E]||(_[E]={name:R,views:0,downloads:0,timeSpent:0,lastViewed:C.created_at}),C.action_type==="view"?_[E].views++:C.action_type==="download"&&_[E].downloads++,new Date(C.created_at)>new Date(_[E].lastViewed)&&(_[E].lastViewed=C.created_at)}),v.length>0&&v.forEach(C=>{const E=C.user_id,P=C.profiles;let R="Unknown User";P&&typeof P=="object"?P.first_name&&P.last_name?R=`${P.first_name} ${P.last_name}`.trim():P.first_name?R=P.first_name:P.last_name?R=P.last_name:P.email&&(R=P.email.split("@")[0]):(console.warn(`No profile found for user ${E} in time spent record`),R=`User ${E.substring(0,8)}...`),_[E]?_[E].timeSpent+=C.time_spent_seconds||0:_[E]={name:R,views:0,downloads:0,timeSpent:C.time_spent_seconds||0,lastViewed:new Date().toISOString()}});const b=Object.values(_).sort((C,E)=>E.views-C.views),S=m.view_count||0,T=m.download_count||0,N=b.reduce((C,E)=>C+E.timeSpent,0);o({totalViews:S,totalTimeSpent:N,memberAnalytics:b.map(C=>({name:C.name,views:C.views,timeSpent:C.timeSpent,lastViewed:C.lastViewed}))}),console.log("Analytics processed successfully:",{totalViews:S,totalDownloads:T,totalTimeSpent:N,memberCount:b.length,memberData:b})}catch(m){console.error("Error fetching analytics:",m),o({totalViews:0,totalTimeSpent:0,memberAnalytics:[]})}finally{c(!1)}},p=m=>{if(m===0)return"0s";const x=Math.floor(m/60),w=m%60;return x>0?w>0?`${x}m ${w}s`:`${x}m`:`${w}s`},h=()=>{switch(r){case"meeting_attachment":return"Meeting Attachment";case"poll_attachment":return"Poll Attachment";default:return"Document"}},g=()=>{if(!a||!a.memberAnalytics.length)return;const m=gs.json_to_sheet(a.memberAnalytics.map(v=>({Member:v.name,Views:v.views,"Time Spent (s)":v.timeSpent,"Last Viewed":v.lastViewed}))),x=gs.book_new();gs.book_append_sheet(x,m,"Analytics");const w=`${t.replace(/[^a-zA-Z0-9]/g,"_")}_analytics_${vt(new Date,"yyyyMMdd_HHmm")}.xlsx`;fm(x,w)};return i.jsxs(Nt,{open:u,onOpenChange:d,children:[i.jsx(BT,{asChild:!0,children:i.jsxs(ue,{size:"sm",variant:"outline",onClick:()=>{d(!0),f()},className:n,children:[i.jsx(Wi,{className:s?"h-4 w-4":"h-3 w-3 mr-1"}),!s&&"Analytics"]})}),i.jsxs(bt,{className:"max-w-4xl max-h-[80vh] overflow-y-auto",children:[i.jsxs(jt,{children:[i.jsxs(Et,{className:"flex items-center gap-2",children:[i.jsx(Wi,{className:"h-5 w-5"}),h()," Analytics"]}),i.jsxs($t,{children:['Analytics for "',t,'"']})]}),l?i.jsx("div",{className:"flex items-center justify-center py-8",children:i.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary"})}):a?i.jsxs("div",{className:"space-y-6",children:[i.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[i.jsxs(Ye,{children:[i.jsx(ct,{className:"pb-2",children:i.jsxs(ft,{className:"text-sm font-medium flex items-center gap-2",children:[i.jsx(Or,{className:"h-4 w-4"}),"Total Views"]})}),i.jsxs(Je,{children:[i.jsx("div",{className:"text-2xl font-bold",children:a.totalViews}),i.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:"Times this file has been viewed"})]})]}),i.jsxs(Ye,{children:[i.jsx(ct,{className:"pb-2",children:i.jsxs(ft,{className:"text-sm font-medium flex items-center gap-2",children:[i.jsx(qr,{className:"h-4 w-4"}),"Total Time Spent"]})}),i.jsxs(Je,{children:[i.jsx("div",{className:"text-2xl font-bold",children:p(a.totalTimeSpent)}),i.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:"Cumulative viewing time"})]})]})]}),a.memberAnalytics.length>0?i.jsxs(Ye,{children:[i.jsxs(ct,{children:[i.jsxs(ft,{className:"flex items-center gap-2",children:[i.jsx(mr,{className:"h-4 w-4"}),"Member Analytics",i.jsx(ue,{size:"sm",variant:"outline",className:"ml-auto",onClick:g,children:"Download Excel"})]}),i.jsx(tn,{children:"Individual member viewing activity"})]}),i.jsx(Je,{children:i.jsxs(Ff,{children:[i.jsx(If,{children:i.jsxs(mi,{children:[i.jsx(dr,{children:"Member"}),i.jsx(dr,{children:"Views"}),i.jsx(dr,{children:"Time Spent"}),i.jsx(dr,{children:"Last Viewed"})]})}),i.jsx(Lf,{children:a.memberAnalytics.map((m,x)=>i.jsxs(mi,{children:[i.jsx(fr,{className:"font-medium",children:m.name}),i.jsx(fr,{children:i.jsxs("div",{className:"flex items-center gap-1",children:[i.jsx(Or,{className:"h-3 w-3 text-gray-400"}),m.views]})}),i.jsx(fr,{children:i.jsxs("div",{className:"flex items-center gap-1",children:[i.jsx(qr,{className:"h-3 w-3 text-gray-400"}),p(m.timeSpent)]})}),i.jsx(fr,{children:vt(new Date(m.lastViewed),"MMM d, hh:mm a")})]},x))})]})})]}):i.jsxs("div",{className:"text-center py-8 text-gray-500",children:[i.jsx(Wi,{className:"h-12 w-12 mx-auto mb-4 text-gray-300"}),i.jsx("p",{className:"text-lg font-medium",children:"No member activity yet"}),i.jsxs("p",{className:"text-sm mt-2",children:["Member views and activity will appear here once users interact with this ",r.replace("_"," ").toLowerCase()]})]})]}):i.jsxs("div",{className:"text-center py-8 text-gray-500",children:[i.jsx(Wi,{className:"h-12 w-12 mx-auto mb-4 text-gray-300"}),i.jsx("p",{children:"Failed to load analytics data"})]})]})]})},lP=({open:e,onOpenChange:t,meeting:r})=>{var A;const[n,s]=y.useState([]),[a,o]=y.useState(!1),[l,c]=y.useState(!1),[u,d]=y.useState([]),{user:f}=kt(),{toast:p}=St(),h=new Date,g=r!=null&&r.end_time?Zm(h,new Date(r.end_time)):!1;y.useEffect(()=>{e&&r&&(m(),x())},[e,r]);const m=async()=>{if(r){c(!0);try{const{data:I,error:X}=await he.from("meeting_attachments").select("*").eq("meeting_id",r.id).order("created_at",{ascending:!1});if(X)throw X;s(I||[])}catch(I){console.error("Error fetching meeting files:",I),p({title:"Error",description:"Failed to load meeting files",variant:"destructive"})}finally{c(!1)}}},x=async()=>{if(r)try{const{data:I,error:X}=await he.from("meeting_attendees").select("id, user_id, status").eq("meeting_id",r.id);if(X)throw X;if(!I||I.length===0){d([]);return}const Y=I.map(F=>F.user_id),{data:z,error:U}=await he.from("profiles").select("id, first_name, last_name, email").in("id",Y);if(U)throw U;const V=I.map(F=>{const D=z==null?void 0:z.find(G=>G.id===F.user_id);return{...F,full_name:D?`${D.first_name||""} ${D.last_name||""}`.trim():"-",email:(D==null?void 0:D.email)||"-"}});d(V)}catch(I){console.error("Error fetching attendee details:",I),p({title:"Error",description:"Failed to load attendee names",variant:"destructive"}),d([])}},w=async I=>{try{if(console.log("Tracking view for file:",I),!f){console.error("No authenticated user found");return}const{error:X}=await he.from("document_analytics").insert({document_id:I,document_type:"meeting_attachment",user_id:f.id,action_type:"view",device_type:navigator.platform||"Unknown",user_agent:navigator.userAgent});X&&console.error("Error recording analytics:",X);const{error:Y}=await he.rpc("increment_view_count",{table_name:"meeting_attachments",attachment_id:I});Y?console.error("Error incrementing view count:",Y):console.log("View count incremented successfully")}catch(X){console.error("Error in trackFileView:",X)}},v=async I=>{try{if(console.log("Tracking download for file:",I),!f){console.error("No authenticated user found");return}const{error:X}=await he.from("document_analytics").insert({document_id:I,document_type:"meeting_attachment",user_id:f.id,action_type:"download",device_type:navigator.platform||"Unknown",user_agent:navigator.userAgent});X&&console.error("Error recording analytics:",X);const{error:Y}=await he.rpc("increment_download_count",{table_name:"meeting_attachments",attachment_id:I});Y?console.error("Error incrementing download count:",Y):console.log("Download count incremented successfully")}catch(X){console.error("Error in trackFileDownload:",X)}},_=async I=>{const X=I.target.files;if(!(!X||X.length===0||!r||!f)){o(!0);try{for(const Y of X){const z=Y.name.split(".").pop(),U=`${r.id}/${Date.now()}_${Y.name}`,{data:V}=await he.storage.listBuckets();if(!(V==null?void 0:V.some(L=>L.name==="meeting-attachments"))){const{error:L}=await he.storage.createBucket("meeting-attachments",{public:!0,allowedMimeTypes:["*/*"],fileSizeLimit:52428800});L&&console.error("Error creating bucket:",L)}const{data:D,error:G}=await he.storage.from("meeting-attachments").upload(U,Y);if(G)throw G;const{error:O}=await he.from("meeting_attachments").insert({meeting_id:r.id,name:Y.name,file_path:D.path,file_size:Y.size,mime_type:Y.type,uploaded_by:f.id});if(O)throw O}p({title:"Files Uploaded",description:`${X.length} file(s) uploaded successfully`}),m()}catch(Y){console.error("Error uploading files:",Y),p({title:"Upload Failed",description:Y.message||"Failed to upload files",variant:"destructive"})}finally{o(!1),I.target.value=""}}},b=async I=>{try{console.log("Attempting to view file:",I.file_path),await w(I.id);const{data:X}=he.storage.from("meeting-attachments").getPublicUrl(I.file_path);if(console.log("Public URL generated:",X.publicUrl),X.publicUrl)try{if((await fetch(X.publicUrl,{method:"HEAD"})).ok){const z=window.open(X.publicUrl,"_blank");p(z?{title:"File Opened",description:"File opened in new tab"}:{title:"Popup Blocked",description:"Please allow popups to view the file",variant:"destructive"})}else throw new Error("File not accessible via public URL")}catch{console.log("Public URL not accessible, trying signed URL...");const{data:z,error:U}=await he.storage.from("meeting-attachments").createSignedUrl(I.file_path,3600);if(!U&&z.signedUrl){const V=window.open(z.signedUrl,"_blank");p(V?{title:"File Opened",description:"File opened in new tab"}:{title:"Popup Blocked",description:"Please allow popups to view the file",variant:"destructive"})}else throw new Error("Could not generate file access URL")}else throw new Error("Could not generate public URL");setTimeout(()=>{m()},1e3)}catch(X){console.error("Error viewing file:",X),p({title:"View Failed",description:"Unable to open file. The file may not exist or the storage is not properly configured.",variant:"destructive"})}},S=async I=>{try{await v(I.id);const{data:X,error:Y}=await he.storage.from("meeting-attachments").download(I.file_path);if(Y)throw Y;const z=URL.createObjectURL(X),U=document.createElement("a");U.href=z,U.download=I.name,document.body.appendChild(U),U.click(),document.body.removeChild(U),URL.revokeObjectURL(z),p({title:"Download Started",description:`Downloading ${I.name}`}),setTimeout(()=>{m()},1e3)}catch(X){console.error("Error downloading file:",X),p({title:"Download Failed",description:X.message||"Failed to download file",variant:"destructive"})}},T=async I=>{if(confirm("Are you sure you want to delete this file?"))try{const X=n.find(U=>U.id===I);if(!X)return;const{error:Y}=await he.storage.from("meeting-attachments").remove([X.file_path]);if(Y)throw Y;const{error:z}=await he.from("meeting_attachments").delete().eq("id",I);if(z)throw z;p({title:"File Deleted",description:"File deleted successfully"}),m()}catch(X){console.error("Error deleting file:",X),p({title:"Delete Failed",description:X.message||"Failed to delete file",variant:"destructive"})}},N=I=>{if(I===0)return"0 Bytes";const X=1024,Y=["Bytes","KB","MB","GB"],z=Math.floor(Math.log(I)/Math.log(X));return parseFloat((I/Math.pow(X,z)).toFixed(2))+" "+Y[z]};if(!r)return null;const C=new Date(r.start_time),E=new Date(r.end_time),P=Math.round((E.getTime()-C.getTime())/(1e3*60)),R=Math.floor(P/60),j=P%60;let M="";return R>0&&(M+=`${R}h `),j>0&&(M+=`${j}m`),i.jsx(Nt,{open:e,onOpenChange:t,children:i.jsxs(bt,{className:"sm:max-w-[800px] max-h-[80vh] overflow-y-auto",children:[i.jsxs(jt,{children:[i.jsx(Et,{children:r.title}),i.jsxs($t,{children:["Meeting scheduled for ",vt(C,"MMMM dd, yyyy")," at ",vt(C,"h:mm a")]})]}),i.jsxs(bl,{defaultValue:"details",className:"w-full",children:[i.jsxs(So,{className:"grid w-full grid-cols-2",children:[i.jsx(Vn,{value:"details",children:"Meeting Details"}),i.jsxs(Vn,{value:"attachments",className:"relative",children:["Attachments",n.length>0&&i.jsx(We,{variant:"secondary",className:"ml-2 h-5 w-5 rounded-full p-0 text-xs",children:n.length})]})]}),i.jsxs(zr,{value:"details",className:"space-y-4 mt-4",children:[i.jsxs("div",{className:"flex items-center space-x-4 text-sm text-gray-600",children:[i.jsxs("div",{className:"flex items-center space-x-1",children:[i.jsx(qr,{className:"h-4 w-4"}),i.jsx("span",{children:M.trim()||"0m"})]}),i.jsxs("div",{className:"flex items-center space-x-1",children:[i.jsx(mr,{className:"h-4 w-4"}),i.jsxs("span",{children:[((A=r.attendees)==null?void 0:A.length)||0," attendees"]})]}),i.jsxs("div",{className:"flex items-center space-x-1",children:[i.jsx(ri,{className:"h-4 w-4"}),i.jsx("span",{children:r.location||"No location specified"})]}),r.meeting_type&&i.jsx(We,{variant:"outline",children:r.meeting_type})]}),i.jsxs("div",{className:"space-y-2",children:[i.jsx("h3",{className:"font-semibold text-gray-900",children:"Attendees"}),u.length>0?i.jsx("div",{className:"overflow-x-auto",children:i.jsxs("table",{className:"min-w-full text-sm border rounded-lg",children:[i.jsx("thead",{children:i.jsxs("tr",{className:"bg-gray-100",children:[i.jsx("th",{className:"px-3 py-2 text-left",children:"Name"}),i.jsx("th",{className:"px-3 py-2 text-left",children:"Email"})]})}),i.jsx("tbody",{children:u.map(I=>i.jsxs("tr",{className:"border-t",children:[i.jsx("td",{className:"px-3 py-2",children:I.full_name}),i.jsx("td",{className:"px-3 py-2",children:I.email})]},I.user_id))})]})}):i.jsx("div",{className:"text-gray-500 italic",children:"No attendees for this meeting."})]}),r.description&&i.jsxs("div",{className:"space-y-2",children:[i.jsx("h3",{className:"font-semibold text-gray-900",children:"Description"}),i.jsx("p",{className:"text-gray-700 bg-gray-50 p-3 rounded-lg",children:r.description})]}),Array.isArray(r.agendas)&&r.agendas.length>0&&i.jsxs("div",{className:"space-y-2",children:[i.jsx("h3",{className:"font-semibold text-gray-900",children:"Agenda"}),i.jsx("ol",{className:"list-decimal list-inside bg-gray-50 p-3 rounded-lg",children:r.agendas.map((I,X)=>i.jsx("li",{className:"mb-1 text-gray-800",children:I},X))})]}),r.teams_join_url&&i.jsxs("div",{className:"space-y-2",children:[i.jsx("h3",{className:"font-semibold text-gray-900",children:"Meeting Link"}),i.jsxs("div",{className:"flex items-center space-x-2 p-3 bg-blue-50 rounded-lg",children:[i.jsx(ra,{className:"h-4 w-4 text-blue-600"}),i.jsx("a",{href:r.teams_join_url,target:"_blank",rel:"noopener noreferrer",className:"text-blue-600 hover:text-blue-800 underline",children:"Join Microsoft Teams Meeting"})]})]}),r.teams_meeting_id&&i.jsxs("div",{className:"space-y-2",children:[i.jsx("h3",{className:"font-semibold text-gray-900",children:"Transcript"}),i.jsx("div",{className:"flex items-center space-x-2 p-3 bg-blue-50 rounded-lg",children:i.jsx(ue,{asChild:!0,size:"sm",className:"bg-blue-600 hover:bg-blue-700 text-white",children:i.jsx("a",{href:`https://teams.microsoft.com/l/meetingTranscript/${r.teams_meeting_id}`,target:"_blank",rel:"noopener noreferrer",children:"View Transcript in Teams"})})})]}),i.jsxs("div",{className:"space-y-3",children:[i.jsx("h3",{className:"font-semibold text-gray-900",children:"Meeting Details"}),i.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[i.jsxs("div",{children:[i.jsx("span",{className:"text-gray-500",children:"Start Time:"}),i.jsx("div",{className:"font-medium",children:vt(C,"MMMM dd, yyyy h:mm a")})]}),i.jsxs("div",{children:[i.jsx("span",{className:"text-gray-500",children:"End Time:"}),i.jsx("div",{className:"font-medium",children:vt(E,"MMMM dd, yyyy h:mm a")})]}),i.jsxs("div",{children:[i.jsx("span",{className:"text-gray-500",children:"Status:"}),i.jsx("div",{className:"font-medium",children:r.status||"Scheduled"})]}),i.jsxs("div",{children:[i.jsx("span",{className:"text-gray-500",children:"Type:"}),i.jsx("div",{className:"font-medium",children:r.meeting_type||"Not specified"})]})]})]}),r.outlook_event_id&&i.jsx("div",{className:"p-3 bg-green-50 rounded-lg",children:i.jsxs("div",{className:"flex items-center space-x-2",children:[i.jsx(en,{className:"h-4 w-4 text-green-600"}),i.jsx("span",{className:"text-green-700 text-sm",children:"This meeting has been added to your Outlook calendar"})]})})]}),i.jsxs(zr,{value:"attachments",className:"space-y-4 mt-4",children:[i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsx("h3",{className:"font-semibold text-gray-900",children:"Meeting Attachments"}),i.jsxs("div",{className:"flex items-center space-x-2",children:[i.jsx("input",{type:"file",multiple:!0,onChange:_,className:"hidden",id:"file-upload",disabled:a||g}),i.jsxs(ue,{size:"sm",onClick:()=>{var I;return(I=document.getElementById("file-upload"))==null?void 0:I.click()},disabled:a||g,className:"bg-purple-600 hover:bg-purple-700",style:g?{opacity:.5,pointerEvents:"none"}:{},children:[i.jsx(Ic,{className:"h-4 w-4 mr-2"}),a?"Uploading...":"Attach Files"]})]})]}),l?i.jsx("div",{className:"flex items-center justify-center py-8",children:i.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-purple-600"})}):n.length>0?i.jsx("div",{className:"space-y-3",children:n.map(I=>i.jsxs("div",{className:"flex items-center justify-between p-3 border border-gray-200 rounded-lg hover:bg-gray-50",children:[i.jsxs("div",{className:"flex items-center space-x-3 flex-1 min-w-0",children:[i.jsx(tr,{className:"h-5 w-5 text-gray-500 shrink-0"}),i.jsxs("div",{className:"flex-1 min-w-0",children:[i.jsx("p",{className:"text-sm font-medium text-gray-900 truncate",children:I.name}),i.jsxs("div",{className:"flex items-center space-x-4 text-xs text-gray-500",children:[i.jsx("span",{children:N(I.file_size??0)}),i.jsx("span",{children:vt(new Date(I.created_at),"MMM dd, yyyy")}),i.jsxs("span",{className:"flex items-center space-x-1",children:[i.jsx(Or,{className:"h-3 w-3"}),i.jsx("span",{children:I.view_count||0})]}),i.jsxs("span",{className:"flex items-center space-x-1",children:[i.jsx(js,{className:"h-3 w-3"}),i.jsx("span",{children:I.download_count||0})]})]})]})]}),i.jsxs("div",{className:"flex items-center space-x-2 shrink-0",children:[i.jsxs(ue,{size:"sm",variant:"outline",onClick:()=>b(I),className:"h-8 px-2",children:[i.jsx(Or,{className:"h-3 w-3 mr-1"}),"View"]}),i.jsx(kw,{documentId:I.id,documentName:I.name,documentType:"meeting_attachment"}),i.jsxs(ue,{size:"sm",variant:"outline",onClick:()=>S(I),className:"h-8 px-2",children:[i.jsx(js,{className:"h-3 w-3 mr-1"}),"Download"]}),i.jsx(ue,{size:"sm",variant:"outline",onClick:()=>T(I.id),className:"h-8 px-2 text-red-600 hover:text-red-700 hover:bg-red-50",children:i.jsx(yr,{className:"h-3 w-3"})})]})]},I.id))}):i.jsxs("div",{className:"text-center py-8",children:[i.jsx(Ic,{className:"h-12 w-12 mx-auto mb-4 text-gray-400"}),i.jsx("p",{className:"text-gray-600 mb-2",children:"No files attached to this meeting"}),i.jsx("p",{className:"text-sm text-gray-500",children:"Upload files to share with meeting participants"})]})]})]})]})})},ZX=()=>{var U;const[e,t]=y.useState([]),[r,n]=y.useState(null),[s,a]=y.useState(!1),{meetings:o,loading:l}=_l(),{documents:c,loading:u}=jp(),{emails:d,loading:f}=zT(),{user:p}=kt(),{profile:h}=Df(),{toast:g}=St(),m=_o(),[x,w]=y.useState(!1),[v,_]=y.useState(null);y.useEffect(()=>{p&&(async()=>{try{const{data:F,error:D}=await he.from("polls").select("*").eq("status","active").order("created_at",{ascending:!1}).limit(2);if(D)throw D;t((F||[]).map(G=>({...G,description:G.description??""})))}catch{g({title:"Error",description:"Failed to load polls",variant:"destructive"})}})()},[p,g]);const b=o.filter(V=>new Date(V.start_time)>new Date).sort((V,F)=>new Date(V.start_time).getTime()-new Date(F.start_time).getTime()).slice(0,2),S=c.sort((V,F)=>new Date(F.created_at).getTime()-new Date(V.created_at).getTime()).slice(0,2),T=d.sort((V,F)=>new Date(F.receivedDateTime).getTime()-new Date(V.receivedDateTime).getTime()).slice(0,2),N=e.filter(V=>{const F=new Date,D=V.status==="active"&&(!V.deadline||new Date(V.deadline)>=F),G=V.status==="active"&&V.deadline&&new Date(V.deadline)<F;return(D||G)&&!V.hasVoted}).sort((V,F)=>new Date(V.deadline).getTime()-new Date(F.deadline).getTime()).slice(0,2),C=h!=null&&h.first_name?`${h.first_name} ${h.last_name||""}`.trim():((U=p==null?void 0:p.email)==null?void 0:U.split("@")[0])||"User",E=V=>{V.teams_join_url?window.open(V.teams_join_url,"_blank"):g({title:"No Teams Link",description:"No Teams link available",variant:"destructive"})},P=V=>{V&&(n(V),a(!0))},R=()=>{a(!1),n(null)},j=V=>{V!=null&&V.id&&window.open(`https://outlook.office.com/mail/inbox/id/${V.id}`,"_blank")},M=V=>m(`/${V}`),A=(V,F=80)=>{if(!V)return"No preview available";const D=V.replace(/<[^>]*>/g,"").replace(/&nbsp;/g," ").replace(/&amp;/g,"&").replace(/&lt;/g,"<").replace(/&gt;/g,">").replace(/&quot;/g,'"').replace(/&#39;/g,"'").replace(/\s+/g," ").trim();return D.length>F?D.substring(0,F)+"...":D},I=V=>{_(V),w(!0)},X=(V,F="")=>V??F;if(l||u||f)return i.jsx("div",{className:"flex items-center justify-center h-64",children:i.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary"})});const Y=V=>V.meeting_type==="online"?i.jsx(ra,{className:"h-4 w-4 text-blue-600 mr-1"}):V.meeting_type==="physical"?i.jsx(ri,{className:"h-4 w-4 text-green-600 mr-1"}):V.meeting_type==="hybrid"?i.jsx(mr,{className:"h-4 w-4 text-purple-600 mr-1"}):null,z=V=>V.meeting_type==="online"&&V.teams_join_url?i.jsx(ue,{size:"sm",className:"bg-blue-600 text-white h-6 w-6 p-0 ml-2",onClick:F=>{F.stopPropagation(),E(V)},title:"Join Online",children:i.jsx(ra,{className:"h-3 w-3"})}):V.meeting_type==="physical"&&V.location?i.jsx(ue,{size:"sm",className:"bg-green-600 text-white h-6 w-6 p-0 ml-2",onClick:F=>{F.stopPropagation(),window.open(`https://maps.google.com/?q=${encodeURIComponent(V.location)}`,"_blank")},title:"View Location",children:i.jsx(ri,{className:"h-3 w-3"})}):V.meeting_type==="hybrid"?i.jsxs("div",{className:"flex gap-1 ml-2",children:[V.teams_join_url&&i.jsx(ue,{size:"sm",className:"bg-blue-600 text-white h-6 w-6 p-0",onClick:F=>{F.stopPropagation(),E(V)},title:"Join Online",children:i.jsx(ra,{className:"h-3 w-3"})}),V.location&&i.jsx(ue,{size:"sm",className:"bg-green-600 text-white h-6 w-6 p-0",onClick:F=>{F.stopPropagation(),window.open(`https://maps.google.com/?q=${encodeURIComponent(V.location)}`,"_blank")},title:"View Location",children:i.jsx(ri,{className:"h-3 w-3"})})]}):null;return i.jsxs("div",{className:"w-full max-w-4xl mx-auto px-2 py-6 space-y-6",children:[i.jsxs("div",{className:"mb-4",children:[i.jsxs("h1",{className:"text-2xl font-bold",children:["Welcome, ",C]}),i.jsx("p",{className:"text-sm text-muted-foreground",children:"Here's a quick overview of your activity."})]}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[i.jsxs(Ye,{className:"h-full min-h-[220px] flex flex-col justify-between",children:[i.jsxs(ct,{className:"pb-2 flex flex-row items-center gap-2",children:[i.jsx(ta,{className:"h-5 w-5 text-red-600"}),i.jsx(ft,{className:"text-base",children:"Recent Emails"})]}),i.jsxs(Je,{className:"pt-0 flex-1 flex flex-col justify-between",children:[T.length>0?T.map(V=>i.jsxs("div",{className:"mb-2 p-2 rounded hover:bg-muted/50 flex flex-col",children:[i.jsxs("div",{className:"flex justify-between items-center",children:[i.jsx("span",{className:"font-medium text-sm truncate",children:X(V.subject,"No Subject")}),i.jsx(ue,{size:"sm",variant:"outline",onClick:()=>j(V),disabled:!V.id,className:"h-6 w-6 p-0",children:i.jsx(Ta,{className:"h-3 w-3"})})]}),i.jsx("span",{className:"text-xs text-muted-foreground",children:A(X(V.body))})]},V.id)):i.jsx("div",{className:"text-center text-muted-foreground py-4",children:"No emails found"}),i.jsx(ue,{variant:"ghost",className:"w-full mt-2",onClick:()=>M("email"),children:"View More"})]})]}),i.jsxs(Ye,{className:"h-full min-h-[220px] flex flex-col justify-between",children:[i.jsxs(ct,{className:"pb-2 flex flex-row items-center gap-2",children:[i.jsx(yF,{className:"h-5 w-5 text-blue-600"}),i.jsx(ft,{className:"text-base",children:"Upcoming Meetings"})]}),i.jsxs(Je,{className:"pt-0 flex-1 flex flex-col justify-between",children:[b.length>0?b.map(V=>i.jsxs("div",{className:"mb-2 p-2 rounded hover:bg-muted/50 flex flex-col cursor-pointer group",onClick:()=>I(V),children:[i.jsxs("div",{className:"flex justify-between items-center",children:[i.jsxs("span",{className:"font-medium text-sm truncate flex items-center",children:[Y(V),X(V.title,"Untitled"),V.meeting_id&&i.jsx("span",{className:"ml-2 px-2 py-0.5 rounded bg-blue-100 text-blue-800 font-mono text-xs border border-blue-300",children:V.meeting_id})]}),z(V)]}),i.jsx("span",{className:"text-xs text-muted-foreground",children:V.start_time?new Date(V.start_time).toLocaleString():""})]},V.id)):i.jsx("div",{className:"text-center text-muted-foreground py-4",children:"No upcoming meetings"}),i.jsx(ue,{variant:"ghost",className:"w-full mt-2",onClick:()=>M("meetings"),children:"View More"})]})]}),i.jsxs(Ye,{className:"h-full min-h-[220px] flex flex-col justify-between",children:[i.jsxs(ct,{className:"pb-2 flex flex-row items-center gap-2",children:[i.jsx(tr,{className:"h-5 w-5 text-green-600"}),i.jsx(ft,{className:"text-base",children:"Recent Documents"})]}),i.jsxs(Je,{className:"pt-0 flex-1 flex flex-col justify-between",children:[S.length>0?S.map(V=>i.jsxs("div",{className:"mb-2 p-2 rounded hover:bg-muted/50 flex flex-col",children:[i.jsxs("div",{className:"flex justify-between items-center",children:[i.jsx("span",{className:"font-medium text-sm truncate",children:X(V.name,"Untitled")}),i.jsx(ue,{size:"sm",variant:"outline",onClick:()=>P(V),disabled:!V.id,className:"h-6 w-6 p-0",children:i.jsx(Ta,{className:"h-3 w-3"})})]}),i.jsx("span",{className:"text-xs text-muted-foreground",children:V.created_at?new Date(V.created_at).toLocaleDateString():""})]},V.id)):i.jsx("div",{className:"text-center text-muted-foreground py-4",children:"No documents uploaded"}),i.jsx(ue,{variant:"ghost",className:"w-full mt-2",onClick:()=>M("documents"),children:"View More"})]})]}),i.jsxs(Ye,{className:"h-full min-h-[220px] flex flex-col justify-between",children:[i.jsxs(ct,{className:"pb-2 flex flex-row items-center gap-2",children:[i.jsx(Gs,{className:"h-5 w-5 text-purple-600"}),i.jsx(ft,{className:"text-base",children:"Active Polls"})]}),i.jsxs(Je,{className:"pt-0 flex flex-col justify-between",children:[N.length>0?N.map(V=>i.jsxs("div",{className:"mb-2 p-2 rounded hover:bg-muted/50 flex flex-col cursor-pointer focus:outline-none focus:ring-2 focus:ring-purple-600",tabIndex:0,onClick:()=>m("/voting",{state:{highlightPollId:V.id}}),onKeyDown:F=>{(F.key==="Enter"||F.key===" ")&&(F.preventDefault(),m("/voting",{state:{highlightPollId:V.id}}))},children:[i.jsxs("div",{className:"flex justify-between items-center",children:[i.jsx("span",{className:"font-medium text-sm truncate",children:X(V.title,"Untitled")}),i.jsx(ue,{size:"sm",variant:"outline",onClick:F=>{F.stopPropagation(),m("/voting",{state:{highlightPollId:V.id}})},className:"h-6 w-6 p-0",children:i.jsx(Ta,{className:"h-3 w-3"})})]}),i.jsxs("span",{className:"text-xs text-muted-foreground",children:["Deadline: ",V.deadline?new Date(V.deadline).toLocaleDateString():""]})]},V.id)):i.jsx("div",{className:"text-center text-muted-foreground py-4",children:"No active polls"}),i.jsx(ue,{variant:"ghost",className:"w-full mt-2",onClick:()=>M("voting"),children:"View More"})]})]})]}),i.jsx(lP,{open:x,onOpenChange:w,meeting:v}),i.jsx(K1,{isOpen:s,onClose:R,document:r,documentType:"document"})]})};var Hf=e=>e.type==="checkbox",Uo=e=>e instanceof Date,jn=e=>e==null;const cP=e=>typeof e=="object";var wr=e=>!jn(e)&&!Array.isArray(e)&&cP(e)&&!Uo(e),eQ=e=>wr(e)&&e.target?Hf(e.target)?e.target.checked:e.target.value:e,tQ=e=>e.substring(0,e.search(/\.\d+(\.|$)/))||e,rQ=(e,t)=>e.has(tQ(t)),nQ=e=>{const t=e.constructor&&e.constructor.prototype;return wr(t)&&t.hasOwnProperty("isPrototypeOf")},Cw=typeof window<"u"&&typeof window.HTMLElement<"u"&&typeof document<"u";function $r(e){let t;const r=Array.isArray(e),n=typeof FileList<"u"?e instanceof FileList:!1;if(e instanceof Date)t=new Date(e);else if(!(Cw&&(e instanceof Blob||n))&&(r||wr(e)))if(t=r?[]:{},!r&&!nQ(e))t=e;else for(const s in e)e.hasOwnProperty(s)&&(t[s]=$r(e[s]));else return e;return t}var Ip=e=>/^\w*$/.test(e),Nr=e=>e===void 0,Tw=e=>Array.isArray(e)?e.filter(Boolean):[],Aw=e=>Tw(e.replace(/["|']|\]/g,"").split(/\.|\[/)),Qe=(e,t,r)=>{if(!t||!wr(e))return r;const n=(Ip(t)?[t]:Aw(t)).reduce((s,a)=>jn(s)?s:s[a],e);return Nr(n)||n===e?Nr(e[t])?r:e[t]:n},ya=e=>typeof e=="boolean",Zt=(e,t,r)=>{let n=-1;const s=Ip(t)?[t]:Aw(t),a=s.length,o=a-1;for(;++n<a;){const l=s[n];let c=r;if(n!==o){const u=e[l];c=wr(u)||Array.isArray(u)?u:isNaN(+s[n+1])?{}:[]}if(l==="__proto__"||l==="constructor"||l==="prototype")return;e[l]=c,e=e[l]}};const DS={BLUR:"blur",FOCUS_OUT:"focusout"},Ys={onBlur:"onBlur",onChange:"onChange",onSubmit:"onSubmit",onTouched:"onTouched",all:"all"},$a={max:"max",min:"min",maxLength:"maxLength",minLength:"minLength",pattern:"pattern",required:"required",validate:"validate"},sQ=ke.createContext(null);sQ.displayName="HookFormContext";var aQ=(e,t,r,n=!0)=>{const s={defaultValues:t._defaultValues};for(const a in e)Object.defineProperty(s,a,{get:()=>{const o=a;return t._proxyFormState[o]!==Ys.all&&(t._proxyFormState[o]=!n||Ys.all),e[o]}});return s};const iQ=typeof window<"u"?y.useLayoutEffect:y.useEffect;var Ea=e=>typeof e=="string",oQ=(e,t,r,n,s)=>Ea(e)?(n&&t.watch.add(e),Qe(r,e,s)):Array.isArray(e)?e.map(a=>(n&&t.watch.add(a),Qe(r,a))):(n&&(t.watchAll=!0),r),lQ=(e,t,r,n,s)=>t?{...r[e],types:{...r[e]&&r[e].types?r[e].types:{},[n]:s||!0}}:{},vd=e=>Array.isArray(e)?e:[e],RS=()=>{let e=[];return{get observers(){return e},next:s=>{for(const a of e)a.next&&a.next(s)},subscribe:s=>(e.push(s),{unsubscribe:()=>{e=e.filter(a=>a!==s)}}),unsubscribe:()=>{e=[]}}},Jv=e=>jn(e)||!cP(e);function Mi(e,t,r=new WeakSet){if(Jv(e)||Jv(t))return e===t;if(Uo(e)&&Uo(t))return e.getTime()===t.getTime();const n=Object.keys(e),s=Object.keys(t);if(n.length!==s.length)return!1;if(r.has(e)||r.has(t))return!0;r.add(e),r.add(t);for(const a of n){const o=e[a];if(!s.includes(a))return!1;if(a!=="ref"){const l=t[a];if(Uo(o)&&Uo(l)||wr(o)&&wr(l)||Array.isArray(o)&&Array.isArray(l)?!Mi(o,l,r):o!==l)return!1}}return!0}var Mn=e=>wr(e)&&!Object.keys(e).length,Pw=e=>e.type==="file",Ks=e=>typeof e=="function",p0=e=>{if(!Cw)return!1;const t=e?e.ownerDocument:0;return e instanceof(t&&t.defaultView?t.defaultView.HTMLElement:HTMLElement)},uP=e=>e.type==="select-multiple",Dw=e=>e.type==="radio",cQ=e=>Dw(e)||Hf(e),hx=e=>p0(e)&&e.isConnected;function uQ(e,t){const r=t.slice(0,-1).length;let n=0;for(;n<r;)e=Nr(e)?n++:e[t[n++]];return e}function dQ(e){for(const t in e)if(e.hasOwnProperty(t)&&!Nr(e[t]))return!1;return!0}function Sr(e,t){const r=Array.isArray(t)?t:Ip(t)?[t]:Aw(t),n=r.length===1?e:uQ(e,r),s=r.length-1,a=r[s];return n&&delete n[a],s!==0&&(wr(n)&&Mn(n)||Array.isArray(n)&&dQ(n))&&Sr(e,r.slice(0,-1)),e}var dP=e=>{for(const t in e)if(Ks(e[t]))return!0;return!1};function g0(e,t={}){const r=Array.isArray(e);if(wr(e)||r)for(const n in e)Array.isArray(e[n])||wr(e[n])&&!dP(e[n])?(t[n]=Array.isArray(e[n])?[]:{},g0(e[n],t[n])):jn(e[n])||(t[n]=!0);return t}function fP(e,t,r){const n=Array.isArray(e);if(wr(e)||n)for(const s in e)Array.isArray(e[s])||wr(e[s])&&!dP(e[s])?Nr(t)||Jv(r[s])?r[s]=Array.isArray(e[s])?g0(e[s],[]):{...g0(e[s])}:fP(e[s],jn(t)?{}:t[s],r[s]):r[s]=!Mi(e[s],t[s]);return r}var Iu=(e,t)=>fP(e,t,g0(t));const MS={value:!1,isValid:!1},OS={value:!0,isValid:!0};var hP=e=>{if(Array.isArray(e)){if(e.length>1){const t=e.filter(r=>r&&r.checked&&!r.disabled).map(r=>r.value);return{value:t,isValid:!!t.length}}return e[0].checked&&!e[0].disabled?e[0].attributes&&!Nr(e[0].attributes.value)?Nr(e[0].value)||e[0].value===""?OS:{value:e[0].value,isValid:!0}:OS:MS}return MS},mP=(e,{valueAsNumber:t,valueAsDate:r,setValueAs:n})=>Nr(e)?e:t?e===""?NaN:e&&+e:r&&Ea(e)?new Date(e):n?n(e):e;const FS={isValid:!1,value:null};var pP=e=>Array.isArray(e)?e.reduce((t,r)=>r&&r.checked&&!r.disabled?{isValid:!0,value:r.value}:t,FS):FS;function IS(e){const t=e.ref;return Pw(t)?t.files:Dw(t)?pP(e.refs).value:uP(t)?[...t.selectedOptions].map(({value:r})=>r):Hf(t)?hP(e.refs).value:mP(Nr(t.value)?e.ref.value:t.value,e)}var fQ=(e,t,r,n)=>{const s={};for(const a of e){const o=Qe(t,a);o&&Zt(s,a,o._f)}return{criteriaMode:r,names:[...e],fields:s,shouldUseNativeValidation:n}},x0=e=>e instanceof RegExp,Lu=e=>Nr(e)?e:x0(e)?e.source:wr(e)?x0(e.value)?e.value.source:e.value:e,LS=e=>({isOnSubmit:!e||e===Ys.onSubmit,isOnBlur:e===Ys.onBlur,isOnChange:e===Ys.onChange,isOnAll:e===Ys.all,isOnTouch:e===Ys.onTouched});const $S="AsyncFunction";var hQ=e=>!!e&&!!e.validate&&!!(Ks(e.validate)&&e.validate.constructor.name===$S||wr(e.validate)&&Object.values(e.validate).find(t=>t.constructor.name===$S)),mQ=e=>e.mount&&(e.required||e.min||e.max||e.maxLength||e.minLength||e.pattern||e.validate),BS=(e,t,r)=>!r&&(t.watchAll||t.watch.has(e)||[...t.watch].some(n=>e.startsWith(n)&&/^\.\w+/.test(e.slice(n.length))));const yd=(e,t,r,n)=>{for(const s of r||Object.keys(e)){const a=Qe(e,s);if(a){const{_f:o,...l}=a;if(o){if(o.refs&&o.refs[0]&&t(o.refs[0],s)&&!n)return!0;if(o.ref&&t(o.ref,o.name)&&!n)return!0;if(yd(l,t))break}else if(wr(l)&&yd(l,t))break}}};function US(e,t,r){const n=Qe(e,r);if(n||Ip(r))return{error:n,name:r};const s=r.split(".");for(;s.length;){const a=s.join("."),o=Qe(t,a),l=Qe(e,a);if(o&&!Array.isArray(o)&&r!==a)return{name:r};if(l&&l.type)return{name:a,error:l};if(l&&l.root&&l.root.type)return{name:`${a}.root`,error:l.root};s.pop()}return{name:r}}var pQ=(e,t,r,n)=>{r(e);const{name:s,...a}=e;return Mn(a)||Object.keys(a).length>=Object.keys(t).length||Object.keys(a).find(o=>t[o]===(!n||Ys.all))},gQ=(e,t,r)=>!e||!t||e===t||vd(e).some(n=>n&&(r?n===t:n.startsWith(t)||t.startsWith(n))),xQ=(e,t,r,n,s)=>s.isOnAll?!1:!r&&s.isOnTouch?!(t||e):(r?n.isOnBlur:s.isOnBlur)?!e:(r?n.isOnChange:s.isOnChange)?e:!0,vQ=(e,t)=>!Tw(Qe(e,t)).length&&Sr(e,t),yQ=(e,t,r)=>{const n=vd(Qe(e,r));return Zt(n,"root",t[r]),Zt(e,r,n),e},hm=e=>Ea(e);function zS(e,t,r="validate"){if(hm(e)||Array.isArray(e)&&e.every(hm)||ya(e)&&!e)return{type:r,message:hm(e)?e:"",ref:t}}var zl=e=>wr(e)&&!x0(e)?e:{value:e,message:""},VS=async(e,t,r,n,s,a)=>{const{ref:o,refs:l,required:c,maxLength:u,minLength:d,min:f,max:p,pattern:h,validate:g,name:m,valueAsNumber:x,mount:w}=e._f,v=Qe(r,m);if(!w||t.has(m))return{};const _=l?l[0]:o,b=j=>{s&&_.reportValidity&&(_.setCustomValidity(ya(j)?"":j||""),_.reportValidity())},S={},T=Dw(o),N=Hf(o),C=T||N,E=(x||Pw(o))&&Nr(o.value)&&Nr(v)||p0(o)&&o.value===""||v===""||Array.isArray(v)&&!v.length,P=lQ.bind(null,m,n,S),R=(j,M,A,I=$a.maxLength,X=$a.minLength)=>{const Y=j?M:A;S[m]={type:j?I:X,message:Y,ref:o,...P(j?I:X,Y)}};if(a?!Array.isArray(v)||!v.length:c&&(!C&&(E||jn(v))||ya(v)&&!v||N&&!hP(l).isValid||T&&!pP(l).isValid)){const{value:j,message:M}=hm(c)?{value:!!c,message:c}:zl(c);if(j&&(S[m]={type:$a.required,message:M,ref:_,...P($a.required,M)},!n))return b(M),S}if(!E&&(!jn(f)||!jn(p))){let j,M;const A=zl(p),I=zl(f);if(!jn(v)&&!isNaN(v)){const X=o.valueAsNumber||v&&+v;jn(A.value)||(j=X>A.value),jn(I.value)||(M=X<I.value)}else{const X=o.valueAsDate||new Date(v),Y=V=>new Date(new Date().toDateString()+" "+V),z=o.type=="time",U=o.type=="week";Ea(A.value)&&v&&(j=z?Y(v)>Y(A.value):U?v>A.value:X>new Date(A.value)),Ea(I.value)&&v&&(M=z?Y(v)<Y(I.value):U?v<I.value:X<new Date(I.value))}if((j||M)&&(R(!!j,A.message,I.message,$a.max,$a.min),!n))return b(S[m].message),S}if((u||d)&&!E&&(Ea(v)||a&&Array.isArray(v))){const j=zl(u),M=zl(d),A=!jn(j.value)&&v.length>+j.value,I=!jn(M.value)&&v.length<+M.value;if((A||I)&&(R(A,j.message,M.message),!n))return b(S[m].message),S}if(h&&!E&&Ea(v)){const{value:j,message:M}=zl(h);if(x0(j)&&!v.match(j)&&(S[m]={type:$a.pattern,message:M,ref:o,...P($a.pattern,M)},!n))return b(M),S}if(g){if(Ks(g)){const j=await g(v,r),M=zS(j,_);if(M&&(S[m]={...M,...P($a.validate,M.message)},!n))return b(M.message),S}else if(wr(g)){let j={};for(const M in g){if(!Mn(j)&&!n)break;const A=zS(await g[M](v,r),_,M);A&&(j={...A,...P(M,A.message)},b(A.message),n&&(S[m]=j))}if(!Mn(j)&&(S[m]={ref:_,...j},!n))return S}}return b(!0),S};const wQ={mode:Ys.onSubmit,reValidateMode:Ys.onChange,shouldFocusError:!0};function _Q(e={}){let t={...wQ,...e},r={submitCount:0,isDirty:!1,isReady:!1,isLoading:Ks(t.defaultValues),isValidating:!1,isSubmitted:!1,isSubmitting:!1,isSubmitSuccessful:!1,isValid:!1,touchedFields:{},dirtyFields:{},validatingFields:{},errors:t.errors||{},disabled:t.disabled||!1},n={},s=wr(t.defaultValues)||wr(t.values)?$r(t.defaultValues||t.values)||{}:{},a=t.shouldUnregister?{}:$r(s),o={action:!1,mount:!1,watch:!1},l={mount:new Set,disabled:new Set,unMount:new Set,array:new Set,watch:new Set},c,u=0;const d={isDirty:!1,dirtyFields:!1,validatingFields:!1,touchedFields:!1,isValidating:!1,isValid:!1,errors:!1};let f={...d};const p={array:RS(),state:RS()},h=t.criteriaMode===Ys.all,g=W=>J=>{clearTimeout(u),u=setTimeout(W,J)},m=async W=>{if(!t.disabled&&(d.isValid||f.isValid||W)){const J=t.resolver?Mn((await N()).errors):await E(n,!0);J!==r.isValid&&p.state.next({isValid:J})}},x=(W,J)=>{!t.disabled&&(d.isValidating||d.validatingFields||f.isValidating||f.validatingFields)&&((W||Array.from(l.mount)).forEach(B=>{B&&(J?Zt(r.validatingFields,B,J):Sr(r.validatingFields,B))}),p.state.next({validatingFields:r.validatingFields,isValidating:!Mn(r.validatingFields)}))},w=(W,J=[],B,ae,de=!0,Q=!0)=>{if(ae&&B&&!t.disabled){if(o.action=!0,Q&&Array.isArray(Qe(n,W))){const fe=B(Qe(n,W),ae.argA,ae.argB);de&&Zt(n,W,fe)}if(Q&&Array.isArray(Qe(r.errors,W))){const fe=B(Qe(r.errors,W),ae.argA,ae.argB);de&&Zt(r.errors,W,fe),vQ(r.errors,W)}if((d.touchedFields||f.touchedFields)&&Q&&Array.isArray(Qe(r.touchedFields,W))){const fe=B(Qe(r.touchedFields,W),ae.argA,ae.argB);de&&Zt(r.touchedFields,W,fe)}(d.dirtyFields||f.dirtyFields)&&(r.dirtyFields=Iu(s,a)),p.state.next({name:W,isDirty:R(W,J),dirtyFields:r.dirtyFields,errors:r.errors,isValid:r.isValid})}else Zt(a,W,J)},v=(W,J)=>{Zt(r.errors,W,J),p.state.next({errors:r.errors})},_=W=>{r.errors=W,p.state.next({errors:r.errors,isValid:!1})},b=(W,J,B,ae)=>{const de=Qe(n,W);if(de){const Q=Qe(a,W,Nr(B)?Qe(s,W):B);Nr(Q)||ae&&ae.defaultChecked||J?Zt(a,W,J?Q:IS(de._f)):A(W,Q),o.mount&&m()}},S=(W,J,B,ae,de)=>{let Q=!1,fe=!1;const Ce={name:W};if(!t.disabled){if(!B||ae){(d.isDirty||f.isDirty)&&(fe=r.isDirty,r.isDirty=Ce.isDirty=R(),Q=fe!==Ce.isDirty);const Ne=Mi(Qe(s,W),J);fe=!!Qe(r.dirtyFields,W),Ne?Sr(r.dirtyFields,W):Zt(r.dirtyFields,W,!0),Ce.dirtyFields=r.dirtyFields,Q=Q||(d.dirtyFields||f.dirtyFields)&&fe!==!Ne}if(B){const Ne=Qe(r.touchedFields,W);Ne||(Zt(r.touchedFields,W,B),Ce.touchedFields=r.touchedFields,Q=Q||(d.touchedFields||f.touchedFields)&&Ne!==B)}Q&&de&&p.state.next(Ce)}return Q?Ce:{}},T=(W,J,B,ae)=>{const de=Qe(r.errors,W),Q=(d.isValid||f.isValid)&&ya(J)&&r.isValid!==J;if(t.delayError&&B?(c=g(()=>v(W,B)),c(t.delayError)):(clearTimeout(u),c=null,B?Zt(r.errors,W,B):Sr(r.errors,W)),(B?!Mi(de,B):de)||!Mn(ae)||Q){const fe={...ae,...Q&&ya(J)?{isValid:J}:{},errors:r.errors,name:W};r={...r,...fe},p.state.next(fe)}},N=async W=>{x(W,!0);const J=await t.resolver(a,t.context,fQ(W||l.mount,n,t.criteriaMode,t.shouldUseNativeValidation));return x(W),J},C=async W=>{const{errors:J}=await N(W);if(W)for(const B of W){const ae=Qe(J,B);ae?Zt(r.errors,B,ae):Sr(r.errors,B)}else r.errors=J;return J},E=async(W,J,B={valid:!0})=>{for(const ae in W){const de=W[ae];if(de){const{_f:Q,...fe}=de;if(Q){const Ce=l.array.has(Q.name),Ne=de._f&&hQ(de._f);Ne&&d.validatingFields&&x([ae],!0);const Xe=await VS(de,l.disabled,a,h,t.shouldUseNativeValidation&&!J,Ce);if(Ne&&d.validatingFields&&x([ae]),Xe[Q.name]&&(B.valid=!1,J))break;!J&&(Qe(Xe,Q.name)?Ce?yQ(r.errors,Xe,Q.name):Zt(r.errors,Q.name,Xe[Q.name]):Sr(r.errors,Q.name))}!Mn(fe)&&await E(fe,J,B)}}return B.valid},P=()=>{for(const W of l.unMount){const J=Qe(n,W);J&&(J._f.refs?J._f.refs.every(B=>!hx(B)):!hx(J._f.ref))&&ne(W)}l.unMount=new Set},R=(W,J)=>!t.disabled&&(W&&J&&Zt(a,W,J),!Mi(V(),s)),j=(W,J,B)=>oQ(W,l,{...o.mount?a:Nr(J)?s:Ea(W)?{[W]:J}:J},B,J),M=W=>Tw(Qe(o.mount?a:s,W,t.shouldUnregister?Qe(s,W,[]):[])),A=(W,J,B={})=>{const ae=Qe(n,W);let de=J;if(ae){const Q=ae._f;Q&&(!Q.disabled&&Zt(a,W,mP(J,Q)),de=p0(Q.ref)&&jn(J)?"":J,uP(Q.ref)?[...Q.ref.options].forEach(fe=>fe.selected=de.includes(fe.value)):Q.refs?Hf(Q.ref)?Q.refs.forEach(fe=>{(!fe.defaultChecked||!fe.disabled)&&(Array.isArray(de)?fe.checked=!!de.find(Ce=>Ce===fe.value):fe.checked=de===fe.value||!!de)}):Q.refs.forEach(fe=>fe.checked=fe.value===de):Pw(Q.ref)?Q.ref.value="":(Q.ref.value=de,Q.ref.type||p.state.next({name:W,values:$r(a)})))}(B.shouldDirty||B.shouldTouch)&&S(W,de,B.shouldTouch,B.shouldDirty,!0),B.shouldValidate&&U(W)},I=(W,J,B)=>{for(const ae in J){if(!J.hasOwnProperty(ae))return;const de=J[ae],Q=W+"."+ae,fe=Qe(n,Q);(l.array.has(W)||wr(de)||fe&&!fe._f)&&!Uo(de)?I(Q,de,B):A(Q,de,B)}},X=(W,J,B={})=>{const ae=Qe(n,W),de=l.array.has(W),Q=$r(J);Zt(a,W,Q),de?(p.array.next({name:W,values:$r(a)}),(d.isDirty||d.dirtyFields||f.isDirty||f.dirtyFields)&&B.shouldDirty&&p.state.next({name:W,dirtyFields:Iu(s,a),isDirty:R(W,Q)})):ae&&!ae._f&&!jn(Q)?I(W,Q,B):A(W,Q,B),BS(W,l)&&p.state.next({...r}),p.state.next({name:o.mount?W:void 0,values:$r(a)})},Y=async W=>{o.mount=!0;const J=W.target;let B=J.name,ae=!0;const de=Qe(n,B),Q=Ne=>{ae=Number.isNaN(Ne)||Uo(Ne)&&isNaN(Ne.getTime())||Mi(Ne,Qe(a,B,Ne))},fe=LS(t.mode),Ce=LS(t.reValidateMode);if(de){let Ne,Xe;const it=J.type?IS(de._f):eQ(W),at=W.type===DS.BLUR||W.type===DS.FOCUS_OUT,ht=!mQ(de._f)&&!t.resolver&&!Qe(r.errors,B)&&!de._f.deps||xQ(at,Qe(r.touchedFields,B),r.isSubmitted,Ce,fe),Ke=BS(B,l,at);Zt(a,B,it),at?(de._f.onBlur&&de._f.onBlur(W),c&&c(0)):de._f.onChange&&de._f.onChange(W);const Bt=S(B,it,at),Te=!Mn(Bt)||Ke;if(!at&&p.state.next({name:B,type:W.type,values:$r(a)}),ht)return(d.isValid||f.isValid)&&(t.mode==="onBlur"?at&&m():at||m()),Te&&p.state.next({name:B,...Ke?{}:Bt});if(!at&&Ke&&p.state.next({...r}),t.resolver){const{errors:Re}=await N([B]);if(Q(it),ae){const tt=US(r.errors,n,B),Dt=US(Re,n,tt.name||B);Ne=Dt.error,B=Dt.name,Xe=Mn(Re)}}else x([B],!0),Ne=(await VS(de,l.disabled,a,h,t.shouldUseNativeValidation))[B],x([B]),Q(it),ae&&(Ne?Xe=!1:(d.isValid||f.isValid)&&(Xe=await E(n,!0)));ae&&(de._f.deps&&U(de._f.deps),T(B,Xe,Ne,Bt))}},z=(W,J)=>{if(Qe(r.errors,J)&&W.focus)return W.focus(),1},U=async(W,J={})=>{let B,ae;const de=vd(W);if(t.resolver){const Q=await C(Nr(W)?W:de);B=Mn(Q),ae=W?!de.some(fe=>Qe(Q,fe)):B}else W?(ae=(await Promise.all(de.map(async Q=>{const fe=Qe(n,Q);return await E(fe&&fe._f?{[Q]:fe}:fe)}))).every(Boolean),!(!ae&&!r.isValid)&&m()):ae=B=await E(n);return p.state.next({...!Ea(W)||(d.isValid||f.isValid)&&B!==r.isValid?{}:{name:W},...t.resolver||!W?{isValid:B}:{},errors:r.errors}),J.shouldFocus&&!ae&&yd(n,z,W?de:l.mount),ae},V=W=>{const J={...o.mount?a:s};return Nr(W)?J:Ea(W)?Qe(J,W):W.map(B=>Qe(J,B))},F=(W,J)=>({invalid:!!Qe((J||r).errors,W),isDirty:!!Qe((J||r).dirtyFields,W),error:Qe((J||r).errors,W),isValidating:!!Qe(r.validatingFields,W),isTouched:!!Qe((J||r).touchedFields,W)}),D=W=>{W&&vd(W).forEach(J=>Sr(r.errors,J)),p.state.next({errors:W?r.errors:{}})},G=(W,J,B)=>{const ae=(Qe(n,W,{_f:{}})._f||{}).ref,de=Qe(r.errors,W)||{},{ref:Q,message:fe,type:Ce,...Ne}=de;Zt(r.errors,W,{...Ne,...J,ref:ae}),p.state.next({name:W,errors:r.errors,isValid:!1}),B&&B.shouldFocus&&ae&&ae.focus&&ae.focus()},O=(W,J)=>Ks(W)?p.state.subscribe({next:B=>W(j(void 0,J),B)}):j(W,J,!0),L=W=>p.state.subscribe({next:J=>{gQ(W.name,J.name,W.exact)&&pQ(J,W.formState||d,H,W.reRenderRoot)&&W.callback({values:{...a},...r,...J})}}).unsubscribe,ie=W=>(o.mount=!0,f={...f,...W.formState},L({...W,formState:f})),ne=(W,J={})=>{for(const B of W?vd(W):l.mount)l.mount.delete(B),l.array.delete(B),J.keepValue||(Sr(n,B),Sr(a,B)),!J.keepError&&Sr(r.errors,B),!J.keepDirty&&Sr(r.dirtyFields,B),!J.keepTouched&&Sr(r.touchedFields,B),!J.keepIsValidating&&Sr(r.validatingFields,B),!t.shouldUnregister&&!J.keepDefaultValue&&Sr(s,B);p.state.next({values:$r(a)}),p.state.next({...r,...J.keepDirty?{isDirty:R()}:{}}),!J.keepIsValid&&m()},me=({disabled:W,name:J})=>{(ya(W)&&o.mount||W||l.disabled.has(J))&&(W?l.disabled.add(J):l.disabled.delete(J))},pe=(W,J={})=>{let B=Qe(n,W);const ae=ya(J.disabled)||ya(t.disabled);return Zt(n,W,{...B||{},_f:{...B&&B._f?B._f:{ref:{name:W}},name:W,mount:!0,...J}}),l.mount.add(W),B?me({disabled:ya(J.disabled)?J.disabled:t.disabled,name:W}):b(W,!0,J.value),{...ae?{disabled:J.disabled||t.disabled}:{},...t.progressive?{required:!!J.required,min:Lu(J.min),max:Lu(J.max),minLength:Lu(J.minLength),maxLength:Lu(J.maxLength),pattern:Lu(J.pattern)}:{},name:W,onChange:Y,onBlur:Y,ref:de=>{if(de){pe(W,J),B=Qe(n,W);const Q=Nr(de.value)&&de.querySelectorAll&&de.querySelectorAll("input,select,textarea")[0]||de,fe=cQ(Q),Ce=B._f.refs||[];if(fe?Ce.find(Ne=>Ne===Q):Q===B._f.ref)return;Zt(n,W,{_f:{...B._f,...fe?{refs:[...Ce.filter(hx),Q,...Array.isArray(Qe(s,W))?[{}]:[]],ref:{type:Q.type,name:W}}:{ref:Q}}}),b(W,!1,void 0,Q)}else B=Qe(n,W,{}),B._f&&(B._f.mount=!1),(t.shouldUnregister||J.shouldUnregister)&&!(rQ(l.array,W)&&o.action)&&l.unMount.add(W)}}},xe=()=>t.shouldFocusError&&yd(n,z,l.mount),Ae=W=>{ya(W)&&(p.state.next({disabled:W}),yd(n,(J,B)=>{const ae=Qe(n,B);ae&&(J.disabled=ae._f.disabled||W,Array.isArray(ae._f.refs)&&ae._f.refs.forEach(de=>{de.disabled=ae._f.disabled||W}))},0,!1))},ge=(W,J)=>async B=>{let ae;B&&(B.preventDefault&&B.preventDefault(),B.persist&&B.persist());let de=$r(a);if(p.state.next({isSubmitting:!0}),t.resolver){const{errors:Q,values:fe}=await N();r.errors=Q,de=$r(fe)}else await E(n);if(l.disabled.size)for(const Q of l.disabled)Sr(de,Q);if(Sr(r.errors,"root"),Mn(r.errors)){p.state.next({errors:{}});try{await W(de,B)}catch(Q){ae=Q}}else J&&await J({...r.errors},B),xe(),setTimeout(xe);if(p.state.next({isSubmitted:!0,isSubmitting:!1,isSubmitSuccessful:Mn(r.errors)&&!ae,submitCount:r.submitCount+1,errors:r.errors}),ae)throw ae},je=(W,J={})=>{Qe(n,W)&&(Nr(J.defaultValue)?X(W,$r(Qe(s,W))):(X(W,J.defaultValue),Zt(s,W,$r(J.defaultValue))),J.keepTouched||Sr(r.touchedFields,W),J.keepDirty||(Sr(r.dirtyFields,W),r.isDirty=J.defaultValue?R(W,$r(Qe(s,W))):R()),J.keepError||(Sr(r.errors,W),d.isValid&&m()),p.state.next({...r}))},k=(W,J={})=>{const B=W?$r(W):s,ae=$r(B),de=Mn(W),Q=de?s:ae;if(J.keepDefaultValues||(s=B),!J.keepValues){if(J.keepDirtyValues){const fe=new Set([...l.mount,...Object.keys(Iu(s,a))]);for(const Ce of Array.from(fe))Qe(r.dirtyFields,Ce)?Zt(Q,Ce,Qe(a,Ce)):X(Ce,Qe(Q,Ce))}else{if(Cw&&Nr(W))for(const fe of l.mount){const Ce=Qe(n,fe);if(Ce&&Ce._f){const Ne=Array.isArray(Ce._f.refs)?Ce._f.refs[0]:Ce._f.ref;if(p0(Ne)){const Xe=Ne.closest("form");if(Xe){Xe.reset();break}}}}if(J.keepFieldsRef)for(const fe of l.mount)X(fe,Qe(Q,fe));else n={}}a=t.shouldUnregister?J.keepDefaultValues?$r(s):{}:$r(Q),p.array.next({values:{...Q}}),p.state.next({values:{...Q}})}l={mount:J.keepDirtyValues?l.mount:new Set,unMount:new Set,array:new Set,disabled:new Set,watch:new Set,watchAll:!1,focus:""},o.mount=!d.isValid||!!J.keepIsValid||!!J.keepDirtyValues,o.watch=!!t.shouldUnregister,p.state.next({submitCount:J.keepSubmitCount?r.submitCount:0,isDirty:de?!1:J.keepDirty?r.isDirty:!!(J.keepDefaultValues&&!Mi(W,s)),isSubmitted:J.keepIsSubmitted?r.isSubmitted:!1,dirtyFields:de?{}:J.keepDirtyValues?J.keepDefaultValues&&a?Iu(s,a):r.dirtyFields:J.keepDefaultValues&&W?Iu(s,W):J.keepDirty?r.dirtyFields:{},touchedFields:J.keepTouched?r.touchedFields:{},errors:J.keepErrors?r.errors:{},isSubmitSuccessful:J.keepIsSubmitSuccessful?r.isSubmitSuccessful:!1,isSubmitting:!1})},le=(W,J)=>k(Ks(W)?W(a):W,J),ce=(W,J={})=>{const B=Qe(n,W),ae=B&&B._f;if(ae){const de=ae.refs?ae.refs[0]:ae.ref;de.focus&&(de.focus(),J.shouldSelect&&Ks(de.select)&&de.select())}},H=W=>{r={...r,...W}},oe={control:{register:pe,unregister:ne,getFieldState:F,handleSubmit:ge,setError:G,_subscribe:L,_runSchema:N,_focusError:xe,_getWatch:j,_getDirty:R,_setValid:m,_setFieldArray:w,_setDisabledField:me,_setErrors:_,_getFieldArray:M,_reset:k,_resetDefaultValues:()=>Ks(t.defaultValues)&&t.defaultValues().then(W=>{le(W,t.resetOptions),p.state.next({isLoading:!1})}),_removeUnmounted:P,_disableForm:Ae,_subjects:p,_proxyFormState:d,get _fields(){return n},get _formValues(){return a},get _state(){return o},set _state(W){o=W},get _defaultValues(){return s},get _names(){return l},set _names(W){l=W},get _formState(){return r},get _options(){return t},set _options(W){t={...t,...W}}},subscribe:ie,trigger:U,register:pe,handleSubmit:ge,watch:O,setValue:X,getValues:V,reset:le,resetField:je,clearErrors:D,unregister:ne,setError:G,setFocus:ce,getFieldState:F};return{...oe,formControl:oe}}function bQ(e={}){const t=ke.useRef(void 0),r=ke.useRef(void 0),[n,s]=ke.useState({isDirty:!1,isValidating:!1,isLoading:Ks(e.defaultValues),isSubmitted:!1,isSubmitting:!1,isSubmitSuccessful:!1,isValid:!1,submitCount:0,dirtyFields:{},touchedFields:{},validatingFields:{},errors:e.errors||{},disabled:e.disabled||!1,isReady:!1,defaultValues:Ks(e.defaultValues)?void 0:e.defaultValues});if(!t.current)if(e.formControl)t.current={...e.formControl,formState:n},e.defaultValues&&!Ks(e.defaultValues)&&e.formControl.reset(e.defaultValues,e.resetOptions);else{const{formControl:o,...l}=_Q(e);t.current={...l,formState:n}}const a=t.current.control;return a._options=e,iQ(()=>{const o=a._subscribe({formState:a._proxyFormState,callback:()=>s({...a._formState}),reRenderRoot:!0});return s(l=>({...l,isReady:!0})),a._formState.isReady=!0,o},[a]),ke.useEffect(()=>a._disableForm(e.disabled),[a,e.disabled]),ke.useEffect(()=>{e.mode&&(a._options.mode=e.mode),e.reValidateMode&&(a._options.reValidateMode=e.reValidateMode)},[a,e.mode,e.reValidateMode]),ke.useEffect(()=>{e.errors&&(a._setErrors(e.errors),a._focusError())},[a,e.errors]),ke.useEffect(()=>{e.shouldUnregister&&a._subjects.state.next({values:a._getWatch()})},[a,e.shouldUnregister]),ke.useEffect(()=>{if(a._proxyFormState.isDirty){const o=a._getDirty();o!==n.isDirty&&a._subjects.state.next({isDirty:o})}},[a,n.isDirty]),ke.useEffect(()=>{e.values&&!Mi(e.values,r.current)?(a._reset(e.values,{keepFieldsRef:!0,...a._options.resetOptions}),r.current=e.values,s(o=>({...o}))):a._resetDefaultValues()},[a,e.values]),ke.useEffect(()=>{a._state.mount||(a._setValid(),a._state.mount=!0),a._state.watch&&(a._state.watch=!1,a._subjects.state.next({...a._formState})),a._removeUnmounted()}),t.current.formState=aQ(n,a),t.current}var SQ="Label",gP=y.forwardRef((e,t)=>i.jsx(ze.label,{...e,ref:t,onMouseDown:r=>{var s;r.target.closest("button, input, select, textarea")||((s=e.onMouseDown)==null||s.call(e,r),!r.defaultPrevented&&r.detail>1&&r.preventDefault())}}));gP.displayName=SQ;var xP=gP;const NQ=yf("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"),Ve=y.forwardRef(({className:e,...t},r)=>i.jsx(xP,{ref:r,className:De(NQ(),e),...t}));Ve.displayName=xP.displayName;const Ma=y.forwardRef(({className:e,...t},r)=>i.jsx("textarea",{className:De("flex min-h-[80px] w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",e),ref:r,...t}));Ma.displayName="Textarea";function Zv(e,[t,r]){return Math.min(r,Math.max(t,e))}function Rw(e){const t=y.useRef({value:e,previous:e});return y.useMemo(()=>(t.current.value!==e&&(t.current.previous=t.current.value,t.current.value=e),t.current.previous),[e])}var jQ=[" ","Enter","ArrowUp","ArrowDown"],EQ=[" ","Enter"],fl="Select",[Lp,$p,kQ]=xf(fl),[gu,cse]=Fr(fl,[kQ,yo]),Bp=yo(),[CQ,jo]=gu(fl),[TQ,AQ]=gu(fl),vP=e=>{const{__scopeSelect:t,children:r,open:n,defaultOpen:s,onOpenChange:a,value:o,defaultValue:l,onValueChange:c,dir:u,name:d,autoComplete:f,disabled:p,required:h,form:g}=e,m=Bp(t),[x,w]=y.useState(null),[v,_]=y.useState(null),[b,S]=y.useState(!1),T=uu(u),[N,C]=Hn({prop:n,defaultProp:s??!1,onChange:a,caller:fl}),[E,P]=Hn({prop:o,defaultProp:l,onChange:c,caller:fl}),R=y.useRef(null),j=x?g||!!x.closest("form"):!0,[M,A]=y.useState(new Set),I=Array.from(M).map(X=>X.props.value).join(";");return i.jsx(Q0,{...m,children:i.jsxs(CQ,{required:h,scope:t,trigger:x,onTriggerChange:w,valueNode:v,onValueNodeChange:_,valueNodeHasChildren:b,onValueNodeHasChildrenChange:S,contentId:Er(),value:E,onValueChange:P,open:N,onOpenChange:C,dir:T,triggerPointerDownPosRef:R,disabled:p,children:[i.jsx(Lp.Provider,{scope:t,children:i.jsx(TQ,{scope:e.__scopeSelect,onNativeOptionAdd:y.useCallback(X=>{A(Y=>new Set(Y).add(X))},[]),onNativeOptionRemove:y.useCallback(X=>{A(Y=>{const z=new Set(Y);return z.delete(X),z})},[]),children:r})}),j?i.jsxs(zP,{"aria-hidden":!0,required:h,tabIndex:-1,name:d,autoComplete:f,value:E,onChange:X=>P(X.target.value),disabled:p,form:g,children:[E===void 0?i.jsx("option",{value:""}):null,Array.from(M)]},I):null]})})};vP.displayName=fl;var yP="SelectTrigger",wP=y.forwardRef((e,t)=>{const{__scopeSelect:r,disabled:n=!1,...s}=e,a=Bp(r),o=jo(yP,r),l=o.disabled||n,c=st(t,o.onTriggerChange),u=$p(r),d=y.useRef("touch"),[f,p,h]=WP(m=>{const x=u().filter(_=>!_.disabled),w=x.find(_=>_.value===o.value),v=HP(x,m,w);v!==void 0&&o.onValueChange(v.value)}),g=m=>{l||(o.onOpenChange(!0),h()),m&&(o.triggerPointerDownPosRef.current={x:Math.round(m.pageX),y:Math.round(m.pageY)})};return i.jsx(Nf,{asChild:!0,...a,children:i.jsx(ze.button,{type:"button",role:"combobox","aria-controls":o.contentId,"aria-expanded":o.open,"aria-required":o.required,"aria-autocomplete":"none",dir:o.dir,"data-state":o.open?"open":"closed",disabled:l,"data-disabled":l?"":void 0,"data-placeholder":VP(o.value)?"":void 0,...s,ref:c,onClick:Oe(s.onClick,m=>{m.currentTarget.focus(),d.current!=="mouse"&&g(m)}),onPointerDown:Oe(s.onPointerDown,m=>{d.current=m.pointerType;const x=m.target;x.hasPointerCapture(m.pointerId)&&x.releasePointerCapture(m.pointerId),m.button===0&&m.ctrlKey===!1&&m.pointerType==="mouse"&&(g(m),m.preventDefault())}),onKeyDown:Oe(s.onKeyDown,m=>{const x=f.current!=="";!(m.ctrlKey||m.altKey||m.metaKey)&&m.key.length===1&&p(m.key),!(x&&m.key===" ")&&jQ.includes(m.key)&&(g(),m.preventDefault())})})})});wP.displayName=yP;var _P="SelectValue",bP=y.forwardRef((e,t)=>{const{__scopeSelect:r,className:n,style:s,children:a,placeholder:o="",...l}=e,c=jo(_P,r),{onValueNodeHasChildrenChange:u}=c,d=a!==void 0,f=st(t,c.onValueNodeChange);return gr(()=>{u(d)},[u,d]),i.jsx(ze.span,{...l,ref:f,style:{pointerEvents:"none"},children:VP(c.value)?i.jsx(i.Fragment,{children:o}):a})});bP.displayName=_P;var PQ="SelectIcon",SP=y.forwardRef((e,t)=>{const{__scopeSelect:r,children:n,...s}=e;return i.jsx(ze.span,{"aria-hidden":!0,...s,ref:t,children:n||""})});SP.displayName=PQ;var DQ="SelectPortal",NP=e=>i.jsx(Jc,{asChild:!0,...e});NP.displayName=DQ;var hl="SelectContent",jP=y.forwardRef((e,t)=>{const r=jo(hl,e.__scopeSelect),[n,s]=y.useState();if(gr(()=>{s(new DocumentFragment)},[]),!r.open){const a=n;return a?xl.createPortal(i.jsx(EP,{scope:e.__scopeSelect,children:i.jsx(Lp.Slot,{scope:e.__scopeSelect,children:i.jsx("div",{children:e.children})})}),a):null}return i.jsx(kP,{...e,ref:t})});jP.displayName=hl;var $s=10,[EP,Eo]=gu(hl),RQ="SelectContentImpl",MQ=oo("SelectContent.RemoveScroll"),kP=y.forwardRef((e,t)=>{const{__scopeSelect:r,position:n="item-aligned",onCloseAutoFocus:s,onEscapeKeyDown:a,onPointerDownOutside:o,side:l,sideOffset:c,align:u,alignOffset:d,arrowPadding:f,collisionBoundary:p,collisionPadding:h,sticky:g,hideWhenDetached:m,avoidCollisions:x,...w}=e,v=jo(hl,r),[_,b]=y.useState(null),[S,T]=y.useState(null),N=st(t,ne=>b(ne)),[C,E]=y.useState(null),[P,R]=y.useState(null),j=$p(r),[M,A]=y.useState(!1),I=y.useRef(!1);y.useEffect(()=>{if(_)return mp(_)},[_]),fp();const X=y.useCallback(ne=>{const[me,...pe]=j().map(ge=>ge.ref.current),[xe]=pe.slice(-1),Ae=document.activeElement;for(const ge of ne)if(ge===Ae||(ge==null||ge.scrollIntoView({block:"nearest"}),ge===me&&S&&(S.scrollTop=0),ge===xe&&S&&(S.scrollTop=S.scrollHeight),ge==null||ge.focus(),document.activeElement!==Ae))return},[j,S]),Y=y.useCallback(()=>X([C,_]),[X,C,_]);y.useEffect(()=>{M&&Y()},[M,Y]);const{onOpenChange:z,triggerPointerDownPosRef:U}=v;y.useEffect(()=>{if(_){let ne={x:0,y:0};const me=xe=>{var Ae,ge;ne={x:Math.abs(Math.round(xe.pageX)-(((Ae=U.current)==null?void 0:Ae.x)??0)),y:Math.abs(Math.round(xe.pageY)-(((ge=U.current)==null?void 0:ge.y)??0))}},pe=xe=>{ne.x<=10&&ne.y<=10?xe.preventDefault():_.contains(xe.target)||z(!1),document.removeEventListener("pointermove",me),U.current=null};return U.current!==null&&(document.addEventListener("pointermove",me),document.addEventListener("pointerup",pe,{capture:!0,once:!0})),()=>{document.removeEventListener("pointermove",me),document.removeEventListener("pointerup",pe,{capture:!0})}}},[_,z,U]),y.useEffect(()=>{const ne=()=>z(!1);return window.addEventListener("blur",ne),window.addEventListener("resize",ne),()=>{window.removeEventListener("blur",ne),window.removeEventListener("resize",ne)}},[z]);const[V,F]=WP(ne=>{const me=j().filter(Ae=>!Ae.disabled),pe=me.find(Ae=>Ae.ref.current===document.activeElement),xe=HP(me,ne,pe);xe&&setTimeout(()=>xe.ref.current.focus())}),D=y.useCallback((ne,me,pe)=>{const xe=!I.current&&!pe;(v.value!==void 0&&v.value===me||xe)&&(E(ne),xe&&(I.current=!0))},[v.value]),G=y.useCallback(()=>_==null?void 0:_.focus(),[_]),O=y.useCallback((ne,me,pe)=>{const xe=!I.current&&!pe;(v.value!==void 0&&v.value===me||xe)&&R(ne)},[v.value]),L=n==="popper"?ey:CP,ie=L===ey?{side:l,sideOffset:c,align:u,alignOffset:d,arrowPadding:f,collisionBoundary:p,collisionPadding:h,sticky:g,hideWhenDetached:m,avoidCollisions:x}:{};return i.jsx(EP,{scope:r,content:_,viewport:S,onViewportChange:T,itemRefCallback:D,selectedItem:C,onItemLeave:G,itemTextRefCallback:O,focusSelectedItem:Y,selectedItemText:P,position:n,isPositioned:M,searchRef:V,children:i.jsx(Mf,{as:MQ,allowPinchZoom:!0,children:i.jsx(Rf,{asChild:!0,trapped:v.open,onMountAutoFocus:ne=>{ne.preventDefault()},onUnmountAutoFocus:Oe(s,ne=>{var me;(me=v.trigger)==null||me.focus({preventScroll:!0}),ne.preventDefault()}),children:i.jsx(vl,{asChild:!0,disableOutsidePointerEvents:!0,onEscapeKeyDown:a,onPointerDownOutside:o,onFocusOutside:ne=>ne.preventDefault(),onDismiss:()=>v.onOpenChange(!1),children:i.jsx(L,{role:"listbox",id:v.contentId,"data-state":v.open?"open":"closed",dir:v.dir,onContextMenu:ne=>ne.preventDefault(),...w,...ie,onPlaced:()=>A(!0),ref:N,style:{display:"flex",flexDirection:"column",outline:"none",...w.style},onKeyDown:Oe(w.onKeyDown,ne=>{const me=ne.ctrlKey||ne.altKey||ne.metaKey;if(ne.key==="Tab"&&ne.preventDefault(),!me&&ne.key.length===1&&F(ne.key),["ArrowUp","ArrowDown","Home","End"].includes(ne.key)){let xe=j().filter(Ae=>!Ae.disabled).map(Ae=>Ae.ref.current);if(["ArrowUp","End"].includes(ne.key)&&(xe=xe.slice().reverse()),["ArrowUp","ArrowDown"].includes(ne.key)){const Ae=ne.target,ge=xe.indexOf(Ae);xe=xe.slice(ge+1)}setTimeout(()=>X(xe)),ne.preventDefault()}})})})})})})});kP.displayName=RQ;var OQ="SelectItemAlignedPosition",CP=y.forwardRef((e,t)=>{const{__scopeSelect:r,onPlaced:n,...s}=e,a=jo(hl,r),o=Eo(hl,r),[l,c]=y.useState(null),[u,d]=y.useState(null),f=st(t,N=>d(N)),p=$p(r),h=y.useRef(!1),g=y.useRef(!0),{viewport:m,selectedItem:x,selectedItemText:w,focusSelectedItem:v}=o,_=y.useCallback(()=>{if(a.trigger&&a.valueNode&&l&&u&&m&&x&&w){const N=a.trigger.getBoundingClientRect(),C=u.getBoundingClientRect(),E=a.valueNode.getBoundingClientRect(),P=w.getBoundingClientRect();if(a.dir!=="rtl"){const Ae=P.left-C.left,ge=E.left-Ae,je=N.left-ge,k=N.width+je,le=Math.max(k,C.width),ce=window.innerWidth-$s,H=Zv(ge,[$s,Math.max($s,ce-le)]);l.style.minWidth=k+"px",l.style.left=H+"px"}else{const Ae=C.right-P.right,ge=window.innerWidth-E.right-Ae,je=window.innerWidth-N.right-ge,k=N.width+je,le=Math.max(k,C.width),ce=window.innerWidth-$s,H=Zv(ge,[$s,Math.max($s,ce-le)]);l.style.minWidth=k+"px",l.style.right=H+"px"}const R=p(),j=window.innerHeight-$s*2,M=m.scrollHeight,A=window.getComputedStyle(u),I=parseInt(A.borderTopWidth,10),X=parseInt(A.paddingTop,10),Y=parseInt(A.borderBottomWidth,10),z=parseInt(A.paddingBottom,10),U=I+X+M+z+Y,V=Math.min(x.offsetHeight*5,U),F=window.getComputedStyle(m),D=parseInt(F.paddingTop,10),G=parseInt(F.paddingBottom,10),O=N.top+N.height/2-$s,L=j-O,ie=x.offsetHeight/2,ne=x.offsetTop+ie,me=I+X+ne,pe=U-me;if(me<=O){const Ae=R.length>0&&x===R[R.length-1].ref.current;l.style.bottom="0px";const ge=u.clientHeight-m.offsetTop-m.offsetHeight,je=Math.max(L,ie+(Ae?G:0)+ge+Y),k=me+je;l.style.height=k+"px"}else{const Ae=R.length>0&&x===R[0].ref.current;l.style.top="0px";const je=Math.max(O,I+m.offsetTop+(Ae?D:0)+ie)+pe;l.style.height=je+"px",m.scrollTop=me-O+m.offsetTop}l.style.margin=`${$s}px 0`,l.style.minHeight=V+"px",l.style.maxHeight=j+"px",n==null||n(),requestAnimationFrame(()=>h.current=!0)}},[p,a.trigger,a.valueNode,l,u,m,x,w,a.dir,n]);gr(()=>_(),[_]);const[b,S]=y.useState();gr(()=>{u&&S(window.getComputedStyle(u).zIndex)},[u]);const T=y.useCallback(N=>{N&&g.current===!0&&(_(),v==null||v(),g.current=!1)},[_,v]);return i.jsx(IQ,{scope:r,contentWrapper:l,shouldExpandOnScrollRef:h,onScrollButtonChange:T,children:i.jsx("div",{ref:c,style:{display:"flex",flexDirection:"column",position:"fixed",zIndex:b},children:i.jsx(ze.div,{...s,ref:f,style:{boxSizing:"border-box",maxHeight:"100%",...s.style}})})})});CP.displayName=OQ;var FQ="SelectPopperPosition",ey=y.forwardRef((e,t)=>{const{__scopeSelect:r,align:n="start",collisionPadding:s=$s,...a}=e,o=Bp(r);return i.jsx(J0,{...o,...a,ref:t,align:n,collisionPadding:s,style:{boxSizing:"border-box",...a.style,"--radix-select-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-select-content-available-width":"var(--radix-popper-available-width)","--radix-select-content-available-height":"var(--radix-popper-available-height)","--radix-select-trigger-width":"var(--radix-popper-anchor-width)","--radix-select-trigger-height":"var(--radix-popper-anchor-height)"}})});ey.displayName=FQ;var[IQ,Mw]=gu(hl,{}),ty="SelectViewport",TP=y.forwardRef((e,t)=>{const{__scopeSelect:r,nonce:n,...s}=e,a=Eo(ty,r),o=Mw(ty,r),l=st(t,a.onViewportChange),c=y.useRef(0);return i.jsxs(i.Fragment,{children:[i.jsx("style",{dangerouslySetInnerHTML:{__html:"[data-radix-select-viewport]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}[data-radix-select-viewport]::-webkit-scrollbar{display:none}"},nonce:n}),i.jsx(Lp.Slot,{scope:r,children:i.jsx(ze.div,{"data-radix-select-viewport":"",role:"presentation",...s,ref:l,style:{position:"relative",flex:1,overflow:"hidden auto",...s.style},onScroll:Oe(s.onScroll,u=>{const d=u.currentTarget,{contentWrapper:f,shouldExpandOnScrollRef:p}=o;if(p!=null&&p.current&&f){const h=Math.abs(c.current-d.scrollTop);if(h>0){const g=window.innerHeight-$s*2,m=parseFloat(f.style.minHeight),x=parseFloat(f.style.height),w=Math.max(m,x);if(w<g){const v=w+h,_=Math.min(g,v),b=v-_;f.style.height=_+"px",f.style.bottom==="0px"&&(d.scrollTop=b>0?b:0,f.style.justifyContent="flex-end")}}}c.current=d.scrollTop})})})]})});TP.displayName=ty;var AP="SelectGroup",[LQ,$Q]=gu(AP),BQ=y.forwardRef((e,t)=>{const{__scopeSelect:r,...n}=e,s=Er();return i.jsx(LQ,{scope:r,id:s,children:i.jsx(ze.div,{role:"group","aria-labelledby":s,...n,ref:t})})});BQ.displayName=AP;var PP="SelectLabel",DP=y.forwardRef((e,t)=>{const{__scopeSelect:r,...n}=e,s=$Q(PP,r);return i.jsx(ze.div,{id:s.id,...n,ref:t})});DP.displayName=PP;var v0="SelectItem",[UQ,RP]=gu(v0),MP=y.forwardRef((e,t)=>{const{__scopeSelect:r,value:n,disabled:s=!1,textValue:a,...o}=e,l=jo(v0,r),c=Eo(v0,r),u=l.value===n,[d,f]=y.useState(a??""),[p,h]=y.useState(!1),g=st(t,v=>{var _;return(_=c.itemRefCallback)==null?void 0:_.call(c,v,n,s)}),m=Er(),x=y.useRef("touch"),w=()=>{s||(l.onValueChange(n),l.onOpenChange(!1))};if(n==="")throw new Error("A <Select.Item /> must have a value prop that is not an empty string. This is because the Select value can be set to an empty string to clear the selection and show the placeholder.");return i.jsx(UQ,{scope:r,value:n,disabled:s,textId:m,isSelected:u,onItemTextChange:y.useCallback(v=>{f(_=>_||((v==null?void 0:v.textContent)??"").trim())},[]),children:i.jsx(Lp.ItemSlot,{scope:r,value:n,disabled:s,textValue:d,children:i.jsx(ze.div,{role:"option","aria-labelledby":m,"data-highlighted":p?"":void 0,"aria-selected":u&&p,"data-state":u?"checked":"unchecked","aria-disabled":s||void 0,"data-disabled":s?"":void 0,tabIndex:s?void 0:-1,...o,ref:g,onFocus:Oe(o.onFocus,()=>h(!0)),onBlur:Oe(o.onBlur,()=>h(!1)),onClick:Oe(o.onClick,()=>{x.current!=="mouse"&&w()}),onPointerUp:Oe(o.onPointerUp,()=>{x.current==="mouse"&&w()}),onPointerDown:Oe(o.onPointerDown,v=>{x.current=v.pointerType}),onPointerMove:Oe(o.onPointerMove,v=>{var _;x.current=v.pointerType,s?(_=c.onItemLeave)==null||_.call(c):x.current==="mouse"&&v.currentTarget.focus({preventScroll:!0})}),onPointerLeave:Oe(o.onPointerLeave,v=>{var _;v.currentTarget===document.activeElement&&((_=c.onItemLeave)==null||_.call(c))}),onKeyDown:Oe(o.onKeyDown,v=>{var b;((b=c.searchRef)==null?void 0:b.current)!==""&&v.key===" "||(EQ.includes(v.key)&&w(),v.key===" "&&v.preventDefault())})})})})});MP.displayName=v0;var Yu="SelectItemText",OP=y.forwardRef((e,t)=>{const{__scopeSelect:r,className:n,style:s,...a}=e,o=jo(Yu,r),l=Eo(Yu,r),c=RP(Yu,r),u=AQ(Yu,r),[d,f]=y.useState(null),p=st(t,w=>f(w),c.onItemTextChange,w=>{var v;return(v=l.itemTextRefCallback)==null?void 0:v.call(l,w,c.value,c.disabled)}),h=d==null?void 0:d.textContent,g=y.useMemo(()=>i.jsx("option",{value:c.value,disabled:c.disabled,children:h},c.value),[c.disabled,c.value,h]),{onNativeOptionAdd:m,onNativeOptionRemove:x}=u;return gr(()=>(m(g),()=>x(g)),[m,x,g]),i.jsxs(i.Fragment,{children:[i.jsx(ze.span,{id:c.textId,...a,ref:p}),c.isSelected&&o.valueNode&&!o.valueNodeHasChildren?xl.createPortal(a.children,o.valueNode):null]})});OP.displayName=Yu;var FP="SelectItemIndicator",IP=y.forwardRef((e,t)=>{const{__scopeSelect:r,...n}=e;return RP(FP,r).isSelected?i.jsx(ze.span,{"aria-hidden":!0,...n,ref:t}):null});IP.displayName=FP;var ry="SelectScrollUpButton",LP=y.forwardRef((e,t)=>{const r=Eo(ry,e.__scopeSelect),n=Mw(ry,e.__scopeSelect),[s,a]=y.useState(!1),o=st(t,n.onScrollButtonChange);return gr(()=>{if(r.viewport&&r.isPositioned){let l=function(){const u=c.scrollTop>0;a(u)};const c=r.viewport;return l(),c.addEventListener("scroll",l),()=>c.removeEventListener("scroll",l)}},[r.viewport,r.isPositioned]),s?i.jsx(BP,{...e,ref:o,onAutoScroll:()=>{const{viewport:l,selectedItem:c}=r;l&&c&&(l.scrollTop=l.scrollTop-c.offsetHeight)}}):null});LP.displayName=ry;var ny="SelectScrollDownButton",$P=y.forwardRef((e,t)=>{const r=Eo(ny,e.__scopeSelect),n=Mw(ny,e.__scopeSelect),[s,a]=y.useState(!1),o=st(t,n.onScrollButtonChange);return gr(()=>{if(r.viewport&&r.isPositioned){let l=function(){const u=c.scrollHeight-c.clientHeight,d=Math.ceil(c.scrollTop)<u;a(d)};const c=r.viewport;return l(),c.addEventListener("scroll",l),()=>c.removeEventListener("scroll",l)}},[r.viewport,r.isPositioned]),s?i.jsx(BP,{...e,ref:o,onAutoScroll:()=>{const{viewport:l,selectedItem:c}=r;l&&c&&(l.scrollTop=l.scrollTop+c.offsetHeight)}}):null});$P.displayName=ny;var BP=y.forwardRef((e,t)=>{const{__scopeSelect:r,onAutoScroll:n,...s}=e,a=Eo("SelectScrollButton",r),o=y.useRef(null),l=$p(r),c=y.useCallback(()=>{o.current!==null&&(window.clearInterval(o.current),o.current=null)},[]);return y.useEffect(()=>()=>c(),[c]),gr(()=>{var d;const u=l().find(f=>f.ref.current===document.activeElement);(d=u==null?void 0:u.ref.current)==null||d.scrollIntoView({block:"nearest"})},[l]),i.jsx(ze.div,{"aria-hidden":!0,...s,ref:t,style:{flexShrink:0,...s.style},onPointerDown:Oe(s.onPointerDown,()=>{o.current===null&&(o.current=window.setInterval(n,50))}),onPointerMove:Oe(s.onPointerMove,()=>{var u;(u=a.onItemLeave)==null||u.call(a),o.current===null&&(o.current=window.setInterval(n,50))}),onPointerLeave:Oe(s.onPointerLeave,()=>{c()})})}),zQ="SelectSeparator",UP=y.forwardRef((e,t)=>{const{__scopeSelect:r,...n}=e;return i.jsx(ze.div,{"aria-hidden":!0,...n,ref:t})});UP.displayName=zQ;var sy="SelectArrow",VQ=y.forwardRef((e,t)=>{const{__scopeSelect:r,...n}=e,s=Bp(r),a=jo(sy,r),o=Eo(sy,r);return a.open&&o.position==="popper"?i.jsx(Z0,{...s,...n,ref:t}):null});VQ.displayName=sy;var WQ="SelectBubbleInput",zP=y.forwardRef(({__scopeSelect:e,value:t,...r},n)=>{const s=y.useRef(null),a=st(n,s),o=Rw(t);return y.useEffect(()=>{const l=s.current;if(!l)return;const c=window.HTMLSelectElement.prototype,d=Object.getOwnPropertyDescriptor(c,"value").set;if(o!==t&&d){const f=new Event("change",{bubbles:!0});d.call(l,t),l.dispatchEvent(f)}},[o,t]),i.jsx(ze.select,{...r,style:{...$E,...r.style},ref:a,defaultValue:t})});zP.displayName=WQ;function VP(e){return e===""||e===void 0}function WP(e){const t=hr(e),r=y.useRef(""),n=y.useRef(0),s=y.useCallback(o=>{const l=r.current+o;t(l),function c(u){r.current=u,window.clearTimeout(n.current),u!==""&&(n.current=window.setTimeout(()=>c(""),1e3))}(l)},[t]),a=y.useCallback(()=>{r.current="",window.clearTimeout(n.current)},[]);return y.useEffect(()=>()=>window.clearTimeout(n.current),[]),[r,s,a]}function HP(e,t,r){const s=t.length>1&&Array.from(t).every(u=>u===t[0])?t[0]:t,a=r?e.indexOf(r):-1;let o=HQ(e,Math.max(a,0));s.length===1&&(o=o.filter(u=>u!==r));const c=o.find(u=>u.textValue.toLowerCase().startsWith(s.toLowerCase()));return c!==r?c:void 0}function HQ(e,t){return e.map((r,n)=>e[(t+n)%e.length])}var GQ=vP,GP=wP,qQ=bP,YQ=SP,KQ=NP,qP=jP,XQ=TP,YP=DP,KP=MP,QQ=OP,JQ=IP,XP=LP,QP=$P,JP=UP;const oa=GQ,la=qQ,As=y.forwardRef(({className:e,children:t,...r},n)=>i.jsxs(GP,{ref:n,className:De("flex h-10 w-full items-center justify-between rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 [&>span]:line-clamp-1",e),...r,children:[t,i.jsx(YQ,{asChild:!0,children:i.jsx(Zc,{className:"h-4 w-4 opacity-50"})})]}));As.displayName=GP.displayName;const ZP=y.forwardRef(({className:e,...t},r)=>i.jsx(XP,{ref:r,className:De("flex cursor-default items-center justify-center py-1",e),...t,children:i.jsx(h1,{className:"h-4 w-4"})}));ZP.displayName=XP.displayName;const e3=y.forwardRef(({className:e,...t},r)=>i.jsx(QP,{ref:r,className:De("flex cursor-default items-center justify-center py-1",e),...t,children:i.jsx(Zc,{className:"h-4 w-4"})}));e3.displayName=QP.displayName;const Ps=y.forwardRef(({className:e,children:t,position:r="popper",...n},s)=>i.jsx(KQ,{children:i.jsxs(qP,{ref:s,className:De("relative z-[14000] max-h-96 min-w-[8rem] overflow-hidden rounded-md border bg-popover text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",r==="popper"&&"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1",e),position:r,...n,children:[i.jsx(ZP,{}),i.jsx(XQ,{className:De("p-1",r==="popper"&&"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)]"),children:t}),i.jsx(e3,{})]})}));Ps.displayName=qP.displayName;const ZQ=y.forwardRef(({className:e,...t},r)=>i.jsx(YP,{ref:r,className:De("py-1.5 pl-8 pr-2 text-sm font-semibold",e),...t}));ZQ.displayName=YP.displayName;const zt=y.forwardRef(({className:e,children:t,...r},n)=>i.jsxs(KP,{ref:n,className:De("relative flex w-full cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",e),...r,children:[i.jsx("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:i.jsx(JQ,{children:i.jsx(Qa,{className:"h-4 w-4"})})}),i.jsx(QQ,{children:t})]}));zt.displayName=KP.displayName;const eJ=y.forwardRef(({className:e,...t},r)=>i.jsx(JP,{ref:r,className:De("-mx-1 my-1 h-px bg-muted",e),...t}));eJ.displayName=JP.displayName;var nt=function(){return nt=Object.assign||function(t){for(var r,n=1,s=arguments.length;n<s;n++){r=arguments[n];for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(t[a]=r[a])}return t},nt.apply(this,arguments)};function tJ(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,n=Object.getOwnPropertySymbols(e);s<n.length;s++)t.indexOf(n[s])<0&&Object.prototype.propertyIsEnumerable.call(e,n[s])&&(r[n[s]]=e[n[s]]);return r}function t3(e,t,r){for(var n=0,s=t.length,a;n<s;n++)(a||!(n in t))&&(a||(a=Array.prototype.slice.call(t,0,n)),a[n]=t[n]);return e.concat(a||Array.prototype.slice.call(t))}function Gf(e){return e.mode==="multiple"}function qf(e){return e.mode==="range"}function Up(e){return e.mode==="single"}var rJ={root:"rdp",multiple_months:"rdp-multiple_months",with_weeknumber:"rdp-with_weeknumber",vhidden:"rdp-vhidden",button_reset:"rdp-button_reset",button:"rdp-button",caption:"rdp-caption",caption_start:"rdp-caption_start",caption_end:"rdp-caption_end",caption_between:"rdp-caption_between",caption_label:"rdp-caption_label",caption_dropdowns:"rdp-caption_dropdowns",dropdown:"rdp-dropdown",dropdown_month:"rdp-dropdown_month",dropdown_year:"rdp-dropdown_year",dropdown_icon:"rdp-dropdown_icon",months:"rdp-months",month:"rdp-month",table:"rdp-table",tbody:"rdp-tbody",tfoot:"rdp-tfoot",head:"rdp-head",head_row:"rdp-head_row",head_cell:"rdp-head_cell",nav:"rdp-nav",nav_button:"rdp-nav_button",nav_button_previous:"rdp-nav_button_previous",nav_button_next:"rdp-nav_button_next",nav_icon:"rdp-nav_icon",row:"rdp-row",weeknumber:"rdp-weeknumber",cell:"rdp-cell",day:"rdp-day",day_today:"rdp-day_today",day_outside:"rdp-day_outside",day_selected:"rdp-day_selected",day_disabled:"rdp-day_disabled",day_hidden:"rdp-day_hidden",day_range_start:"rdp-day_range_start",day_range_end:"rdp-day_range_end",day_range_middle:"rdp-day_range_middle"};function nJ(e,t){return vt(e,"LLLL y",t)}function sJ(e,t){return vt(e,"d",t)}function aJ(e,t){return vt(e,"LLLL",t)}function iJ(e){return"".concat(e)}function oJ(e,t){return vt(e,"cccccc",t)}function lJ(e,t){return vt(e,"yyyy",t)}var cJ=Object.freeze({__proto__:null,formatCaption:nJ,formatDay:sJ,formatMonthCaption:aJ,formatWeekNumber:iJ,formatWeekdayName:oJ,formatYearCaption:lJ}),uJ=function(e,t,r){return vt(e,"do MMMM (EEEE)",r)},dJ=function(){return"Month: "},fJ=function(){return"Go to next month"},hJ=function(){return"Go to previous month"},mJ=function(e,t){return vt(e,"cccc",t)},pJ=function(e){return"Week n. ".concat(e)},gJ=function(){return"Year: "},xJ=Object.freeze({__proto__:null,labelDay:uJ,labelMonthDropdown:dJ,labelNext:fJ,labelPrevious:hJ,labelWeekNumber:pJ,labelWeekday:mJ,labelYearDropdown:gJ});function vJ(){var e="buttons",t=rJ,r=nw,n={},s={},a=1,o={},l=new Date;return{captionLayout:e,classNames:t,formatters:cJ,labels:xJ,locale:r,modifiersClassNames:n,modifiers:s,numberOfMonths:a,styles:o,today:l,mode:"default"}}function yJ(e){var t=e.fromYear,r=e.toYear,n=e.fromMonth,s=e.toMonth,a=e.fromDate,o=e.toDate;return n?a=Mr(n):t&&(a=new Date(t,0,1)),s?o=Ja(s):r&&(o=new Date(r,11,31)),{fromDate:a?zc(a):void 0,toDate:o?zc(o):void 0}}var r3=y.createContext(void 0);function wJ(e){var t,r=e.initialProps,n=vJ(),s=yJ(r),a=s.fromDate,o=s.toDate,l=(t=r.captionLayout)!==null&&t!==void 0?t:n.captionLayout;l!=="buttons"&&(!a||!o)&&(l="buttons");var c;(Up(r)||Gf(r)||qf(r))&&(c=r.onSelect);var u=nt(nt(nt({},n),r),{captionLayout:l,classNames:nt(nt({},n.classNames),r.classNames),components:nt({},r.components),formatters:nt(nt({},n.formatters),r.formatters),fromDate:a,labels:nt(nt({},n.labels),r.labels),mode:r.mode||n.mode,modifiers:nt(nt({},n.modifiers),r.modifiers),modifiersClassNames:nt(nt({},n.modifiersClassNames),r.modifiersClassNames),onSelect:c,styles:nt(nt({},n.styles),r.styles),toDate:o});return i.jsx(r3.Provider,{value:u,children:e.children})}function Ht(){var e=y.useContext(r3);if(!e)throw new Error("useDayPicker must be used within a DayPickerProvider.");return e}function n3(e){var t=Ht(),r=t.locale,n=t.classNames,s=t.styles,a=t.formatters.formatCaption;return i.jsx("div",{className:n.caption_label,style:s.caption_label,"aria-live":"polite",role:"presentation",id:e.id,children:a(e.displayMonth,{locale:r})})}function _J(e){return i.jsx("svg",nt({width:"8px",height:"8px",viewBox:"0 0 120 120","data-testid":"iconDropdown"},e,{children:i.jsx("path",{d:"M4.22182541,48.2218254 C8.44222828,44.0014225 15.2388494,43.9273804 19.5496459,47.9996989 L19.7781746,48.2218254 L60,88.443 L100.221825,48.2218254 C104.442228,44.0014225 111.238849,43.9273804 115.549646,47.9996989 L115.778175,48.2218254 C119.998577,52.4422283 120.07262,59.2388494 116.000301,63.5496459 L115.778175,63.7781746 L67.7781746,111.778175 C63.5577717,115.998577 56.7611506,116.07262 52.4503541,112.000301 L52.2218254,111.778175 L4.22182541,63.7781746 C-0.0739418023,59.4824074 -0.0739418023,52.5175926 4.22182541,48.2218254 Z",fill:"currentColor",fillRule:"nonzero"})}))}function s3(e){var t,r,n=e.onChange,s=e.value,a=e.children,o=e.caption,l=e.className,c=e.style,u=Ht(),d=(r=(t=u.components)===null||t===void 0?void 0:t.IconDropdown)!==null&&r!==void 0?r:_J;return i.jsxs("div",{className:l,style:c,children:[i.jsx("span",{className:u.classNames.vhidden,children:e["aria-label"]}),i.jsx("select",{name:e.name,"aria-label":e["aria-label"],className:u.classNames.dropdown,style:u.styles.dropdown,value:s,onChange:n,children:a}),i.jsxs("div",{className:u.classNames.caption_label,style:u.styles.caption_label,"aria-hidden":"true",children:[o,i.jsx(d,{className:u.classNames.dropdown_icon,style:u.styles.dropdown_icon})]})]})}function bJ(e){var t,r=Ht(),n=r.fromDate,s=r.toDate,a=r.styles,o=r.locale,l=r.formatters.formatMonthCaption,c=r.classNames,u=r.components,d=r.labels.labelMonthDropdown;if(!n)return i.jsx(i.Fragment,{});if(!s)return i.jsx(i.Fragment,{});var f=[];if(qz(n,s))for(var p=Mr(n),h=n.getMonth();h<=s.getMonth();h++)f.push(nx(p,h));else for(var p=Mr(new Date),h=0;h<=11;h++)f.push(nx(p,h));var g=function(x){var w=Number(x.target.value),v=nx(Mr(e.displayMonth),w);e.onChange(v)},m=(t=u==null?void 0:u.Dropdown)!==null&&t!==void 0?t:s3;return i.jsx(m,{name:"months","aria-label":d(),className:c.dropdown_month,style:a.dropdown_month,onChange:g,value:e.displayMonth.getMonth(),caption:l(e.displayMonth,{locale:o}),children:f.map(function(x){return i.jsx("option",{value:x.getMonth(),children:l(x,{locale:o})},x.getMonth())})})}function SJ(e){var t,r=e.displayMonth,n=Ht(),s=n.fromDate,a=n.toDate,o=n.locale,l=n.styles,c=n.classNames,u=n.components,d=n.formatters.formatYearCaption,f=n.labels.labelYearDropdown,p=[];if(!s)return i.jsx(i.Fragment,{});if(!a)return i.jsx(i.Fragment,{});for(var h=s.getFullYear(),g=a.getFullYear(),m=h;m<=g;m++)p.push(W2(_4(new Date),m));var x=function(v){var _=W2(Mr(r),Number(v.target.value));e.onChange(_)},w=(t=u==null?void 0:u.Dropdown)!==null&&t!==void 0?t:s3;return i.jsx(w,{name:"years","aria-label":f(),className:c.dropdown_year,style:l.dropdown_year,onChange:x,value:r.getFullYear(),caption:d(r,{locale:o}),children:p.map(function(v){return i.jsx("option",{value:v.getFullYear(),children:d(v,{locale:o})},v.getFullYear())})})}function NJ(e,t){var r=y.useState(e),n=r[0],s=r[1],a=t===void 0?n:t;return[a,s]}function jJ(e){var t=e.month,r=e.defaultMonth,n=e.today,s=t||r||n||new Date,a=e.toDate,o=e.fromDate,l=e.numberOfMonths,c=l===void 0?1:l;if(a&&Vc(a,s)<0){var u=-1*(c-1);s=us(a,u)}return o&&Vc(s,o)<0&&(s=o),Mr(s)}function EJ(){var e=Ht(),t=jJ(e),r=NJ(t,e.month),n=r[0],s=r[1],a=function(o){var l;if(!e.disableNavigation){var c=Mr(o);s(c),(l=e.onMonthChange)===null||l===void 0||l.call(e,c)}};return[n,a]}function kJ(e,t){for(var r=t.reverseMonths,n=t.numberOfMonths,s=Mr(e),a=Mr(us(s,n)),o=Vc(a,s),l=[],c=0;c<o;c++){var u=us(s,c);l.push(u)}return r&&(l=l.reverse()),l}function CJ(e,t){if(!t.disableNavigation){var r=t.toDate,n=t.pagedNavigation,s=t.numberOfMonths,a=s===void 0?1:s,o=n?a:1,l=Mr(e);if(!r)return us(l,o);var c=Vc(r,e);if(!(c<a))return us(l,o)}}function TJ(e,t){if(!t.disableNavigation){var r=t.fromDate,n=t.pagedNavigation,s=t.numberOfMonths,a=s===void 0?1:s,o=n?a:1,l=Mr(e);if(!r)return us(l,-o);var c=Vc(l,r);if(!(c<=0))return us(l,-o)}}var a3=y.createContext(void 0);function AJ(e){var t=Ht(),r=EJ(),n=r[0],s=r[1],a=kJ(n,t),o=CJ(n,t),l=TJ(n,t),c=function(f){return a.some(function(p){return aw(f,p)})},u=function(f,p){c(f)||(p&&sw(f,p)?s(us(f,1+t.numberOfMonths*-1)):s(f))},d={currentMonth:n,displayMonths:a,goToMonth:s,goToDate:u,previousMonth:l,nextMonth:o,isDateDisplayed:c};return i.jsx(a3.Provider,{value:d,children:e.children})}function Yf(){var e=y.useContext(a3);if(!e)throw new Error("useNavigation must be used within a NavigationProvider");return e}function WS(e){var t,r=Ht(),n=r.classNames,s=r.styles,a=r.components,o=Yf().goToMonth,l=function(d){o(us(d,e.displayIndex?-e.displayIndex:0))},c=(t=a==null?void 0:a.CaptionLabel)!==null&&t!==void 0?t:n3,u=i.jsx(c,{id:e.id,displayMonth:e.displayMonth});return i.jsxs("div",{className:n.caption_dropdowns,style:s.caption_dropdowns,children:[i.jsx("div",{className:n.vhidden,children:u}),i.jsx(bJ,{onChange:l,displayMonth:e.displayMonth}),i.jsx(SJ,{onChange:l,displayMonth:e.displayMonth})]})}function PJ(e){return i.jsx("svg",nt({width:"16px",height:"16px",viewBox:"0 0 120 120"},e,{children:i.jsx("path",{d:"M69.490332,3.34314575 C72.6145263,0.218951416 77.6798462,0.218951416 80.8040405,3.34314575 C83.8617626,6.40086786 83.9268205,11.3179931 80.9992143,14.4548388 L80.8040405,14.6568542 L35.461,60 L80.8040405,105.343146 C83.8617626,108.400868 83.9268205,113.317993 80.9992143,116.454839 L80.8040405,116.656854 C77.7463184,119.714576 72.8291931,119.779634 69.6923475,116.852028 L69.490332,116.656854 L18.490332,65.6568542 C15.4326099,62.5991321 15.367552,57.6820069 18.2951583,54.5451612 L18.490332,54.3431458 L69.490332,3.34314575 Z",fill:"currentColor",fillRule:"nonzero"})}))}function DJ(e){return i.jsx("svg",nt({width:"16px",height:"16px",viewBox:"0 0 120 120"},e,{children:i.jsx("path",{d:"M49.8040405,3.34314575 C46.6798462,0.218951416 41.6145263,0.218951416 38.490332,3.34314575 C35.4326099,6.40086786 35.367552,11.3179931 38.2951583,14.4548388 L38.490332,14.6568542 L83.8333725,60 L38.490332,105.343146 C35.4326099,108.400868 35.367552,113.317993 38.2951583,116.454839 L38.490332,116.656854 C41.5480541,119.714576 46.4651794,119.779634 49.602025,116.852028 L49.8040405,116.656854 L100.804041,65.6568542 C103.861763,62.5991321 103.926821,57.6820069 100.999214,54.5451612 L100.804041,54.3431458 L49.8040405,3.34314575 Z",fill:"currentColor"})}))}var y0=y.forwardRef(function(e,t){var r=Ht(),n=r.classNames,s=r.styles,a=[n.button_reset,n.button];e.className&&a.push(e.className);var o=a.join(" "),l=nt(nt({},s.button_reset),s.button);return e.style&&Object.assign(l,e.style),i.jsx("button",nt({},e,{ref:t,type:"button",className:o,style:l}))});function RJ(e){var t,r,n=Ht(),s=n.dir,a=n.locale,o=n.classNames,l=n.styles,c=n.labels,u=c.labelPrevious,d=c.labelNext,f=n.components;if(!e.nextMonth&&!e.previousMonth)return i.jsx(i.Fragment,{});var p=u(e.previousMonth,{locale:a}),h=[o.nav_button,o.nav_button_previous].join(" "),g=d(e.nextMonth,{locale:a}),m=[o.nav_button,o.nav_button_next].join(" "),x=(t=f==null?void 0:f.IconRight)!==null&&t!==void 0?t:DJ,w=(r=f==null?void 0:f.IconLeft)!==null&&r!==void 0?r:PJ;return i.jsxs("div",{className:o.nav,style:l.nav,children:[!e.hidePrevious&&i.jsx(y0,{name:"previous-month","aria-label":p,className:h,style:l.nav_button_previous,disabled:!e.previousMonth,onClick:e.onPreviousClick,children:s==="rtl"?i.jsx(x,{className:o.nav_icon,style:l.nav_icon}):i.jsx(w,{className:o.nav_icon,style:l.nav_icon})}),!e.hideNext&&i.jsx(y0,{name:"next-month","aria-label":g,className:m,style:l.nav_button_next,disabled:!e.nextMonth,onClick:e.onNextClick,children:s==="rtl"?i.jsx(w,{className:o.nav_icon,style:l.nav_icon}):i.jsx(x,{className:o.nav_icon,style:l.nav_icon})})]})}function HS(e){var t=Ht().numberOfMonths,r=Yf(),n=r.previousMonth,s=r.nextMonth,a=r.goToMonth,o=r.displayMonths,l=o.findIndex(function(g){return aw(e.displayMonth,g)}),c=l===0,u=l===o.length-1,d=t>1&&(c||!u),f=t>1&&(u||!c),p=function(){n&&a(n)},h=function(){s&&a(s)};return i.jsx(RJ,{displayMonth:e.displayMonth,hideNext:d,hidePrevious:f,nextMonth:s,previousMonth:n,onPreviousClick:p,onNextClick:h})}function MJ(e){var t,r=Ht(),n=r.classNames,s=r.disableNavigation,a=r.styles,o=r.captionLayout,l=r.components,c=(t=l==null?void 0:l.CaptionLabel)!==null&&t!==void 0?t:n3,u;return s?u=i.jsx(c,{id:e.id,displayMonth:e.displayMonth}):o==="dropdown"?u=i.jsx(WS,{displayMonth:e.displayMonth,id:e.id}):o==="dropdown-buttons"?u=i.jsxs(i.Fragment,{children:[i.jsx(WS,{displayMonth:e.displayMonth,displayIndex:e.displayIndex,id:e.id}),i.jsx(HS,{displayMonth:e.displayMonth,displayIndex:e.displayIndex,id:e.id})]}):u=i.jsxs(i.Fragment,{children:[i.jsx(c,{id:e.id,displayMonth:e.displayMonth,displayIndex:e.displayIndex}),i.jsx(HS,{displayMonth:e.displayMonth,id:e.id})]}),i.jsx("div",{className:n.caption,style:a.caption,children:u})}function OJ(e){var t=Ht(),r=t.footer,n=t.styles,s=t.classNames.tfoot;return r?i.jsx("tfoot",{className:s,style:n.tfoot,children:i.jsx("tr",{children:i.jsx("td",{colSpan:8,children:r})})}):i.jsx(i.Fragment,{})}function FJ(e,t,r){for(var n=r?ll(new Date):Ts(new Date,{locale:e,weekStartsOn:t}),s=[],a=0;a<7;a++){var o=hn(n,a);s.push(o)}return s}function IJ(){var e=Ht(),t=e.classNames,r=e.styles,n=e.showWeekNumber,s=e.locale,a=e.weekStartsOn,o=e.ISOWeek,l=e.formatters.formatWeekdayName,c=e.labels.labelWeekday,u=FJ(s,a,o);return i.jsxs("tr",{style:r.head_row,className:t.head_row,children:[n&&i.jsx("td",{style:r.head_cell,className:t.head_cell}),u.map(function(d,f){return i.jsx("th",{scope:"col",className:t.head_cell,style:r.head_cell,"aria-label":c(d,{locale:s}),children:l(d,{locale:s})},f)})]})}function LJ(){var e,t=Ht(),r=t.classNames,n=t.styles,s=t.components,a=(e=s==null?void 0:s.HeadRow)!==null&&e!==void 0?e:IJ;return i.jsx("thead",{style:n.head,className:r.head,children:i.jsx(a,{})})}function $J(e){var t=Ht(),r=t.locale,n=t.formatters.formatDay;return i.jsx(i.Fragment,{children:n(e.date,{locale:r})})}var Ow=y.createContext(void 0);function BJ(e){if(!Gf(e.initialProps)){var t={selected:void 0,modifiers:{disabled:[]}};return i.jsx(Ow.Provider,{value:t,children:e.children})}return i.jsx(UJ,{initialProps:e.initialProps,children:e.children})}function UJ(e){var t=e.initialProps,r=e.children,n=t.selected,s=t.min,a=t.max,o=function(u,d,f){var p,h;(p=t.onDayClick)===null||p===void 0||p.call(t,u,d,f);var g=!!(d.selected&&s&&(n==null?void 0:n.length)===s);if(!g){var m=!!(!d.selected&&a&&(n==null?void 0:n.length)===a);if(!m){var x=n?t3([],n):[];if(d.selected){var w=x.findIndex(function(v){return $n(u,v)});x.splice(w,1)}else x.push(u);(h=t.onSelect)===null||h===void 0||h.call(t,x,u,d,f)}}},l={disabled:[]};n&&l.disabled.push(function(u){var d=a&&n.length>a-1,f=n.some(function(p){return $n(p,u)});return!!(d&&!f)});var c={selected:n,onDayClick:o,modifiers:l};return i.jsx(Ow.Provider,{value:c,children:r})}function Fw(){var e=y.useContext(Ow);if(!e)throw new Error("useSelectMultiple must be used within a SelectMultipleProvider");return e}function zJ(e,t){var r=t||{},n=r.from,s=r.to;return n&&s?$n(s,e)&&$n(n,e)?void 0:$n(s,e)?{from:s,to:void 0}:$n(n,e)?void 0:Zm(n,e)?{from:e,to:s}:{from:n,to:e}:s?Zm(e,s)?{from:s,to:e}:{from:e,to:s}:n?sw(e,n)?{from:e,to:n}:{from:n,to:e}:{from:e,to:void 0}}var Iw=y.createContext(void 0);function VJ(e){if(!qf(e.initialProps)){var t={selected:void 0,modifiers:{range_start:[],range_end:[],range_middle:[],disabled:[]}};return i.jsx(Iw.Provider,{value:t,children:e.children})}return i.jsx(WJ,{initialProps:e.initialProps,children:e.children})}function WJ(e){var t=e.initialProps,r=e.children,n=t.selected,s=n||{},a=s.from,o=s.to,l=t.min,c=t.max,u=function(h,g,m){var x,w;(x=t.onDayClick)===null||x===void 0||x.call(t,h,g,m);var v=zJ(h,n);(w=t.onSelect)===null||w===void 0||w.call(t,v,h,g,m)},d={range_start:[],range_end:[],range_middle:[],disabled:[]};if(a?(d.range_start=[a],o?(d.range_end=[o],$n(a,o)||(d.range_middle=[{after:a,before:o}])):d.range_end=[a]):o&&(d.range_start=[o],d.range_end=[o]),l&&(a&&!o&&d.disabled.push({after:tx(a,l-1),before:hn(a,l-1)}),a&&o&&d.disabled.push({after:a,before:hn(a,l-1)}),!a&&o&&d.disabled.push({after:tx(o,l-1),before:hn(o,l-1)})),c){if(a&&!o&&(d.disabled.push({before:hn(a,-c+1)}),d.disabled.push({after:hn(a,c-1)})),a&&o){var f=Xs(o,a)+1,p=c-f;d.disabled.push({before:tx(a,p)}),d.disabled.push({after:hn(o,p)})}!a&&o&&(d.disabled.push({before:hn(o,-c+1)}),d.disabled.push({after:hn(o,c-1)}))}return i.jsx(Iw.Provider,{value:{selected:n,onDayClick:u,modifiers:d},children:r})}function Lw(){var e=y.useContext(Iw);if(!e)throw new Error("useSelectRange must be used within a SelectRangeProvider");return e}function mm(e){return Array.isArray(e)?t3([],e):e!==void 0?[e]:[]}function HJ(e){var t={};return Object.entries(e).forEach(function(r){var n=r[0],s=r[1];t[n]=mm(s)}),t}var ca;(function(e){e.Outside="outside",e.Disabled="disabled",e.Selected="selected",e.Hidden="hidden",e.Today="today",e.RangeStart="range_start",e.RangeEnd="range_end",e.RangeMiddle="range_middle"})(ca||(ca={}));var GJ=ca.Selected,Ba=ca.Disabled,qJ=ca.Hidden,YJ=ca.Today,mx=ca.RangeEnd,px=ca.RangeMiddle,gx=ca.RangeStart,KJ=ca.Outside;function XJ(e,t,r){var n,s=(n={},n[GJ]=mm(e.selected),n[Ba]=mm(e.disabled),n[qJ]=mm(e.hidden),n[YJ]=[e.today],n[mx]=[],n[px]=[],n[gx]=[],n[KJ]=[],n);return e.fromDate&&s[Ba].push({before:e.fromDate}),e.toDate&&s[Ba].push({after:e.toDate}),Gf(e)?s[Ba]=s[Ba].concat(t.modifiers[Ba]):qf(e)&&(s[Ba]=s[Ba].concat(r.modifiers[Ba]),s[gx]=r.modifiers[gx],s[px]=r.modifiers[px],s[mx]=r.modifiers[mx]),s}var i3=y.createContext(void 0);function QJ(e){var t=Ht(),r=Fw(),n=Lw(),s=XJ(t,r,n),a=HJ(t.modifiers),o=nt(nt({},s),a);return i.jsx(i3.Provider,{value:o,children:e.children})}function o3(){var e=y.useContext(i3);if(!e)throw new Error("useModifiers must be used within a ModifiersProvider");return e}function JJ(e){return!!(e&&typeof e=="object"&&"before"in e&&"after"in e)}function ZJ(e){return!!(e&&typeof e=="object"&&"from"in e)}function eZ(e){return!!(e&&typeof e=="object"&&"after"in e)}function tZ(e){return!!(e&&typeof e=="object"&&"before"in e)}function rZ(e){return!!(e&&typeof e=="object"&&"dayOfWeek"in e)}function nZ(e,t){var r,n=t.from,s=t.to;if(n&&s){var a=Xs(s,n)<0;a&&(r=[s,n],n=r[0],s=r[1]);var o=Xs(e,n)>=0&&Xs(s,e)>=0;return o}return s?$n(s,e):n?$n(n,e):!1}function sZ(e){return ew(e)}function aZ(e){return Array.isArray(e)&&e.every(ew)}function iZ(e,t){return t.some(function(r){if(typeof r=="boolean")return r;if(sZ(r))return $n(e,r);if(aZ(r))return r.includes(e);if(ZJ(r))return nZ(e,r);if(rZ(r))return r.dayOfWeek.includes(e.getDay());if(JJ(r)){var n=Xs(r.before,e),s=Xs(r.after,e),a=n>0,o=s<0,l=Zm(r.before,r.after);return l?o&&a:a||o}return eZ(r)?Xs(e,r.after)>0:tZ(r)?Xs(r.before,e)>0:typeof r=="function"?r(e):!1})}function $w(e,t,r){var n=Object.keys(t).reduce(function(a,o){var l=t[o];return iZ(e,l)&&a.push(o),a},[]),s={};return n.forEach(function(a){return s[a]=!0}),r&&!aw(e,r)&&(s.outside=!0),s}function oZ(e,t){for(var r=Mr(e[0]),n=Ja(e[e.length-1]),s,a,o=r;o<=n;){var l=$w(o,t),c=!l.disabled&&!l.hidden;if(!c){o=hn(o,1);continue}if(l.selected)return o;l.today&&!a&&(a=o),s||(s=o),o=hn(o,1)}return a||s}var lZ=365;function l3(e,t){var r=t.moveBy,n=t.direction,s=t.context,a=t.modifiers,o=t.retry,l=o===void 0?{count:0,lastFocused:e}:o,c=s.weekStartsOn,u=s.fromDate,d=s.toDate,f=s.locale,p={day:hn,week:Jm,month:us,year:AU,startOfWeek:function(x){return s.ISOWeek?ll(x):Ts(x,{locale:f,weekStartsOn:c})},endOfWeek:function(x){return s.ISOWeek?b4(x):Yd(x,{locale:f,weekStartsOn:c})}},h=p[r](e,n==="after"?1:-1);n==="before"&&u?h=PU([u,h]):n==="after"&&d&&(h=DU([d,h]));var g=!0;if(a){var m=$w(h,a);g=!m.disabled&&!m.hidden}return g?h:l.count>lZ?l.lastFocused:l3(h,{moveBy:r,direction:n,context:s,modifiers:a,retry:nt(nt({},l),{count:l.count+1})})}var c3=y.createContext(void 0);function cZ(e){var t=Yf(),r=o3(),n=y.useState(),s=n[0],a=n[1],o=y.useState(),l=o[0],c=o[1],u=oZ(t.displayMonths,r),d=s??(l&&t.isDateDisplayed(l))?l:u,f=function(){c(s),a(void 0)},p=function(x){a(x)},h=Ht(),g=function(x,w){if(s){var v=l3(s,{moveBy:x,direction:w,context:h,modifiers:r});$n(s,v)||(t.goToDate(v,s),p(v))}},m={focusedDay:s,focusTarget:d,blur:f,focus:p,focusDayAfter:function(){return g("day","after")},focusDayBefore:function(){return g("day","before")},focusWeekAfter:function(){return g("week","after")},focusWeekBefore:function(){return g("week","before")},focusMonthBefore:function(){return g("month","before")},focusMonthAfter:function(){return g("month","after")},focusYearBefore:function(){return g("year","before")},focusYearAfter:function(){return g("year","after")},focusStartOfWeek:function(){return g("startOfWeek","before")},focusEndOfWeek:function(){return g("endOfWeek","after")}};return i.jsx(c3.Provider,{value:m,children:e.children})}function Bw(){var e=y.useContext(c3);if(!e)throw new Error("useFocusContext must be used within a FocusProvider");return e}function uZ(e,t){var r=o3(),n=$w(e,r,t);return n}var Uw=y.createContext(void 0);function dZ(e){if(!Up(e.initialProps)){var t={selected:void 0};return i.jsx(Uw.Provider,{value:t,children:e.children})}return i.jsx(fZ,{initialProps:e.initialProps,children:e.children})}function fZ(e){var t=e.initialProps,r=e.children,n=function(a,o,l){var c,u,d;if((c=t.onDayClick)===null||c===void 0||c.call(t,a,o,l),o.selected&&!t.required){(u=t.onSelect)===null||u===void 0||u.call(t,void 0,a,o,l);return}(d=t.onSelect)===null||d===void 0||d.call(t,a,a,o,l)},s={selected:t.selected,onDayClick:n};return i.jsx(Uw.Provider,{value:s,children:r})}function u3(){var e=y.useContext(Uw);if(!e)throw new Error("useSelectSingle must be used within a SelectSingleProvider");return e}function hZ(e,t){var r=Ht(),n=u3(),s=Fw(),a=Lw(),o=Bw(),l=o.focusDayAfter,c=o.focusDayBefore,u=o.focusWeekAfter,d=o.focusWeekBefore,f=o.blur,p=o.focus,h=o.focusMonthBefore,g=o.focusMonthAfter,m=o.focusYearBefore,x=o.focusYearAfter,w=o.focusStartOfWeek,v=o.focusEndOfWeek,_=function(Y){var z,U,V,F;Up(r)?(z=n.onDayClick)===null||z===void 0||z.call(n,e,t,Y):Gf(r)?(U=s.onDayClick)===null||U===void 0||U.call(s,e,t,Y):qf(r)?(V=a.onDayClick)===null||V===void 0||V.call(a,e,t,Y):(F=r.onDayClick)===null||F===void 0||F.call(r,e,t,Y)},b=function(Y){var z;p(e),(z=r.onDayFocus)===null||z===void 0||z.call(r,e,t,Y)},S=function(Y){var z;f(),(z=r.onDayBlur)===null||z===void 0||z.call(r,e,t,Y)},T=function(Y){var z;(z=r.onDayMouseEnter)===null||z===void 0||z.call(r,e,t,Y)},N=function(Y){var z;(z=r.onDayMouseLeave)===null||z===void 0||z.call(r,e,t,Y)},C=function(Y){var z;(z=r.onDayPointerEnter)===null||z===void 0||z.call(r,e,t,Y)},E=function(Y){var z;(z=r.onDayPointerLeave)===null||z===void 0||z.call(r,e,t,Y)},P=function(Y){var z;(z=r.onDayTouchCancel)===null||z===void 0||z.call(r,e,t,Y)},R=function(Y){var z;(z=r.onDayTouchEnd)===null||z===void 0||z.call(r,e,t,Y)},j=function(Y){var z;(z=r.onDayTouchMove)===null||z===void 0||z.call(r,e,t,Y)},M=function(Y){var z;(z=r.onDayTouchStart)===null||z===void 0||z.call(r,e,t,Y)},A=function(Y){var z;(z=r.onDayKeyUp)===null||z===void 0||z.call(r,e,t,Y)},I=function(Y){var z;switch(Y.key){case"ArrowLeft":Y.preventDefault(),Y.stopPropagation(),r.dir==="rtl"?l():c();break;case"ArrowRight":Y.preventDefault(),Y.stopPropagation(),r.dir==="rtl"?c():l();break;case"ArrowDown":Y.preventDefault(),Y.stopPropagation(),u();break;case"ArrowUp":Y.preventDefault(),Y.stopPropagation(),d();break;case"PageUp":Y.preventDefault(),Y.stopPropagation(),Y.shiftKey?m():h();break;case"PageDown":Y.preventDefault(),Y.stopPropagation(),Y.shiftKey?x():g();break;case"Home":Y.preventDefault(),Y.stopPropagation(),w();break;case"End":Y.preventDefault(),Y.stopPropagation(),v();break}(z=r.onDayKeyDown)===null||z===void 0||z.call(r,e,t,Y)},X={onClick:_,onFocus:b,onBlur:S,onKeyDown:I,onKeyUp:A,onMouseEnter:T,onMouseLeave:N,onPointerEnter:C,onPointerLeave:E,onTouchCancel:P,onTouchEnd:R,onTouchMove:j,onTouchStart:M};return X}function mZ(){var e=Ht(),t=u3(),r=Fw(),n=Lw(),s=Up(e)?t.selected:Gf(e)?r.selected:qf(e)?n.selected:void 0;return s}function pZ(e){return Object.values(ca).includes(e)}function gZ(e,t){var r=[e.classNames.day];return Object.keys(t).forEach(function(n){var s=e.modifiersClassNames[n];if(s)r.push(s);else if(pZ(n)){var a=e.classNames["day_".concat(n)];a&&r.push(a)}}),r}function xZ(e,t){var r=nt({},e.styles.day);return Object.keys(t).forEach(function(n){var s;r=nt(nt({},r),(s=e.modifiersStyles)===null||s===void 0?void 0:s[n])}),r}function vZ(e,t,r){var n,s,a,o=Ht(),l=Bw(),c=uZ(e,t),u=hZ(e,c),d=mZ(),f=!!(o.onDayClick||o.mode!=="default");y.useEffect(function(){var T;c.outside||l.focusedDay&&f&&$n(l.focusedDay,e)&&((T=r.current)===null||T===void 0||T.focus())},[l.focusedDay,e,r,f,c.outside]);var p=gZ(o,c).join(" "),h=xZ(o,c),g=!!(c.outside&&!o.showOutsideDays||c.hidden),m=(a=(s=o.components)===null||s===void 0?void 0:s.DayContent)!==null&&a!==void 0?a:$J,x=i.jsx(m,{date:e,displayMonth:t,activeModifiers:c}),w={style:h,className:p,children:x,role:"gridcell"},v=l.focusTarget&&$n(l.focusTarget,e)&&!c.outside,_=l.focusedDay&&$n(l.focusedDay,e),b=nt(nt(nt({},w),(n={disabled:c.disabled,role:"gridcell"},n["aria-selected"]=c.selected,n.tabIndex=_||v?0:-1,n)),u),S={isButton:f,isHidden:g,activeModifiers:c,selectedDays:d,buttonProps:b,divProps:w};return S}function yZ(e){var t=y.useRef(null),r=vZ(e.date,e.displayMonth,t);return r.isHidden?i.jsx("div",{role:"gridcell"}):r.isButton?i.jsx(y0,nt({name:"day",ref:t},r.buttonProps)):i.jsx("div",nt({},r.divProps))}function wZ(e){var t=e.number,r=e.dates,n=Ht(),s=n.onWeekNumberClick,a=n.styles,o=n.classNames,l=n.locale,c=n.labels.labelWeekNumber,u=n.formatters.formatWeekNumber,d=u(Number(t),{locale:l});if(!s)return i.jsx("span",{className:o.weeknumber,style:a.weeknumber,children:d});var f=c(Number(t),{locale:l}),p=function(h){s(t,r,h)};return i.jsx(y0,{name:"week-number","aria-label":f,className:o.weeknumber,style:a.weeknumber,onClick:p,children:d})}function _Z(e){var t,r,n=Ht(),s=n.styles,a=n.classNames,o=n.showWeekNumber,l=n.components,c=(t=l==null?void 0:l.Day)!==null&&t!==void 0?t:yZ,u=(r=l==null?void 0:l.WeekNumber)!==null&&r!==void 0?r:wZ,d;return o&&(d=i.jsx("td",{className:a.cell,style:s.cell,children:i.jsx(u,{number:e.weekNumber,dates:e.dates})})),i.jsxs("tr",{className:a.row,style:s.row,children:[d,e.dates.map(function(f){return i.jsx("td",{className:a.cell,style:s.cell,role:"presentation",children:i.jsx(c,{displayMonth:e.displayMonth,date:f})},Vz(f))})]})}function GS(e,t,r){for(var n=r!=null&&r.ISOWeek?b4(t):Yd(t,r),s=r!=null&&r.ISOWeek?ll(e):Ts(e,r),a=Xs(n,s),o=[],l=0;l<=a;l++)o.push(hn(s,l));var c=o.reduce(function(u,d){var f=r!=null&&r.ISOWeek?S4(d):j4(d,r),p=u.find(function(h){return h.weekNumber===f});return p?(p.dates.push(d),u):(u.push({weekNumber:f,dates:[d]}),u)},[]);return c}function bZ(e,t){var r=GS(Mr(e),Ja(e),t);if(t!=null&&t.useFixedWeeks){var n=Hz(e,t);if(n<6){var s=r[r.length-1],a=s.dates[s.dates.length-1],o=Jm(a,6-n),l=GS(Jm(a,1),o,t);r.push.apply(r,l)}}return r}function SZ(e){var t,r,n,s=Ht(),a=s.locale,o=s.classNames,l=s.styles,c=s.hideHead,u=s.fixedWeeks,d=s.components,f=s.weekStartsOn,p=s.firstWeekContainsDate,h=s.ISOWeek,g=bZ(e.displayMonth,{useFixedWeeks:!!u,ISOWeek:h,locale:a,weekStartsOn:f,firstWeekContainsDate:p}),m=(t=d==null?void 0:d.Head)!==null&&t!==void 0?t:LJ,x=(r=d==null?void 0:d.Row)!==null&&r!==void 0?r:_Z,w=(n=d==null?void 0:d.Footer)!==null&&n!==void 0?n:OJ;return i.jsxs("table",{id:e.id,className:o.table,style:l.table,role:"grid","aria-labelledby":e["aria-labelledby"],children:[!c&&i.jsx(m,{}),i.jsx("tbody",{className:o.tbody,style:l.tbody,children:g.map(function(v){return i.jsx(x,{displayMonth:e.displayMonth,dates:v.dates,weekNumber:v.weekNumber},v.weekNumber)})}),i.jsx(w,{displayMonth:e.displayMonth})]})}function NZ(){return!!(typeof window<"u"&&window.document&&window.document.createElement)}var jZ=NZ()?y.useLayoutEffect:y.useEffect,xx=!1,EZ=0;function qS(){return"react-day-picker-".concat(++EZ)}function kZ(e){var t,r=e??(xx?qS():null),n=y.useState(r),s=n[0],a=n[1];return jZ(function(){s===null&&a(qS())},[]),y.useEffect(function(){xx===!1&&(xx=!0)},[]),(t=e??s)!==null&&t!==void 0?t:void 0}function CZ(e){var t,r,n=Ht(),s=n.dir,a=n.classNames,o=n.styles,l=n.components,c=Yf().displayMonths,u=kZ(n.id?"".concat(n.id,"-").concat(e.displayIndex):void 0),d=n.id?"".concat(n.id,"-grid-").concat(e.displayIndex):void 0,f=[a.month],p=o.month,h=e.displayIndex===0,g=e.displayIndex===c.length-1,m=!h&&!g;s==="rtl"&&(t=[h,g],g=t[0],h=t[1]),h&&(f.push(a.caption_start),p=nt(nt({},p),o.caption_start)),g&&(f.push(a.caption_end),p=nt(nt({},p),o.caption_end)),m&&(f.push(a.caption_between),p=nt(nt({},p),o.caption_between));var x=(r=l==null?void 0:l.Caption)!==null&&r!==void 0?r:MJ;return i.jsxs("div",{className:f.join(" "),style:p,children:[i.jsx(x,{id:u,displayMonth:e.displayMonth,displayIndex:e.displayIndex}),i.jsx(SZ,{id:d,"aria-labelledby":u,displayMonth:e.displayMonth})]},e.displayIndex)}function TZ(e){var t=Ht(),r=t.classNames,n=t.styles;return i.jsx("div",{className:r.months,style:n.months,children:e.children})}function AZ(e){var t,r,n=e.initialProps,s=Ht(),a=Bw(),o=Yf(),l=y.useState(!1),c=l[0],u=l[1];y.useEffect(function(){s.initialFocus&&a.focusTarget&&(c||(a.focus(a.focusTarget),u(!0)))},[s.initialFocus,c,a.focus,a.focusTarget,a]);var d=[s.classNames.root,s.className];s.numberOfMonths>1&&d.push(s.classNames.multiple_months),s.showWeekNumber&&d.push(s.classNames.with_weeknumber);var f=nt(nt({},s.styles.root),s.style),p=Object.keys(n).filter(function(g){return g.startsWith("data-")}).reduce(function(g,m){var x;return nt(nt({},g),(x={},x[m]=n[m],x))},{}),h=(r=(t=n.components)===null||t===void 0?void 0:t.Months)!==null&&r!==void 0?r:TZ;return i.jsx("div",nt({className:d.join(" "),style:f,dir:s.dir,id:s.id,nonce:n.nonce,title:n.title,lang:n.lang},p,{children:i.jsx(h,{children:o.displayMonths.map(function(g,m){return i.jsx(CZ,{displayIndex:m,displayMonth:g},m)})})}))}function PZ(e){var t=e.children,r=tJ(e,["children"]);return i.jsx(wJ,{initialProps:r,children:i.jsx(AJ,{children:i.jsx(dZ,{initialProps:r,children:i.jsx(BJ,{initialProps:r,children:i.jsx(VJ,{initialProps:r,children:i.jsx(QJ,{children:i.jsx(cZ,{children:t})})})})})})})}function DZ(e){return i.jsx(PZ,nt({},e,{children:i.jsx(AZ,{initialProps:e})}))}function rf({className:e,classNames:t,showOutsideDays:r=!0,...n}){return i.jsx(DZ,{showOutsideDays:r,className:De("p-3",e),classNames:{months:"flex flex-col sm:flex-row space-y-4 sm:space-x-4 sm:space-y-0",month:"space-y-4",caption:"flex justify-center pt-1 relative items-center",caption_label:"text-sm font-medium",nav:"space-x-1 flex items-center",nav_button:De(Hd({variant:"outline"}),"h-7 w-7 bg-transparent p-0 opacity-50 hover:opacity-100"),nav_button_previous:"absolute left-1",nav_button_next:"absolute right-1",table:"w-full border-collapse space-y-1",head_row:"flex",head_cell:"text-muted-foreground rounded-md w-9 font-normal text-[0.8rem]",row:"flex w-full mt-2",cell:"h-9 w-9 text-center text-sm p-0 relative [&:has([aria-selected].day-range-end)]:rounded-r-md [&:has([aria-selected].day-outside)]:bg-accent/50 [&:has([aria-selected])]:bg-accent first:[&:has([aria-selected])]:rounded-l-md last:[&:has([aria-selected])]:rounded-r-md focus-within:relative focus-within:z-20",day:De(Hd({variant:"ghost"}),"h-9 w-9 p-0 font-normal aria-selected:opacity-100"),day_range_end:"day-range-end",day_selected:"bg-primary text-primary-foreground hover:bg-primary hover:text-primary-foreground focus:bg-primary focus:text-primary-foreground",day_today:"bg-accent text-accent-foreground",day_outside:"day-outside text-muted-foreground opacity-50 aria-selected:bg-accent/50 aria-selected:text-muted-foreground aria-selected:opacity-30",day_disabled:"text-muted-foreground opacity-50",day_range_middle:"aria-selected:bg-accent aria-selected:text-accent-foreground",day_hidden:"invisible",...t},components:{IconLeft:({...s})=>i.jsx(lk,{className:"h-4 w-4"}),IconRight:({...s})=>i.jsx(f1,{className:"h-4 w-4"})},...n})}rf.displayName="Calendar";var zp="Popover",[d3,use]=Fr(zp,[yo]),Kf=yo(),[RZ,ko]=d3(zp),f3=e=>{const{__scopePopover:t,children:r,open:n,defaultOpen:s,onOpenChange:a,modal:o=!1}=e,l=Kf(t),c=y.useRef(null),[u,d]=y.useState(!1),[f,p]=Hn({prop:n,defaultProp:s??!1,onChange:a,caller:zp});return i.jsx(Q0,{...l,children:i.jsx(RZ,{scope:t,contentId:Er(),triggerRef:c,open:f,onOpenChange:p,onOpenToggle:y.useCallback(()=>p(h=>!h),[p]),hasCustomAnchor:u,onCustomAnchorAdd:y.useCallback(()=>d(!0),[]),onCustomAnchorRemove:y.useCallback(()=>d(!1),[]),modal:o,children:r})})};f3.displayName=zp;var h3="PopoverAnchor",MZ=y.forwardRef((e,t)=>{const{__scopePopover:r,...n}=e,s=ko(h3,r),a=Kf(r),{onCustomAnchorAdd:o,onCustomAnchorRemove:l}=s;return y.useEffect(()=>(o(),()=>l()),[o,l]),i.jsx(Nf,{...a,...n,ref:t})});MZ.displayName=h3;var m3="PopoverTrigger",p3=y.forwardRef((e,t)=>{const{__scopePopover:r,...n}=e,s=ko(m3,r),a=Kf(r),o=st(t,s.triggerRef),l=i.jsx(ze.button,{type:"button","aria-haspopup":"dialog","aria-expanded":s.open,"aria-controls":s.contentId,"data-state":w3(s.open),...n,ref:o,onClick:Oe(e.onClick,s.onOpenToggle)});return s.hasCustomAnchor?l:i.jsx(Nf,{asChild:!0,...a,children:l})});p3.displayName=m3;var zw="PopoverPortal",[OZ,FZ]=d3(zw,{forceMount:void 0}),g3=e=>{const{__scopePopover:t,forceMount:r,children:n,container:s}=e,a=ko(zw,t);return i.jsx(OZ,{scope:t,forceMount:r,children:i.jsx(Ir,{present:r||a.open,children:i.jsx(Jc,{asChild:!0,container:s,children:n})})})};g3.displayName=zw;var Hc="PopoverContent",x3=y.forwardRef((e,t)=>{const r=FZ(Hc,e.__scopePopover),{forceMount:n=r.forceMount,...s}=e,a=ko(Hc,e.__scopePopover);return i.jsx(Ir,{present:n||a.open,children:a.modal?i.jsx(LZ,{...s,ref:t}):i.jsx($Z,{...s,ref:t})})});x3.displayName=Hc;var IZ=oo("PopoverContent.RemoveScroll"),LZ=y.forwardRef((e,t)=>{const r=ko(Hc,e.__scopePopover),n=y.useRef(null),s=st(t,n),a=y.useRef(!1);return y.useEffect(()=>{const o=n.current;if(o)return mp(o)},[]),i.jsx(Mf,{as:IZ,allowPinchZoom:!0,children:i.jsx(v3,{...e,ref:s,trapFocus:r.open,disableOutsidePointerEvents:!0,onCloseAutoFocus:Oe(e.onCloseAutoFocus,o=>{var l;o.preventDefault(),a.current||(l=r.triggerRef.current)==null||l.focus()}),onPointerDownOutside:Oe(e.onPointerDownOutside,o=>{const l=o.detail.originalEvent,c=l.button===0&&l.ctrlKey===!0,u=l.button===2||c;a.current=u},{checkForDefaultPrevented:!1}),onFocusOutside:Oe(e.onFocusOutside,o=>o.preventDefault(),{checkForDefaultPrevented:!1})})})}),$Z=y.forwardRef((e,t)=>{const r=ko(Hc,e.__scopePopover),n=y.useRef(!1),s=y.useRef(!1);return i.jsx(v3,{...e,ref:t,trapFocus:!1,disableOutsidePointerEvents:!1,onCloseAutoFocus:a=>{var o,l;(o=e.onCloseAutoFocus)==null||o.call(e,a),a.defaultPrevented||(n.current||(l=r.triggerRef.current)==null||l.focus(),a.preventDefault()),n.current=!1,s.current=!1},onInteractOutside:a=>{var c,u;(c=e.onInteractOutside)==null||c.call(e,a),a.defaultPrevented||(n.current=!0,a.detail.originalEvent.type==="pointerdown"&&(s.current=!0));const o=a.target;((u=r.triggerRef.current)==null?void 0:u.contains(o))&&a.preventDefault(),a.detail.originalEvent.type==="focusin"&&s.current&&a.preventDefault()}})}),v3=y.forwardRef((e,t)=>{const{__scopePopover:r,trapFocus:n,onOpenAutoFocus:s,onCloseAutoFocus:a,disableOutsidePointerEvents:o,onEscapeKeyDown:l,onPointerDownOutside:c,onFocusOutside:u,onInteractOutside:d,...f}=e,p=ko(Hc,r),h=Kf(r);return fp(),i.jsx(Rf,{asChild:!0,loop:!0,trapped:n,onMountAutoFocus:s,onUnmountAutoFocus:a,children:i.jsx(vl,{asChild:!0,disableOutsidePointerEvents:o,onInteractOutside:d,onEscapeKeyDown:l,onPointerDownOutside:c,onFocusOutside:u,onDismiss:()=>p.onOpenChange(!1),children:i.jsx(J0,{"data-state":w3(p.open),role:"dialog",id:p.contentId,...h,...f,ref:t,style:{...f.style,"--radix-popover-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-popover-content-available-width":"var(--radix-popper-available-width)","--radix-popover-content-available-height":"var(--radix-popper-available-height)","--radix-popover-trigger-width":"var(--radix-popper-anchor-width)","--radix-popover-trigger-height":"var(--radix-popper-anchor-height)"}})})})}),y3="PopoverClose",BZ=y.forwardRef((e,t)=>{const{__scopePopover:r,...n}=e,s=ko(y3,r);return i.jsx(ze.button,{type:"button",...n,ref:t,onClick:Oe(e.onClick,()=>s.onOpenChange(!1))})});BZ.displayName=y3;var UZ="PopoverArrow",zZ=y.forwardRef((e,t)=>{const{__scopePopover:r,...n}=e,s=Kf(r);return i.jsx(Z0,{...s,...n,ref:t})});zZ.displayName=UZ;function w3(e){return e?"open":"closed"}var VZ=f3,WZ=p3,HZ=g3,_3=x3;const nf=VZ,sf=WZ,Gc=y.forwardRef(({className:e,align:t="center",sideOffset:r=4,...n},s)=>i.jsx(HZ,{children:i.jsx(_3,{ref:s,align:t,sideOffset:r,className:De("z-[14000] w-72 rounded-md border bg-popover p-4 text-popover-foreground shadow-md outline-none data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",e),...n})}));Gc.displayName=_3.displayName;var Vp="Checkbox",[GZ,dse]=Fr(Vp),[qZ,Vw]=GZ(Vp);function YZ(e){const{__scopeCheckbox:t,checked:r,children:n,defaultChecked:s,disabled:a,form:o,name:l,onCheckedChange:c,required:u,value:d="on",internal_do_not_use_render:f}=e,[p,h]=Hn({prop:r,defaultProp:s??!1,onChange:c,caller:Vp}),[g,m]=y.useState(null),[x,w]=y.useState(null),v=y.useRef(!1),_=g?!!o||!!g.closest("form"):!0,b={checked:p,disabled:a,setChecked:h,control:g,setControl:m,name:l,form:o,value:d,hasConsumerStoppedPropagationRef:v,required:u,defaultChecked:so(s)?!1:s,isFormControl:_,bubbleInput:x,setBubbleInput:w};return i.jsx(qZ,{scope:t,...b,children:KZ(f)?f(b):n})}var b3="CheckboxTrigger",S3=y.forwardRef(({__scopeCheckbox:e,onKeyDown:t,onClick:r,...n},s)=>{const{control:a,value:o,disabled:l,checked:c,required:u,setControl:d,setChecked:f,hasConsumerStoppedPropagationRef:p,isFormControl:h,bubbleInput:g}=Vw(b3,e),m=st(s,d),x=y.useRef(c);return y.useEffect(()=>{const w=a==null?void 0:a.form;if(w){const v=()=>f(x.current);return w.addEventListener("reset",v),()=>w.removeEventListener("reset",v)}},[a,f]),i.jsx(ze.button,{type:"button",role:"checkbox","aria-checked":so(c)?"mixed":c,"aria-required":u,"data-state":C3(c),"data-disabled":l?"":void 0,disabled:l,value:o,...n,ref:m,onKeyDown:Oe(t,w=>{w.key==="Enter"&&w.preventDefault()}),onClick:Oe(r,w=>{f(v=>so(v)?!0:!v),g&&h&&(p.current=w.isPropagationStopped(),p.current||w.stopPropagation())})})});S3.displayName=b3;var Ww=y.forwardRef((e,t)=>{const{__scopeCheckbox:r,name:n,checked:s,defaultChecked:a,required:o,disabled:l,value:c,onCheckedChange:u,form:d,...f}=e;return i.jsx(YZ,{__scopeCheckbox:r,checked:s,defaultChecked:a,disabled:l,required:o,onCheckedChange:u,name:n,form:d,value:c,internal_do_not_use_render:({isFormControl:p})=>i.jsxs(i.Fragment,{children:[i.jsx(S3,{...f,ref:t,__scopeCheckbox:r}),p&&i.jsx(k3,{__scopeCheckbox:r})]})})});Ww.displayName=Vp;var N3="CheckboxIndicator",j3=y.forwardRef((e,t)=>{const{__scopeCheckbox:r,forceMount:n,...s}=e,a=Vw(N3,r);return i.jsx(Ir,{present:n||so(a.checked)||a.checked===!0,children:i.jsx(ze.span,{"data-state":C3(a.checked),"data-disabled":a.disabled?"":void 0,...s,ref:t,style:{pointerEvents:"none",...e.style}})})});j3.displayName=N3;var E3="CheckboxBubbleInput",k3=y.forwardRef(({__scopeCheckbox:e,...t},r)=>{const{control:n,hasConsumerStoppedPropagationRef:s,checked:a,defaultChecked:o,required:l,disabled:c,name:u,value:d,form:f,bubbleInput:p,setBubbleInput:h}=Vw(E3,e),g=st(r,h),m=Rw(a),x=j1(n);y.useEffect(()=>{const v=p;if(!v)return;const _=window.HTMLInputElement.prototype,S=Object.getOwnPropertyDescriptor(_,"checked").set,T=!s.current;if(m!==a&&S){const N=new Event("click",{bubbles:T});v.indeterminate=so(a),S.call(v,so(a)?!1:a),v.dispatchEvent(N)}},[p,m,a,s]);const w=y.useRef(so(a)?!1:a);return i.jsx(ze.input,{type:"checkbox","aria-hidden":!0,defaultChecked:o??w.current,required:l,disabled:c,name:u,value:d,form:f,...t,tabIndex:-1,ref:g,style:{...t.style,...x,position:"absolute",pointerEvents:"none",opacity:0,margin:0,transform:"translateX(-100%)"}})});k3.displayName=E3;function KZ(e){return typeof e=="function"}function so(e){return e==="indeterminate"}function C3(e){return so(e)?"indeterminate":e?"checked":"unchecked"}const Za=y.forwardRef(({className:e,indeterminate:t=!1,...r},n)=>{const s=y.useRef(null);return y.useEffect(()=>{if(s.current){const a=s.current.querySelector('input[type="checkbox"]');a&&(a.indeterminate=t)}},[t]),y.useImperativeHandle(n,()=>s.current),i.jsx(Ww,{ref:s,className:De("peer h-4 w-4 shrink-0 rounded-sm border border-primary ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=checked]:text-primary-foreground",e),...r,children:i.jsx(j3,{className:De("flex items-center justify-center text-current"),children:i.jsx(Qa,{className:"h-4 w-4"})})})});Za.displayName=Ww.displayName;var YS=1,XZ=.9,QZ=.8,JZ=.17,vx=.1,yx=.999,ZZ=.9999,eee=.99,tee=/[\\\/_+.#"@\[\(\{&]/,ree=/[\\\/_+.#"@\[\(\{&]/g,nee=/[\s-]/,T3=/[\s-]/g;function ay(e,t,r,n,s,a,o){if(a===t.length)return s===e.length?YS:eee;var l=`${s},${a}`;if(o[l]!==void 0)return o[l];for(var c=n.charAt(a),u=r.indexOf(c,s),d=0,f,p,h,g;u>=0;)f=ay(e,t,r,n,u+1,a+1,o),f>d&&(u===s?f*=YS:tee.test(e.charAt(u-1))?(f*=QZ,h=e.slice(s,u-1).match(ree),h&&s>0&&(f*=Math.pow(yx,h.length))):nee.test(e.charAt(u-1))?(f*=XZ,g=e.slice(s,u-1).match(T3),g&&s>0&&(f*=Math.pow(yx,g.length))):(f*=JZ,s>0&&(f*=Math.pow(yx,u-s))),e.charAt(u)!==t.charAt(a)&&(f*=ZZ)),(f<vx&&r.charAt(u-1)===n.charAt(a+1)||n.charAt(a+1)===n.charAt(a)&&r.charAt(u-1)!==n.charAt(a))&&(p=ay(e,t,r,n,u+1,a+2,o),p*vx>f&&(f=p*vx)),f>d&&(d=f),u=r.indexOf(c,u+1);return o[l]=d,d}function KS(e){return e.toLowerCase().replace(T3," ")}function see(e,t,r){return e=r&&r.length>0?`${e+" "+r.join(" ")}`:e,ay(e,t,KS(e),KS(t),0,0,{})}var $u='[cmdk-group=""]',wx='[cmdk-group-items=""]',aee='[cmdk-group-heading=""]',A3='[cmdk-item=""]',XS=`${A3}:not([aria-disabled="true"])`,iy="cmdk-item-select",Hl="data-value",iee=(e,t,r)=>see(e,t,r),P3=y.createContext(void 0),Xf=()=>y.useContext(P3),D3=y.createContext(void 0),Hw=()=>y.useContext(D3),R3=y.createContext(void 0),M3=y.forwardRef((e,t)=>{let r=Gl(()=>{var D,G;return{search:"",value:(G=(D=e.value)!=null?D:e.defaultValue)!=null?G:"",selectedItemId:void 0,filtered:{count:0,items:new Map,groups:new Set}}}),n=Gl(()=>new Set),s=Gl(()=>new Map),a=Gl(()=>new Map),o=Gl(()=>new Set),l=O3(e),{label:c,children:u,value:d,onValueChange:f,filter:p,shouldFilter:h,loop:g,disablePointerSelection:m=!1,vimBindings:x=!0,...w}=e,v=Er(),_=Er(),b=Er(),S=y.useRef(null),T=xee();ml(()=>{if(d!==void 0){let D=d.trim();r.current.value=D,N.emit()}},[d]),ml(()=>{T(6,M)},[]);let N=y.useMemo(()=>({subscribe:D=>(o.current.add(D),()=>o.current.delete(D)),snapshot:()=>r.current,setState:(D,G,O)=>{var L,ie,ne,me;if(!Object.is(r.current[D],G)){if(r.current[D]=G,D==="search")j(),P(),T(1,R);else if(D==="value"){if(document.activeElement.hasAttribute("cmdk-input")||document.activeElement.hasAttribute("cmdk-root")){let pe=document.getElementById(b);pe?pe.focus():(L=document.getElementById(v))==null||L.focus()}if(T(7,()=>{var pe;r.current.selectedItemId=(pe=A())==null?void 0:pe.id,N.emit()}),O||T(5,M),((ie=l.current)==null?void 0:ie.value)!==void 0){let pe=G??"";(me=(ne=l.current).onValueChange)==null||me.call(ne,pe);return}}N.emit()}},emit:()=>{o.current.forEach(D=>D())}}),[]),C=y.useMemo(()=>({value:(D,G,O)=>{var L;G!==((L=a.current.get(D))==null?void 0:L.value)&&(a.current.set(D,{value:G,keywords:O}),r.current.filtered.items.set(D,E(G,O)),T(2,()=>{P(),N.emit()}))},item:(D,G)=>(n.current.add(D),G&&(s.current.has(G)?s.current.get(G).add(D):s.current.set(G,new Set([D]))),T(3,()=>{j(),P(),r.current.value||R(),N.emit()}),()=>{a.current.delete(D),n.current.delete(D),r.current.filtered.items.delete(D);let O=A();T(4,()=>{j(),(O==null?void 0:O.getAttribute("id"))===D&&R(),N.emit()})}),group:D=>(s.current.has(D)||s.current.set(D,new Set),()=>{a.current.delete(D),s.current.delete(D)}),filter:()=>l.current.shouldFilter,label:c||e["aria-label"],getDisablePointerSelection:()=>l.current.disablePointerSelection,listId:v,inputId:b,labelId:_,listInnerRef:S}),[]);function E(D,G){var O,L;let ie=(L=(O=l.current)==null?void 0:O.filter)!=null?L:iee;return D?ie(D,r.current.search,G):0}function P(){if(!r.current.search||l.current.shouldFilter===!1)return;let D=r.current.filtered.items,G=[];r.current.filtered.groups.forEach(L=>{let ie=s.current.get(L),ne=0;ie.forEach(me=>{let pe=D.get(me);ne=Math.max(pe,ne)}),G.push([L,ne])});let O=S.current;I().sort((L,ie)=>{var ne,me;let pe=L.getAttribute("id"),xe=ie.getAttribute("id");return((ne=D.get(xe))!=null?ne:0)-((me=D.get(pe))!=null?me:0)}).forEach(L=>{let ie=L.closest(wx);ie?ie.appendChild(L.parentElement===ie?L:L.closest(`${wx} > *`)):O.appendChild(L.parentElement===O?L:L.closest(`${wx} > *`))}),G.sort((L,ie)=>ie[1]-L[1]).forEach(L=>{var ie;let ne=(ie=S.current)==null?void 0:ie.querySelector(`${$u}[${Hl}="${encodeURIComponent(L[0])}"]`);ne==null||ne.parentElement.appendChild(ne)})}function R(){let D=I().find(O=>O.getAttribute("aria-disabled")!=="true"),G=D==null?void 0:D.getAttribute(Hl);N.setState("value",G||void 0)}function j(){var D,G,O,L;if(!r.current.search||l.current.shouldFilter===!1){r.current.filtered.count=n.current.size;return}r.current.filtered.groups=new Set;let ie=0;for(let ne of n.current){let me=(G=(D=a.current.get(ne))==null?void 0:D.value)!=null?G:"",pe=(L=(O=a.current.get(ne))==null?void 0:O.keywords)!=null?L:[],xe=E(me,pe);r.current.filtered.items.set(ne,xe),xe>0&&ie++}for(let[ne,me]of s.current)for(let pe of me)if(r.current.filtered.items.get(pe)>0){r.current.filtered.groups.add(ne);break}r.current.filtered.count=ie}function M(){var D,G,O;let L=A();L&&(((D=L.parentElement)==null?void 0:D.firstChild)===L&&((O=(G=L.closest($u))==null?void 0:G.querySelector(aee))==null||O.scrollIntoView({block:"nearest"})),L.scrollIntoView({block:"nearest"}))}function A(){var D;return(D=S.current)==null?void 0:D.querySelector(`${A3}[aria-selected="true"]`)}function I(){var D;return Array.from(((D=S.current)==null?void 0:D.querySelectorAll(XS))||[])}function X(D){let G=I()[D];G&&N.setState("value",G.getAttribute(Hl))}function Y(D){var G;let O=A(),L=I(),ie=L.findIndex(me=>me===O),ne=L[ie+D];(G=l.current)!=null&&G.loop&&(ne=ie+D<0?L[L.length-1]:ie+D===L.length?L[0]:L[ie+D]),ne&&N.setState("value",ne.getAttribute(Hl))}function z(D){let G=A(),O=G==null?void 0:G.closest($u),L;for(;O&&!L;)O=D>0?pee(O,$u):gee(O,$u),L=O==null?void 0:O.querySelector(XS);L?N.setState("value",L.getAttribute(Hl)):Y(D)}let U=()=>X(I().length-1),V=D=>{D.preventDefault(),D.metaKey?U():D.altKey?z(1):Y(1)},F=D=>{D.preventDefault(),D.metaKey?X(0):D.altKey?z(-1):Y(-1)};return y.createElement(ze.div,{ref:t,tabIndex:-1,...w,"cmdk-root":"",onKeyDown:D=>{var G;(G=w.onKeyDown)==null||G.call(w,D);let O=D.nativeEvent.isComposing||D.keyCode===229;if(!(D.defaultPrevented||O))switch(D.key){case"n":case"j":{x&&D.ctrlKey&&V(D);break}case"ArrowDown":{V(D);break}case"p":case"k":{x&&D.ctrlKey&&F(D);break}case"ArrowUp":{F(D);break}case"Home":{D.preventDefault(),X(0);break}case"End":{D.preventDefault(),U();break}case"Enter":{D.preventDefault();let L=A();if(L){let ie=new Event(iy);L.dispatchEvent(ie)}}}}},y.createElement("label",{"cmdk-label":"",htmlFor:C.inputId,id:C.labelId,style:yee},c),Wp(e,D=>y.createElement(D3.Provider,{value:N},y.createElement(P3.Provider,{value:C},D))))}),oee=y.forwardRef((e,t)=>{var r,n;let s=Er(),a=y.useRef(null),o=y.useContext(R3),l=Xf(),c=O3(e),u=(n=(r=c.current)==null?void 0:r.forceMount)!=null?n:o==null?void 0:o.forceMount;ml(()=>{if(!u)return l.item(s,o==null?void 0:o.id)},[u]);let d=F3(s,a,[e.value,e.children,a],e.keywords),f=Hw(),p=po(T=>T.value&&T.value===d.current),h=po(T=>u||l.filter()===!1?!0:T.search?T.filtered.items.get(s)>0:!0);y.useEffect(()=>{let T=a.current;if(!(!T||e.disabled))return T.addEventListener(iy,g),()=>T.removeEventListener(iy,g)},[h,e.onSelect,e.disabled]);function g(){var T,N;m(),(N=(T=c.current).onSelect)==null||N.call(T,d.current)}function m(){f.setState("value",d.current,!0)}if(!h)return null;let{disabled:x,value:w,onSelect:v,forceMount:_,keywords:b,...S}=e;return y.createElement(ze.div,{ref:di(a,t),...S,id:s,"cmdk-item":"",role:"option","aria-disabled":!!x,"aria-selected":!!p,"data-disabled":!!x,"data-selected":!!p,onPointerMove:x||l.getDisablePointerSelection()?void 0:m,onClick:x?void 0:g},e.children)}),lee=y.forwardRef((e,t)=>{let{heading:r,children:n,forceMount:s,...a}=e,o=Er(),l=y.useRef(null),c=y.useRef(null),u=Er(),d=Xf(),f=po(h=>s||d.filter()===!1?!0:h.search?h.filtered.groups.has(o):!0);ml(()=>d.group(o),[]),F3(o,l,[e.value,e.heading,c]);let p=y.useMemo(()=>({id:o,forceMount:s}),[s]);return y.createElement(ze.div,{ref:di(l,t),...a,"cmdk-group":"",role:"presentation",hidden:f?void 0:!0},r&&y.createElement("div",{ref:c,"cmdk-group-heading":"","aria-hidden":!0,id:u},r),Wp(e,h=>y.createElement("div",{"cmdk-group-items":"",role:"group","aria-labelledby":r?u:void 0},y.createElement(R3.Provider,{value:p},h))))}),cee=y.forwardRef((e,t)=>{let{alwaysRender:r,...n}=e,s=y.useRef(null),a=po(o=>!o.search);return!r&&!a?null:y.createElement(ze.div,{ref:di(s,t),...n,"cmdk-separator":"",role:"separator"})}),uee=y.forwardRef((e,t)=>{let{onValueChange:r,...n}=e,s=e.value!=null,a=Hw(),o=po(u=>u.search),l=po(u=>u.selectedItemId),c=Xf();return y.useEffect(()=>{e.value!=null&&a.setState("search",e.value)},[e.value]),y.createElement(ze.input,{ref:t,...n,"cmdk-input":"",autoComplete:"off",autoCorrect:"off",spellCheck:!1,"aria-autocomplete":"list",role:"combobox","aria-expanded":!0,"aria-controls":c.listId,"aria-labelledby":c.labelId,"aria-activedescendant":l,id:c.inputId,type:"text",value:s?e.value:o,onChange:u=>{s||a.setState("search",u.target.value),r==null||r(u.target.value)}})}),dee=y.forwardRef((e,t)=>{let{children:r,label:n="Suggestions",...s}=e,a=y.useRef(null),o=y.useRef(null),l=po(u=>u.selectedItemId),c=Xf();return y.useEffect(()=>{if(o.current&&a.current){let u=o.current,d=a.current,f,p=new ResizeObserver(()=>{f=requestAnimationFrame(()=>{let h=u.offsetHeight;d.style.setProperty("--cmdk-list-height",h.toFixed(1)+"px")})});return p.observe(u),()=>{cancelAnimationFrame(f),p.unobserve(u)}}},[]),y.createElement(ze.div,{ref:di(a,t),...s,"cmdk-list":"",role:"listbox",tabIndex:-1,"aria-activedescendant":l,"aria-label":n,id:c.listId},Wp(e,u=>y.createElement("div",{ref:di(o,c.listInnerRef),"cmdk-list-sizer":""},u)))}),fee=y.forwardRef((e,t)=>{let{open:r,onOpenChange:n,overlayClassName:s,contentClassName:a,container:o,...l}=e;return y.createElement(B1,{open:r,onOpenChange:n},y.createElement(U1,{container:o},y.createElement(gp,{"cmdk-overlay":"",className:s}),y.createElement(xp,{"aria-label":e.label,"cmdk-dialog":"",className:a},y.createElement(M3,{ref:t,...l}))))}),hee=y.forwardRef((e,t)=>po(r=>r.filtered.count===0)?y.createElement(ze.div,{ref:t,...e,"cmdk-empty":"",role:"presentation"}):null),mee=y.forwardRef((e,t)=>{let{progress:r,children:n,label:s="Loading...",...a}=e;return y.createElement(ze.div,{ref:t,...a,"cmdk-loading":"",role:"progressbar","aria-valuenow":r,"aria-valuemin":0,"aria-valuemax":100,"aria-label":s},Wp(e,o=>y.createElement("div",{"aria-hidden":!0},o)))}),Kn=Object.assign(M3,{List:dee,Item:oee,Input:uee,Group:lee,Separator:cee,Dialog:fee,Empty:hee,Loading:mee});function pee(e,t){let r=e.nextElementSibling;for(;r;){if(r.matches(t))return r;r=r.nextElementSibling}}function gee(e,t){let r=e.previousElementSibling;for(;r;){if(r.matches(t))return r;r=r.previousElementSibling}}function O3(e){let t=y.useRef(e);return ml(()=>{t.current=e}),t}var ml=typeof window>"u"?y.useEffect:y.useLayoutEffect;function Gl(e){let t=y.useRef();return t.current===void 0&&(t.current=e()),t}function po(e){let t=Hw(),r=()=>e(t.snapshot());return y.useSyncExternalStore(t.subscribe,r,r)}function F3(e,t,r,n=[]){let s=y.useRef(),a=Xf();return ml(()=>{var o;let l=(()=>{var u;for(let d of r){if(typeof d=="string")return d.trim();if(typeof d=="object"&&"current"in d)return d.current?(u=d.current.textContent)==null?void 0:u.trim():s.current}})(),c=n.map(u=>u.trim());a.value(e,l,c),(o=t.current)==null||o.setAttribute(Hl,l),s.current=l}),s}var xee=()=>{let[e,t]=y.useState(),r=Gl(()=>new Map);return ml(()=>{r.current.forEach(n=>n()),r.current=new Map},[e]),(n,s)=>{r.current.set(n,s),t({})}};function vee(e){let t=e.type;return typeof t=="function"?t(e.props):"render"in t?t.render(e.props):e}function Wp({asChild:e,children:t},r){return e&&y.isValidElement(t)?y.cloneElement(vee(t),{ref:t.ref},r(t.props.children)):r(t)}var yee={position:"absolute",width:"1px",height:"1px",padding:"0",margin:"-1px",overflow:"hidden",clip:"rect(0, 0, 0, 0)",whiteSpace:"nowrap",borderWidth:"0"};const I3=y.forwardRef(({className:e,...t},r)=>i.jsx(Kn,{ref:r,className:De("flex h-full w-full flex-col overflow-hidden rounded-md bg-popover text-popover-foreground",e),...t}));I3.displayName=Kn.displayName;const L3=y.forwardRef(({className:e,...t},r)=>i.jsxs("div",{className:"flex items-center border-b px-3","cmdk-input-wrapper":"",children:[i.jsx(q0,{className:"mr-2 h-4 w-4 shrink-0 opacity-50"}),i.jsx(Kn.Input,{ref:r,className:De("flex h-11 w-full rounded-md bg-transparent py-3 text-sm outline-none placeholder:text-muted-foreground disabled:cursor-not-allowed disabled:opacity-50",e),...t})]}));L3.displayName=Kn.Input.displayName;const $3=y.forwardRef(({className:e,...t},r)=>i.jsx(Kn.List,{ref:r,className:De("max-h-[300px] overflow-y-auto overflow-x-hidden",e),...t}));$3.displayName=Kn.List.displayName;const B3=y.forwardRef((e,t)=>i.jsx(Kn.Empty,{ref:t,className:"py-6 text-center text-sm",...e}));B3.displayName=Kn.Empty.displayName;const U3=y.forwardRef(({className:e,...t},r)=>i.jsx(Kn.Group,{ref:r,className:De("overflow-hidden p-1 text-foreground [&_[cmdk-group-heading]]:px-2 [&_[cmdk-group-heading]]:py-1.5 [&_[cmdk-group-heading]]:text-xs [&_[cmdk-group-heading]]:font-medium [&_[cmdk-group-heading]]:text-muted-foreground",e),...t}));U3.displayName=Kn.Group.displayName;const wee=y.forwardRef(({className:e,...t},r)=>i.jsx(Kn.Separator,{ref:r,className:De("-mx-1 h-px bg-border",e),...t}));wee.displayName=Kn.Separator.displayName;const z3=y.forwardRef(({className:e,...t},r)=>i.jsx(Kn.Item,{ref:r,className:De("relative flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none data-[disabled=true]:pointer-events-none data-[selected='true']:bg-accent data-[selected=true]:text-accent-foreground data-[disabled=true]:opacity-50",e),...t}));z3.displayName=Kn.Item.displayName;const _ee=({selectedAttendees:e,onAttendeesChange:t,placeholder:r="Select attendees..."})=>{const[n,s]=y.useState(!1),[a,o]=y.useState([]),[l,c]=y.useState(!1),[u,d]=y.useState(""),{toast:f}=St();y.useEffect(()=>{p()},[]);const p=async()=>{c(!0);try{const{data:_,error:b}=await he.from("profiles").select("id, email, first_name, last_name").order("first_name");if(b)throw b;o((_||[]).filter(S=>typeof S.email=="string"&&S.email).map(S=>({...S,email:String(S.email)})))}catch(_){console.error("Error fetching users:",_),f({title:"Error",description:"Failed to load users",variant:"destructive"})}finally{c(!1)}},h=_=>{const b=e.includes(_);t(b?e.filter(S=>S!==_):[...e,_])},g=()=>{const _=a.map(b=>b.email).filter(b=>b);t(_)},m=()=>{t([])},x=()=>{u&&u.includes("@")?(e.includes(u)||t([...e,u]),d("")):f({title:"Invalid Email",description:"Please enter a valid email address",variant:"destructive"})},w=_=>{t(e.filter(b=>b!==_))},v=_=>{const b=a.find(S=>S.email===_);return b&&b.first_name&&b.last_name?`${b.first_name} ${b.last_name}`:_};return i.jsxs("div",{className:"space-y-3",children:[i.jsx(Ve,{children:"Meeting Attendees"}),e.length>0&&i.jsx("div",{className:"flex flex-wrap gap-2 p-2 border rounded-md bg-gray-50",children:e.map(_=>i.jsxs(We,{variant:"secondary",className:"flex items-center gap-1",children:[i.jsx("span",{className:"text-xs",children:v(_)}),i.jsx(ue,{variant:"ghost",size:"sm",className:"h-4 w-4 p-0 hover:bg-transparent",onClick:()=>w(_),children:i.jsx(Cn,{className:"h-3 w-3"})})]},_))}),i.jsxs(nf,{open:n,onOpenChange:s,children:[i.jsx(sf,{asChild:!0,children:i.jsxs(ue,{variant:"outline",role:"combobox","aria-expanded":n,className:"w-full justify-between",children:[i.jsxs("div",{className:"flex items-center space-x-2",children:[i.jsx(mr,{className:"h-4 w-4"}),i.jsx("span",{children:e.length>0?`${e.length} selected`:r})]}),i.jsx(Zc,{className:"ml-2 h-4 w-4 shrink-0 opacity-50"})]})}),i.jsx(Gc,{className:"w-[350px] p-0 bg-white border rounded-xl shadow-xl mt-2",children:i.jsxs(I3,{children:[i.jsx(L3,{placeholder:"Search users...",className:"px-4 py-2 border-b rounded-t-xl"}),i.jsxs($3,{className:"max-h-[320px] overflow-y-auto",children:[i.jsx(B3,{children:"No users found."}),i.jsxs(U3,{children:[i.jsxs("div",{className:"flex items-center space-x-2 p-3 border-b bg-gray-50 rounded-t-xl",children:[i.jsxs(ue,{variant:"secondary",size:"sm",onClick:g,className:"flex items-center space-x-1",children:[i.jsx(uk,{className:"h-4 w-4"}),i.jsx("span",{children:"Select All"})]}),i.jsxs(ue,{variant:"secondary",size:"sm",onClick:m,className:"flex items-center space-x-1",children:[i.jsx(RF,{className:"h-4 w-4"}),i.jsx("span",{children:"Deselect All"})]})]}),l?i.jsx("div",{className:"p-4 text-center text-sm text-gray-500",children:"Loading users..."}):a.map(_=>_.email&&i.jsxs(z3,{onSelect:()=>h(_.email),className:"flex items-center space-x-3 cursor-pointer px-4 py-2 hover:bg-gray-100 transition rounded-none group",children:[i.jsx("div",{className:"flex items-center justify-center h-8 w-8 bg-gray-200 rounded-full text-gray-500 font-bold text-xs",children:_.first_name?_.first_name[0]:_.email[0]}),i.jsxs("div",{className:"flex-1",children:[i.jsx("div",{className:"font-medium",children:_.first_name&&_.last_name?`${_.first_name} ${_.last_name}`:_.email}),i.jsx("div",{className:"text-xs text-gray-600 group-hover:text-white transition-colors duration-150",children:_.email})]}),i.jsx("div",{className:"flex items-center",children:i.jsx(Za,{checked:e.includes(_.email),onChange:()=>h(_.email),className:"bg-white border-gray-400 group-hover:border-gray-600"})})]},_.id))]})]})]})})]}),i.jsxs("div",{className:"flex space-x-2",children:[i.jsx(dt,{placeholder:"Add email manually...",value:u,onChange:_=>d(_.target.value),onKeyPress:_=>{_.key==="Enter"&&(_.preventDefault(),x())}}),i.jsx(ue,{variant:"outline",onClick:x,disabled:!u,children:"Add"})]}),i.jsx("p",{className:"text-xs text-gray-500",children:"Selected attendees will receive calendar invitations and meeting notifications."})]})};function bee(e){switch(e){case"30min":return 30;case"1hour":return 60;case"1.5hours":return 90;case"2hours":return 120;case"3hours":return 180;default:const t=parseFloat(e);return isNaN(t)?60:t}}const QS=({open:e,onOpenChange:t,preselectedDate:r,meetingToEdit:n})=>{const{register:s,handleSubmit:a,setValue:o,watch:l,reset:c}=bQ(),[u,d]=y.useState(),[f,p]=y.useState(!1),[h,g]=y.useState([]),[m,x]=y.useState([]),[w,v]=y.useState(!0),[_,b]=y.useState(!1),[S,T]=y.useState(!1),[N,C]=y.useState([""]),[E,P]=y.useState(""),{createMeeting:R,updateMeeting:j}=_l(),{isConnected:M}=cu(),{user:A}=kt(),{toast:I}=St(),X=l("type"),Y=l("time");y.useEffect(()=>{e&&r&&d(r)},[e,r]),y.useEffect(()=>{const ge=async je=>{if(!je.length)return[];const{data:k,error:le}=await he.from("profiles").select("id, email").in("id",je);return le?je:je.map(ce=>{var H;return((H=k.find(K=>K.id===ce))==null?void 0:H.email)||ce})};if(e&&n){if(o("title",n.title||""),o("description",n.description||""),o("time",n.start_time?n.start_time.slice(11,16):""),n.duration)o("duration",n.duration);else if(n.start_time&&n.end_time){const je=new Date(n.start_time),k=new Date(n.end_time),le=Math.round((k.getTime()-je.getTime())/6e4);o("duration",le.toString())}o("type",n.meeting_type||""),o("location",n.location||""),d(n.start_time?new Date(n.start_time):void 0),x([]),v(!0),n.attendees&&n.attendees.length>0?ge(n.attendees.map(je=>je.user_id)).then(je=>{const k=[...je,...(n.manual_attendees||[]).map(le=>typeof le=="string"?le:le.email)];g(k)}):g((n.manual_attendees||[]).map(je=>typeof je=="string"?je:je.email))}else e&&!n&&(c(),d(r),g([]),x([]),v(!0))},[e,n,r,c,o]);const z=(ge,je)=>{if(!ge||!je)return!1;const k=new Date,le=new Date(je);le.setHours(0,0,0,0);const ce=new Date;if(ce.setHours(0,0,0,0),le.getTime()!==ce.getTime())return!1;const[H,K]=ge.split(":").map(Number),oe=new Date;oe.setHours(H,K,0,0);const W=new Date(k.getTime()+5*60*1e3);return oe<=W},U=5,V=10*1024*1024,F=["application/pdf","application/vnd.openxmlformats-officedocument.wordprocessingml.document","application/vnd.openxmlformats-officedocument.presentationml.presentation","application/vnd.openxmlformats-officedocument.spreadsheetml.sheet","text/plain","image/jpeg","image/png"],D=ge=>{if(console.log("Date selected:",ge),d(ge),p(!1),ge&&Y){const je=new Date;je.setHours(0,0,0,0);const k=new Date(ge);k.setHours(0,0,0,0),k.getTime()===je.getTime()&&z(Y,ge)&&(o("time",""),I({title:"Time Reset",description:"Selected time was in the past, please choose a future time",variant:"destructive"}))}},G=ge=>{const je=Array.from(ge.target.files||[]);if(m.length+je.length>U){I({title:"Too Many Files",description:`Maximum ${U} files allowed`,variant:"destructive"});return}const k=[],le=[];je.forEach(ce=>{if(ce.size>V){le.push(`${ce.name}: File too large (max 10MB)`);return}if(!F.includes(ce.type)){le.push(`${ce.name}: File type not supported`);return}k.push({file:ce,name:ce.name,size:ce.size})}),le.length>0&&I({title:"File Upload Errors",description:le.join(", "),variant:"destructive"}),k.length>0&&x(ce=>[...ce,...k]),ge.target.value=""},O=ge=>{x(je=>je.filter((k,le)=>le!==ge))},L=ge=>{if(ge===0)return"0 Bytes";const je=1024,k=["Bytes","KB","MB","GB"],le=Math.floor(Math.log(ge)/Math.log(je));return parseFloat((ge/Math.pow(je,le)).toFixed(2))+" "+k[le]},ie=async ge=>{if(!(m.length===0||!A)){b(!0);try{for(const je of m){const k=je.file.name.split(".").pop(),le=`${ge}/${Date.now()}_${je.file.name}`,{data:ce,error:H}=await he.storage.from("meeting-attachments").upload(le,je.file);if(H)throw H;const{error:K}=await he.from("meeting_attachments").insert({meeting_id:ge,name:je.file.name,file_path:ce.path,file_size:je.file.size,mime_type:je.file.type,uploaded_by:A.id});if(K)throw K}m.length>0&&I({title:"Files Uploaded",description:`${m.length} file(s) uploaded successfully`})}catch(je){console.error("Error uploading files:",je),I({title:"File Upload Failed",description:je.message||"Failed to upload some files",variant:"destructive"})}finally{b(!1)}}},ne=async ge=>{if(!S)try{if(T(!0),console.log("Form submission started"),console.log("Selected date:",u),console.log("Form data:",ge),!u){I({title:"Date Required",description:"Please select a meeting date",variant:"destructive"});return}if(!ge.time){I({title:"Time Required",description:"Please select a meeting time",variant:"destructive"});return}if(!A){I({title:"Authentication Required",description:"Please sign in to create meetings",variant:"destructive"});return}const je=new Date(u),[k,le]=ge.time.split(":").map(Number);je.setHours(k,le,0,0);const ce=je.toISOString(),H=h.join(", "),K={meeting_id:E,title:ge.title,description:ge.description,date:je,time:ge.time,duration:ge.duration,type:ge.type,location:ge.type==="online"?"Microsoft Teams Meeting":ge.type==="hybrid"?ge.location?`${ge.location} + Microsoft Teams`:"Microsoft Teams + Physical Location":ge.location,attendees:h.join(", "),attachments:m,rsvpEnabled:w,agendas:N};if(console.log("Meeting data being sent:",K),n){const W=[],J=[];for(const ae of h){const{data:de}=await he.from("profiles").select("id").eq("email",ae).single();de!=null&&de.id?W.push(ae):J.push(ae)}if(await j(n.id,{title:ge.title,description:ge.description,start_time:je.toISOString(),end_time:new Date(je.getTime()+bee(ge.duration)*6e4).toISOString(),meeting_type:ge.type,location:ge.location,manual_attendees:J,agendas:N})){await he.from("meeting_attendees").delete().eq("meeting_id",n.id);for(const ae of W){const{data:de}=await he.from("profiles").select("id").eq("email",ae).single(),Q=de==null?void 0:de.id;Q&&await he.from("meeting_attendees").insert({meeting_id:n.id,user_id:Q})}if(J.length>0)try{await he.functions.invoke("send-outlook-email",{body:{subject:`Meeting Invitation: ${ge.title}`,body:`
                    <div style="font-family: Arial, sans-serif; max-width: 600px; margin: 0 auto; padding: 20px;">
                      <h2>Meeting Invitation</h2>
                      <p><strong>Meeting:</strong> ${ge.title}</p>
                      <p><strong>Date:</strong> ${je.toLocaleDateString()}</p>
                      <p><strong>Time:</strong> ${ge.time}</p>
                      <p><strong>Location:</strong> ${ge.location}</p>
                      <p><strong>Description:</strong> ${ge.description}</p>
                      <br>
                      <p>You have been invited to attend this meeting. Please respond to this email to confirm your attendance.</p>
                    </div>
                  `,recipients:J}}),I({title:"Invitations Sent",description:`Invitations sent to ${J.length} external attendees`})}catch(ae){console.error("Error sending invitations to manual emails:",ae),I({title:"Invitation Error",description:"Failed to send invitations to external attendees",variant:"destructive"})}I({title:"Meeting Updated",description:"Meeting details updated successfully."}),c(),d(void 0),g([]),x([]),v(!0),t(!1,!0)}return}const oe=await R(K);oe&&(m.length>0&&await ie(oe.id),c(),d(void 0),g([]),x([]),v(!0),t(!1,!0))}catch(je){console.error("Error submitting meeting:",je),I({title:"Meeting Creation Error",description:je.message||"Failed to create meeting",variant:"destructive"})}finally{T(!1)}},me=()=>{c(),d(void 0),g([]),x([]),v(!0),t(!1,!1)},pe=(ge,je)=>{C(k=>k.map((le,ce)=>ce===ge?je:le))},xe=()=>C(ge=>[...ge,""]),Ae=ge=>C(je=>je.length>1?je.filter((k,le)=>le!==ge):je);return i.jsx(Nt,{open:e,onOpenChange:me,children:i.jsxs(bt,{className:"sm:max-w-[700px] max-h-[90vh] overflow-y-auto bg-white rounded-xl shadow-xl p-0",children:[i.jsxs("button",{type:"button","aria-label":"Close",onClick:me,className:"absolute top-2 right-2 p-2 rounded hover:bg-gray-100 focus:outline-none z-20",children:[i.jsx("span",{className:"sr-only",children:"Close"}),i.jsx("svg",{className:"h-5 w-5",fill:"none",stroke:"currentColor",strokeWidth:"2",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M6 18L18 6M6 6l12 12"})})]}),i.jsxs("div",{className:"p-6",children:[i.jsxs(jt,{children:[i.jsx(Et,{children:n?"Edit Meeting":"Schedule New Meeting"}),i.jsxs($t,{children:[n?"Edit meeting details and attendees.":"Create a new meeting with file attachments.",r&&!n&&i.jsxs("span",{className:"block mt-2 text-primary text-sm font-medium",children:["Creating meeting for ",vt(r,"MMMM dd, yyyy")]}),!M&&X==="online"&&i.jsx("span",{className:"block mt-2 text-orange-600 text-sm",children:"Connect your Microsoft account in Settings to create Teams meetings automatically."})]})]}),i.jsxs("form",{onSubmit:a(ne),className:"space-y-10 mt-4",children:[i.jsxs("div",{className:"mb-6 pb-6 border-b",children:[i.jsx("h3",{className:"text-lg font-bold mb-4",children:"Meeting Details"}),i.jsxs("div",{className:"mb-4",children:[i.jsx(Ve,{className:"font-semibold",htmlFor:"meeting-id",children:"Meeting ID"}),i.jsx(dt,{id:"meeting-id",className:"mt-1 font-mono text-base w-fit",value:E,onChange:ge=>P(ge.target.value),maxLength:32,required:!0}),i.jsx("div",{className:"text-xs text-gray-500 mt-1",children:"This ID will be assigned to the meeting and must be unique."})]}),i.jsxs("div",{className:"grid grid-cols-1 gap-4",children:[i.jsxs("div",{children:[i.jsx(Ve,{htmlFor:"title",children:"Title *"}),i.jsx(dt,{id:"title",...s("title",{required:!0}),placeholder:"e.g., Monthly Bureau Meeting"})]}),i.jsxs("div",{children:[i.jsx(Ve,{htmlFor:"description",children:"Description"}),i.jsx(Ma,{id:"description",...s("description"),placeholder:"Meeting agenda and details...",rows:3})]}),i.jsxs("div",{children:[i.jsx(Ve,{children:"Agenda(s)"}),i.jsxs("div",{className:"space-y-2",children:[N.map((ge,je)=>i.jsxs("div",{className:"flex gap-2 items-center",children:[i.jsx(dt,{value:ge,onChange:k=>pe(je,k.target.value),placeholder:`Agenda item #${je+1}`,className:"flex-1"}),N.length>1&&i.jsx(ue,{type:"button",variant:"ghost",size:"icon",onClick:()=>Ae(je),"aria-label":"Remove agenda",children:i.jsx(Cn,{className:"h-4 w-4"})})]},je)),i.jsx(ue,{type:"button",variant:"outline",size:"sm",onClick:xe,className:"mt-1",children:"+ Add Agenda"})]})]})]})]}),i.jsxs("div",{className:"mb-6 pb-6 border-b",children:[i.jsx("h3",{className:"text-lg font-bold mb-4",children:"Date & Time"}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[i.jsxs("div",{children:[i.jsx(Ve,{children:"Date *"}),i.jsxs(nf,{open:f,onOpenChange:p,children:[i.jsx(sf,{asChild:!0,children:i.jsxs(ue,{variant:"outline",className:De("w-full justify-start text-left font-normal",!u&&"text-muted-foreground"),type:"button",children:[i.jsx(en,{className:"mr-2 h-4 w-4"}),u?vt(u,"PPP"):"Pick a date"]})}),i.jsx(Gc,{className:"w-auto p-0",align:"start",children:i.jsx(rf,{mode:"single",selected:u,onSelect:D,disabled:ge=>ge<new Date(new Date().setHours(0,0,0,0)),initialFocus:!0,className:De("p-3 pointer-events-auto")})})]})]}),i.jsxs("div",{children:[i.jsx(Ve,{htmlFor:"time",children:"Time *"}),i.jsxs("select",{id:"time",className:"w-full border rounded px-3 py-2 text-left bg-white focus:outline-none focus:ring-2 focus:ring-primary",value:Y||"",onChange:ge=>o("time",ge.target.value),children:[i.jsx("option",{value:"",disabled:!0,children:"Select time"}),Array.from({length:24*4},(ge,je)=>{const k=Math.floor(je/4),le=je%4*15,ce=`${k.toString().padStart(2,"0")}:${le.toString().padStart(2,"0")}`;return i.jsx("option",{value:ce,children:ce},ce)})]}),Y&&z(Y,u)&&i.jsx("p",{className:"text-sm text-red-500 mt-1",children:"Selected time is in the past. Please choose a time at least 5 minutes from now."})]}),i.jsxs("div",{children:[i.jsx(Ve,{htmlFor:"duration",children:"Duration *"}),i.jsxs(oa,{onValueChange:ge=>o("duration",ge),children:[i.jsx(As,{children:i.jsx(la,{placeholder:"Select duration"})}),i.jsxs(Ps,{children:[i.jsx(zt,{value:"30min",children:"30 minutes"}),i.jsx(zt,{value:"1hour",children:"1 hour"}),i.jsx(zt,{value:"1.5hours",children:"1.5 hours"}),i.jsx(zt,{value:"2hours",children:"2 hours"}),i.jsx(zt,{value:"3hours",children:"3 hours"})]})]})]}),i.jsxs("div",{children:[i.jsx(Ve,{htmlFor:"type",children:"Meeting Type *"}),i.jsxs(oa,{onValueChange:ge=>o("type",ge),children:[i.jsx(As,{children:i.jsx(la,{placeholder:"Select type"})}),i.jsxs(Ps,{children:[i.jsx(zt,{value:"online",children:i.jsxs("div",{className:"flex items-center space-x-2",children:[i.jsx(ra,{className:"h-4 w-4"}),i.jsx("span",{children:"Teams Meeting"})]})}),i.jsx(zt,{value:"physical",children:i.jsxs("div",{className:"flex items-center space-x-2",children:[i.jsx(ri,{className:"h-4 w-4"}),i.jsx("span",{children:"Physical Meeting"})]})}),i.jsx(zt,{value:"hybrid",children:i.jsxs("div",{className:"flex items-center space-x-2",children:[i.jsx(mr,{className:"h-4 w-4"}),i.jsx("span",{children:"Hybrid Meeting"})]})})]})]})]}),X&&X!=="online"&&i.jsxs("div",{className:"md:col-span-2",children:[i.jsx(Ve,{htmlFor:"location",children:X==="hybrid"?"Physical Location *":"Meeting Location *"}),i.jsx(dt,{id:"location",...s("location",{required:X!=="online"}),placeholder:X==="hybrid"?"Conference room address":"Conference room or venue"})]}),(X==="online"||X==="hybrid")&&i.jsxs("div",{className:"md:col-span-2 p-4 bg-blue-50 rounded-lg border border-blue-200",children:[i.jsxs("div",{className:"flex items-center space-x-2 mb-2",children:[i.jsx(ra,{className:"h-4 w-4 text-blue-600"}),i.jsx("span",{className:"font-medium text-blue-800",children:"Teams Meeting"})]}),i.jsx("p",{className:"text-sm text-blue-700",children:M?"A Microsoft Teams meeting will be created automatically with a shareable join link and calendar event.":"Connect your Microsoft account in Settings to automatically create Teams meetings with calendar integration."}),n&&(n.teams_join_url||n.teams_joinUrl)&&i.jsx("div",{className:"mt-2",children:i.jsx("a",{href:n.teams_join_url||n.teams_joinUrl,target:"_blank",rel:"noopener noreferrer",className:"text-blue-700 underline font-medium",children:"Join Teams Meeting"})})]})]})]}),i.jsxs("div",{className:"mb-6 pb-6 border-b",children:[i.jsx("h3",{className:"text-lg font-bold mb-4",children:"Attendees"}),i.jsx(_ee,{selectedAttendees:h,onAttendeesChange:g,placeholder:"Select meeting attendees..."}),i.jsx("p",{className:"text-xs text-gray-400 mt-2",children:"Selected attendees will receive calendar invitations and meeting notifications."})]}),i.jsxs("div",{className:"mb-6 pb-6 border-b",children:[i.jsx("h3",{className:"text-lg font-bold mb-4",children:"Attachments"}),i.jsxs("div",{className:"space-y-3",children:[i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsx(Ve,{children:"File Attachments"}),i.jsxs("span",{className:"text-xs text-gray-500",children:["Max ",U," files, 10MB each"]})]}),i.jsxs("div",{className:"border-2 border-dashed border-gray-300 rounded-lg p-4",children:[i.jsx("input",{type:"file",multiple:!0,accept:".pdf,.docx,.pptx,.xlsx,.txt,.jpg,.jpeg,.png",onChange:G,className:"hidden",id:"file-upload",disabled:S||_}),i.jsx("label",{htmlFor:"file-upload",className:"cursor-pointer",children:i.jsxs("div",{className:"text-center",children:[i.jsx(Ic,{className:"h-8 w-8 mx-auto text-gray-400 mb-2"}),i.jsx("p",{className:"text-sm text-gray-600",children:"Click to attach files or drag and drop"}),i.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Supported: PDF, DOCX, PPTX, XLSX, TXT, JPG, PNG"})]})})]}),m.length>0&&i.jsxs("div",{className:"space-y-2",children:[i.jsx("p",{className:"text-sm font-medium",children:"Attached Files:"}),m.map((ge,je)=>i.jsxs("div",{className:"flex items-center justify-between p-2 bg-gray-50 rounded",children:[i.jsxs("div",{className:"flex items-center space-x-2",children:[i.jsx(Ic,{className:"h-4 w-4 text-gray-500"}),i.jsx("span",{className:"text-sm",children:ge.name}),i.jsxs("span",{className:"text-xs text-gray-500",children:["(",L(ge.size),")"]})]}),i.jsx(ue,{variant:"ghost",size:"sm",onClick:()=>O(je),className:"h-6 w-6 p-0",type:"button",disabled:S||_,children:i.jsx(Cn,{className:"h-4 w-4"})})]},je))]})]})]}),i.jsxs("div",{className:"mb-6 pb-6 border-b",children:[i.jsx("h3",{className:"text-lg font-bold mb-4",children:"RSVP"}),i.jsxs("div",{className:"flex items-center space-x-2",children:[i.jsx("input",{type:"checkbox",id:"rsvp",checked:w,onChange:ge=>v(ge.target.checked),className:"rounded"}),i.jsx(Ve,{htmlFor:"rsvp",children:"Enable RSVP (attendees can respond Yes/No/Maybe)"})]})]}),i.jsxs("div",{className:"flex justify-end gap-2 border-t pt-4 mt-8 bg-white",children:[i.jsx(ue,{type:"button",variant:"outline",onClick:me,disabled:S||_,children:"Cancel"}),i.jsx(ue,{type:"submit",disabled:S||_,className:"w-full",children:S?"Creating...":n?"Save Changes":"Create Teams Meeting"})]})]})]})]})})},See=({open:e,onOpenChange:t,meeting:r})=>{const[n,s]=y.useState(""),[a,o]=y.useState([{id:1,name:"Radha Krishna Das",email:"rk.das@iskcon.org",status:"accepted"},{id:2,name:"Gopala Swami",email:"gopala@iskcon.org",status:"pending"},{id:3,name:"Sita Devi Dasi",email:"sita.dd@iskcon.org",status:"accepted"},{id:4,name:"Arjuna Das",email:"arjuna@iskcon.org",status:"declined"}]),l=()=>{if(n){const d={id:Date.now(),name:n.split("@")[0],email:n,status:"pending"};o([...a,d]),s("")}},c=d=>{o(a.filter(f=>f.id!==d))},u=d=>{switch(d){case"accepted":return"bg-green-100 text-green-800";case"pending":return"bg-yellow-100 text-yellow-800";case"declined":return"bg-red-100 text-red-800";default:return"bg-gray-100 text-gray-800"}};return r?i.jsx(Nt,{open:e,onOpenChange:t,children:i.jsxs(bt,{className:"sm:max-w-[600px]",children:[i.jsxs(jt,{children:[i.jsx(Et,{children:"Manage Attendees"}),i.jsxs($t,{children:["Add or remove attendees for ",r.title]})]}),i.jsxs("div",{className:"space-y-4",children:[i.jsxs("div",{className:"flex space-x-2",children:[i.jsx(dt,{placeholder:"Enter email address",value:n,onChange:d=>s(d.target.value),onKeyPress:d=>d.key==="Enter"&&l()}),i.jsxs(ue,{onClick:l,children:[i.jsx(Pa,{className:"h-4 w-4 mr-2"}),"Add"]})]}),i.jsx("div",{className:"space-y-3 max-h-64 overflow-y-auto",children:a.map(d=>i.jsxs("div",{className:"flex items-center justify-between p-3 border rounded-lg",children:[i.jsxs("div",{className:"flex items-center space-x-3",children:[i.jsxs(qd,{className:"h-8 w-8",children:[i.jsx(Km,{src:""}),i.jsx(Xm,{children:d.name.split(" ").map(f=>f[0]).join("")})]}),i.jsxs("div",{children:[i.jsx("div",{className:"font-medium text-gray-900",children:d.name}),i.jsx("div",{className:"text-sm text-gray-500",children:d.email})]})]}),i.jsxs("div",{className:"flex items-center space-x-2",children:[i.jsx(We,{className:u(d.status),children:d.status}),i.jsx(ue,{variant:"ghost",size:"sm",onClick:()=>c(d.id),children:i.jsx(Cn,{className:"h-4 w-4"})})]})]},d.id))})]}),i.jsxs(G1,{children:[i.jsx(ue,{variant:"outline",onClick:()=>t(!1),children:"Cancel"}),i.jsxs(ue,{className:"bg-primary hover:bg-primary/90",children:[i.jsx(ta,{className:"h-4 w-4 mr-2"}),"Send Invitations"]})]})]})}):null},Qf=()=>{const[e,t]=y.useState([]),[r,n]=y.useState(!1),{user:s}=kt(),{toast:a}=St(),o=async f=>{if(!f)return[];try{console.log("Fetching attendance for meeting:",f);const{data:p,error:h}=await he.from("attendance_records").select(`
          *,
          profiles!attendance_records_user_id_fkey(first_name, last_name, email)
        `).eq("meeting_id",f);return h?(console.error("Attendance fetch error:",h),[]):(console.log("Fetched attendance records:",p),p||[])}catch(p){return console.error("Error fetching attendance:",p),[]}},l=async f=>{var p,h;if(!s)return a({title:"Authentication Required",description:"Please sign in to mark attendance",variant:"destructive"}),!1;try{console.log("Marking attendance:",f);const{error:g}=await he.from("attendance_records").upsert({meeting_id:f.meetingId,user_id:f.userId,attendance_status:f.status,attendance_type:f.type,join_time:(p=f.joinTime)==null?void 0:p.toISOString(),leave_time:(h=f.leaveTime)==null?void 0:h.toISOString(),notes:f.notes,verified_by:s.id,is_verified:!0},{onConflict:"meeting_id,user_id"});if(g)throw console.error("Attendance marking error:",g),g;return a({title:"Success",description:"Attendance marked successfully"}),await d(),!0}catch(g){return console.error("Error marking attendance:",g),a({title:"Error",description:g.message||"Failed to mark attendance",variant:"destructive"}),!1}},c=async(f,p)=>{if(p!=null&&p.attendees)try{const h=p.attendees.map(async m=>{const{data:x}=await he.from("profiles").select("id").eq("email",m.emailAddress).single();if(!x)return null;const w=m.joinDateTime?new Date(m.joinDateTime):null,v=m.leaveDateTime?new Date(m.leaveDateTime):null;let _="present";return w?v&&w&&(v.getTime()-w.getTime())/6e4<15&&(_="left_early"):_="absent",{meeting_id:f,user_id:x.id,attendance_status:_,attendance_type:"online",join_time:w==null?void 0:w.toISOString(),leave_time:v==null?void 0:v.toISOString(),is_verified:!0}}),g=(await Promise.all(h)).filter(Boolean);if(g.length>0){const{error:m}=await he.from("attendance_records").upsert(g);if(m)throw m;a({title:"Success",description:`Auto-tracked attendance for ${g.length} participants`})}}catch(h){console.error("Error auto-tracking attendance:",h),a({title:"Warning",description:"Failed to auto-track some attendance records",variant:"destructive"})}},u=async(f,p,h)=>{try{let g=he.from("attendance_records").select(`
          *,
          profiles!attendance_records_user_id_fkey(first_name, last_name, email),
          meetings!attendance_records_meeting_id_fkey(title, start_time, meeting_type)
        `);f&&(g=g.eq("meeting_id",f)),p&&h&&(g=g.gte("created_at",p.toISOString()).lte("created_at",h.toISOString()));const{data:m,error:x}=await g;return x?(console.error("Report generation error:",x),[]):m||[]}catch(g){return console.error("Error generating report:",g),[]}},d=async()=>{n(!0);try{const{data:f,error:p}=await he.from("attendance_records").select(`
          *,
          profiles!attendance_records_user_id_fkey(first_name, last_name, email)
        `);if(p){console.error("Attendance fetch error:",p),n(!1);return}const h=(f||[]).map(g=>({...g,attendance_status:g.attendance_status,attendance_type:g.attendance_type}));t(h)}catch(f){console.error("Error fetching attendance:",f)}n(!1)};return{attendanceRecords:e,loading:r,fetchAttendanceForMeeting:o,markAttendance:l,autoTrackOnlineAttendance:c,generateAttendanceReport:u,fetchAttendance:d}},Nee=({open:e,onOpenChange:t,meeting:r})=>{const[n,s]=y.useState("physical"),[a,o]=y.useState("present"),[l,c]=y.useState(""),[u,d]=y.useState(!1),{markAttendance:f}=Qf(),{user:p}=kt(),h=async()=>{if(!(!p||!r)){d(!0);try{await f({meetingId:r.id,userId:p.id,status:a,type:n,joinTime:new Date,notes:l})&&(t(!1),c(""))}catch(m){console.error("Check-in error:",m)}finally{d(!1)}}};if(!r)return null;const g=r.meeting_type==="online"||r.teams_join_url;return i.jsx(Nt,{open:e,onOpenChange:t,children:i.jsxs(bt,{className:"sm:max-w-[500px]",children:[i.jsxs(jt,{children:[i.jsxs(Et,{className:"flex items-center space-x-2",children:[i.jsx(sl,{className:"h-5 w-5"}),i.jsx("span",{children:"Check In to Meeting"})]}),i.jsx($t,{children:r.title})]}),i.jsxs("div",{className:"space-y-4",children:[i.jsxs("div",{className:"flex items-center space-x-4 text-sm text-gray-600",children:[i.jsxs("div",{className:"flex items-center space-x-1",children:[i.jsx(qr,{className:"h-4 w-4"}),i.jsx("span",{children:new Date(r.start_time).toLocaleString()})]}),i.jsxs("div",{className:"flex items-center space-x-1",children:[g?i.jsx(ra,{className:"h-4 w-4"}):i.jsx(ri,{className:"h-4 w-4"}),i.jsx("span",{children:r.location||"Online Meeting"})]})]}),g&&r.location&&i.jsxs("div",{className:"space-y-2",children:[i.jsx("label",{className:"text-sm font-medium",children:"How are you attending?"}),i.jsxs("div",{className:"flex space-x-2",children:[i.jsxs(ue,{variant:n==="physical"?"default":"outline",size:"sm",onClick:()=>s("physical"),children:[i.jsx(ri,{className:"h-4 w-4 mr-2"}),"In Person"]}),i.jsxs(ue,{variant:n==="online"?"default":"outline",size:"sm",onClick:()=>s("online"),children:[i.jsx(ra,{className:"h-4 w-4 mr-2"}),"Online"]})]})]}),i.jsxs("div",{className:"space-y-2",children:[i.jsx("label",{className:"text-sm font-medium",children:"Attendance Status"}),i.jsxs("div",{className:"flex space-x-2",children:[i.jsx(ue,{variant:a==="present"?"default":"outline",size:"sm",onClick:()=>o("present"),className:a==="present"?"bg-success hover:bg-success/90":"",children:"On Time"}),i.jsx(ue,{variant:a==="late"?"default":"outline",size:"sm",onClick:()=>o("late"),className:a==="late"?"bg-warning hover:bg-warning/90":"",children:"Late Arrival"})]})]}),i.jsxs("div",{className:"space-y-2",children:[i.jsx("label",{className:"text-sm font-medium",children:"Notes (Optional)"}),i.jsx(Ma,{value:l,onChange:m=>c(m.target.value),placeholder:"Any additional notes about your attendance...",rows:3})]}),i.jsxs("div",{className:"flex justify-end space-x-2 pt-4 border-t",children:[i.jsx(ue,{variant:"outline",onClick:()=>t(!1),children:"Cancel"}),i.jsxs(ue,{onClick:h,disabled:u,className:"bg-primary hover:bg-primary/90",children:[i.jsx(sl,{className:"h-4 w-4 mr-2"}),u?"Checking In...":"Check In"]})]})]})]})})};function jee(e){if(!e)return[];let t=[];if(typeof e=="string")try{t=JSON.parse(e)}catch{return[]}else if(Array.isArray(e))t=e;else return[];return t.map(r=>{if(typeof r=="string"){try{const n=JSON.parse(r);if(n&&typeof n.email=="string")return{email:n.email,rsvp:n.rsvp==="yes"||n.rsvp==="no"||n.rsvp==="maybe"?n.rsvp:null}}catch{return null}return{email:r,rsvp:null}}return r&&typeof r.email=="string"?{email:r.email,rsvp:r.rsvp==="yes"||r.rsvp==="no"||r.rsvp==="maybe"?r.rsvp:null}:null}).filter(Boolean)}const Eee=({open:e,onOpenChange:t,meeting:r})=>{const[n,s]=y.useState([]),[a,o]=y.useState(!1),{toast:l}=St(),{user:c}=kt(),[u,d]=y.useState(!1);_l();const f=async()=>{if(r){o(!0);try{const{data:x,error:w}=await he.from("meeting_attendees").select("id, user_id, rsvp_response, rsvp_submitted_at").eq("meeting_id",r.id).order("rsvp_submitted_at",{ascending:!1,nullsFirst:!1});if(w)throw w;const v=x.map(C=>C.user_id),{data:_,error:b}=await he.from("profiles").select("id, first_name, last_name, email").in("id",v);if(b)throw b;const S=x.map(C=>{const E=_==null?void 0:_.find(P=>P.id===C.user_id);return{...C,rsvp_response:C.rsvp_response,profiles:E?{first_name:E.first_name||"Unknown",last_name:E.last_name||"User",email:E.email||"No email"}:null,is_manual:!1}}),T=jee(r.manual_attendees).map(C=>({email:C.email,rsvp:C.rsvp==="yes"||C.rsvp==="no"||C.rsvp==="maybe"?C.rsvp:null})),N=[...S,...T.map(C=>({id:`manual-${C.email}`,user_id:"",rsvp_response:C.rsvp,rsvp_submitted_at:null,profiles:{first_name:"External",last_name:"Attendee",email:C.email},is_manual:!0}))];s(N)}catch{l({title:"Error",description:"Failed to load RSVP responses",variant:"destructive"})}finally{o(!1)}}};y.useEffect(()=>{e&&r&&f()},[e,r]),y.useEffect(()=>{if(!e||!r)return;const x=he.channel(`rsvp-updates-${r.id}`).on("postgres_changes",{event:"*",schema:"public",table:"meeting_attendees",filter:`meeting_id=eq.${r.id}`},w=>{f()}).subscribe();return()=>{he.removeChannel(x)}},[e,r]);let p=n.find(x=>x.user_id===(c==null?void 0:c.id));!p&&(c!=null&&c.email)&&(p=n.find(x=>{var w,v,_;return(((v=(w=x.profiles)==null?void 0:w.email)==null?void 0:v.toLowerCase())??"")===(((_=c.email)==null?void 0:_.toLowerCase())??"")}));const h=async x=>{if(!(!r||!c)){d(!0);try{const{data:w,error:v}=await he.from("meeting_attendees").select("id").eq("meeting_id",r.id).eq("user_id",c.id).maybeSingle();if(v)throw v;if(w){const{error:_}=await he.from("meeting_attendees").update({rsvp_response:x,rsvp_submitted_at:new Date().toISOString()}).eq("meeting_id",r.id).eq("user_id",c.id);if(_)throw _}else{const{error:_}=await he.from("meeting_attendees").insert({meeting_id:r.id,user_id:c.id,rsvp_response:x,rsvp_submitted_at:new Date().toISOString()});if(_)throw _}l({title:"RSVP Updated",description:`Your response: ${x.charAt(0).toUpperCase()+x.slice(1)}`}),f()}catch{l({title:"Error",description:"Failed to update RSVP",variant:"destructive"})}finally{d(!1)}}};if(!r)return i.jsx(Nt,{open:e,onOpenChange:t,children:i.jsxs(bt,{style:{zIndex:2e4,position:"fixed",top:"50%",left:"50%",transform:"translate(-50%, -50%)",maxHeight:"90vh",overflowY:"auto",background:"white"},className:"sm:max-w-[400px] w-full max-w-lg flex flex-col items-center justify-center",children:[i.jsx("button",{type:"button","aria-label":"Close",onClick:()=>t(!1),className:"absolute top-2 right-2 p-2 rounded hover:bg-gray-100 focus:outline-none z-20",children:i.jsx(Cn,{className:"h-5 w-5"})}),i.jsxs("div",{className:"text-center py-8",children:[i.jsx(mr,{className:"h-12 w-12 mx-auto mb-4 text-gray-400"}),i.jsxs("p",{className:"text-gray-600 font-semibold",children:["No meeting data found.",i.jsx("br",{}),"Please try again."]})]})]})});const g={yes:n.filter(x=>!x.is_manual&&x.rsvp_response==="yes").length,no:n.filter(x=>!x.is_manual&&x.rsvp_response==="no").length,maybe:n.filter(x=>!x.is_manual&&x.rsvp_response==="maybe").length,pending:n.filter(x=>!x.is_manual&&!x.rsvp_response).length,external:n.filter(x=>x.is_manual).length},m=x=>{switch(x){case"yes":return i.jsx(We,{className:"bg-green-100 text-green-800",children:"Yes"});case"no":return i.jsx(We,{className:"bg-red-100 text-red-800",children:"No"});case"maybe":return i.jsx(We,{className:"bg-yellow-100 text-yellow-800",children:"Maybe"});default:return i.jsx(We,{variant:"outline",children:"No Response"})}};return i.jsx(Nt,{open:e,onOpenChange:t,children:i.jsxs(bt,{style:{zIndex:2e4,position:"fixed",top:"50%",left:"50%",transform:"translate(-50%, -50%)",maxHeight:"90vh",overflowY:"auto",background:"white"},className:"sm:max-w-[800px] w-full max-w-lg overflow-y-auto relative",children:[i.jsx("button",{type:"button","aria-label":"Close",onClick:()=>t(!1),className:"absolute top-2 right-2 p-2 rounded hover:bg-gray-100 focus:outline-none z-20",children:i.jsx(Cn,{className:"h-5 w-5"})}),i.jsxs(jt,{children:[i.jsxs(Et,{className:"flex items-center space-x-2",children:[i.jsx(mr,{className:"h-5 w-5"}),i.jsx("span",{children:"RSVP Responses"})]}),i.jsxs($t,{children:['View attendee responses for "',r.title,'"']})]}),i.jsxs("div",{className:"space-y-6",children:[p&&i.jsxs(Ye,{className:"mb-2",children:[i.jsx(ct,{children:i.jsx(ft,{children:"Your Response"})}),i.jsx(Je,{children:i.jsxs("div",{className:"flex items-center gap-4",children:[i.jsxs(ue,{variant:p.rsvp_response==="yes"?"default":"outline",onClick:()=>h("yes"),disabled:u,children:[i.jsx(as,{className:"h-4 w-4 mr-1"})," Yes"]}),i.jsxs(ue,{variant:p.rsvp_response==="no"?"destructive":"outline",onClick:()=>h("no"),disabled:u,children:[i.jsx(ro,{className:"h-4 w-4 mr-1"})," No"]}),i.jsxs(ue,{variant:p.rsvp_response==="maybe"?"secondary":"outline",onClick:()=>h("maybe"),disabled:u,children:[i.jsx(qr,{className:"h-4 w-4 mr-1"})," Maybe"]}),i.jsx("span",{className:"ml-4",children:m(p.rsvp_response)})]})})]}),i.jsxs("div",{className:"grid grid-cols-2 sm:grid-cols-5 gap-2",children:[i.jsx(Ye,{children:i.jsxs(Je,{className:"p-4 text-center",children:[i.jsxs("div",{className:"flex items-center justify-center space-x-2 mb-2",children:[i.jsx(as,{className:"h-5 w-5 text-green-600"}),i.jsx("span",{className:"text-2xl font-bold text-green-600",children:g.yes})]}),i.jsx("p",{className:"text-sm text-gray-600",children:"Yes"})]})}),i.jsx(Ye,{children:i.jsxs(Je,{className:"p-4 text-center",children:[i.jsxs("div",{className:"flex items-center justify-center space-x-2 mb-2",children:[i.jsx(ro,{className:"h-5 w-5 text-red-600"}),i.jsx("span",{className:"text-2xl font-bold text-red-600",children:g.no})]}),i.jsx("p",{className:"text-sm text-gray-600",children:"No"})]})}),i.jsx(Ye,{children:i.jsxs(Je,{className:"p-4 text-center",children:[i.jsxs("div",{className:"flex items-center justify-center space-x-2 mb-2",children:[i.jsx(qr,{className:"h-5 w-5 text-yellow-600"}),i.jsx("span",{className:"text-2xl font-bold text-yellow-600",children:g.maybe})]}),i.jsx("p",{className:"text-sm text-gray-600",children:"Maybe"})]})}),i.jsx(Ye,{children:i.jsxs(Je,{className:"p-4 text-center",children:[i.jsxs("div",{className:"flex items-center justify-center space-x-2 mb-2",children:[i.jsx(qr,{className:"h-5 w-5 text-gray-400"}),i.jsx("span",{className:"text-2xl font-bold text-gray-600",children:g.pending})]}),i.jsx("p",{className:"text-sm text-gray-600",children:"Pending"})]})}),i.jsx(Ye,{children:i.jsxs(Je,{className:"p-4 text-center",children:[i.jsxs("div",{className:"flex items-center justify-center space-x-2 mb-2",children:[i.jsx(mr,{className:"h-5 w-5 text-blue-600"}),i.jsx("span",{className:"text-2xl font-bold text-blue-600",children:g.external})]}),i.jsx("p",{className:"text-sm text-gray-600",children:"External"})]})})]}),i.jsxs(Ye,{children:[i.jsx(ct,{children:i.jsx(ft,{children:"All Responses"})}),i.jsx(Je,{children:i.jsxs(Ff,{children:[i.jsx(If,{children:i.jsxs(mi,{children:[i.jsx(dr,{children:"Name"}),i.jsx(dr,{children:"Email"}),i.jsx(dr,{children:"Response"}),i.jsx(dr,{children:"Submitted At"})]})}),i.jsx(Lf,{children:n.map(x=>{var w;return i.jsxs(mi,{children:[i.jsx(fr,{children:x.profiles?`${x.profiles.first_name} ${x.profiles.last_name}`:"External Attendee"}),i.jsx(fr,{children:((w=x.profiles)==null?void 0:w.email)||""}),i.jsx(fr,{children:m(x.rsvp_response)}),i.jsx(fr,{children:x.rsvp_submitted_at?vt(new Date(x.rsvp_submitted_at),"PPpp"):"-"})]},x.id)})})]})})]})]})]})})};function kee(e,t){return y.useReducer((r,n)=>t[r][n]??r,e)}var Gw="ScrollArea",[V3,fse]=Fr(Gw),[Cee,Rs]=V3(Gw),W3=y.forwardRef((e,t)=>{const{__scopeScrollArea:r,type:n="hover",dir:s,scrollHideDelay:a=600,...o}=e,[l,c]=y.useState(null),[u,d]=y.useState(null),[f,p]=y.useState(null),[h,g]=y.useState(null),[m,x]=y.useState(null),[w,v]=y.useState(0),[_,b]=y.useState(0),[S,T]=y.useState(!1),[N,C]=y.useState(!1),E=st(t,R=>c(R)),P=uu(s);return i.jsx(Cee,{scope:r,type:n,dir:P,scrollHideDelay:a,scrollArea:l,viewport:u,onViewportChange:d,content:f,onContentChange:p,scrollbarX:h,onScrollbarXChange:g,scrollbarXEnabled:S,onScrollbarXEnabledChange:T,scrollbarY:m,onScrollbarYChange:x,scrollbarYEnabled:N,onScrollbarYEnabledChange:C,onCornerWidthChange:v,onCornerHeightChange:b,children:i.jsx(ze.div,{dir:P,...o,ref:E,style:{position:"relative","--radix-scroll-area-corner-width":w+"px","--radix-scroll-area-corner-height":_+"px",...e.style}})})});W3.displayName=Gw;var H3="ScrollAreaViewport",G3=y.forwardRef((e,t)=>{const{__scopeScrollArea:r,children:n,nonce:s,...a}=e,o=Rs(H3,r),l=y.useRef(null),c=st(t,l,o.onViewportChange);return i.jsxs(i.Fragment,{children:[i.jsx("style",{dangerouslySetInnerHTML:{__html:"[data-radix-scroll-area-viewport]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}[data-radix-scroll-area-viewport]::-webkit-scrollbar{display:none}"},nonce:s}),i.jsx(ze.div,{"data-radix-scroll-area-viewport":"",...a,ref:c,style:{overflowX:o.scrollbarXEnabled?"scroll":"hidden",overflowY:o.scrollbarYEnabled?"scroll":"hidden",...e.style},children:i.jsx("div",{ref:o.onContentChange,style:{minWidth:"100%",display:"table"},children:n})})]})});G3.displayName=H3;var Fa="ScrollAreaScrollbar",qw=y.forwardRef((e,t)=>{const{forceMount:r,...n}=e,s=Rs(Fa,e.__scopeScrollArea),{onScrollbarXEnabledChange:a,onScrollbarYEnabledChange:o}=s,l=e.orientation==="horizontal";return y.useEffect(()=>(l?a(!0):o(!0),()=>{l?a(!1):o(!1)}),[l,a,o]),s.type==="hover"?i.jsx(Tee,{...n,ref:t,forceMount:r}):s.type==="scroll"?i.jsx(Aee,{...n,ref:t,forceMount:r}):s.type==="auto"?i.jsx(q3,{...n,ref:t,forceMount:r}):s.type==="always"?i.jsx(Yw,{...n,ref:t}):null});qw.displayName=Fa;var Tee=y.forwardRef((e,t)=>{const{forceMount:r,...n}=e,s=Rs(Fa,e.__scopeScrollArea),[a,o]=y.useState(!1);return y.useEffect(()=>{const l=s.scrollArea;let c=0;if(l){const u=()=>{window.clearTimeout(c),o(!0)},d=()=>{c=window.setTimeout(()=>o(!1),s.scrollHideDelay)};return l.addEventListener("pointerenter",u),l.addEventListener("pointerleave",d),()=>{window.clearTimeout(c),l.removeEventListener("pointerenter",u),l.removeEventListener("pointerleave",d)}}},[s.scrollArea,s.scrollHideDelay]),i.jsx(Ir,{present:r||a,children:i.jsx(q3,{"data-state":a?"visible":"hidden",...n,ref:t})})}),Aee=y.forwardRef((e,t)=>{const{forceMount:r,...n}=e,s=Rs(Fa,e.__scopeScrollArea),a=e.orientation==="horizontal",o=Gp(()=>c("SCROLL_END"),100),[l,c]=kee("hidden",{hidden:{SCROLL:"scrolling"},scrolling:{SCROLL_END:"idle",POINTER_ENTER:"interacting"},interacting:{SCROLL:"interacting",POINTER_LEAVE:"idle"},idle:{HIDE:"hidden",SCROLL:"scrolling",POINTER_ENTER:"interacting"}});return y.useEffect(()=>{if(l==="idle"){const u=window.setTimeout(()=>c("HIDE"),s.scrollHideDelay);return()=>window.clearTimeout(u)}},[l,s.scrollHideDelay,c]),y.useEffect(()=>{const u=s.viewport,d=a?"scrollLeft":"scrollTop";if(u){let f=u[d];const p=()=>{const h=u[d];f!==h&&(c("SCROLL"),o()),f=h};return u.addEventListener("scroll",p),()=>u.removeEventListener("scroll",p)}},[s.viewport,a,c,o]),i.jsx(Ir,{present:r||l!=="hidden",children:i.jsx(Yw,{"data-state":l==="hidden"?"hidden":"visible",...n,ref:t,onPointerEnter:Oe(e.onPointerEnter,()=>c("POINTER_ENTER")),onPointerLeave:Oe(e.onPointerLeave,()=>c("POINTER_LEAVE"))})})}),q3=y.forwardRef((e,t)=>{const r=Rs(Fa,e.__scopeScrollArea),{forceMount:n,...s}=e,[a,o]=y.useState(!1),l=e.orientation==="horizontal",c=Gp(()=>{if(r.viewport){const u=r.viewport.offsetWidth<r.viewport.scrollWidth,d=r.viewport.offsetHeight<r.viewport.scrollHeight;o(l?u:d)}},10);return qc(r.viewport,c),qc(r.content,c),i.jsx(Ir,{present:n||a,children:i.jsx(Yw,{"data-state":a?"visible":"hidden",...s,ref:t})})}),Yw=y.forwardRef((e,t)=>{const{orientation:r="vertical",...n}=e,s=Rs(Fa,e.__scopeScrollArea),a=y.useRef(null),o=y.useRef(0),[l,c]=y.useState({content:0,viewport:0,scrollbar:{size:0,paddingStart:0,paddingEnd:0}}),u=J3(l.viewport,l.content),d={...n,sizes:l,onSizesChange:c,hasThumb:u>0&&u<1,onThumbChange:p=>a.current=p,onThumbPointerUp:()=>o.current=0,onThumbPointerDown:p=>o.current=p};function f(p,h){return Fee(p,o.current,l,h)}return r==="horizontal"?i.jsx(Pee,{...d,ref:t,onThumbPositionChange:()=>{if(s.viewport&&a.current){const p=s.viewport.scrollLeft,h=JS(p,l,s.dir);a.current.style.transform=`translate3d(${h}px, 0, 0)`}},onWheelScroll:p=>{s.viewport&&(s.viewport.scrollLeft=p)},onDragScroll:p=>{s.viewport&&(s.viewport.scrollLeft=f(p,s.dir))}}):r==="vertical"?i.jsx(Dee,{...d,ref:t,onThumbPositionChange:()=>{if(s.viewport&&a.current){const p=s.viewport.scrollTop,h=JS(p,l);a.current.style.transform=`translate3d(0, ${h}px, 0)`}},onWheelScroll:p=>{s.viewport&&(s.viewport.scrollTop=p)},onDragScroll:p=>{s.viewport&&(s.viewport.scrollTop=f(p))}}):null}),Pee=y.forwardRef((e,t)=>{const{sizes:r,onSizesChange:n,...s}=e,a=Rs(Fa,e.__scopeScrollArea),[o,l]=y.useState(),c=y.useRef(null),u=st(t,c,a.onScrollbarXChange);return y.useEffect(()=>{c.current&&l(getComputedStyle(c.current))},[c]),i.jsx(K3,{"data-orientation":"horizontal",...s,ref:u,sizes:r,style:{bottom:0,left:a.dir==="rtl"?"var(--radix-scroll-area-corner-width)":0,right:a.dir==="ltr"?"var(--radix-scroll-area-corner-width)":0,"--radix-scroll-area-thumb-width":Hp(r)+"px",...e.style},onThumbPointerDown:d=>e.onThumbPointerDown(d.x),onDragScroll:d=>e.onDragScroll(d.x),onWheelScroll:(d,f)=>{if(a.viewport){const p=a.viewport.scrollLeft+d.deltaX;e.onWheelScroll(p),eD(p,f)&&d.preventDefault()}},onResize:()=>{c.current&&a.viewport&&o&&n({content:a.viewport.scrollWidth,viewport:a.viewport.offsetWidth,scrollbar:{size:c.current.clientWidth,paddingStart:_0(o.paddingLeft),paddingEnd:_0(o.paddingRight)}})}})}),Dee=y.forwardRef((e,t)=>{const{sizes:r,onSizesChange:n,...s}=e,a=Rs(Fa,e.__scopeScrollArea),[o,l]=y.useState(),c=y.useRef(null),u=st(t,c,a.onScrollbarYChange);return y.useEffect(()=>{c.current&&l(getComputedStyle(c.current))},[c]),i.jsx(K3,{"data-orientation":"vertical",...s,ref:u,sizes:r,style:{top:0,right:a.dir==="ltr"?0:void 0,left:a.dir==="rtl"?0:void 0,bottom:"var(--radix-scroll-area-corner-height)","--radix-scroll-area-thumb-height":Hp(r)+"px",...e.style},onThumbPointerDown:d=>e.onThumbPointerDown(d.y),onDragScroll:d=>e.onDragScroll(d.y),onWheelScroll:(d,f)=>{if(a.viewport){const p=a.viewport.scrollTop+d.deltaY;e.onWheelScroll(p),eD(p,f)&&d.preventDefault()}},onResize:()=>{c.current&&a.viewport&&o&&n({content:a.viewport.scrollHeight,viewport:a.viewport.offsetHeight,scrollbar:{size:c.current.clientHeight,paddingStart:_0(o.paddingTop),paddingEnd:_0(o.paddingBottom)}})}})}),[Ree,Y3]=V3(Fa),K3=y.forwardRef((e,t)=>{const{__scopeScrollArea:r,sizes:n,hasThumb:s,onThumbChange:a,onThumbPointerUp:o,onThumbPointerDown:l,onThumbPositionChange:c,onDragScroll:u,onWheelScroll:d,onResize:f,...p}=e,h=Rs(Fa,r),[g,m]=y.useState(null),x=st(t,E=>m(E)),w=y.useRef(null),v=y.useRef(""),_=h.viewport,b=n.content-n.viewport,S=hr(d),T=hr(c),N=Gp(f,10);function C(E){if(w.current){const P=E.clientX-w.current.left,R=E.clientY-w.current.top;u({x:P,y:R})}}return y.useEffect(()=>{const E=P=>{const R=P.target;(g==null?void 0:g.contains(R))&&S(P,b)};return document.addEventListener("wheel",E,{passive:!1}),()=>document.removeEventListener("wheel",E,{passive:!1})},[_,g,b,S]),y.useEffect(T,[n,T]),qc(g,N),qc(h.content,N),i.jsx(Ree,{scope:r,scrollbar:g,hasThumb:s,onThumbChange:hr(a),onThumbPointerUp:hr(o),onThumbPositionChange:T,onThumbPointerDown:hr(l),children:i.jsx(ze.div,{...p,ref:x,style:{position:"absolute",...p.style},onPointerDown:Oe(e.onPointerDown,E=>{E.button===0&&(E.target.setPointerCapture(E.pointerId),w.current=g.getBoundingClientRect(),v.current=document.body.style.webkitUserSelect,document.body.style.webkitUserSelect="none",h.viewport&&(h.viewport.style.scrollBehavior="auto"),C(E))}),onPointerMove:Oe(e.onPointerMove,C),onPointerUp:Oe(e.onPointerUp,E=>{const P=E.target;P.hasPointerCapture(E.pointerId)&&P.releasePointerCapture(E.pointerId),document.body.style.webkitUserSelect=v.current,h.viewport&&(h.viewport.style.scrollBehavior=""),w.current=null})})})}),w0="ScrollAreaThumb",X3=y.forwardRef((e,t)=>{const{forceMount:r,...n}=e,s=Y3(w0,e.__scopeScrollArea);return i.jsx(Ir,{present:r||s.hasThumb,children:i.jsx(Mee,{ref:t,...n})})}),Mee=y.forwardRef((e,t)=>{const{__scopeScrollArea:r,style:n,...s}=e,a=Rs(w0,r),o=Y3(w0,r),{onThumbPositionChange:l}=o,c=st(t,f=>o.onThumbChange(f)),u=y.useRef(void 0),d=Gp(()=>{u.current&&(u.current(),u.current=void 0)},100);return y.useEffect(()=>{const f=a.viewport;if(f){const p=()=>{if(d(),!u.current){const h=Iee(f,l);u.current=h,l()}};return l(),f.addEventListener("scroll",p),()=>f.removeEventListener("scroll",p)}},[a.viewport,d,l]),i.jsx(ze.div,{"data-state":o.hasThumb?"visible":"hidden",...s,ref:c,style:{width:"var(--radix-scroll-area-thumb-width)",height:"var(--radix-scroll-area-thumb-height)",...n},onPointerDownCapture:Oe(e.onPointerDownCapture,f=>{const h=f.target.getBoundingClientRect(),g=f.clientX-h.left,m=f.clientY-h.top;o.onThumbPointerDown({x:g,y:m})}),onPointerUp:Oe(e.onPointerUp,o.onThumbPointerUp)})});X3.displayName=w0;var Kw="ScrollAreaCorner",Q3=y.forwardRef((e,t)=>{const r=Rs(Kw,e.__scopeScrollArea),n=!!(r.scrollbarX&&r.scrollbarY);return r.type!=="scroll"&&n?i.jsx(Oee,{...e,ref:t}):null});Q3.displayName=Kw;var Oee=y.forwardRef((e,t)=>{const{__scopeScrollArea:r,...n}=e,s=Rs(Kw,r),[a,o]=y.useState(0),[l,c]=y.useState(0),u=!!(a&&l);return qc(s.scrollbarX,()=>{var f;const d=((f=s.scrollbarX)==null?void 0:f.offsetHeight)||0;s.onCornerHeightChange(d),c(d)}),qc(s.scrollbarY,()=>{var f;const d=((f=s.scrollbarY)==null?void 0:f.offsetWidth)||0;s.onCornerWidthChange(d),o(d)}),u?i.jsx(ze.div,{...n,ref:t,style:{width:a,height:l,position:"absolute",right:s.dir==="ltr"?0:void 0,left:s.dir==="rtl"?0:void 0,bottom:0,...e.style}}):null});function _0(e){return e?parseInt(e,10):0}function J3(e,t){const r=e/t;return isNaN(r)?0:r}function Hp(e){const t=J3(e.viewport,e.content),r=e.scrollbar.paddingStart+e.scrollbar.paddingEnd,n=(e.scrollbar.size-r)*t;return Math.max(n,18)}function Fee(e,t,r,n="ltr"){const s=Hp(r),a=s/2,o=t||a,l=s-o,c=r.scrollbar.paddingStart+o,u=r.scrollbar.size-r.scrollbar.paddingEnd-l,d=r.content-r.viewport,f=n==="ltr"?[0,d]:[d*-1,0];return Z3([c,u],f)(e)}function JS(e,t,r="ltr"){const n=Hp(t),s=t.scrollbar.paddingStart+t.scrollbar.paddingEnd,a=t.scrollbar.size-s,o=t.content-t.viewport,l=a-n,c=r==="ltr"?[0,o]:[o*-1,0],u=Zv(e,c);return Z3([0,o],[0,l])(u)}function Z3(e,t){return r=>{if(e[0]===e[1]||t[0]===t[1])return t[0];const n=(t[1]-t[0])/(e[1]-e[0]);return t[0]+n*(r-e[0])}}function eD(e,t){return e>0&&e<t}var Iee=(e,t=()=>{})=>{let r={left:e.scrollLeft,top:e.scrollTop},n=0;return function s(){const a={left:e.scrollLeft,top:e.scrollTop},o=r.left!==a.left,l=r.top!==a.top;(o||l)&&t(),r=a,n=window.requestAnimationFrame(s)}(),()=>window.cancelAnimationFrame(n)};function Gp(e,t){const r=hr(e),n=y.useRef(0);return y.useEffect(()=>()=>window.clearTimeout(n.current),[]),y.useCallback(()=>{window.clearTimeout(n.current),n.current=window.setTimeout(r,t)},[r,t])}function qc(e,t){const r=hr(t);gr(()=>{let n=0;if(e){const s=new ResizeObserver(()=>{cancelAnimationFrame(n),n=window.requestAnimationFrame(r)});return s.observe(e),()=>{window.cancelAnimationFrame(n),s.unobserve(e)}}},[e,r])}var tD=W3,Lee=G3,$ee=Q3;const Xw=y.forwardRef(({className:e,children:t,...r},n)=>i.jsxs(tD,{ref:n,className:De("relative overflow-hidden",e),...r,children:[i.jsx(Lee,{className:"h-full w-full rounded-[inherit]",children:t}),i.jsx(rD,{}),i.jsx($ee,{})]}));Xw.displayName=tD.displayName;const rD=y.forwardRef(({className:e,orientation:t="vertical",...r},n)=>i.jsx(qw,{ref:n,orientation:t,className:De("flex touch-none select-none transition-colors",t==="vertical"&&"h-full w-2.5 border-l border-l-transparent p-[1px]",t==="horizontal"&&"h-2.5 flex-col border-t border-t-transparent p-[1px]",e),...r,children:i.jsx(X3,{className:"relative flex-1 rounded-full bg-border"})}));rD.displayName=qw.displayName;var Bee="Separator",ZS="horizontal",Uee=["horizontal","vertical"],nD=y.forwardRef((e,t)=>{const{decorative:r,orientation:n=ZS,...s}=e,a=zee(n)?n:ZS,l=r?{role:"none"}:{"aria-orientation":a==="vertical"?a:void 0,role:"separator"};return i.jsx(ze.div,{"data-orientation":a,...l,...s,ref:t})});nD.displayName=Bee;function zee(e){return Uee.includes(e)}var sD=nD;const aD=y.forwardRef(({className:e,orientation:t="horizontal",decorative:r=!0,...n},s)=>i.jsx(sD,{ref:s,decorative:r,orientation:t,className:De("shrink-0 bg-border",t==="horizontal"?"h-[1px] w-full":"h-full w-[1px]",e),...n}));aD.displayName=sD.displayName;const Vee=()=>{const[e,t]=y.useState([]),[r,n]=y.useState(!1),{user:s}=kt(),{accessToken:a,isConnected:o,checkAndRefreshToken:l}=cu();St();const c=async()=>{try{const{data:h,error:g}=await he.from("folders").select("id, name, parent_folder_id").in("name",["ISKCON Repository","Meeting Transcripts"]);if(g)throw g;const m=h==null?void 0:h.find(w=>w.name==="ISKCON Repository"&&w.parent_folder_id===null),x=h==null?void 0:h.find(w=>w.name==="Meeting Transcripts"&&w.parent_folder_id===(m==null?void 0:m.id));return(x==null?void 0:x.id)||null}catch(h){return console.error("Error finding Meeting Transcripts folder:",h),null}};return{transcripts:e,loading:r,fetchTranscriptForMeeting:async h=>{try{console.log(`Fetching saved transcript for meeting: ${h}`);const{data:g,error:m}=await he.from("meeting_transcripts").select("*").eq("meeting_id",h).single();if(m&&m.code!=="PGRST116")throw console.error("Error fetching transcript:",m),m;return console.log("Saved transcript found:",!!g,"Has content:",!!(g!=null&&g.transcript_content)),g}catch(g){return g.code==="PGRST116"?(console.log("No saved transcript found for meeting:",h),null):(console.error("Error fetching transcript:",g),null)}},fetchTeamsTranscript:async(h,g)=>{var m,x,w,v,_,b,S,T,N,C,E,P,R,j,M,A,I,X,Y;if(!s)throw console.error("No authenticated user found"),new Error("No authenticated user found");if(!o||!a)throw console.error("Microsoft account not connected or no access token"),new Error("Microsoft account not connected. Please connect your Microsoft account in Settings.");try{console.log(`Enhanced Teams transcript extraction for meeting: ${g}`),console.log("Using access token:",a?"Present":"Missing"),await l();let z=null;for(let U=1;U<=5;U++)try{console.log(`Enhanced extraction attempt ${U} for Teams meeting`);const{data:V,error:F}=await he.functions.invoke("fetch-teams-transcript",{body:{meetingId:g,accessToken:a}});if(F){if(console.error(`Enhanced attempt ${U} failed:`,F),z=F,(m=F.message)!=null&&m.includes("401")||(x=F.message)!=null&&x.includes("Unauthorized")||(w=F.message)!=null&&w.includes("expired")){console.log("Token issue detected, refreshing...");try{await l(),console.log("Token refreshed for enhanced extraction, retrying...");continue}catch(D){throw console.error("Token refresh failed during enhanced extraction:",D),new Error("Microsoft authentication expired. Please reconnect your Microsoft account in Settings.")}}if(U===5)throw F;await new Promise(D=>setTimeout(D,2e3*Math.pow(1.5,U-1)));continue}if(console.log("Enhanced Teams transcript response:",{success:V==null?void 0:V.success,hasTranscripts:!!((_=(v=V==null?void 0:V.transcript)==null?void 0:v.value)!=null&&_.length),hasRecordings:V==null?void 0:V.hasRecordings,hasContent:V==null?void 0:V.hasContent,contentLength:((b=V==null?void 0:V.transcriptContent)==null?void 0:b.length)||0,strategiesAttempted:((T=(S=V==null?void 0:V.extractionDetails)==null?void 0:S.strategiesAttempted)==null?void 0:T.length)||0,foundWith:V==null?void 0:V.foundWith,transcriptMethod:V==null?void 0:V.transcriptMethod}),(V==null?void 0:V.success)===!1)throw new Error(V.error||"Enhanced extraction failed");if(V!=null&&V.success&&(V!=null&&V.hasContent)&&(V!=null&&V.transcriptContent))return console.log("Enhanced extraction successful! Content length:",V.transcriptContent.length),V;if(V!=null&&V.success&&(V!=null&&V.hasRecordings)&&!(V!=null&&V.hasContent))throw new Error("Meeting recording found but transcript is still being processed. Transcripts can take up to 24 hours to become available after a meeting ends. Please try again later.");if(V!=null&&V.success&&((C=(N=V==null?void 0:V.transcript)==null?void 0:N.value)==null?void 0:C.length)>0&&!(V!=null&&V.hasContent))throw new Error("Transcript metadata found but content extraction failed. This may be due to transcript processing delays or access restrictions. Please try again in a few minutes.");if((V==null?void 0:V.success)===!1||!((P=(E=V==null?void 0:V.transcript)==null?void 0:E.value)!=null&&P.length)&&!(V!=null&&V.hasRecordings)){const D=V!=null&&V.foundWith?` (Meeting found via: ${V.foundWith})`:"";throw new Error(`No transcript or recording found for this meeting${D}. Ensure the meeting was recorded with transcription enabled in Teams.`)}else return console.log("Enhanced extraction returning partial data"),V}catch(V){if(console.error(`Enhanced extraction attempt ${U} error:`,V),z=V,U===5)throw V;await new Promise(F=>setTimeout(F,2e3*Math.pow(1.5,U-1)))}throw z}catch(z){console.error("Enhanced Teams transcript extraction error:",z);let U="Failed to extract Teams transcript using enhanced methods";throw(R=z.message)!=null&&R.includes("401")||(j=z.message)!=null&&j.includes("Unauthorized")?U="Microsoft authentication expired. Please reconnect your Microsoft account in Settings.":(M=z.message)!=null&&M.includes("404")||(A=z.message)!=null&&A.includes("Not Found")?U="Meeting not found in Teams. The meeting may not exist or you may not have access to it.":(I=z.message)!=null&&I.includes("403")?U="Access denied. Please ensure you have permission to access this meeting's transcript and recordings.":((X=z.message)!=null&&X.includes("processing")||(Y=z.message)!=null&&Y.includes("24 hours")||z.message)&&(U=z.message),new Error(U)}},saveTranscript:async(h,g)=>{var m;try{console.log(`Saving transcript for meeting: ${h}`),console.log("Transcript data length:",((m=g.content)==null?void 0:m.length)||0);const{data:x,error:w}=await he.from("meeting_transcripts").upsert({meeting_id:h,transcript_content:g.content,summary:g.summary,action_items:g.actionItems,participants:g.participants,teams_transcript_id:g.teamsTranscriptId}).select().single();if(w)throw console.error("Error saving transcript:",w),w;return console.log("Transcript saved successfully:",x.id),x}catch(x){throw console.error("Error saving transcript:",x),new Error("Failed to save transcript to database")}},saveTranscriptToDocuments:async(h,g,m)=>{var x,w;if(!s)return!1;try{const v=await c(),_=m?new Date(m).toLocaleDateString("en-US",{year:"numeric",month:"2-digit",day:"2-digit"}).replace(/\//g,"-"):new Date().toLocaleDateString("en-US",{year:"numeric",month:"2-digit",day:"2-digit"}).replace(/\//g,"-"),b=`${g}_${_}_transcript.txt`,S=`
Meeting: ${g}
Date: ${m?new Date(m).toLocaleDateString():new Date().toLocaleDateString()}
Time: ${m?new Date(m).toLocaleTimeString():new Date().toLocaleTimeString()}

TRANSCRIPT:
${h.transcript_content||"No transcript content available"}

PARTICIPANTS:
${((x=h.participants)==null?void 0:x.map(N=>{var C,E,P;return`- ${((C=N.identity)==null?void 0:C.displayName)||((P=(E=N.identity)==null?void 0:E.user)==null?void 0:P.displayName)||N.emailAddress||"Unknown"}`}).join(`
`))||"No participants listed"}

SUMMARY:
${h.summary||"No summary available"}

ACTION ITEMS:
${((w=h.action_items)==null?void 0:w.map((N,C)=>`${C+1}. ${N.text||N}`).join(`
`))||"No action items"}
      `.trim(),{error:T}=await he.from("documents").insert({name:b,file_path:`transcripts/${h.meeting_id}/${b}`,folder_id:v,uploaded_by:s.id,mime_type:"text/plain",file_size:S.length});if(T)throw T;return!0}catch(v){throw console.error("Error saving transcript to documents:",v),new Error("Failed to save transcript to documents")}}}},Wee=({open:e,onOpenChange:t,meeting:r})=>{var R;const[n,s]=y.useState(null),[a,o]=y.useState(!1),[l,c]=y.useState(!1),[u,d]=y.useState(!1),[f,p]=y.useState(null),[h,g]=y.useState(null),{fetchTranscriptForMeeting:m,fetchTeamsTranscript:x,saveTranscript:w,saveTranscriptToDocuments:v}=Vee(),{autoTrackOnlineAttendance:_}=Qf(),{accessToken:b,isConnected:S,isExpired:T,forceRefresh:N}=cu(),{toast:C}=St(),E=async(j=!1)=>{var M,A,I,X,Y,z,U,V,F,D,G;if(r){o(!0),p(null),g(null);try{if(console.log(`Enhanced transcript loading for meeting: ${r.title} (ID: ${r.id})`),console.log("Teams meeting ID:",r.teams_meeting_id),!j){const O=await m(r.id);if(O&&O.transcript_content){console.log("Found saved transcript with content:",O),s(O),o(!1);return}}if(r.teams_meeting_id){if(console.log(`Starting enhanced Teams transcript extraction for: ${r.teams_meeting_id}`),!S||T){p("Microsoft account is not connected or token has expired. Please reconnect in Settings."),o(!1);return}if(!b){p("No Microsoft access token available. Please reconnect your Microsoft account in Settings."),o(!1);return}d(!0);try{const O=await x(r.id,r.teams_meeting_id);if(console.log("Enhanced Teams data received:",O),g(O),O)if(O.success&&O.hasContent&&O.transcriptContent){if(console.log("Enhanced processing successful, transcript content found..."),(I=(A=(M=O.attendees)==null?void 0:M.value)==null?void 0:A[0])!=null&&I.attendanceRecords)try{await _(r.id,O),console.log("Attendance tracked successfully from enhanced data")}catch(ne){console.warn("Failed to track attendance from enhanced data:",ne)}const L={content:O.transcriptContent,summary:"AI-generated summary will be available soon",actionItems:[],participants:((z=(Y=(X=O.attendees)==null?void 0:X.value)==null?void 0:Y[0])==null?void 0:z.attendanceRecords)||[],teamsTranscriptId:(F=(V=(U=O.transcript)==null?void 0:U.value)==null?void 0:V[0])==null?void 0:F.id},ie=await w(r.id,L);ie&&(s(ie),C({title:"Enhanced Transcript Extracted!",description:"Teams transcript has been successfully extracted using enhanced methods and saved."}))}else if(O.hasRecordings&&!O.hasContent)p("Meeting recording found but transcript is still being processed. This can take up to 24 hours after the meeting ends. The enhanced extraction will continue to monitor for availability.");else if(((G=(D=O.transcript)==null?void 0:D.value)==null?void 0:G.length)>0&&!O.hasContent)p("Transcript is available in Teams but content could not be extracted with enhanced methods. This may be due to processing delays or access restrictions.");else if(O.success===!1)p(O.error||"Enhanced extraction methods were unable to retrieve transcript from this meeting.");else{const L=O.foundWith?` (Found via: ${O.foundWith})`:"";p(`No transcript found for this meeting in Teams${L}. Enhanced extraction attempted multiple strategies but found no accessible transcript data.`)}else p("Enhanced extraction failed to connect to Teams or retrieve meeting data.")}catch(O){console.error("Enhanced Teams extraction error:",O),p(O.message||"Enhanced extraction methods failed to retrieve transcript from Teams.")}d(!1)}else p("This meeting was not created through Teams integration, so enhanced transcript extraction is not available.")}catch(O){console.error("Enhanced transcript loading error:",O),p("An unexpected error occurred during enhanced transcript extraction. Please try again."),d(!1)}finally{o(!1)}}};if(y.useEffect(()=>{e&&r&&E()},[e,r]),!r)return null;const P=!!r.teams_meeting_id;return i.jsx(Nt,{open:e,onOpenChange:t,children:i.jsxs(bt,{className:"sm:max-w-[800px] max-h-[90vh]",children:[i.jsxs(jt,{children:[i.jsxs(Et,{className:"flex items-center space-x-2",children:[i.jsx(tr,{className:"h-5 w-5"}),i.jsx("span",{children:"Enhanced Meeting Transcript & Notes"})]}),i.jsx($t,{children:r.title})]}),i.jsxs("div",{className:"space-y-4",children:[i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsxs("div",{className:"flex items-center space-x-4 text-sm text-gray-600",children:[i.jsxs("div",{className:"flex items-center space-x-1",children:[i.jsx(qr,{className:"h-4 w-4"}),i.jsx("span",{children:new Date(r.start_time).toLocaleDateString()})]}),(n==null?void 0:n.participants)&&i.jsxs("div",{className:"flex items-center space-x-1",children:[i.jsx(mr,{className:"h-4 w-4"}),i.jsxs("span",{children:[n.participants.length," participants"]})]}),P?i.jsxs(We,{variant:"outline",className:"flex items-center space-x-1",children:[i.jsx(as,{className:"h-3 w-3"}),i.jsx("span",{children:"Enhanced Teams Integration"})]}):i.jsxs(We,{variant:"secondary",className:"flex items-center space-x-1",children:[i.jsx(ea,{className:"h-3 w-3"}),i.jsx("span",{children:"No Teams Integration"})]}),!S&&i.jsxs(We,{variant:"destructive",className:"flex items-center space-x-1",children:[i.jsx(ea,{className:"h-3 w-3"}),i.jsx("span",{children:"Microsoft Disconnected"})]})]}),i.jsxs("div",{className:"flex space-x-2",children:[i.jsxs(ue,{variant:"outline",size:"sm",onClick:()=>E(!1),disabled:a||u,children:[i.jsx(os,{className:`h-4 w-4 mr-2 ${a||u?"animate-spin":""}`}),"Refresh"]}),P&&i.jsxs(ue,{variant:"outline",size:"sm",onClick:async()=>{T&&await N(),E(!0)},disabled:a||u,children:[i.jsx(os,{className:`h-4 w-4 mr-2 ${a||u?"animate-spin":""}`}),"Enhanced Extract"]}),n&&i.jsxs(i.Fragment,{children:[i.jsxs(ue,{variant:"outline",size:"sm",onClick:()=>{var Y,z;const j=new Date(r.end_time||r.start_time).toLocaleDateString("en-US",{year:"numeric",month:"2-digit",day:"2-digit"}).replace(/\//g,"-"),M=`
Meeting: ${r.title}
Date: ${new Date(r.start_time).toLocaleDateString()}
Duration: ${Math.round((new Date(r.end_time).getTime()-new Date(r.start_time).getTime())/(1e3*60))} minutes

SUMMARY:
${n.summary||"No summary available"}

PARTICIPANTS:
${((Y=n.participants)==null?void 0:Y.map(U=>{var V,F,D;return`- ${((V=U.identity)==null?void 0:V.displayName)||((D=(F=U.identity)==null?void 0:F.user)==null?void 0:D.displayName)||U.emailAddress||"Unknown"}`}).join(`
`))||"No participants listed"}

TRANSCRIPT:
${n.transcript_content||"No transcript content available"}

ACTION ITEMS:
${((z=n.action_items)==null?void 0:z.map((U,V)=>`${V+1}. ${U.text||U}`).join(`
`))||"No action items"}
                      `.trim(),A=new Blob([M],{type:"text/plain"}),I=URL.createObjectURL(A),X=document.createElement("a");X.href=I,X.download=`${r.title}_${j}_transcript.txt`,document.body.appendChild(X),X.click(),document.body.removeChild(X),URL.revokeObjectURL(I)},children:[i.jsx(js,{className:"h-4 w-4 mr-2"}),"Download"]}),i.jsxs(ue,{variant:"outline",size:"sm",onClick:async()=>{if(!(!n||!r)){c(!0);try{await v(n,r.title,r.end_time)&&C({title:"Success",description:"Transcript has been saved to ISKCON Repository > Meeting Transcripts"})}catch(j){console.error("Error saving to documents:",j),C({title:"Error",description:"Failed to save transcript to documents",variant:"destructive"})}finally{c(!1)}}},disabled:l,children:[i.jsx(m1,{className:"h-4 w-4 mr-2"}),l?"Saving...":"Save to Repository"]})]})]})]}),(a||u)&&i.jsxs("div",{className:"text-center py-8",children:[i.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary mx-auto mb-4"}),i.jsx("p",{className:"text-gray-600",children:u?"Running enhanced transcript extraction with multiple strategies...":"Loading transcript..."}),u&&i.jsxs("div",{className:"text-sm text-gray-500 mt-2 space-y-1",children:[i.jsx("p",{children:" Searching through online meetings and calendar events"}),i.jsx("p",{children:" Checking call records and meeting recordings"}),i.jsx("p",{children:" Attempting multiple transcript extraction methods"}),i.jsx("p",{children:" Processing various content formats (VTT, plain text, JSON)"}),i.jsx("p",{children:" Progressive retry with intelligent backoff"})]})]}),f&&i.jsx("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-4",children:i.jsxs("div",{className:"flex items-start space-x-2",children:[i.jsx(ea,{className:"h-5 w-5 text-yellow-600 mt-0.5"}),i.jsxs("div",{className:"flex-1",children:[i.jsx("h3",{className:"font-semibold text-yellow-800",children:"Enhanced Transcript Extraction Result"}),i.jsx("p",{className:"text-yellow-700 text-sm mt-1",children:f}),h&&i.jsxs("div",{className:"mt-3 text-xs text-yellow-600 bg-yellow-100 p-2 rounded",children:[i.jsx("p",{children:i.jsx("strong",{children:"Enhanced Extraction Details:"})}),h.foundWith&&i.jsxs("p",{children:["Meeting discovered via: ",h.foundWith]}),h.transcriptMethod&&i.jsxs("p",{children:["Transcript method used: ",h.transcriptMethod]}),h.hasRecordings&&i.jsx("p",{children:"Recordings found: Yes"}),((R=h.extractionDetails)==null?void 0:R.strategiesAttempted)&&i.jsxs("p",{children:["Strategies attempted: ",h.extractionDetails.strategiesAttempted.join(", ")]}),h.suggestion&&i.jsxs("div",{className:"mt-2",children:[i.jsx("p",{children:i.jsx("strong",{children:"Suggestion:"})}),i.jsx("p",{children:h.suggestion})]})]}),i.jsxs("div",{className:"mt-3 text-sm text-yellow-700",children:[i.jsx("p",{children:i.jsx("strong",{children:"Enhanced extraction capabilities:"})}),i.jsxs("ul",{className:"list-disc list-inside mt-1 space-y-1",children:[i.jsx("li",{children:"Multiple transcript API endpoints (v1.0 and beta)"}),i.jsx("li",{children:"Advanced meeting discovery across calendar and calls"}),i.jsx("li",{children:"Call records and recording metadata analysis"}),i.jsx("li",{children:"Multiple content format processing (VTT, text, JSON)"}),i.jsx("li",{children:"Progressive retry with intelligent backoff"})]})]})]})]})}),!a&&!u&&!n&&!f&&i.jsxs("div",{className:"text-center py-8 text-gray-500",children:[i.jsx(tr,{className:"h-12 w-12 mx-auto mb-4 opacity-20"}),i.jsx("p",{children:"No transcript available for this meeting"}),P?i.jsxs("div",{className:"text-sm mt-2 space-y-1",children:[i.jsx("p",{children:"This meeting has Teams integration but no transcript was found."}),i.jsx("p",{children:'Try the "Enhanced Extract" button to attempt comprehensive extraction.'})]}):i.jsx("p",{className:"text-sm mt-2",children:"This meeting was not created through Teams integration."})]}),n&&i.jsx(Xw,{className:"max-h-[500px]",children:i.jsxs("div",{className:"space-y-6",children:[n.summary&&i.jsxs("div",{children:[i.jsx("h3",{className:"font-semibold text-gray-900 mb-2",children:"Summary"}),i.jsx("div",{className:"bg-blue-50 p-4 rounded-lg",children:i.jsx("p",{className:"text-gray-700",children:n.summary})})]}),n.participants&&n.participants.length>0&&i.jsxs("div",{children:[i.jsx("h3",{className:"font-semibold text-gray-900 mb-2",children:"Participants"}),i.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-2",children:n.participants.map((j,M)=>{var A,I,X;return i.jsx(We,{variant:"outline",children:((A=j.identity)==null?void 0:A.displayName)||((X=(I=j.identity)==null?void 0:I.user)==null?void 0:X.displayName)||j.emailAddress||`Participant ${M+1}`},M)})})]}),n.action_items&&n.action_items.length>0&&i.jsxs("div",{children:[i.jsx("h3",{className:"font-semibold text-gray-900 mb-2",children:"Action Items"}),i.jsx("div",{className:"space-y-2",children:n.action_items.map((j,M)=>i.jsxs("div",{className:"flex items-start space-x-2",children:[i.jsxs("span",{className:"text-sm text-gray-500 mt-1",children:[M+1,"."]}),i.jsx("span",{className:"text-sm",children:j.text||j})]},M))})]}),i.jsx(aD,{}),n.transcript_content&&i.jsxs("div",{children:[i.jsx("h3",{className:"font-semibold text-gray-900 mb-2",children:"Full Transcript"}),i.jsx("div",{className:"bg-gray-50 p-4 rounded-lg",children:i.jsx("pre",{className:"whitespace-pre-wrap text-sm text-gray-700 font-sans",children:n.transcript_content})})]})]})})]})]})})},Hee=()=>{const[e,t]=y.useState(!1),[r,n]=y.useState(null),{user:s}=kt(),{toast:a}=St(),o=y.useCallback(async()=>{var c,u;if(!s){a({title:"Authentication Required",description:"Please sign in to sync meetings",variant:"destructive"});return}t(!0);try{console.log("Starting Outlook meetings sync...");const{data:d,error:f}=await he.functions.invoke("sync-outlook-meetings",{body:{user_id:s.id}});if(f)throw new Error(f.message);if(d!=null&&d.error)throw new Error(d.error);const{syncedCount:p,skippedCount:h,totalFound:g}=d;n(new Date),p>0?a({title:"Meetings Synced!",description:`Successfully imported ${p} meeting${p!==1?"s":""} from Outlook. ${h} already existed.`}):g===0&&a({title:"No Meetings Found",description:"No upcoming meetings found in your Outlook calendar."}),console.log(`Sync completed: ${p} synced, ${h} skipped, ${g} total`)}catch(d){console.error("Sync failed:",d);let f="Failed to sync meetings from Outlook";(c=d.message)!=null&&c.includes("Microsoft account not connected")?f="Microsoft account not connected. Please connect your account in Settings.":(u=d.message)!=null&&u.includes("Failed to fetch meetings")&&(f="Unable to access your Outlook calendar. Please check your Microsoft account connection."),a({title:"Sync Failed",description:f,variant:"destructive"})}finally{t(!1)}},[s,a]),l=y.useCallback(async()=>{r&&Date.now()-r.getTime()<5*60*1e3||await o()},[o,r]);return y.useEffect(()=>{s&&(console.log("Auto-syncing meetings on mount..."),l())},[s,l]),y.useEffect(()=>{if(!s)return;const c=setInterval(()=>{console.log("Auto-syncing meetings (periodic)..."),l()},10*60*1e3);return()=>clearInterval(c)},[s,l]),{syncing:e,lastSyncTime:r,syncOutlookMeetings:o,autoSync:l}},Gee=()=>{var de;const[e,t]=y.useState(null),[r,n]=y.useState(!1),[s,a]=y.useState(!1),[o,l]=y.useState(!1),[c,u]=y.useState(!1),[d,f]=y.useState(!1),[p,h]=y.useState(!1),[g,m]=y.useState(null),[x,w]=y.useState(void 0),[v,_]=y.useState(""),[b,S]=y.useState("upcoming"),[T,N]=y.useState(null),[C,E]=y.useState(null),P=yl(),{user:R}=kt(),{toast:j}=St(),{userRole:M,isSuperAdmin:A,isAdmin:I,canDeleteMeetings:X,canScheduleMeetings:Y}=ua(),{profile:z}=Df(),{syncing:U,lastSyncTime:V,syncOutlookMeetings:F}=Hee(),{meetings:D,loading:G,deleteMeeting:O,fetchMeetings:L,isDeletingMeeting:ie}=_l(),ne=(de=P.state)==null?void 0:de.highlightMeetingId,me=(Q,fe="")=>Q??fe,pe=Q=>{if(!Q)return new Date(0);const fe=new Date(Q);return isNaN(fe.getTime())?new Date(0):fe};y.useEffect(()=>{if(ne){t(ne);const Q=document.getElementById(`meeting-card-${ne}`);Q&&Q.scrollIntoView({behavior:"smooth",block:"center"});const fe=setTimeout(()=>t(null),2e3);return()=>clearTimeout(fe)}},[ne]),y.useEffect(()=>{if(!U&&V){const Q=setTimeout(()=>{L()},1e3);return()=>clearTimeout(Q)}},[U,V,L]),y.useEffect(()=>{C&&ie(C)&&E(null)},[C,ie]);const xe=new Date,Ae=y.useMemo(()=>!D||!Array.isArray(D)?[]:D.filter(Ce=>Ce&&Ce.id).reduce((Ce,Ne)=>(Ne&&(Ce.some(it=>it&&Ne.outlook_event_id&&it.outlook_event_id===Ne.outlook_event_id||it&&Ne.teams_meeting_id&&it.teams_meeting_id===Ne.teams_meeting_id||it&&it.id===Ne.id)||Ce.push(Ne)),Ce),[]),[D]),ge=y.useMemo(()=>{if(!Ae||Ae.length===0)return[];let Q=Ae;return b==="upcoming"?Q=Q.filter(fe=>!fe||!fe.start_time?!1:pe(fe.start_time)>=xe):b==="past"&&(Q=Q.filter(fe=>!fe||!fe.start_time?!1:pe(fe.start_time)<xe)),v.trim()&&(Q=Q.filter(fe=>!fe||!fe.title?!1:fe.title.toLowerCase().includes(v.toLowerCase()))),b==="upcoming"?Q.sort((fe,Ce)=>!fe||!Ce||!fe.start_time||!Ce.start_time?0:xc(pe(fe.start_time),pe(Ce.start_time))):Q.sort((fe,Ce)=>!fe||!Ce||!fe.start_time||!Ce.start_time?0:RU(pe(fe.start_time),pe(Ce.start_time)))},[Ae,b,v,xe]),je=Q=>{E(C===Q?null:Q)},k=Q=>{m(Q),a(!0)},le=Q=>{m(Q),h(!0)},ce=Q=>{m(Q),u(!0)},H=Q=>{m(Q),f(!0)},K=async(Q,fe)=>{if(!X){j({title:"Access Denied",description:"You don't have permission to delete meetings",variant:"destructive"});return}if(ie(Q)){j({title:"Already Deleting",description:"This meeting is already being deleted",variant:"destructive"});return}await O(Q,A,I)},oe=Q=>{n(!1),w(void 0),Q&&setTimeout(()=>{L()},500)},W=async()=>{if(!U){if(!(z!=null&&z.microsoft_access_token)){j({title:"Microsoft Account Required",description:"Please connect your Microsoft account in Settings to sync meetings.",variant:"destructive"});return}await F()}},J=(Q,fe)=>{const Ce=pe(Q),Ne=pe(fe),Xe=Math.round((Ne.getTime()-Ce.getTime())/(1e3*60)),it=Math.floor(Xe/60),at=Xe%60;let ht="";return it>0&&(ht+=`${it}h `),at>0&&(ht+=`${at}m`),{date:vt(Ce,"MMM dd, yyyy"),time:vt(Ce,"h:mm a"),duration:ht.trim()||"0m"}},B=Q=>{if(!Q.start_time||!Q.end_time)return!1;const fe=new Date,Ce=pe(Q.start_time),Ne=pe(Q.end_time);return fe>=Ce&&fe<=Ne},ae=Q=>{if(!Q.start_time||!Q.end_time)return!1;const fe=new Date,Ce=pe(Q.start_time),Ne=pe(Q.end_time),Xe=new Date(Ce.getTime()-60*60*1e3);return fe>=Xe&&fe<=Ne};return G?i.jsx("div",{className:"flex items-center justify-center h-64",children:i.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary"})}):!Ae||Ae.length===0?i.jsx("div",{className:"max-w-5xl mx-auto px-4 py-12",children:i.jsxs("div",{className:"text-center text-muted-foreground",children:[i.jsx("h3",{className:"text-lg font-semibold mb-2",children:"No meetings found"}),i.jsx("p",{className:"text-sm",children:"Create your first meeting or sync with Outlook to get started."})]})}):i.jsxs("div",{className:"max-w-5xl mx-auto px-4 space-y-6",children:[i.jsxs("div",{className:"flex flex-col md:flex-row md:items-center md:justify-between gap-4 mb-4",children:[i.jsxs("div",{className:"flex gap-2",children:[i.jsx(ue,{variant:b==="all"?"default":"ghost",size:"sm",onClick:()=>S("all"),children:"All"}),i.jsx(ue,{variant:b==="past"?"default":"ghost",size:"sm",onClick:()=>S("past"),children:"Past"}),i.jsx(ue,{variant:b==="upcoming"?"default":"ghost",size:"sm",onClick:()=>S("upcoming"),children:"Upcoming"})]}),i.jsxs("div",{className:"relative w-full max-w-xs flex gap-2 items-center",children:[i.jsx(Ep,{type:"text",placeholder:"Search meetings...",value:v,onChange:Q=>_(Q.target.value),className:"w-full"}),(z==null?void 0:z.microsoft_access_token)&&i.jsxs(ue,{variant:"outline",size:"sm",onClick:W,disabled:U,className:"min-w-[120px] flex items-center gap-2",children:[i.jsx(os,{className:U?"animate-spin h-4 w-4":"h-4 w-4"}),U?"Syncing...":"Sync Outlook"]})]})]}),i.jsx("div",{className:"space-y-4",children:ge.length===0?i.jsx("div",{className:"text-center text-muted-foreground py-12",children:"No meetings found matching your criteria."}):ge.map(Q=>{if(!Q)return null;const fe=J(me(Q.start_time,""),me(Q.end_time,"")),Ce=Q.start_time?pe(Q.start_time)<xe:!1,Ne=!Ce&&B(Q),Xe=!Ce&&ae(Q),it=typeof Q.attendee_count=="number"?Q.attendee_count:Array.isArray(Q.attendees)?Q.attendees.length:0,at=ie(Q.id),ht=C===Q.id,Ke=X&&(M==="super_admin"||M==="admin"||Q.created_by===(R==null?void 0:R.id));return i.jsxs(Ye,{className:`w-full hover:shadow-md transition-shadow relative ${at?"opacity-50 pointer-events-none":""} ${e===Q.id?"ring-2 ring-primary":""}`,id:`meeting-card-${Q.id}`,children:[at&&i.jsx("div",{className:"absolute inset-0 bg-white/70 flex items-center justify-center z-10",children:i.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary"})}),i.jsxs(ct,{className:"pb-4 flex flex-row items-center gap-4 cursor-pointer",onClick:()=>je(Q.id),children:[i.jsxs("div",{className:"flex-1 min-w-0",children:[i.jsxs(ft,{className:"text-lg flex flex-wrap items-center gap-2",children:[i.jsx("span",{className:"break-words leading-tight",children:me(Q.title,"Untitled")}),Q.meeting_id&&i.jsx("span",{className:"ml-2 px-2 py-0.5 rounded bg-blue-100 text-blue-800 font-mono text-xs border border-blue-300",children:Q.meeting_id}),Ne&&i.jsx(We,{className:"bg-red-500 text-white animate-pulse shrink-0",children:"LIVE"}),Q.meeting_type&&i.jsx(We,{className:"bg-gray-200 text-gray-800 shrink-0 capitalize",children:Q.meeting_type}),Q.teams_join_url&&i.jsx(We,{className:"bg-blue-500 text-white shrink-0",children:"Teams"}),Ce&&i.jsx(We,{className:"bg-gray-100 text-gray-800",variant:"secondary",children:"Completed"})]}),Q.created_at&&i.jsxs("div",{className:"text-xs text-gray-500 mt-1",children:["Created: ",vt(new Date(Q.created_at),"MMM dd, yyyy, h:mm a")]}),i.jsxs("div",{className:"flex items-center space-x-2 text-gray-600 mt-1",children:[i.jsx(en,{className:"h-4 w-4 shrink-0"}),i.jsxs("span",{className:"text-sm font-medium",children:[fe.date," at ",fe.time]}),i.jsxs("span",{className:"text-xs text-gray-500",children:["(",fe.duration,")"]})]}),i.jsxs("div",{className:"flex items-center space-x-2 text-gray-600 mt-1",children:[i.jsx(mr,{className:"h-4 w-4 shrink-0"}),i.jsxs("span",{className:"text-sm",children:[it," attendees"]})]}),i.jsxs("div",{className:"text-xs text-gray-500 mt-1",children:["Created by: ",Q.created_by_name||Q.created_by]})]}),i.jsx(ue,{variant:"ghost",size:"icon",onClick:Bt=>{Bt.stopPropagation(),je(Q.id)},children:ht?i.jsx(lk,{className:"h-5 w-5"}):i.jsx(Pa,{className:"h-5 w-5"})})]}),ht&&i.jsxs(Je,{className:"space-y-4",children:[i.jsxs("div",{className:"flex flex-wrap gap-2 mb-2",children:[Q.teams_join_url&&i.jsx(ue,{variant:"default",size:"sm",asChild:!0,disabled:at,className:"bg-blue-600 hover:bg-blue-700 text-white min-h-[40px]",children:i.jsxs("a",{href:Q.teams_join_url,target:"_blank",rel:"noopener noreferrer",children:[i.jsx(ra,{className:"h-4 w-4 mr-2"})," Join Teams Meeting"]})}),Xe&&i.jsxs(ue,{variant:"outline",size:"sm",onClick:()=>ce(Q),disabled:at,className:"bg-green-50 hover:bg-green-100 text-green-700 min-h-[40px]",children:[i.jsx(sl,{className:"h-4 w-4 mr-2"})," Check In"]}),i.jsxs(ue,{variant:"outline",size:"sm",onClick:()=>k(Q),className:"min-h-[40px]",children:[i.jsx(tr,{className:"h-4 w-4 mr-2"})," Agenda"]}),Q.teams_meeting_id?i.jsx(ue,{asChild:!0,variant:"outline",size:"sm",className:"min-h-[40px]",children:i.jsxs("a",{href:`https://teams.microsoft.com/l/meetingTranscript/${Q.teams_meeting_id}`,target:"_blank",rel:"noopener noreferrer",children:[i.jsx(tr,{className:"h-4 w-4 mr-2"})," Transcript"]})}):i.jsxs(ue,{variant:"outline",size:"sm",onClick:()=>le(Q),className:"min-h-[40px]",children:[i.jsx(tr,{className:"h-4 w-4 mr-2"})," Transcript"]}),Q.rsvp_enabled&&i.jsxs(ue,{variant:"outline",size:"sm",onClick:()=>H(Q),className:"min-h-[40px]",children:[i.jsx(uk,{className:"h-4 w-4 mr-2"})," RSVP"]}),Ke&&i.jsxs(H1,{children:[i.jsx(LT,{asChild:!0,children:i.jsx(ue,{variant:"destructive",size:"sm",disabled:at,className:"min-h-[40px]",children:at?i.jsxs("span",{className:"flex items-center",children:[i.jsx("span",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white mr-2"}),"Deleting..."]}):i.jsxs(i.Fragment,{children:[i.jsx(yr,{className:"h-4 w-4 mr-2"})," Delete"]})})}),i.jsxs(vp,{children:[i.jsxs(yp,{children:[i.jsx(_p,{children:"Delete Meeting Everywhere?"}),i.jsxs(bp,{children:["This will delete the meeting from the portal, Outlook, Teams, and all related data (attendees, attachments, transcripts). Are you sure you want to proceed?",i.jsx("br",{}),i.jsx("span",{className:"text-xs text-red-600 font-semibold",children:"If your Microsoft connection is missing or expired, the meeting may not be deleted from Outlook/Teams. You may be prompted to reconnect."})]})]}),i.jsxs(wp,{children:[i.jsx(Np,{children:"Cancel"}),i.jsx(Sp,{onClick:()=>K(Q.id,Q.title||"Untitled"),disabled:at,children:"Yes, Delete Everywhere"})]})]})]}),(M==="admin"||M==="super_admin")&&i.jsxs(ue,{variant:"outline",size:"sm",onClick:()=>N(Q),className:"min-h-[40px]",children:[i.jsx(AF,{className:"h-4 w-4 mr-1"})," Edit"]})]}),i.jsx("div",{className:"text-sm text-muted-foreground mb-2",style:{whiteSpace:"pre-line"},children:me(Q.description,"No description provided")})]})]},Q.id)})}),Y&&i.jsx(ue,{onClick:()=>n(!0),className:"fixed bottom-8 right-8 z-50 rounded-full shadow-lg bg-[#8E1616] hover:bg-[#7A1414] text-white w-16 h-16 flex items-center justify-center text-3xl",children:i.jsx(Pa,{className:"h-8 w-8"})}),Y&&i.jsx(QS,{open:r,onOpenChange:oe,preselectedDate:x}),i.jsx(lP,{open:s,onOpenChange:a,meeting:g}),i.jsx(See,{open:o,onOpenChange:l,meeting:g}),i.jsx(Nee,{open:c,onOpenChange:u,meeting:g}),i.jsx(Eee,{open:d,onOpenChange:f,meeting:g}),i.jsx(Wee,{open:p,onOpenChange:h,meeting:g}),i.jsx(QS,{open:!!T,onOpenChange:(Q,fe)=>{N(Q?T:null),fe&&setTimeout(()=>{L()},1e3)},meetingToEdit:T})]})};var qp="Switch",[qee,hse]=Fr(qp),[Yee,Kee]=qee(qp),iD=y.forwardRef((e,t)=>{const{__scopeSwitch:r,name:n,checked:s,defaultChecked:a,required:o,disabled:l,value:c="on",onCheckedChange:u,form:d,...f}=e,[p,h]=y.useState(null),g=st(t,_=>h(_)),m=y.useRef(!1),x=p?d||!!p.closest("form"):!0,[w,v]=Hn({prop:s,defaultProp:a??!1,onChange:u,caller:qp});return i.jsxs(Yee,{scope:r,checked:w,disabled:l,children:[i.jsx(ze.button,{type:"button",role:"switch","aria-checked":w,"aria-required":o,"data-state":uD(w),"data-disabled":l?"":void 0,disabled:l,value:c,...f,ref:g,onClick:Oe(e.onClick,_=>{v(b=>!b),x&&(m.current=_.isPropagationStopped(),m.current||_.stopPropagation())})}),x&&i.jsx(cD,{control:p,bubbles:!m.current,name:n,value:c,checked:w,required:o,disabled:l,form:d,style:{transform:"translateX(-100%)"}})]})});iD.displayName=qp;var oD="SwitchThumb",lD=y.forwardRef((e,t)=>{const{__scopeSwitch:r,...n}=e,s=Kee(oD,r);return i.jsx(ze.span,{"data-state":uD(s.checked),"data-disabled":s.disabled?"":void 0,...n,ref:t})});lD.displayName=oD;var Xee="SwitchBubbleInput",cD=y.forwardRef(({__scopeSwitch:e,control:t,checked:r,bubbles:n=!0,...s},a)=>{const o=y.useRef(null),l=st(o,a),c=Rw(r),u=j1(t);return y.useEffect(()=>{const d=o.current;if(!d)return;const f=window.HTMLInputElement.prototype,h=Object.getOwnPropertyDescriptor(f,"checked").set;if(c!==r&&h){const g=new Event("click",{bubbles:n});h.call(d,r),d.dispatchEvent(g)}},[c,r,n]),i.jsx("input",{type:"checkbox","aria-hidden":!0,defaultChecked:r,...s,tabIndex:-1,ref:l,style:{...s.style,...u,position:"absolute",pointerEvents:"none",opacity:0,margin:0}})});cD.displayName=Xee;function uD(e){return e?"checked":"unchecked"}var dD=iD,Qee=lD;const ws=y.forwardRef(({className:e,...t},r)=>i.jsx(dD,{className:De("peer inline-flex h-6 w-11 shrink-0 cursor-pointer items-center rounded-full border-2 border-transparent transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 focus-visible:ring-offset-background disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=unchecked]:bg-input",e),...t,ref:r,children:i.jsx(Qee,{className:De("pointer-events-none block h-5 w-5 rounded-full bg-background shadow-lg ring-0 transition-transform data-[state=checked]:translate-x-5 data-[state=unchecked]:translate-x-0")})}));ws.displayName=dD.displayName;const xu=()=>{const[e,t]=y.useState([]),[r,n]=y.useState(!0),{user:s}=kt(),a=y.useRef(!1),o=async()=>{try{n(!0),await l();const{data:_,error:b}=await he.from("polls").select(`
          *,
          unique_id,
          sub_polls (*),
          poll_attachments (*)
        `).order("created_at",{ascending:!1});if(b)throw b;const S=await Promise.all(_.map(async T=>{const{data:N}=await he.rpc("get_poll_stats",{poll_id_param:T.id});return{id:T.id,title:T.title,description:T.description??null,deadline:T.deadline??null,status:T.status,is_secret:T.is_secret,notify_members:T.notify_members,created_by:T.created_by,created_at:T.created_at,updated_at:T.updated_at,reopen_deadline:T.reopen_deadline??void 0,sub_polls:T.sub_polls||[],attachments:T.poll_attachments||[],stats:(N==null?void 0:N[0])||{total_voters:0,voted_count:0,pending_count:0,sub_poll_count:0},unique_id:T.unique_id??void 0}}));if(s)for(const T of S){const{data:N}=await he.from("poll_votes").select("id").eq("poll_id",T.id).eq("user_id",s.id).limit(1);T.hasVoted=!!(N&&N.length>0)}t(S)}catch(_){console.error("Error fetching polls:",_),gt.error("Failed to fetch polls")}finally{n(!1)}},l=async()=>{try{const{error:_}=await he.rpc("auto_close_reopened_polls");if(_)throw _}catch(_){console.error("Error auto-closing expired polls:",_)}},c=async _=>{if(!s)return gt.error("You must be logged in to create a poll"),null;try{const{data:b,error:S}=await he.from("polls").insert({title:_.title,description:_.description,deadline:_.deadline,notify_members:_.notify_members,created_by:s.id,unique_id:_.unique_id}).select().single();if(S)throw S;const T=_.subPolls.filter(N=>N.title.trim()).map((N,C)=>({poll_id:b.id,title:N.title,description:N.description,order_index:C}));if(T.length>0){const{error:N}=await he.from("sub_polls").insert(T);if(N)throw N}return _.attachment&&await d(b.id,_.attachment),_.notify_members&&await p(b.id),gt.success("Poll created successfully"),await o(),b}catch(b){return console.error("Error creating poll:",b),gt.error("Failed to create poll"),null}},u=async(_,b)=>{if(!s)return gt.error("You must be logged in to update a poll"),!1;try{const{error:S}=await he.from("polls").update({title:b.title,description:b.description,deadline:b.deadline,updated_at:new Date().toISOString()}).eq("id",_);if(S)throw S;for(const T of b.subPolls){const{error:N}=await he.from("sub_polls").update({title:T.title,description:T.description}).eq("id",T.id);if(N)throw N}return gt.success("Poll updated successfully"),await o(),!0}catch(S){return console.error("Error updating poll:",S),gt.error("Failed to update poll"),!1}},d=async(_,b)=>{if(!s)return null;try{await f();const S=b.name.split(".").pop(),T=`${Date.now()}.${S}`,N=`${_}/${T}`;console.log("Uploading file to storage:",N);const{error:C}=await he.storage.from("poll-attachments").upload(N,b);if(C)throw console.error("Upload error:",C),C;const{data:{publicUrl:E}}=he.storage.from("poll-attachments").getPublicUrl(N);console.log("File uploaded successfully, public URL:",E);const{error:P}=await he.from("poll_attachments").insert({poll_id:_,file_name:b.name,file_path:E,file_size:b.size,mime_type:b.type,uploaded_by:s.id});if(P)throw console.error("Database error:",P),P;return N}catch(S){return console.error("Error uploading attachment:",S),gt.error("Failed to upload attachment"),null}},f=async()=>{try{const{data:_,error:b}=await he.storage.listBuckets();if(b){console.error("Error listing buckets:",b);return}if(!(_==null?void 0:_.some(T=>T.id==="poll-attachments"))){console.log("Creating poll-attachments bucket...");const{error:T}=await he.storage.createBucket("poll-attachments",{public:!0,fileSizeLimit:52428800,allowedMimeTypes:["application/pdf","application/msword","application/vnd.openxmlformats-officedocument.wordprocessingml.document","application/vnd.ms-excel","application/vnd.openxmlformats-officedocument.spreadsheetml.sheet","application/vnd.ms-powerpoint","application/vnd.openxmlformats-officedocument.presentationml.presentation","image/jpeg","image/png","image/gif","image/webp","text/plain"]});T?console.error("Error creating bucket:",T):console.log("Poll-attachments bucket created successfully")}}catch(_){console.error("Error ensuring bucket exists:",_)}},p=async _=>{try{const{error:b}=await he.functions.invoke("send-poll-notifications",{body:{pollId:_,notificationType:"initial"}});if(b)throw b}catch(b){console.error("Error sending notifications:",b)}},h=async _=>{try{const{error:b}=await he.from("polls").delete().eq("id",_);if(b)throw b;gt.success("Poll deleted successfully"),await o()}catch(b){console.error("Error deleting poll:",b),gt.error("Failed to delete poll")}},g=async(_,b)=>{try{const{error:S}=await he.from("polls").update({status:b,updated_at:new Date().toISOString()}).eq("id",_);if(S)throw S;gt.success(`Poll ${b==="completed"?"completed":b} successfully`),await o()}catch(S){console.error("Error updating poll status:",S),gt.error("Failed to update poll status")}},m=async(_,b)=>{try{if(console.log("Downloading attachment:",{filePath:_,fileName:b}),_.includes("supabase.co/storage")||_.includes("/storage/v1/object/public/")){console.log("Using direct download from public URL");const N=document.createElement("a");N.href=_,N.download=b,N.target="_blank",N.rel="noopener noreferrer",document.body.appendChild(N),N.click(),document.body.removeChild(N),gt.success(`Download started: ${b}`);return}console.log("Constructing public URL for legacy path");const{data:{publicUrl:S}}=he.storage.from("poll-attachments").getPublicUrl(_);console.log("Constructed public URL:",S);const T=document.createElement("a");T.href=S,T.download=b,T.target="_blank",T.rel="noopener noreferrer",document.body.appendChild(T),T.click(),document.body.removeChild(T),gt.success(`Download started: ${b}`)}catch(S){console.error("Error downloading attachment:",S),gt.error("Failed to download attachment")}},x=async(_,b)=>{try{const{error:S}=await he.rpc("reset_user_poll_votes",{poll_id_param:_,user_id_param:b});if(S)throw S;gt.success("User votes reset successfully"),await o()}catch(S){console.error("Error resetting user votes:",S),gt.error("Failed to reset user votes")}},w=async _=>{try{const{error:b}=await he.rpc("reset_all_poll_votes",{poll_id_param:_});if(b)throw b;gt.success("All votes reset successfully"),await o()}catch(b){console.error("Error resetting all votes:",b),gt.error("Failed to reset all votes")}},v=_=>{a.current=_};return y.useEffect(()=>{o();const _=setInterval(()=>{a.current||o()},30*1e3);return()=>clearInterval(_)},[]),{polls:e,loading:r,createPoll:c,updatePoll:u,deletePoll:h,updatePollStatus:g,downloadAttachment:m,resetUserVotes:x,resetAllVotes:w,refetch:o,setPollingPaused:v}};var Yp="Collapsible",[Jee,fD]=Fr(Yp),[Zee,Qw]=Jee(Yp),hD=y.forwardRef((e,t)=>{const{__scopeCollapsible:r,open:n,defaultOpen:s,disabled:a,onOpenChange:o,...l}=e,[c,u]=Hn({prop:n,defaultProp:s??!1,onChange:o,caller:Yp});return i.jsx(Zee,{scope:r,disabled:a,contentId:Er(),open:c,onOpenToggle:y.useCallback(()=>u(d=>!d),[u]),children:i.jsx(ze.div,{"data-state":Zw(c),"data-disabled":a?"":void 0,...l,ref:t})})});hD.displayName=Yp;var mD="CollapsibleTrigger",pD=y.forwardRef((e,t)=>{const{__scopeCollapsible:r,...n}=e,s=Qw(mD,r);return i.jsx(ze.button,{type:"button","aria-controls":s.contentId,"aria-expanded":s.open||!1,"data-state":Zw(s.open),"data-disabled":s.disabled?"":void 0,disabled:s.disabled,...n,ref:t,onClick:Oe(e.onClick,s.onOpenToggle)})});pD.displayName=mD;var Jw="CollapsibleContent",gD=y.forwardRef((e,t)=>{const{forceMount:r,...n}=e,s=Qw(Jw,e.__scopeCollapsible);return i.jsx(Ir,{present:r||s.open,children:({present:a})=>i.jsx(ete,{...n,ref:t,present:a})})});gD.displayName=Jw;var ete=y.forwardRef((e,t)=>{const{__scopeCollapsible:r,present:n,children:s,...a}=e,o=Qw(Jw,r),[l,c]=y.useState(n),u=y.useRef(null),d=st(t,u),f=y.useRef(0),p=f.current,h=y.useRef(0),g=h.current,m=o.open||l,x=y.useRef(m),w=y.useRef(void 0);return y.useEffect(()=>{const v=requestAnimationFrame(()=>x.current=!1);return()=>cancelAnimationFrame(v)},[]),gr(()=>{const v=u.current;if(v){w.current=w.current||{transitionDuration:v.style.transitionDuration,animationName:v.style.animationName},v.style.transitionDuration="0s",v.style.animationName="none";const _=v.getBoundingClientRect();f.current=_.height,h.current=_.width,x.current||(v.style.transitionDuration=w.current.transitionDuration,v.style.animationName=w.current.animationName),c(n)}},[o.open,n]),i.jsx(ze.div,{"data-state":Zw(o.open),"data-disabled":o.disabled?"":void 0,id:o.contentId,hidden:!m,...a,ref:d,style:{"--radix-collapsible-content-height":p?`${p}px`:void 0,"--radix-collapsible-content-width":g?`${g}px`:void 0,...e.style},children:m&&s})});function Zw(e){return e?"open":"closed"}var tte=hD,rte=pD,nte=gD,fa="Accordion",ste=["Home","End","ArrowDown","ArrowUp","ArrowLeft","ArrowRight"],[e_,ate,ite]=xf(fa),[Kp,mse]=Fr(fa,[ite,fD]),t_=fD(),xD=ke.forwardRef((e,t)=>{const{type:r,...n}=e,s=n,a=n;return i.jsx(e_.Provider,{scope:e.__scopeAccordion,children:r==="multiple"?i.jsx(ute,{...a,ref:t}):i.jsx(cte,{...s,ref:t})})});xD.displayName=fa;var[vD,ote]=Kp(fa),[yD,lte]=Kp(fa,{collapsible:!1}),cte=ke.forwardRef((e,t)=>{const{value:r,defaultValue:n,onValueChange:s=()=>{},collapsible:a=!1,...o}=e,[l,c]=Hn({prop:r,defaultProp:n??"",onChange:s,caller:fa});return i.jsx(vD,{scope:e.__scopeAccordion,value:ke.useMemo(()=>l?[l]:[],[l]),onItemOpen:c,onItemClose:ke.useCallback(()=>a&&c(""),[a,c]),children:i.jsx(yD,{scope:e.__scopeAccordion,collapsible:a,children:i.jsx(wD,{...o,ref:t})})})}),ute=ke.forwardRef((e,t)=>{const{value:r,defaultValue:n,onValueChange:s=()=>{},...a}=e,[o,l]=Hn({prop:r,defaultProp:n??[],onChange:s,caller:fa}),c=ke.useCallback(d=>l((f=[])=>[...f,d]),[l]),u=ke.useCallback(d=>l((f=[])=>f.filter(p=>p!==d)),[l]);return i.jsx(vD,{scope:e.__scopeAccordion,value:o,onItemOpen:c,onItemClose:u,children:i.jsx(yD,{scope:e.__scopeAccordion,collapsible:!0,children:i.jsx(wD,{...a,ref:t})})})}),[dte,Xp]=Kp(fa),wD=ke.forwardRef((e,t)=>{const{__scopeAccordion:r,disabled:n,dir:s,orientation:a="vertical",...o}=e,l=ke.useRef(null),c=st(l,t),u=ate(r),f=uu(s)==="ltr",p=Oe(e.onKeyDown,h=>{var C;if(!ste.includes(h.key))return;const g=h.target,m=u().filter(E=>{var P;return!((P=E.ref.current)!=null&&P.disabled)}),x=m.findIndex(E=>E.ref.current===g),w=m.length;if(x===-1)return;h.preventDefault();let v=x;const _=0,b=w-1,S=()=>{v=x+1,v>b&&(v=_)},T=()=>{v=x-1,v<_&&(v=b)};switch(h.key){case"Home":v=_;break;case"End":v=b;break;case"ArrowRight":a==="horizontal"&&(f?S():T());break;case"ArrowDown":a==="vertical"&&S();break;case"ArrowLeft":a==="horizontal"&&(f?T():S());break;case"ArrowUp":a==="vertical"&&T();break}const N=v%w;(C=m[N].ref.current)==null||C.focus()});return i.jsx(dte,{scope:r,disabled:n,direction:s,orientation:a,children:i.jsx(e_.Slot,{scope:r,children:i.jsx(ze.div,{...o,"data-orientation":a,ref:c,onKeyDown:n?void 0:p})})})}),b0="AccordionItem",[fte,r_]=Kp(b0),_D=ke.forwardRef((e,t)=>{const{__scopeAccordion:r,value:n,...s}=e,a=Xp(b0,r),o=ote(b0,r),l=t_(r),c=Er(),u=n&&o.value.includes(n)||!1,d=a.disabled||e.disabled;return i.jsx(fte,{scope:r,open:u,disabled:d,triggerId:c,children:i.jsx(tte,{"data-orientation":a.orientation,"data-state":kD(u),...l,...s,ref:t,disabled:d,open:u,onOpenChange:f=>{f?o.onItemOpen(n):o.onItemClose(n)}})})});_D.displayName=b0;var bD="AccordionHeader",SD=ke.forwardRef((e,t)=>{const{__scopeAccordion:r,...n}=e,s=Xp(fa,r),a=r_(bD,r);return i.jsx(ze.h3,{"data-orientation":s.orientation,"data-state":kD(a.open),"data-disabled":a.disabled?"":void 0,...n,ref:t})});SD.displayName=bD;var oy="AccordionTrigger",ND=ke.forwardRef((e,t)=>{const{__scopeAccordion:r,...n}=e,s=Xp(fa,r),a=r_(oy,r),o=lte(oy,r),l=t_(r);return i.jsx(e_.ItemSlot,{scope:r,children:i.jsx(rte,{"aria-disabled":a.open&&!o.collapsible||void 0,"data-orientation":s.orientation,id:a.triggerId,...l,...n,ref:t})})});ND.displayName=oy;var jD="AccordionContent",ED=ke.forwardRef((e,t)=>{const{__scopeAccordion:r,...n}=e,s=Xp(fa,r),a=r_(jD,r),o=t_(r);return i.jsx(nte,{role:"region","aria-labelledby":a.triggerId,"data-orientation":s.orientation,...o,...n,ref:t,style:{"--radix-accordion-content-height":"var(--radix-collapsible-content-height)","--radix-accordion-content-width":"var(--radix-collapsible-content-width)",...e.style}})});ED.displayName=jD;function kD(e){return e?"open":"closed"}var hte=xD,mte=_D,pte=SD,CD=ND,TD=ED;const gte=hte,AD=y.forwardRef(({className:e,...t},r)=>i.jsx(mte,{ref:r,className:De("border-b",e),...t}));AD.displayName="AccordionItem";const PD=y.forwardRef(({className:e,children:t,...r},n)=>i.jsx(pte,{className:"flex",children:i.jsxs(CD,{ref:n,className:De("flex flex-1 items-center justify-between py-4 font-medium transition-all hover:underline [&[data-state=open]>svg]:rotate-180",e),...r,children:[t,i.jsx(Zc,{className:"h-4 w-4 shrink-0 transition-transform duration-200"})]})}));PD.displayName=CD.displayName;const DD=y.forwardRef(({className:e,children:t,...r},n)=>i.jsx(TD,{ref:n,className:"overflow-hidden text-sm transition-all data-[state=closed]:animate-accordion-up data-[state=open]:animate-accordion-down",...r,children:i.jsx("div",{className:De("pb-4 pt-0",e),children:t})}));DD.displayName=TD.displayName;const xte=({open:e,onOpenChange:t})=>{const[r,n]=y.useState({title:"",description:"",deadline:"",notifyMembers:!0}),[s,a]=y.useState([{id:"1",title:"",description:""}]),[o,l]=y.useState(null),{createPoll:c}=xu(),[u,d]=y.useState(!1),[f,p]=y.useState(!1),[h,g]=y.useState(null),[m,x]=y.useState(""),[w,v]=y.useState(()=>{const P=new Date,R=P.getFullYear(),j=String(P.getMonth()+1).padStart(2,"0"),M=Math.floor(1e3+Math.random()*9e3);return`CR 1 / ${R} / ${j} / ${M}`}),_=()=>{const P={id:Date.now().toString(),title:"",description:""};a([...s,P])},b=P=>{s.length>1&&a(s.filter(R=>R.id!==P))},S=(P,R,j)=>{a(s.map(M=>M.id===P?{...M,[R]:j}:M))},T=P=>{var j;const R=(j=P.target.files)==null?void 0:j[0];R&&(["application/pdf","application/msword","application/vnd.openxmlformats-officedocument.wordprocessingml.document"].includes(R.type)?l(R):(alert("Please select a PDF, DOC, or DOCX file."),P.target.value=""))},N=()=>{l(null)},C=()=>{n({title:"",description:"",deadline:"",notifyMembers:!0}),a([{id:"1",title:"",description:""}]),l(null)},E=async P=>{if(P.preventDefault(),u)return;d(!0);const R=s.filter(A=>A.title.trim()!=="");if(R.length===0){alert("Please add at least one sub-poll with a title."),d(!1);return}let j="";if(h&&m){const[A,I]=m.split(":"),X=new Date(h);X.setHours(Number(A),Number(I),0,0),j=X.toISOString()}const M=await c({title:r.title,description:r.description,deadline:j,notify_members:r.notifyMembers,subPolls:R.map(A=>({title:A.title,description:A.description})),attachment:o||void 0,unique_id:w});d(!1),M?(t(!1),C(),g(null),x("")):gt.error("Failed to create poll. Please try again.")};return i.jsx(Nt,{open:e,onOpenChange:t,children:i.jsxs(bt,{className:"max-w-lg max-h-[80vh] overflow-y-auto bg-white pointer-events-auto px-6 sm:px-10 py-8",children:[i.jsx("button",{type:"button","aria-label":"Close",onClick:()=>t(!1),className:"absolute top-2 right-2 p-2 rounded hover:bg-gray-100 focus:outline-none z-20",children:i.jsx(Cn,{className:"h-5 w-5"})}),i.jsxs(jt,{children:[i.jsx(Et,{className:"text-2xl font-bold mb-1",children:"Create New Poll"}),i.jsx($t,{className:"mb-6 text-gray-600",children:"Create a new poll with multiple questions for committee voting"})]}),i.jsxs("form",{onSubmit:E,className:"space-y-6",children:[i.jsxs("div",{className:"mb-6 pb-6 border-b",children:[i.jsx("h3",{className:"text-lg font-bold mb-4",children:"Poll Details"}),i.jsxs("div",{className:"space-y-4",children:[i.jsxs("div",{children:[i.jsx(Ve,{htmlFor:"title",children:"Main Poll Title"}),i.jsx(dt,{id:"title",value:r.title,onChange:P=>n({...r,title:P.target.value}),placeholder:"Enter main poll title...",required:!0,className:"mt-2"})]}),i.jsxs("div",{children:[i.jsx(Ve,{htmlFor:"description",children:"Main Description"}),i.jsx(Ma,{id:"description",value:r.description,onChange:P=>n({...r,description:P.target.value}),placeholder:"Provide overall description of the poll...",rows:2,className:"mt-2"})]})]})]}),i.jsxs("div",{className:"mb-6 pb-6 border-b",children:[i.jsx("h3",{className:"text-lg font-bold mb-4",children:"Voting Deadline & Attachment"}),i.jsxs("div",{className:"space-y-4",children:[i.jsxs("div",{children:[i.jsx(Ve,{children:"Voting Deadline"}),i.jsxs("div",{className:"flex gap-2 mt-2",children:[i.jsxs(nf,{open:f,onOpenChange:p,children:[i.jsx(sf,{asChild:!0,children:i.jsxs(ue,{variant:"outline",className:De("w-40 justify-start text-left font-normal",!h&&"text-muted-foreground"),type:"button",children:[i.jsx(en,{className:"mr-2 h-4 w-4"}),h?vt(h,"PPP"):"Pick date"]})}),i.jsx(Gc,{className:"w-auto p-0",align:"start",children:i.jsx(rf,{mode:"single",selected:h||void 0,onSelect:P=>{g(P||null),p(!1)},initialFocus:!0,className:De("p-3 pointer-events-auto")})})]}),i.jsxs("select",{className:"border rounded px-2 py-1 w-28",value:m,onChange:P=>x(P.target.value),children:[i.jsx("option",{value:"",children:"Pick time"}),Array.from({length:24*4},(P,R)=>{const j=Math.floor(R/4).toString().padStart(2,"0"),M=(R%4*15).toString().padStart(2,"0");return i.jsx("option",{value:`${j}:${M}`,children:`${j}:${M}`},`${j}:${M}`)})]})]})]}),i.jsxs("div",{children:[i.jsx(Ve,{htmlFor:"attachment",children:"Supporting Document (Optional)"}),i.jsx("div",{className:"mt-2",children:o?i.jsx("div",{className:"border border-gray-300 rounded-lg p-2",children:i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsx("p",{className:"font-medium text-sm truncate max-w-[120px]",children:o.name}),i.jsx(ue,{type:"button",variant:"ghost",size:"sm",onClick:N,className:"text-red-500 hover:text-red-700",children:i.jsx(Cn,{className:"h-4 w-4"})})]})}):i.jsxs("div",{className:"border-2 border-dashed border-gray-300 rounded-lg p-4 text-center",children:[i.jsx(g1,{className:"h-8 w-8 text-gray-400 mx-auto mb-2"}),i.jsx("div",{className:"text-sm text-gray-600 mb-2",children:"Upload a supporting document (PDF, DOC, DOCX)"}),i.jsx("input",{type:"file",accept:".pdf,.doc,.docx",onChange:T,className:"hidden",id:"attachment-input"}),i.jsx(ue,{type:"button",variant:"outline",onClick:()=>{var P;return(P=document.getElementById("attachment-input"))==null?void 0:P.click()},children:"Choose File"})]})})]})]})]}),i.jsxs("div",{className:"mb-6 pb-6 border-b",children:[i.jsxs("div",{className:"flex items-center justify-between mb-4",children:[i.jsx("h3",{className:"text-lg font-bold",children:"Poll Questions"}),i.jsxs(ue,{type:"button",variant:"outline",size:"sm",onClick:_,children:[i.jsx(Pa,{className:"h-4 w-4 mr-2"}),"Add Question"]})]}),i.jsx(gte,{type:"single",collapsible:!0,className:"w-full",children:s.map((P,R)=>i.jsxs(AD,{value:P.id,className:"border-2 border-dashed border-gray-200 rounded mb-2",children:[i.jsxs(PD,{className:"flex items-center justify-between px-2 py-1",children:[i.jsxs("span",{className:"text-base font-medium",children:["Question ",R+1]}),s.length>1&&i.jsx(ue,{type:"button",variant:"ghost",size:"sm",onClick:j=>{j.stopPropagation(),b(P.id)},className:"text-red-500 hover:text-red-700 hover:bg-red-50 ml-2",children:i.jsx(yr,{className:"h-4 w-4"})})]}),i.jsx(DD,{className:"px-2 pb-2",children:i.jsxs("div",{className:"space-y-2",children:[i.jsxs("div",{children:[i.jsx(Ve,{htmlFor:`subpoll-title-${P.id}`,children:"Question Title *"}),i.jsx(dt,{id:`subpoll-title-${P.id}`,value:P.title,onChange:j=>S(P.id,"title",j.target.value),placeholder:"Enter the question...",required:!0,className:"mt-1"})]}),i.jsxs("div",{children:[i.jsx(Ve,{htmlFor:`subpoll-description-${P.id}`,children:"Question Description"}),i.jsx(Ma,{id:`subpoll-description-${P.id}`,value:P.description,onChange:j=>S(P.id,"description",j.target.value),placeholder:"Additional details about this question...",rows:2,className:"mt-1"})]}),i.jsx("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-2",children:i.jsxs("p",{className:"text-xs text-blue-800",children:["Members will vote: ",i.jsx("strong",{children:"For"}),", ",i.jsx("strong",{children:"Against"}),", or ",i.jsx("strong",{children:"Abstain"})," on this question"]})})]})})]},P.id))})]}),i.jsx("div",{className:"mb-6 pb-6 border-b",children:i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsxs("div",{children:[i.jsx(Ve,{htmlFor:"notify",children:"Notify Members"}),i.jsx("p",{className:"text-xs text-gray-500",children:"Send notification to all eligible voters"})]}),i.jsx(ws,{id:"notify",checked:r.notifyMembers,onCheckedChange:P=>n({...r,notifyMembers:P})})]})}),i.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:[i.jsx("h4",{className:"font-medium text-blue-900 mb-2",children:"Voting Rules"}),i.jsxs("ul",{className:"text-sm text-blue-800 space-y-1",children:[i.jsx("li",{children:" Members must vote on each question: For, Against, or Abstain"}),i.jsx("li",{children:" Votes cannot be changed once submitted"}),i.jsx("li",{children:" Each question is evaluated independently"}),i.jsx("li",{children:" Voting is anonymous - individual choices are hidden from other members"})]})]}),i.jsxs("div",{children:[i.jsx(Ve,{children:"Voting Unique ID"}),i.jsx(dt,{value:w,onChange:P=>v(P.target.value),placeholder:"CIRCULAR RESOLUTION 1 / YEAR / MONTH / UNIQUE IDENTIFIER",className:"mb-4"})]}),i.jsxs("div",{className:"flex justify-end space-x-2 pt-4",children:[i.jsx(ue,{type:"button",variant:"outline",onClick:()=>t(!1),children:"Cancel"}),i.jsx(ue,{type:"submit",className:"bg-red-700 hover:bg-red-800 text-white",disabled:u,children:u?"Creating...":`Create Poll (${s.length} question${s.length>1?"s":""})`})]})]})]})})},vte=e=>new Promise(t=>setTimeout(t,e)),_x=async(e,t=3,r=1e3)=>{let n;for(let s=0;s<t;s++)try{return await e()}catch(a){if(console.log(`Attempt ${s+1} failed:`,a),n=a,s<t-1){const o=r*Math.pow(2,s);console.log(`Retrying in ${o}ms...`),await vte(o)}}throw n},yte=()=>{const[e,t]=y.useState(!1),{user:r}=kt();return{submitVotes:async o=>{if(!r)return gt.error("You must be logged in to vote"),!1;try{t(!0),console.log("Starting vote submission for user:",r.id,"poll:",o.pollId);const l=await _x(async()=>{const{data:c,error:u}=await he.from("poll_votes").select("sub_poll_id").eq("user_id",r.id).in("sub_poll_id",o.votes.map(p=>p.subPollId));if(u)throw console.error("Error checking existing votes:",u),u;if(c&&c.length>0)throw new Error("ALREADY_VOTED");const d=o.votes.map(p=>({poll_id:o.pollId,sub_poll_id:p.subPollId,user_id:r.id,vote:p.vote,comment:o.comment||null}));console.log("Inserting vote records:",d);const{error:f}=await he.from("poll_votes").insert(d);if(f)throw console.error("Error inserting votes:",f),f;return!0});return console.log("Vote submission successful"),gt.success("Your votes have been submitted successfully"),l}catch(l){return console.error("Error submitting votes:",l),l.message==="ALREADY_VOTED"?gt.error("You have already voted on some of these questions"):gt.error("Failed to submit votes. Please check your connection and try again."),!1}finally{t(!1)}},getUserVotes:async o=>{if(!r)return null;try{console.log("Fetching user votes for poll:",o,"user:",r.id);const l=await _x(async()=>{const{data:c,error:u}=await he.from("poll_votes").select("*").eq("poll_id",o).eq("user_id",r.id);if(u)throw u;return c});return console.log("Retrieved user votes:",l),l}catch(l){return console.error("Error fetching user votes:",l),null}},checkVotingEligibility:async o=>{var l;if(console.log("Checking voting eligibility for poll:",o,"user:",r==null?void 0:r.id),!r)return console.log("No user found"),{canVote:!1,reason:"Not logged in"};try{return await _x(async()=>{const{data:u,error:d}=await he.from("polls").select("status, deadline").eq("id",o).single();if(d)throw console.error("Error fetching poll:",d),d;if(console.log("Poll data:",u),u.status!=="active")return{canVote:!1,reason:"Poll is not active"};const{data:f,error:p}=await he.from("poll_votes").select("id").eq("poll_id",o).eq("user_id",r.id).limit(1);if(p)throw console.error("Error checking existing votes:",p),p;return console.log("Existing votes:",f),f&&f.length>0?{canVote:!1,reason:"You have already voted on this poll"}:(console.log("User can vote"),{canVote:!0,reason:null})})}catch(c){return console.error("Error checking voting eligibility:",c),(l=c.message)!=null&&l.includes("Failed to fetch")?{canVote:!1,reason:"Network connection error. Please check your internet connection."}:{canVote:!1,reason:"Error checking eligibility. Please try again."}}},submitting:e}},wte=({attachments:e,onViewDocument:t})=>{const{downloadAttachment:r}=xu();if(!e||e.length===0)return null;const n=d=>d?d.includes("pdf")?tr:d.includes("image")?Or:d.includes("document")||d.includes("word")||d.includes("spreadsheet")||d.includes("excel")||d.includes("presentation")||d.includes("powerpoint")?tr:Ld:Ld,s=d=>{if(!d)return"Unknown size";const f=["Bytes","KB","MB","GB"],p=Math.floor(Math.log(d)/Math.log(1024));return Math.round(d/Math.pow(1024,p)*100)/100+" "+f[p]},a=d=>d?d.includes("pdf")?"PDF":d.includes("image")?"Image":d.includes("document")||d.includes("word")?"Word":d.includes("spreadsheet")||d.includes("excel")?"Excel":d.includes("presentation")||d.includes("powerpoint")?"PowerPoint":"File":"File",o=async(d,f)=>{try{const{data:{user:p}}=await he.auth.getUser();if(!p)return;await he.from("document_analytics").insert({document_id:d,user_id:p.id,action:f,document_type:"poll_attachment",timestamp:new Date().toISOString()})}catch(p){console.error("Error tracking analytics:",p)}},l=async d=>{try{console.log("Starting download for poll attachment:",d.id),await o(d.id,"download"),console.log("Download tracked successfully for poll attachment:",d.id),await r(d.file_path,d.file_name),console.log("Download completed for poll attachment:",d.file_name)}catch(f){console.error("Error downloading poll attachment:",f)}},c=async d=>{try{console.log("Starting view for poll attachment:",d.id),await o(d.id,"view"),console.log("View tracked successfully for poll attachment:",d.id),t&&t(d)}catch(f){console.error("Error viewing poll attachment:",f),t&&t(d)}},u=d=>d?d.includes("pdf")||d.includes("image")||d.includes("text")||d.includes("document")||d.includes("word")||d.includes("spreadsheet")||d.includes("excel")||d.includes("presentation")||d.includes("powerpoint"):!1;return i.jsxs(Ye,{className:"mt-4",children:[i.jsx(ct,{className:"pb-4",children:i.jsxs(ft,{className:"flex items-center gap-2 text-lg",children:[i.jsx(tr,{className:"h-5 w-5"}),"Poll Attachments (",e.length,")"]})}),i.jsx(Je,{className:"pt-0",children:i.jsx("div",{className:"space-y-3",children:e.map(d=>{const f=n(d.mime_type),p=u(d.mime_type)&&t,h=d.view_count||0,g=d.download_count||0;return i.jsxs("div",{className:"flex items-center justify-between p-3 border border-border rounded-lg hover:bg-muted/50 transition-colors",children:[i.jsxs("div",{className:"flex items-center space-x-3",children:[i.jsx("div",{className:"p-2 bg-blue-100 rounded-lg",children:i.jsx(f,{className:"h-4 w-4 text-blue-600"})}),i.jsxs("div",{className:"flex-1 min-w-0",children:[i.jsx("h4",{className:"text-sm font-medium text-foreground truncate",children:d.file_name}),i.jsxs("div",{className:"flex items-center space-x-2 mt-1",children:[i.jsx(We,{variant:"outline",className:"text-xs",children:a(d.mime_type)}),i.jsx("span",{className:"text-xs text-muted-foreground",children:s(d.file_size)}),i.jsxs("span",{className:"text-xs text-muted-foreground flex items-center space-x-1",children:[i.jsx(Or,{className:"h-3 w-3"}),i.jsx("span",{children:h})]}),i.jsxs("span",{className:"text-xs text-muted-foreground flex items-center space-x-1",children:[i.jsx(js,{className:"h-3 w-3"}),i.jsx("span",{children:g})]})]})]})]}),i.jsxs("div",{className:"flex items-center space-x-2",children:[p&&i.jsxs(ue,{size:"sm",variant:"outline",onClick:()=>c(d),className:"h-8 text-xs",children:[i.jsx(Or,{className:"h-3 w-3 mr-1"}),"View"]}),i.jsx(kw,{documentId:d.id,documentName:d.file_name,documentType:"poll_attachment"}),i.jsxs(ue,{size:"sm",variant:"outline",onClick:()=>l(d),className:"h-8 text-xs",children:[i.jsx(js,{className:"h-3 w-3 mr-1"}),"Download"]})]})]},d.id)})})})]})},_te=({open:e,onOpenChange:t,poll:r})=>{var Y,z,U,V,F,D,G;const[n,s]=y.useState(""),[a,o]=y.useState({}),[l,c]=y.useState({canVote:!0,reason:null}),[u,d]=y.useState(!1),[f,p]=y.useState(!1),[h,g]=y.useState(null),[m,x]=y.useState(!1),[w,v]=y.useState(""),{submitVotes:_,checkVotingEligibility:b,getUserVotes:S}=yte();y.useEffect(()=>{r&&e?(console.log("Dialog opened for poll:",r.id),N()):e||T()},[r,e]),y.useEffect(()=>{if(!(r!=null&&r.deadline))return;const O=()=>{const ie=new Date,ne=new Date(r.deadline);if(sw(ne,ie)){v("Poll closed");return}const me=Gz({start:ie,end:ne});v(Uz(me,{format:["days","hours","minutes","seconds"]})+" left")};O();const L=setInterval(O,1e3);return()=>clearInterval(L)},[r==null?void 0:r.deadline]);const T=()=>{o({}),s(""),c({canVote:!0,reason:null}),d(!1),p(!1)},N=async()=>{if(r){p(!0),o({}),s(""),d(!1);try{console.log("Checking eligibility for poll:",r.id);const O=await b(r.id);if(console.log("Eligibility result:",O),c(O),!O.canVote){console.log("User cannot vote, checking for existing votes");const L=await S(r.id);if(L&&L.length>0){console.log("Found existing votes:",L);const ie={};L.forEach(me=>{ie[me.sub_poll_id]=me.vote}),o(ie);const ne=L.find(me=>me.comment);ne&&s(ne.comment||"")}}}catch(O){console.error("Error initializing dialog:",O),gt.error("Failed to load voting data"),c({canVote:!1,reason:"Failed to load voting data"})}finally{p(!1)}}},C=(O,L)=>{console.log("Vote selection changed:",{subPollId:O,vote:L}),o(ie=>{const ne={...ie,[O]:L};return console.log("Updated vote selections:",ne),ne})},E=((Y=r==null?void 0:r.sub_polls)==null?void 0:Y.every(O=>a.hasOwnProperty(O.id)))||!1,P=async()=>{if(!r||!E||u){console.log("Submit blocked:",{poll:!!r,allQuestionsAnswered:E,isSubmitting:u}),E||gt.error("Please answer all questions before submitting");return}console.log("Starting vote submission for poll:",r.id),console.log("Vote selections:",a),console.log("Comment:",n),d(!0);try{const O=Object.entries(a).map(([ie,ne])=>({subPollId:ie,vote:ne}));console.log("Formatted votes for submission:",O);const L=await _({pollId:r.id,votes:O,comment:n.trim()||void 0});console.log("Vote submission result:",L),L&&(gt.success("Your votes have been submitted successfully!"),t(!1),T())}catch(O){console.error("Error in handleSubmit:",O),gt.error("An error occurred while submitting votes")}finally{d(!1)}},R=()=>{console.log("Retrying initialization"),N()},j=O=>{const L={id:O.id,name:O.file_name,file_path:O.file_path,file_size:O.file_size,mime_type:O.mime_type,uploaded_by:O.uploaded_by,created_at:O.created_at};g(L),x(!0)},M=()=>{x(!1),g(null)};if(!r)return null;const A=[{value:"favor",label:"In Favour",icon:IF,color:"bg-green-50 border-green-200 hover:bg-green-100 text-green-700",selectedColor:"bg-green-100 border-green-400 ring-2 ring-green-200"},{value:"against",label:"Against",icon:FF,color:"bg-red-50 border-red-200 hover:bg-red-100 text-red-700",selectedColor:"bg-red-100 border-red-400 ring-2 ring-red-200"},{value:"abstain",label:"Abstain",icon:CF,color:"bg-gray-50 border-gray-200 hover:bg-gray-100 text-gray-700",selectedColor:"bg-gray-100 border-gray-400 ring-2 ring-gray-200"}],I=Object.keys(a).length,X=((z=r.sub_polls)==null?void 0:z.length)||0;return i.jsxs(i.Fragment,{children:[i.jsx(Nt,{open:e,onOpenChange:t,children:i.jsxs(bt,{className:"w-full max-w-4xl max-h-[90vh] overflow-y-auto",children:[i.jsxs(jt,{className:"space-y-3 pb-4 border-b",children:[i.jsxs("div",{className:"flex items-center gap-3",children:[i.jsx("div",{className:"p-2 bg-primary/10 rounded-lg",children:i.jsx(Gs,{className:"h-5 w-5 text-primary"})}),i.jsxs("div",{children:[i.jsx(Et,{className:"text-xl font-bold",children:r.title}),i.jsx($t,{className:"text-sm mt-1",children:r.description})]})]}),i.jsxs("div",{className:"flex flex-wrap gap-4 text-xs text-gray-600",children:[i.jsxs("div",{className:"flex items-center gap-1",children:[i.jsx(qr,{className:"h-3 w-3"}),i.jsxs("span",{children:["Deadline: ",vt(new Date(r.deadline),"MMM dd, yyyy HH:mm")]}),i.jsx("span",{className:"ml-2 font-semibold text-primary",children:w})]}),i.jsxs("div",{className:"flex items-center gap-1",children:[i.jsx(mr,{className:"h-3 w-3"}),i.jsxs("span",{children:[((U=r.stats)==null?void 0:U.total_voters)||0," eligible voters"]})]}),i.jsx(We,{variant:r.status==="active"?"default":"secondary",children:r.status}),r.is_secret&&i.jsx(We,{variant:"outline",children:"Secret Ballot"})]})]}),f?i.jsx("div",{className:"flex items-center justify-center py-12",children:i.jsxs("div",{className:"flex flex-col items-center gap-4",children:[i.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary"}),i.jsx("p",{className:"text-gray-600",children:"Loading voting data..."})]})}):!l.canVote&&((V=l.reason)!=null&&V.includes("Network"))?i.jsx("div",{className:"flex items-center justify-center py-12",children:i.jsx(Ye,{className:"max-w-md mx-auto text-center",children:i.jsxs(Je,{className:"p-8",children:[i.jsx(ea,{className:"h-16 w-16 text-red-500 mx-auto mb-4"}),i.jsx("h3",{className:"text-lg font-semibold text-red-700 mb-2",children:"Connection Error"}),i.jsx("p",{className:"text-gray-600 mb-4",children:l.reason}),i.jsxs(ue,{onClick:R,variant:"outline",children:[i.jsx(os,{className:"h-4 w-4 mr-2"}),"Retry"]})]})})}):!l.canVote&&!((F=l.reason)!=null&&F.includes("already voted"))?i.jsx("div",{className:"flex items-center justify-center py-12",children:i.jsx(Ye,{className:"max-w-md mx-auto text-center",children:i.jsxs(Je,{className:"p-8",children:[i.jsx(ea,{className:"h-16 w-16 text-red-500 mx-auto mb-4"}),i.jsx("h3",{className:"text-lg font-semibold text-red-700 mb-2",children:"Cannot Vote"}),i.jsx("p",{className:"text-gray-600",children:l.reason})]})})}):i.jsxs("div",{className:"space-y-6 py-4",children:[(r==null?void 0:r.attachments)&&r.attachments.length>0&&i.jsx(wte,{attachments:r.attachments,onViewDocument:j}),i.jsx("div",{className:"space-y-6",children:(D=r.sub_polls)==null?void 0:D.map((O,L)=>i.jsx(Ye,{className:"border-2",children:i.jsx(Je,{className:"p-6",children:i.jsxs("div",{className:"space-y-4",children:[i.jsxs("div",{className:"flex items-start justify-between",children:[i.jsxs("div",{className:"flex-1",children:[i.jsxs("h3",{className:"text-lg font-semibold mb-2",children:["Question ",L+1,": ",O.title]}),O.description&&i.jsx("p",{className:"text-gray-600 text-sm mb-4",children:O.description})]}),a[O.id]&&i.jsx(as,{className:"h-5 w-5 text-green-600 ml-4 flex-shrink-0"})]}),i.jsx("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-3",children:A.map(ie=>{const ne=a[O.id]===ie.value,me=ie.icon;return i.jsx("button",{onClick:()=>l.canVote&&C(O.id,ie.value),disabled:!l.canVote,className:`p-4 border-2 rounded-lg transition-all duration-200 text-left ${ne?ie.selectedColor:ie.color} ${l.canVote?"cursor-pointer":"opacity-60 cursor-not-allowed"}`,children:i.jsxs("div",{className:"flex items-center gap-3",children:[i.jsx(me,{className:"h-5 w-5"}),i.jsx("span",{className:"font-medium",children:ie.label})]})},ie.value)})})]})})},O.id))}),l.canVote&&i.jsxs(i.Fragment,{children:[i.jsx(Ye,{className:"bg-blue-50 border-blue-200",children:i.jsx(Je,{className:"p-4",children:i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsxs("span",{className:"font-medium text-blue-900",children:["Progress: ",I," of ",X," questions answered"]}),i.jsx(We,{variant:E?"default":"secondary",children:E?"Ready to Submit":"In Progress"})]})})}),i.jsx(Ye,{children:i.jsxs(Je,{className:"p-6",children:[i.jsx(Ve,{className:"text-base font-medium mb-3 block",children:"Additional Comments (Optional)"}),i.jsx(Ma,{value:n,onChange:O=>s(O.target.value),placeholder:"Share your thoughts about this vote...",rows:3,className:"resize-none"})]})}),i.jsxs("div",{className:"space-y-4 pt-4 border-t",children:[!E&&i.jsx(Ye,{className:"bg-amber-50 border-amber-200",children:i.jsx(Je,{className:"p-4",children:i.jsxs("div",{className:"flex items-center gap-3 text-amber-800",children:[i.jsx(ea,{className:"h-5 w-5"}),i.jsxs("p",{className:"text-sm font-medium",children:["Please answer all ",X," questions before submitting your vote."]})]})})}),i.jsxs("div",{className:"flex gap-3 justify-end",children:[i.jsx(ue,{variant:"outline",onClick:()=>t(!1),disabled:u,children:"Cancel"}),i.jsxs(ue,{onClick:P,disabled:!E||u,className:"min-w-[150px]",children:[i.jsx(Gs,{className:"h-4 w-4 mr-2"}),u?"Submitting...":"Submit All Votes"]})]})]})]}),!l.canVote&&((G=l.reason)==null?void 0:G.includes("already voted"))&&Object.keys(a).length>0&&i.jsxs("div",{className:"space-y-4 pt-4 border-t",children:[i.jsxs("div",{className:"text-center mb-4",children:[i.jsx("h3",{className:"text-lg font-semibold text-gray-700",children:"Your Submitted Votes"}),i.jsx("p",{className:"text-sm text-gray-500",children:"Below are the votes you previously submitted"})]}),n&&i.jsx(Ye,{children:i.jsxs(Je,{className:"p-6",children:[i.jsx(Ve,{className:"text-base font-medium mb-3 block",children:"Your Comment"}),i.jsx("div",{className:"bg-gray-100 p-3 rounded border text-gray-700",children:n})]})})]})]})]})}),i.jsx(K1,{isOpen:m,onClose:M,document:h,documentType:"poll_attachment"})]})};var n_="Progress",s_=100,[bte,pse]=Fr(n_),[Ste,Nte]=bte(n_),RD=y.forwardRef((e,t)=>{const{__scopeProgress:r,value:n=null,max:s,getValueLabel:a=jte,...o}=e;(s||s===0)&&!eN(s)&&console.error(Ete(`${s}`,"Progress"));const l=eN(s)?s:s_;n!==null&&!tN(n,l)&&console.error(kte(`${n}`,"Progress"));const c=tN(n,l)?n:null,u=S0(c)?a(c,l):void 0;return i.jsx(Ste,{scope:r,value:c,max:l,children:i.jsx(ze.div,{"aria-valuemax":l,"aria-valuemin":0,"aria-valuenow":S0(c)?c:void 0,"aria-valuetext":u,role:"progressbar","data-state":FD(c,l),"data-value":c??void 0,"data-max":l,...o,ref:t})})});RD.displayName=n_;var MD="ProgressIndicator",OD=y.forwardRef((e,t)=>{const{__scopeProgress:r,...n}=e,s=Nte(MD,r);return i.jsx(ze.div,{"data-state":FD(s.value,s.max),"data-value":s.value??void 0,"data-max":s.max,...n,ref:t})});OD.displayName=MD;function jte(e,t){return`${Math.round(e/t*100)}%`}function FD(e,t){return e==null?"indeterminate":e===t?"complete":"loading"}function S0(e){return typeof e=="number"}function eN(e){return S0(e)&&!isNaN(e)&&e>0}function tN(e,t){return S0(e)&&!isNaN(e)&&e<=t&&e>=0}function Ete(e,t){return`Invalid prop \`max\` of value \`${e}\` supplied to \`${t}\`. Only numbers greater than 0 are valid max values. Defaulting to \`${s_}\`.`}function kte(e,t){return`Invalid prop \`value\` of value \`${e}\` supplied to \`${t}\`. The \`value\` prop must be:
  - a positive number
  - less than the value passed to \`max\` (or ${s_} if no \`max\` prop is set)
  - \`null\` or \`undefined\` if the progress is indeterminate.

Defaulting to \`null\`.`}var ID=RD,Cte=OD;const Ku=y.forwardRef(({className:e,value:t,...r},n)=>i.jsx(ID,{ref:n,className:De("relative h-4 w-full overflow-hidden rounded-full bg-secondary",e),...r,children:i.jsx(Cte,{className:"h-full w-full flex-1 bg-primary transition-all",style:{transform:`translateX(-${100-(t||0)}%)`}})}));Ku.displayName=ID.displayName;const Tte=({open:e,onOpenChange:t,poll:r})=>{var T,N,C,E;const[n,s]=y.useState([]),[a,o]=y.useState({}),[l,c]=y.useState(!1),[u,d]=y.useState(!1),[f,p]=y.useState(((N=(T=r==null?void 0:r.sub_polls)==null?void 0:T[0])==null?void 0:N.id)||""),[h,g]=y.useState(!1);y.useEffect(()=>{r&&e&&(m(),x())},[r,e]);const m=async()=>{if(r){c(!0);try{const{data:P,error:R}=await he.from("profiles").select("id, first_name, last_name, email, avatar_url").order("first_name");if(R)throw R;const{data:j,error:M}=await he.from("poll_votes").select("user_id, voted_at").eq("poll_id",r.id);if(M)throw M;const A=new Map;j==null||j.forEach(X=>{A.has(X.user_id)||A.set(X.user_id,X.voted_at)});const I=(P==null?void 0:P.map(X=>({id:X.id,first_name:X.first_name||"",last_name:X.last_name||"",email:X.email||"",avatar_url:X.avatar_url,has_voted:A.has(X.id),voted_at:A.get(X.id)||null})))||[];s(I)}catch(P){console.error("Error fetching member voting status:",P)}finally{c(!1)}}},x=async()=>{var P;if(r){d(!0);try{console.log("Fetching vote results for poll:",r.id);const{data:R,error:j}=await he.from("poll_votes").select("sub_poll_id, vote").eq("poll_id",r.id);if(j)throw j;console.log("Retrieved votes:",R);const M={};(P=r.sub_polls)==null||P.forEach(A=>{M[A.id]={favor:0,against:0,abstain:0,total:0}}),R==null||R.forEach(A=>{M[A.sub_poll_id]&&(A.vote==="favor"?M[A.sub_poll_id].favor++:A.vote==="against"?M[A.sub_poll_id].against++:A.vote==="abstain"&&M[A.sub_poll_id].abstain++,M[A.sub_poll_id].total++)}),console.log("Calculated results:",M),o(M)}catch(R){console.error("Error fetching vote results:",R)}finally{d(!1)}}};if(!r)return null;const w=n.filter(P=>P.has_voted),v=n.filter(P=>!P.has_voted),_=(P,R)=>R>0?Math.round(P/R*100):0,b=P=>{if(P.total===0)return null;const R=Math.max(P.favor,P.against,P.abstain);return P.favor===R&&P.favor>0?"favor":P.against===R&&P.against>0?"against":P.abstain===R&&P.abstain>0?"abstain":null},S=P=>{if(!P)return i.jsx(We,{variant:"secondary",children:"No Votes"});switch(P){case"favor":return i.jsxs(We,{className:"bg-green-100 text-green-800 border-green-300",children:[i.jsx(as,{className:"h-3 w-3 mr-1"}),"Passed"]});case"against":return i.jsxs(We,{className:"bg-red-100 text-red-800 border-red-300",children:[i.jsx(ro,{className:"h-3 w-3 mr-1"}),"Rejected"]});case"abstain":return i.jsxs(We,{className:"bg-yellow-100 text-yellow-800 border-yellow-300",children:[i.jsx(yv,{className:"h-3 w-3 mr-1"}),"Abstained"]});default:return i.jsx(We,{variant:"secondary",children:"No Result"})}};return i.jsx(Nt,{open:e,onOpenChange:t,children:i.jsxs(bt,{style:{zIndex:2e4,position:"fixed",top:"50%",left:"50%",transform:"translate(-50%, -50%)",maxHeight:"90vh",overflowY:"auto",background:"white"},className:"sm:max-w-[700px] w-full max-w-lg overflow-y-auto relative",children:[i.jsx("button",{type:"button","aria-label":"Close",onClick:()=>t(!1),className:"absolute top-2 right-2 p-2 rounded hover:bg-gray-100 focus:outline-none z-20",children:i.jsx(ro,{className:"h-5 w-5"})}),i.jsxs(jt,{children:[i.jsxs(Et,{className:"flex items-center space-x-2",children:[i.jsx(mr,{className:"h-5 w-5"}),i.jsx("span",{children:"Poll Results"})]}),i.jsx($t,{children:"View voting results for each question"})]}),i.jsxs(Ye,{className:"mb-4",children:[i.jsxs(ct,{className:"py-2 px-4",children:[i.jsx(ft,{className:"text-base",children:r.title}),r.description&&i.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:r.description})]}),i.jsxs(Je,{className:"flex flex-wrap gap-4 items-center py-2 px-4",children:[i.jsxs("div",{className:"text-xs text-muted-foreground flex items-center gap-1",children:[i.jsx(en,{className:"h-3 w-3"})," ",vt(new Date(r.deadline),"MMM dd, yyyy HH:mm")]}),i.jsxs("div",{className:"text-xs text-muted-foreground flex items-center gap-1",children:[i.jsx(mr,{className:"h-3 w-3"})," ",((C=r.stats)==null?void 0:C.voted_count)||0,"/",((E=r.stats)==null?void 0:E.total_voters)||0," voted"]}),i.jsx("div",{className:"text-xs text-muted-foreground flex items-center gap-1",children:i.jsx(We,{variant:r.status==="active"?"default":"secondary",children:r.status})})]})]}),r.sub_polls&&r.sub_polls.length>0&&i.jsxs(bl,{value:f,onValueChange:p,className:"mb-4",children:[i.jsx(So,{className:"flex flex-wrap gap-2 mb-2",children:r.sub_polls.map((P,R)=>i.jsxs(Vn,{value:P.id,"aria-label":`Question ${R+1}`,children:["Q",R+1]},P.id))}),r.sub_polls.map((P,R)=>{const j=a[P.id]||{favor:0,against:0,abstain:0,total:0},M=b(j);return i.jsx(zr,{value:P.id,children:i.jsxs(Ye,{className:"mb-4",children:[i.jsxs(ct,{children:[i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsxs(ft,{className:"text-base",children:["Question ",R+1,": ",P.title]}),S(M)]}),P.description&&i.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:P.description})]}),i.jsxs(Je,{className:"space-y-4",children:[i.jsxs("div",{className:"space-y-2",children:[i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsxs("div",{className:"flex items-center space-x-2",children:[i.jsx(as,{className:"h-4 w-4 text-green-600"}),i.jsx("span",{className:"text-sm font-medium",children:"For"})]}),i.jsxs("span",{className:"text-sm text-muted-foreground",children:[j.favor," votes (",_(j.favor,j.total),"%)"]})]}),i.jsx(Ku,{value:_(j.favor,j.total),className:"h-2"})]}),i.jsxs("div",{className:"space-y-2",children:[i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsxs("div",{className:"flex items-center space-x-2",children:[i.jsx(ro,{className:"h-4 w-4 text-red-600"}),i.jsx("span",{className:"text-sm font-medium",children:"Against"})]}),i.jsxs("span",{className:"text-sm text-muted-foreground",children:[j.against," votes (",_(j.against,j.total),"%)"]})]}),i.jsx(Ku,{value:_(j.against,j.total),className:"h-2"})]}),i.jsxs("div",{className:"space-y-2",children:[i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsxs("div",{className:"flex items-center space-x-2",children:[i.jsx(yv,{className:"h-4 w-4 text-yellow-600"}),i.jsx("span",{className:"text-sm font-medium",children:"Abstain"})]}),i.jsxs("span",{className:"text-sm text-muted-foreground",children:[j.abstain," votes (",_(j.abstain,j.total),"%)"]})]}),i.jsx(Ku,{value:_(j.abstain,j.total),className:"h-2"})]}),j.total>0&&i.jsx("div",{className:"mt-3 pt-3 border-t",children:i.jsxs("p",{className:"text-sm text-muted-foreground",children:["Total votes: ",j.total]})})]})]})},P.id)})]}),i.jsxs(Ye,{className:"mb-4",children:[i.jsxs(ct,{className:"flex flex-row items-center justify-between cursor-pointer select-none",onClick:()=>g(P=>!P),"aria-label":"Toggle Member Voting Status",children:[i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx(mr,{className:"h-5 w-5"}),i.jsx("span",{className:"text-base font-medium",children:"Member Voting Status"}),i.jsxs("span",{className:"text-xs text-muted-foreground",children:["(",w.length,"/",n.length," voted)"]})]}),i.jsx(ue,{size:"icon",variant:"ghost","aria-label":h?"Collapse":"Expand",children:h?i.jsx(h1,{}):i.jsx(Zc,{})})]}),h&&i.jsx(Je,{children:l?i.jsx("div",{className:"flex items-center justify-center py-8",children:i.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary"})}):i.jsxs("div",{className:"space-y-4",children:[i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[i.jsxs("div",{children:[i.jsxs("h4",{className:"font-medium text-green-700 mb-3 flex items-center gap-2",children:[i.jsx(as,{className:"h-4 w-4"}),"Voted (",w.length,")"]}),i.jsx("div",{className:"space-y-2 max-h-64 overflow-y-auto",children:w.length>0?w.map(P=>i.jsxs("div",{className:"flex items-center space-x-3 p-2 bg-green-50 rounded-lg",children:[i.jsxs(qd,{className:"h-8 w-8",children:[i.jsx(Km,{src:P.avatar_url||""}),i.jsxs(Xm,{children:[P.first_name.charAt(0),P.last_name.charAt(0)]})]}),i.jsxs("div",{className:"flex-1 min-w-0",children:[i.jsxs("p",{className:"text-sm font-medium text-gray-900",children:[P.first_name," ",P.last_name]}),P.voted_at&&i.jsxs("p",{className:"text-xs text-gray-500 flex items-center gap-1",children:[i.jsx(qr,{className:"h-3 w-3"}),vt(new Date(P.voted_at),"MMM dd, HH:mm")]})]}),i.jsx(as,{className:"h-4 w-4 text-green-600"})]},P.id)):i.jsx("p",{className:"text-sm text-gray-500",children:"No votes cast yet"})})]}),i.jsxs("div",{children:[i.jsxs("h4",{className:"font-medium text-orange-700 mb-3 flex items-center gap-2",children:[i.jsx(qr,{className:"h-4 w-4"}),"Pending (",v.length,")"]}),i.jsx("div",{className:"space-y-2 max-h-64 overflow-y-auto",children:v.length>0?v.map(P=>i.jsxs("div",{className:"flex items-center space-x-3 p-2 bg-orange-50 rounded-lg",children:[i.jsxs(qd,{className:"h-8 w-8",children:[i.jsx(Km,{src:P.avatar_url||""}),i.jsxs(Xm,{children:[P.first_name.charAt(0),P.last_name.charAt(0)]})]}),i.jsxs("div",{className:"flex-1 min-w-0",children:[i.jsxs("p",{className:"text-sm font-medium text-gray-900",children:[P.first_name," ",P.last_name]}),i.jsx("p",{className:"text-xs text-gray-500",children:P.email})]}),i.jsx(qr,{className:"h-4 w-4 text-orange-600"})]},P.id)):i.jsx("p",{className:"text-sm text-gray-500",children:"All members have voted"})})]})]}),i.jsxs("div",{className:"mt-4",children:[i.jsxs("div",{className:"flex justify-between text-sm mb-2",children:[i.jsx("span",{children:"Voting Progress"}),i.jsxs("span",{children:[w.length,"/",n.length," members"]})]}),i.jsx(Ku,{value:n.length>0?w.length/n.length*100:0,className:"h-2"})]})]})})]}),r.is_secret&&i.jsx("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-4 mt-2",children:i.jsxs("p",{className:"text-sm text-yellow-800",children:[i.jsx("strong",{children:"Secret Ballot:"})," Individual votes are anonymous and cannot be traced back to specific voters. Only participation status is shown above."]})})]})})},Ate=({open:e,onOpenChange:t,poll:r})=>{const[n,s]=y.useState({title:"",description:"",deadline:""}),[a,o]=y.useState([]),[l,c]=y.useState(!1),{updatePoll:u}=xu();y.useEffect(()=>{var h;if(r&&e){const g=new Date(r.deadline),x=new Date(g.getTime()-g.getTimezoneOffset()*6e4).toISOString().slice(0,16);s({title:r.title,description:r.description||"",deadline:x}),o(((h=r.sub_polls)==null?void 0:h.map(w=>({id:w.id,title:w.title,description:w.description||""})))||[])}},[r,e]);const d=(h,g,m)=>{o(x=>x.map((w,v)=>v===h?{...w,[g]:m}:w))},f=()=>{o(h=>[...h,{id:Date.now().toString(),title:"",description:""}])},p=async h=>{if(h.preventDefault(),!!r){c(!0);try{const g=new Date(n.deadline),x=new Date(g.getTime()-g.getTimezoneOffset()*6e4).toISOString();await u(r.id,{title:n.title,description:n.description,deadline:x,subPolls:a})&&(t(!1),gt.success("Poll updated successfully"))}catch(g){console.error("Error updating poll:",g),gt.error("Failed to update poll")}finally{c(!1)}}};return r?i.jsx(Nt,{open:e,onOpenChange:t,children:i.jsxs(bt,{style:{zIndex:2e4,position:"fixed",top:"50%",left:"50%",transform:"translate(-50%, -50%)",maxHeight:"90vh",overflowY:"auto",background:"white"},className:"sm:max-w-[700px] w-full max-w-lg overflow-y-auto relative",children:[i.jsx("button",{type:"button","aria-label":"Close",onClick:()=>t(!1),className:"absolute top-2 right-2 p-2 rounded hover:bg-gray-100 focus:outline-none z-20",children:i.jsx(Cn,{className:"h-5 w-5"})}),i.jsxs(jt,{children:[i.jsxs(Et,{className:"flex items-center space-x-2",children:[i.jsx(sm,{className:"h-5 w-5"}),i.jsx("span",{children:"Edit Poll"})]}),i.jsx($t,{children:"Edit poll details and questions. Note: Changes will affect ongoing voting."})]}),i.jsxs("form",{onSubmit:p,className:"space-y-6",children:[i.jsxs("div",{children:[i.jsx(Ve,{htmlFor:"edit-title",children:"Poll Title"}),i.jsx(dt,{id:"edit-title",value:n.title,onChange:h=>s({...n,title:h.target.value}),placeholder:"Enter poll title...",required:!0,className:"mt-2"})]}),i.jsxs("div",{children:[i.jsx(Ve,{htmlFor:"edit-description",children:"Description"}),i.jsx(Ma,{id:"edit-description",value:n.description,onChange:h=>s({...n,description:h.target.value}),placeholder:"Provide description of the poll...",rows:3,className:"mt-2"})]}),i.jsxs("div",{children:[i.jsx(Ve,{htmlFor:"edit-deadline",children:"Voting Deadline"}),i.jsxs("div",{className:"flex gap-4 mt-2",children:[i.jsx(dt,{id:"edit-deadline",type:"date",value:n.deadline.slice(0,10),onChange:h=>s({...n,deadline:h.target.value+n.deadline.slice(10)}),className:"w-40",required:!0}),i.jsx(dt,{id:"edit-deadline-time",type:"time",value:n.deadline.slice(11,16),onChange:h=>s({...n,deadline:n.deadline.slice(0,10)+"T"+h.target.value}),className:"w-28",required:!0})]})]}),i.jsxs("div",{className:"space-y-4",children:[i.jsx(Ve,{className:"text-lg font-semibold",children:"Poll Questions"}),i.jsx("div",{className:"flex justify-end mb-2",children:i.jsx(ue,{type:"button",variant:"outline",size:"sm",onClick:f,children:"+ Add Question"})}),i.jsx("div",{className:"space-y-4",children:a.map((h,g)=>i.jsxs(Ye,{className:"border-2 border-dashed border-gray-200",children:[i.jsx(ct,{className:"pb-3",children:i.jsxs(ft,{className:"text-base",children:["Question ",g+1]})}),i.jsxs(Je,{className:"space-y-3",children:[i.jsxs("div",{children:[i.jsx(Ve,{htmlFor:`edit-subpoll-title-${g}`,children:"Question Title"}),i.jsx(dt,{id:`edit-subpoll-title-${g}`,value:h.title,onChange:m=>d(g,"title",m.target.value),placeholder:"Enter the question...",className:"mt-1"})]}),i.jsxs("div",{children:[i.jsx(Ve,{htmlFor:`edit-subpoll-description-${g}`,children:"Question Description"}),i.jsx(Ma,{id:`edit-subpoll-description-${g}`,value:h.description,onChange:m=>d(g,"description",m.target.value),placeholder:"Additional details about this question...",rows:2,className:"mt-1"})]})]})]},h.id))})]}),i.jsxs("div",{className:"bg-gray-50 border border-gray-200 rounded-lg p-4",children:[i.jsx("h4",{className:"font-medium text-gray-900 mb-2",children:"Important Notice"}),i.jsx("p",{className:"text-sm text-gray-800",children:"Editing this poll may affect ongoing voting. Members who have already voted will keep their votes, but changes to questions may cause confusion. Consider creating a new poll instead if major changes are needed."})]}),i.jsxs("div",{className:"flex justify-end space-x-2 pt-4",children:[i.jsxs(ue,{type:"button",variant:"outline",onClick:()=>t(!1),children:[i.jsx(Cn,{className:"h-4 w-4 mr-2"}),"Cancel"]}),i.jsxs(ue,{type:"submit",disabled:l,className:"bg-primary hover:bg-primary/90",children:[i.jsx(m1,{className:"h-4 w-4 mr-2"}),l?"Saving...":"Save Changes"]})]})]})]})}):null},bx=[{value:"15",label:"15 minutes"},{value:"30",label:"30 minutes"},{value:"60",label:"1 hour"},{value:"120",label:"2 hours"},{value:"240",label:"4 hours"},{value:"1440",label:"24 hours"}],Pte=({open:e,onOpenChange:t,poll:r})=>{var v,_,b;const[n,s]=y.useState(""),[a,o]=y.useState("30"),[l,c]=y.useState([]),[u,d]=y.useState(!1),{resetUserVotes:f,resetAllVotes:p,refetch:h}=xu();y.useEffect(()=>{e&&r&&g()},[e,r]);const g=async()=>{try{const{data:S,error:T}=await he.from("profiles").select("id, first_name, last_name, email").order("first_name");if(T)throw T;c(S||[])}catch(S){console.error("Error fetching profiles:",S)}},m=async()=>{var S;if(r){d(!0);try{const{error:T}=await he.rpc("reopen_poll_with_deadline",{poll_id_param:r.id,minutes_param:parseInt(a)});if(T)throw T;gt.success(`Poll reopened for ${(S=bx.find(N=>N.value===a))==null?void 0:S.label}`),await h(),t(!1)}catch(T){console.error("Error reopening poll:",T),gt.error("Failed to reopen poll")}finally{d(!1)}}},x=async()=>{!r||!n||(d(!0),await f(r.id,n),d(!1),s(""))},w=async()=>{r&&confirm("Are you sure you want to reset ALL votes? This action cannot be undone.")&&(d(!0),await p(r.id),d(!1))};return r?i.jsx(Nt,{open:e,onOpenChange:t,children:i.jsxs(bt,{className:"sm:max-w-[600px] max-h-[90vh] overflow-y-auto bg-white",children:[i.jsxs("button",{type:"button","aria-label":"Close",onClick:()=>t(!1),className:"absolute top-2 right-2 p-2 rounded hover:bg-gray-100 focus:outline-none z-20",children:[i.jsx("span",{className:"sr-only",children:"Close"}),i.jsx("svg",{className:"h-5 w-5",fill:"none",stroke:"currentColor",strokeWidth:"2",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M6 18L18 6M6 6l12 12"})})]}),i.jsxs(jt,{children:[i.jsxs(Et,{className:"flex items-center space-x-2",children:[i.jsx(os,{className:"h-5 w-5"}),i.jsx("span",{children:"Reopen Poll"})]}),i.jsx($t,{children:"Manage poll reopening and vote resets for completed polls"})]}),i.jsxs("div",{className:"space-y-6",children:[i.jsxs(Ye,{children:[i.jsxs(ct,{children:[i.jsxs(ft,{className:"text-lg flex items-center gap-2",children:[r.title,i.jsx(We,{variant:"secondary",children:"Completed"})]}),r.description&&i.jsx("p",{className:"text-sm text-muted-foreground",children:r.description})]}),i.jsx(Je,{children:i.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[i.jsxs("div",{children:[i.jsx("span",{className:"text-muted-foreground",children:"Total Voters:"}),i.jsx("span",{className:"ml-2 font-medium",children:((v=r.stats)==null?void 0:v.total_voters)||0})]}),i.jsxs("div",{children:[i.jsx("span",{className:"text-muted-foreground",children:"Votes Cast:"}),i.jsx("span",{className:"ml-2 font-medium",children:((_=r.stats)==null?void 0:_.voted_count)||0})]})]})})]}),i.jsxs(Ye,{children:[i.jsx(ct,{children:i.jsxs(ft,{className:"text-base flex items-center gap-2",children:[i.jsx(os,{className:"h-4 w-4"}),"Reopen Poll with Time Limit"]})}),i.jsxs(Je,{className:"space-y-4",children:[i.jsx("p",{className:"text-sm text-muted-foreground",children:"Reopen this completed poll for a specific duration. The poll will automatically close after the selected time."}),i.jsxs("div",{className:"space-y-3",children:[i.jsxs("div",{children:[i.jsxs("label",{className:"text-sm font-medium mb-2 block flex items-center gap-2",children:[i.jsx(qr,{className:"h-4 w-4"}),"Select Duration"]}),i.jsxs(oa,{value:a,onValueChange:o,children:[i.jsx(As,{children:i.jsx(la,{placeholder:"Select reopening duration"})}),i.jsx(Ps,{children:bx.map(S=>i.jsx(zt,{value:S.value,children:S.label},S.value))})]})]}),i.jsxs(ue,{onClick:m,disabled:u,className:"w-full",children:[i.jsx(os,{className:"h-4 w-4 mr-2"}),u?"Reopening...":`Reopen Poll for ${(b=bx.find(S=>S.value===a))==null?void 0:b.label}`]})]})]})]}),i.jsxs(Ye,{children:[i.jsx(ct,{children:i.jsxs(ft,{className:"text-base flex items-center gap-2",children:[i.jsx(Nv,{className:"h-4 w-4"}),"Reset Individual User Votes"]})}),i.jsxs(Je,{className:"space-y-4",children:[i.jsx("p",{className:"text-sm text-muted-foreground",children:"Reset votes for a specific user on this poll. The user will be able to vote again."}),i.jsxs("div",{className:"space-y-3",children:[i.jsxs(oa,{value:n,onValueChange:s,children:[i.jsx(As,{children:i.jsx(la,{placeholder:"Select a user to reset votes"})}),i.jsx(Ps,{children:l.map(S=>i.jsx(zt,{value:S.id,children:S.first_name||S.last_name?`${S.first_name||""} ${S.last_name||""}`.trim():S.email||"Unknown User"},S.id))})]}),i.jsxs(ue,{onClick:x,disabled:!n||u,variant:"outline",className:"w-full",children:[i.jsx(Nv,{className:"h-4 w-4 mr-2"}),"Reset User Votes"]})]})]})]}),i.jsxs(Ye,{className:"border-destructive/20",children:[i.jsx(ct,{children:i.jsxs(ft,{className:"text-base flex items-center gap-2 text-destructive",children:[i.jsx(mr,{className:"h-4 w-4"}),"Reset All Votes"]})}),i.jsxs(Je,{className:"space-y-4",children:[i.jsxs("div",{className:"bg-destructive/10 border border-destructive/20 rounded-lg p-3",children:[i.jsxs("div",{className:"flex items-center gap-2 text-destructive mb-2",children:[i.jsx(p1,{className:"h-4 w-4"}),i.jsx("span",{className:"font-medium",children:"Warning"})]}),i.jsx("p",{className:"text-sm text-destructive",children:"This will permanently delete ALL votes for this poll. This action cannot be undone."})]}),i.jsxs(ue,{onClick:w,disabled:u,variant:"destructive",className:"w-full",children:[i.jsx(mr,{className:"h-4 w-4 mr-2"}),"Reset All Votes"]})]})]})]})]})}):null},rN=()=>{var je;const t=(je=yl().state)==null?void 0:je.highlightPollId,[r,n]=y.useState(null),[s,a]=y.useState(!1),[o,l]=y.useState(!1),[c,u]=y.useState(!1),[d,f]=y.useState(!1),[p,h]=y.useState(!1),[g,m]=y.useState(null),[x,w]=y.useState({}),[v,_]=y.useState(!1),[b,S]=y.useState(null),[T,N]=y.useState("active"),{polls:C,loading:E,deletePoll:P,updatePollStatus:R,refetch:j,setPollingPaused:M}=xu(),A=ua(),{toast:I}=St();lu();const X=C.filter(k=>k.stats&&typeof k.stats.voted_count=="number"&&typeof k.stats.total_voters=="number"&&k.stats.voted_count===k.stats.total_voters&&k.stats.total_voters>0||k.status==="completed"),Y=new Date,z=C.filter(k=>k.stats&&typeof k.stats.voted_count=="number"&&typeof k.stats.total_voters=="number"&&k.stats.voted_count===k.stats.total_voters&&k.stats.total_voters>0||k.status==="completed"?!1:k.deadline?new Date(k.deadline)>=Y:!0),U=C.filter(k=>k.stats&&typeof k.stats.voted_count=="number"&&typeof k.stats.total_voters=="number"&&k.stats.voted_count===k.stats.total_voters&&k.stats.total_voters>0||k.status==="completed"||!k.deadline?!1:new Date(k.deadline)<Y);ke.useEffect(()=>{const k=async()=>{var ce;const le={};for(const H of U)try{const{data:K,error:oe}=await he.from("poll_votes").select("sub_poll_id, vote").eq("poll_id",H.id);if(oe)throw oe;const W={};(ce=H.sub_polls)==null||ce.forEach(J=>{W[J.id]={favor:0,against:0,abstain:0,total:0}}),K==null||K.forEach(J=>{W[J.sub_poll_id]&&(J.vote==="favor"?W[J.sub_poll_id].favor++:J.vote==="against"?W[J.sub_poll_id].against++:J.vote==="abstain"&&W[J.sub_poll_id].abstain++,W[J.sub_poll_id].total++)}),le[H.id]=W}catch(K){console.error("Error fetching poll results:",K)}w(le)};U.length>0&&k()},[U]);const V=k=>{const le=x[k.id];if(!le||!k.sub_polls)return null;let ce=0,H=0,K=0,oe=0;if(Object.values(le).forEach(J=>{ce+=J.favor,H+=J.against,K+=J.abstain,oe+=J.total}),oe===0)return null;const W=Math.max(ce,H,K);return ce===W&&ce>0?"favor":H===W&&H>0?"against":K===W&&K>0?"abstain":null},F=k=>{if(!k)return null;switch(k){case"favor":return i.jsxs(We,{className:"bg-green-100 text-green-800 border-green-300",children:[i.jsx(as,{className:"h-3 w-3 mr-1"}),"Passed"]});case"against":return i.jsxs(We,{className:"bg-red-100 text-red-800 border-red-300",children:[i.jsx(ro,{className:"h-3 w-3 mr-1"}),"Rejected"]});case"abstain":return i.jsxs(We,{className:"bg-yellow-100 text-yellow-800 border-yellow-300",children:[i.jsx(yv,{className:"h-3 w-3 mr-1"}),"Abstained"]});default:return null}},D=k=>{m(k),l(!0)},G=k=>{m(k),u(!0)},O=k=>{if(!A.canEditVoting){I({title:"Access Denied",description:"You don't have permission to edit polls",variant:"destructive"});return}m(k),f(!0)},L=async(k,le)=>{if(!A.canDeleteContent){I({title:"Access Denied",description:"You don't have permission to delete polls",variant:"destructive"});return}confirm(le==="completed"?"Are you sure you want to delete this completed poll? This will permanently remove the poll and all its voting results. This action cannot be undone.":"Are you sure you want to delete this poll?")&&await P(k)},ie=async(k,le,ce)=>{if(!A.canEditVoting){I({title:"Access Denied",description:"You don't have permission to manage polls",variant:"destructive"});return}if(typeof le=="number"&&typeof ce=="number"&&le<ce){S(k),_(!0);return}await R(k,"completed")},ne=(k,le="")=>k??le,me=k=>{M(k),k||j(),a(k)};ke.useEffect(()=>{M(s)},[s,M]),ke.useEffect(()=>{if(t){n(t);const k=document.getElementById(`poll-card-${t}`);k&&k.scrollIntoView({behavior:"smooth",block:"center"});const le=setTimeout(()=>n(null),2e3);return()=>clearTimeout(le)}},[t]);const pe=(k,le)=>!k.unique_id&&!le.unique_id?0:k.unique_id?le.unique_id?k.unique_id.localeCompare(le.unique_id,void 0,{numeric:!0,sensitivity:"base"}):-1:1,xe=[...z].sort(pe),Ae=[...U].sort(pe);if([...X].sort(pe),E)return i.jsx("div",{className:"flex items-center justify-center h-64",children:i.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary"})});const ge=C.length===0;return i.jsxs("div",{className:"max-w-5xl mx-auto px-0 space-y-6",children:[i.jsxs("div",{className:"flex flex-col md:flex-row md:items-center md:justify-between gap-4",children:[i.jsxs("div",{children:[i.jsx("h1",{className:"text-2xl font-bold",children:"Voting & Polls"}),i.jsx("p",{className:"text-sm text-muted-foreground",children:"Participate in decisions and view results."}),i.jsx("p",{className:"text-xs text-blue-700 bg-blue-50 rounded px-2 py-1 mt-2 inline-block",children:"All voting is anonymous. Individual choices are hidden from other members."})]}),A.canCreateVoting&&!A.loading&&i.jsxs(ue,{onClick:()=>a(!0),className:"bg-[#8E1616] hover:bg-[#7A1414] text-white",children:[i.jsx(Pa,{className:"h-4 w-4 mr-2"})," Create Poll"]})]}),ge?i.jsx("div",{className:"text-center text-muted-foreground py-12",children:i.jsxs("div",{className:"max-w-md mx-auto",children:[i.jsx(Gs,{className:"h-12 w-12 mx-auto text-gray-400 mb-4"}),i.jsx("h3",{className:"text-lg font-medium mb-2",children:"No polls available"}),i.jsx("p",{className:"text-sm text-gray-500",children:"Polls will appear here when they are created by administrators."})]})}):i.jsxs(bl,{value:T,onValueChange:N,className:"space-y-6",children:[i.jsxs(So,{className:"grid w-full grid-cols-3",children:[i.jsxs(Vn,{value:"active",children:["Active (",xe.length,")"]}),i.jsxs(Vn,{value:"past",children:["Past Date (",Ae.length,")"]}),i.jsxs(Vn,{value:"completed",children:["Completed (",X.length,")"]})]}),i.jsx(zr,{value:"active",className:"space-y-4",children:xe.length===0?i.jsx("div",{className:"text-center text-muted-foreground py-8",children:i.jsxs("div",{className:"max-w-md mx-auto",children:[i.jsx(as,{className:"h-12 w-12 mx-auto text-gray-400 mb-4"}),i.jsx("h3",{className:"text-lg font-medium mb-2",children:"No active polls"}),i.jsx("p",{className:"text-sm text-gray-500",children:"All polls have been completed or are not yet available."})]})}):i.jsx("div",{className:"space-y-4",children:xe.map(k=>{var le,ce,H,K,oe,W,J;return i.jsxs(Ye,{id:`poll-card-${k.id}`,className:`hover:shadow-md transition-shadow border-l-4 border-l-green-500 flex flex-row items-stretch ${r===k.id?"blink-highlight":""}`,children:[i.jsxs("div",{className:"flex-1",children:[i.jsx(ct,{className:"pb-3 flex items-start justify-between",children:i.jsxs("div",{className:"flex-1",children:[i.jsxs(ft,{className:"text-lg flex items-center gap-2 mb-2",children:[i.jsx("span",{className:"font-semibold",children:ne(k.title,"Untitled")}),i.jsx(We,{className:"bg-green-500 text-white text-xs",children:"Active"})]}),k.unique_id&&i.jsxs(We,{className:"bg-blue-600 text-white text-sm px-3 py-1 rounded-full flex items-center gap-1 shadow-sm",children:[i.jsx(Gs,{className:"h-4 w-4 mr-1"})," ",k.unique_id]}),k.description&&i.jsx(tn,{className:"text-sm text-gray-600 mt-1",children:ne(k.description,"")})]})}),i.jsxs(Je,{className:"space-y-4",children:[i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 text-sm text-muted-foreground",children:[i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx(en,{className:"h-4 w-4 text-gray-500"}),i.jsxs("span",{children:["Deadline: ",k.deadline?vt(new Date(k.deadline),"MMM dd, yyyy"):"No deadline"]})]}),i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx(mr,{className:"h-4 w-4 text-gray-500"}),i.jsxs("span",{children:[((le=k.stats)==null?void 0:le.voted_count)||0,"/",((ce=k.stats)==null?void 0:ce.total_voters)||0," voted"]})]}),i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx(tr,{className:"h-4 w-4 text-gray-500"}),i.jsxs("span",{children:[((H=k.stats)==null?void 0:H.sub_poll_count)||0," questions"]})]})]}),i.jsxs("div",{className:"flex flex-wrap gap-2 pt-2 border-t",children:[k.hasVoted?i.jsxs(ue,{disabled:!0,className:"bg-gray-300 text-gray-600 cursor-not-allowed",children:[i.jsx(Qa,{className:"h-4 w-4 mr-2"}),"Voted"]}):i.jsxs(ue,{onClick:()=>D(k),className:"bg-green-600 hover:bg-green-700 text-white",children:[i.jsx(Gs,{className:"h-4 w-4 mr-2"}),"Vote Now"]}),i.jsxs(ue,{variant:"outline",onClick:()=>G(k),children:[i.jsx(Or,{className:"h-4 w-4 mr-2"}),"View Results"]}),A.canEditVoting&&i.jsxs(ue,{variant:"outline",onClick:()=>O(k),children:[i.jsx(sm,{className:"h-4 w-4 mr-2"}),"Edit"]}),A.canEditVoting&&i.jsxs(ue,{variant:"outline",onClick:()=>{var B,ae;return ie(k.id,(B=k.stats)==null?void 0:B.voted_count,(ae=k.stats)==null?void 0:ae.total_voters)},className:"text-orange-600 hover:text-orange-700 hover:bg-orange-50",children:[i.jsx(Qa,{className:"h-4 w-4 mr-2"}),"Complete"]}),A.canDeleteContent&&i.jsxs(ue,{variant:"outline",onClick:()=>L(k.id,k.status),className:"text-red-600 hover:text-red-700 hover:bg-red-50 border-red-300",title:"Delete poll",children:[i.jsx(yr,{className:"h-4 w-4 mr-2"}),"Delete"]})]})]})]}),i.jsxs("div",{className:"flex flex-col justify-center items-center px-6 bg-gray-50 border-l border-gray-200 min-w-[120px]",children:[i.jsx("div",{className:"text-3xl font-bold text-green-700",children:((K=k.stats)==null?void 0:K.voted_count)||0}),i.jsxs("div",{className:"text-lg text-gray-500",children:["/ ",((oe=k.stats)==null?void 0:oe.total_voters)||0]}),i.jsxs("div",{className:"text-md text-blue-700 mt-2",children:[(((W=k.stats)==null?void 0:W.total_voters)||0)-(((J=k.stats)==null?void 0:J.voted_count)||0)," Pending"]})]})]},k.id)})})}),i.jsx(zr,{value:"past",className:"space-y-4",children:Ae.length===0?i.jsx("div",{className:"text-center text-muted-foreground py-8",children:i.jsxs("div",{className:"max-w-md mx-auto",children:[i.jsx(as,{className:"h-12 w-12 mx-auto text-gray-400 mb-4"}),i.jsx("h3",{className:"text-lg font-medium mb-2",children:"No past date polls"}),i.jsx("p",{className:"text-sm text-gray-500",children:"Polls with deadlines in the past will appear here."})]})}):i.jsx("div",{className:"space-y-4",children:Ae.map(k=>{var H,K,oe,W;const le=V(k),ce=F(le);return i.jsxs(Ye,{id:`poll-card-${k.id}`,className:`hover:shadow-md transition-shadow border-l-4 border-l-gray-400 flex flex-row items-stretch ${r===k.id?"blink-highlight":""}`,children:[i.jsxs("div",{className:"flex-1",children:[i.jsx(ct,{className:"pb-3 flex items-start justify-between",children:i.jsxs("div",{className:"flex-1",children:[i.jsxs(ft,{className:"text-lg flex items-center gap-2 mb-2",children:[i.jsx("span",{className:"font-semibold",children:ne(k.title,"Untitled")}),i.jsx(We,{variant:"secondary",className:"text-xs",children:"Past Date"}),k.unique_id&&i.jsxs(We,{className:"bg-blue-600 text-white text-sm px-3 py-1 rounded-full flex items-center gap-1 shadow-sm",children:[i.jsx(Gs,{className:"h-4 w-4 mr-1"})," ",k.unique_id]}),ce]}),i.jsxs(tn,{className:"text-sm text-gray-600 mt-1",children:["Deadline was ",k.deadline?vt(new Date(k.deadline),"MMM dd, yyyy"):"Unknown date"]})]})}),i.jsx(Je,{children:i.jsxs("div",{className:"flex flex-wrap gap-2 pt-2 border-t",children:[k.hasVoted?i.jsxs(ue,{disabled:!0,className:"bg-gray-300 text-gray-600 cursor-not-allowed",children:[i.jsx(Qa,{className:"h-4 w-4 mr-2"}),"Voted"]}):i.jsxs(ue,{onClick:()=>D(k),className:"bg-green-600 hover:bg-green-700 text-white",children:[i.jsx(Gs,{className:"h-4 w-4 mr-2"}),"Vote Now"]}),i.jsxs(ue,{variant:"outline",onClick:()=>G(k),children:[i.jsx(Or,{className:"h-4 w-4 mr-2"}),"View Results"]}),A.canEditVoting&&i.jsxs(ue,{variant:"outline",onClick:()=>O(k),children:[i.jsx(sm,{className:"h-4 w-4 mr-2"}),"Edit"]}),A.canEditVoting&&i.jsxs(ue,{variant:"outline",onClick:()=>{var J,B;return ie(k.id,(J=k.stats)==null?void 0:J.voted_count,(B=k.stats)==null?void 0:B.total_voters)},className:"text-orange-600 hover:text-orange-700 hover:bg-orange-50",children:[i.jsx(Qa,{className:"h-4 w-4 mr-2"}),"Complete"]}),A.canDeleteContent&&i.jsxs(ue,{variant:"outline",onClick:()=>L(k.id,k.status),className:"text-red-600 hover:text-red-700 hover:bg-red-50 border-red-300",title:k.status==="completed"?"Delete completed poll (this will permanently remove all voting results)":"Delete poll",children:[i.jsx(yr,{className:"h-4 w-4 mr-2"}),k.status==="completed"?"Delete Poll":"Delete"]})]})})]}),i.jsxs("div",{className:"flex flex-col justify-center items-center px-6 bg-gray-50 border-l border-gray-200 min-w-[120px]",children:[i.jsx("div",{className:"text-3xl font-bold text-green-700",children:((H=k.stats)==null?void 0:H.voted_count)||0}),i.jsxs("div",{className:"text-lg text-gray-500",children:["/ ",((K=k.stats)==null?void 0:K.total_voters)||0]}),i.jsxs("div",{className:"text-md text-blue-700 mt-2",children:[(((oe=k.stats)==null?void 0:oe.total_voters)||0)-(((W=k.stats)==null?void 0:W.voted_count)||0)," Pending"]})]})]},k.id)})})}),i.jsx(zr,{value:"completed",className:"space-y-4",children:X.length===0?i.jsx("div",{className:"text-center text-muted-foreground py-8",children:i.jsxs("div",{className:"max-w-md mx-auto",children:[i.jsx(as,{className:"h-12 w-12 mx-auto text-gray-400 mb-4"}),i.jsx("h3",{className:"text-lg font-medium mb-2",children:"No completed polls"}),i.jsx("p",{className:"text-sm text-gray-500",children:"Polls will appear here once all members have voted or are manually completed."})]})}):i.jsx("div",{className:"space-y-4",children:X.map(k=>{var H,K,oe,W;const le=V(k),ce=F(le);return i.jsxs(Ye,{id:`poll-card-${k.id}`,className:`hover:shadow-md transition-shadow border-l-4 border-l-gray-400 flex flex-row items-stretch ${r===k.id?"blink-highlight":""}`,children:[i.jsxs("div",{className:"flex-1",children:[i.jsx(ct,{className:"pb-3 flex items-start justify-between",children:i.jsxs("div",{className:"flex-1",children:[i.jsxs(ft,{className:"text-lg flex items-center gap-2 mb-2",children:[i.jsx("span",{className:"font-semibold",children:ne(k.title,"Untitled")}),i.jsx(We,{variant:"secondary",className:"text-xs",children:"Completed"}),k.unique_id&&i.jsxs(We,{className:"bg-blue-600 text-white text-sm px-3 py-1 rounded-full flex items-center gap-1 shadow-sm",children:[i.jsx(Gs,{className:"h-4 w-4 mr-1"})," ",k.unique_id]}),ce]}),i.jsxs(tn,{className:"text-sm text-gray-600 mt-1",children:["Completed on ",k.deadline?vt(new Date(k.deadline),"MMM dd, yyyy"):"Unknown date"]})]})}),i.jsx(Je,{children:i.jsxs("div",{className:"flex flex-wrap gap-2 pt-2 border-t",children:[i.jsxs(ue,{variant:"outline",onClick:()=>G(k),children:[i.jsx(Or,{className:"h-4 w-4 mr-2"}),"View Results"]}),A.canEditVoting&&i.jsxs(ue,{variant:"outline",onClick:()=>O(k),children:[i.jsx(sm,{className:"h-4 w-4 mr-2"}),"Edit"]}),A.canDeleteContent&&i.jsxs(ue,{variant:"outline",onClick:()=>L(k.id,k.status),className:"text-red-600 hover:text-red-700 hover:bg-red-50 border-red-300",title:k.status==="completed"?"Delete completed poll (this will permanently remove all voting results)":"Delete poll",children:[i.jsx(yr,{className:"h-4 w-4 mr-2"}),k.status==="completed"?"Delete Poll":"Delete"]})]})})]}),i.jsxs("div",{className:"flex flex-col justify-center items-center px-6 bg-gray-50 border-l border-gray-200 min-w-[120px]",children:[i.jsx("div",{className:"text-3xl font-bold text-green-700",children:((H=k.stats)==null?void 0:H.voted_count)??0}),i.jsxs("div",{className:"text-lg text-gray-500",children:["/ ",((K=k.stats)==null?void 0:K.total_voters)??0]}),i.jsxs("div",{className:"text-md text-blue-700 mt-2",children:[(((oe=k.stats)==null?void 0:oe.total_voters)??0)-(((W=k.stats)==null?void 0:W.voted_count)??0)," Pending"]})]})]},k.id)})})})]}),A.canCreateVoting&&i.jsx(xte,{open:s,onOpenChange:me}),i.jsx(_te,{open:o,onOpenChange:l,poll:g}),i.jsx(Tte,{open:c,onOpenChange:u,poll:g}),i.jsx(Ate,{open:d,onOpenChange:f,poll:g}),i.jsx(Pte,{open:p,onOpenChange:h,poll:g}),A.canCreateVoting&&i.jsx(ue,{onClick:()=>a(!0),className:"fixed bottom-8 right-8 z-50 rounded-full shadow-lg bg-[#8E1616] hover:bg-[#7A1414] text-white w-16 h-16 flex items-center justify-center text-3xl",children:i.jsx(Pa,{className:"h-8 w-8"})}),i.jsx(Nt,{open:v,onOpenChange:_,children:i.jsxs(bt,{children:[i.jsxs(jt,{children:[i.jsx(Et,{children:"Complete Poll Early?"}),i.jsx($t,{children:"Not all members have voted. Are you sure you want to complete this poll and close voting? This action cannot be undone."})]}),i.jsxs(G1,{children:[i.jsx(ue,{variant:"outline",onClick:()=>{_(!1),S(null)},children:"Cancel"}),i.jsx(ue,{variant:"destructive",onClick:async()=>{b&&(await R(b,"completed"),_(!1),S(null))},children:"Yes, Complete Poll"})]})]})})]})},LD=()=>{const[e,t]=y.useState(!1),{toast:r}=St(),{user:n,session:s}=kt();return{createMember:async o=>{t(!0);try{if(console.log("Current user:",n),console.log("Current session:",s),!n||!s)return r({title:"Not authenticated",description:"You must be logged in as an admin to add members.",variant:"destructive"}),{error:"Not authenticated"};const{data:l,error:c}=await he.functions.invoke("create-member",{body:o});return console.log("Edge function response:",l,c),c||!(l!=null&&l.success)?(r({title:"Creation Failed",description:(c==null?void 0:c.message)||(l==null?void 0:l.error)||"Failed to create member",variant:"destructive"}),{error:(c==null?void 0:c.message)||(l==null?void 0:l.error)}):(r({title:"Member Created",description:"Member added successfully."}),l)}catch(l){return console.error("Error in createMember:",l),r({title:"Creation Failed",description:l.message||"Failed to create member",variant:"destructive"}),{error:l.message}}finally{t(!1)}},isCreating:e}},Dte=e=>{const t=/^[^\s@]+@[^\s@]+\.[^\s@]+$/;if(!e||typeof e!="string")return{isValid:!1,error:"Email is required"};const r=e.trim().toLowerCase();return t.test(r)?r.includes("<script>")||r.includes("javascript:")?{isValid:!1,error:"Invalid email format"}:{isValid:!0,sanitizedValue:r}:{isValid:!1,error:"Invalid email format"}},Rte=e=>!e||typeof e!="string"?{isValid:!1,error:"Password is required"}:e.length<8?{isValid:!1,error:"Password must be at least 8 characters long"}:/[A-Za-z]/.test(e)?/[0-9]/.test(e)?{isValid:!0,sanitizedValue:e}:{isValid:!1,error:"Password must contain at least one number"}:{isValid:!1,error:"Password must contain at least one letter"},Mte=e=>{if(!e)return{isValid:!0,sanitizedValue:""};if(typeof e!="string")return{isValid:!1,error:"Invalid phone number format"};const t=e.replace(/\s+/g,"").replace(/[^\d+]/g,"");return/^\+?[0-9]{10,15}$/.test(t)?{isValid:!0,sanitizedValue:t}:{isValid:!1,error:"Invalid phone number format"}},nN=(e,t="Name")=>{if(!e||typeof e!="string")return{isValid:!1,error:`${t} is required`};const r=e.trim();return r.length<2?{isValid:!1,error:`${t} must be at least 2 characters long`}:r.length>50?{isValid:!1,error:`${t} must be less than 50 characters`}:r.includes("<script>")||r.includes("javascript:")?{isValid:!1,error:`Invalid ${t.toLowerCase()} format`}:{isValid:!0,sanitizedValue:r}},Ote=({open:e,onOpenChange:t,onMemberAdded:r})=>{const{createMember:n,isCreating:s}=LD(),[a,o]=y.useState({email:"",firstName:"",lastName:"",phone:"",role:"member",notes:"",password:""}),[l,c]=y.useState(!1),[u,d]=y.useState(!1),[f,p]=y.useState(null),[h,g]=y.useState({}),[m,x]=y.useState(!1),w=y.useCallback(()=>{const N="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789!@#$%^&*()_+";let C="";for(let E=0;E<12;E++)C+=N.charAt(Math.floor(Math.random()*N.length));return C},[]),v=y.useCallback(()=>{const N=w();o(C=>({...C,password:N})),c(!0)},[w]),_=y.useCallback(()=>{const N={},C=Dte(a.email);C.isValid||(N.email=C.error);const E=nN(a.firstName,"First name");E.isValid||(N.firstName=E.error);const P=nN(a.lastName,"Last name");P.isValid||(N.lastName=P.error);const R=Rte(a.password);if(R.isValid||(N.password=R.error),a.phone){const j=Mte(a.phone);j.isValid||(N.phone=j.error)}return(!a.role||!["super_admin","admin","member","secretary","treasurer"].includes(a.role))&&(N.role="Please select a valid role"),N},[a]),b=y.useCallback(async N=>{N.preventDefault(),p(null),g({});const C=_();if(Object.keys(C).length>0){g(C);return}x(!0);try{od.log("Creating new member:",{email:a.email,role:a.role}),await n({email:a.email,firstName:a.firstName,lastName:a.lastName,phone:a.phone||void 0,role:a.role,notes:a.notes||void 0,password:a.password}),o({email:"",firstName:"",lastName:"",phone:"",role:"member",notes:"",password:""}),c(!1),d(!1),g({}),p(null),r==null||r(),t(!1)}catch(E){p(E.message||"Failed to create member. Please try again.")}finally{x(!1)}},[a,_,n,r,t]),S=y.useCallback((N,C)=>{o(E=>({...E,[N]:C})),h[N]&&g(E=>({...E,[N]:""}))},[h]),T=y.useCallback(()=>{o({email:"",firstName:"",lastName:"",phone:"",role:"member",notes:"",password:""}),c(!1),d(!1),g({}),p(null),t(!1)},[t]);return i.jsx(Nt,{open:e,onOpenChange:T,children:i.jsxs(bt,{className:"sm:max-w-[500px] bg-white pointer-events-auto overflow-visible",children:[i.jsxs("button",{type:"button","aria-label":"Close",onClick:T,className:"absolute top-2 right-2 p-2 rounded hover:bg-gray-100 focus:outline-none z-20",children:[i.jsx(lo,{className:"sr-only"}),i.jsx("span",{className:"sr-only",children:"Close"}),i.jsx("svg",{className:"h-5 w-5",fill:"none",stroke:"currentColor",strokeWidth:"2",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M6 18L18 6M6 6l12 12"})})]}),i.jsxs(jt,{children:[i.jsxs(Et,{className:"flex items-center space-x-2",children:[i.jsx(lo,{className:"h-5 w-5"}),i.jsx("span",{children:"Add New Member"})]}),i.jsx($t,{children:"Add a new bureau member with appropriate role and permissions"})]}),i.jsxs("form",{onSubmit:b,className:"space-y-4",children:[f&&i.jsxs("div",{className:"flex items-center space-x-2 p-3 bg-red-50 border border-red-200 rounded-md",role:"alert",children:[i.jsx(ea,{className:"h-4 w-4 text-red-500"}),i.jsx("span",{className:"text-sm text-red-700",children:f})]}),i.jsxs("div",{children:[i.jsx(Ve,{htmlFor:"email",children:"Email Address *"}),i.jsxs("div",{className:"relative",children:[i.jsx(ta,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400"}),i.jsx(dt,{id:"email",type:"email",value:a.email,onChange:N=>S("email",N.target.value),placeholder:"member@iskconbureau.in",autoComplete:"off",className:`pl-10 ${h.email?"border-red-500":""}`,required:!0,"aria-invalid":!!h.email,"aria-describedby":h.email?"email-error":void 0,disabled:m})]}),h.email&&i.jsx("div",{id:"email-error",className:"text-red-500 text-xs mt-1",role:"alert",children:h.email})]}),i.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[i.jsxs("div",{children:[i.jsx(Ve,{htmlFor:"firstName",children:"First Name *"}),i.jsx(dt,{id:"firstName",value:a.firstName,onChange:N=>S("firstName",N.target.value),placeholder:"Enter first name",className:h.firstName?"border-red-500":"",required:!0,"aria-invalid":!!h.firstName,"aria-describedby":h.firstName?"firstName-error":void 0}),h.firstName&&i.jsx("div",{id:"firstName-error",className:"text-red-500 text-xs mt-1",role:"alert",children:h.firstName})]}),i.jsxs("div",{children:[i.jsx(Ve,{htmlFor:"lastName",children:"Last Name *"}),i.jsx(dt,{id:"lastName",value:a.lastName,onChange:N=>S("lastName",N.target.value),placeholder:"Enter last name",className:h.lastName?"border-red-500":"",required:!0,"aria-invalid":!!h.lastName,"aria-describedby":h.lastName?"lastName-error":void 0}),h.lastName&&i.jsx("div",{id:"lastName-error",className:"text-red-500 text-xs mt-1",role:"alert",children:h.lastName})]})]}),i.jsxs("div",{children:[i.jsx(Ve,{htmlFor:"phone",children:"Phone Number"}),i.jsxs("div",{className:"relative",children:[i.jsx(_f,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400"}),i.jsx(dt,{id:"phone",type:"tel",value:a.phone,onChange:N=>S("phone",N.target.value),placeholder:"+91 98765 43210",className:`pl-10 ${h.phone?"border-red-500":""}`,"aria-invalid":!!h.phone,"aria-describedby":h.phone?"phone-error":void 0})]}),h.phone&&i.jsx("div",{id:"phone-error",className:"text-red-500 text-xs mt-1",role:"alert",children:h.phone})]}),i.jsxs("div",{children:[i.jsx(Ve,{htmlFor:"role",children:"Role *"}),i.jsxs(oa,{value:a.role,onValueChange:N=>S("role",N),children:[i.jsx(As,{className:h.role?"border-red-500":"",children:i.jsx(la,{placeholder:"Select a role"})}),i.jsxs(Ps,{children:[i.jsx(zt,{value:"member",children:"Member"}),i.jsx(zt,{value:"admin",children:"Admin"}),i.jsx(zt,{value:"super_admin",children:"Super Admin"})]})]}),h.role&&i.jsx("div",{className:"text-red-500 text-xs mt-1",role:"alert",children:h.role})]}),i.jsxs("div",{children:[i.jsx(Ve,{htmlFor:"password",children:"Password *"}),i.jsxs("div",{className:"relative",children:[i.jsx(dt,{id:"password",type:l?"text":"password",value:a.password,onChange:N=>S("password",N.target.value),placeholder:"Enter password",className:`pr-20 ${h.password?"border-red-500":""}`,required:!0,"aria-invalid":!!h.password,"aria-describedby":h.password?"password-error":void 0}),i.jsxs("div",{className:"absolute right-2 top-1/2 transform -translate-y-1/2 flex space-x-1",children:[i.jsx(ue,{type:"button",variant:"ghost",size:"sm",onClick:()=>c(!l),className:"h-6 w-6 p-0",children:l?i.jsx(nm,{className:"h-3 w-3"}):i.jsx(Or,{className:"h-3 w-3"})}),i.jsx(ue,{type:"button",variant:"ghost",size:"sm",onClick:v,className:"h-6 w-6 p-0",children:i.jsx(os,{className:"h-3 w-3"})})]})]}),h.password&&i.jsx("div",{id:"password-error",className:"text-red-500 text-xs mt-1",role:"alert",children:h.password}),i.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Password must be at least 8 characters with letters and numbers"})]}),i.jsxs("div",{children:[i.jsxs(ue,{type:"button",variant:"ghost",onClick:()=>d(!u),className:"text-sm text-gray-600 hover:text-gray-800",children:[u?"Hide":"Add"," Notes"]}),u&&i.jsx(Ma,{value:a.notes,onChange:N=>S("notes",N.target.value),placeholder:"Additional notes about this member...",className:"mt-2",rows:3})]}),i.jsxs("div",{className:"flex justify-end space-x-2 pt-4",children:[i.jsx(ue,{type:"button",variant:"outline",onClick:T,disabled:m,children:"Cancel"}),i.jsx(ue,{type:"submit",disabled:m||s,children:m||s?"Creating...":"Create Member"})]})]})]})})};var ly=["Enter"," "],Fte=["ArrowDown","PageUp","Home"],$D=["ArrowUp","PageDown","End"],Ite=[...Fte,...$D],Lte={ltr:[...ly,"ArrowRight"],rtl:[...ly,"ArrowLeft"]},$te={ltr:["ArrowLeft"],rtl:["ArrowRight"]},Jf="Menu",[af,Bte,Ute]=xf(Jf),[Cl,BD]=Fr(Jf,[Ute,yo,kp]),Qp=yo(),UD=kp(),[zte,Tl]=Cl(Jf),[Vte,Zf]=Cl(Jf),zD=e=>{const{__scopeMenu:t,open:r=!1,children:n,dir:s,onOpenChange:a,modal:o=!0}=e,l=Qp(t),[c,u]=y.useState(null),d=y.useRef(!1),f=hr(a),p=uu(s);return y.useEffect(()=>{const h=()=>{d.current=!0,document.addEventListener("pointerdown",g,{capture:!0,once:!0}),document.addEventListener("pointermove",g,{capture:!0,once:!0})},g=()=>d.current=!1;return document.addEventListener("keydown",h,{capture:!0}),()=>{document.removeEventListener("keydown",h,{capture:!0}),document.removeEventListener("pointerdown",g,{capture:!0}),document.removeEventListener("pointermove",g,{capture:!0})}},[]),i.jsx(Q0,{...l,children:i.jsx(zte,{scope:t,open:r,onOpenChange:f,content:c,onContentChange:u,children:i.jsx(Vte,{scope:t,onClose:y.useCallback(()=>f(!1),[f]),isUsingKeyboardRef:d,dir:p,modal:o,children:n})})})};zD.displayName=Jf;var Wte="MenuAnchor",a_=y.forwardRef((e,t)=>{const{__scopeMenu:r,...n}=e,s=Qp(r);return i.jsx(Nf,{...s,...n,ref:t})});a_.displayName=Wte;var i_="MenuPortal",[Hte,VD]=Cl(i_,{forceMount:void 0}),WD=e=>{const{__scopeMenu:t,forceMount:r,children:n,container:s}=e,a=Tl(i_,t);return i.jsx(Hte,{scope:t,forceMount:r,children:i.jsx(Ir,{present:r||a.open,children:i.jsx(Jc,{asChild:!0,container:s,children:n})})})};WD.displayName=i_;var Es="MenuContent",[Gte,o_]=Cl(Es),HD=y.forwardRef((e,t)=>{const r=VD(Es,e.__scopeMenu),{forceMount:n=r.forceMount,...s}=e,a=Tl(Es,e.__scopeMenu),o=Zf(Es,e.__scopeMenu);return i.jsx(af.Provider,{scope:e.__scopeMenu,children:i.jsx(Ir,{present:n||a.open,children:i.jsx(af.Slot,{scope:e.__scopeMenu,children:o.modal?i.jsx(qte,{...s,ref:t}):i.jsx(Yte,{...s,ref:t})})})})}),qte=y.forwardRef((e,t)=>{const r=Tl(Es,e.__scopeMenu),n=y.useRef(null),s=st(t,n);return y.useEffect(()=>{const a=n.current;if(a)return mp(a)},[]),i.jsx(l_,{...e,ref:s,trapFocus:r.open,disableOutsidePointerEvents:r.open,disableOutsideScroll:!0,onFocusOutside:Oe(e.onFocusOutside,a=>a.preventDefault(),{checkForDefaultPrevented:!1}),onDismiss:()=>r.onOpenChange(!1)})}),Yte=y.forwardRef((e,t)=>{const r=Tl(Es,e.__scopeMenu);return i.jsx(l_,{...e,ref:t,trapFocus:!1,disableOutsidePointerEvents:!1,disableOutsideScroll:!1,onDismiss:()=>r.onOpenChange(!1)})}),Kte=oo("MenuContent.ScrollLock"),l_=y.forwardRef((e,t)=>{const{__scopeMenu:r,loop:n=!1,trapFocus:s,onOpenAutoFocus:a,onCloseAutoFocus:o,disableOutsidePointerEvents:l,onEntryFocus:c,onEscapeKeyDown:u,onPointerDownOutside:d,onFocusOutside:f,onInteractOutside:p,onDismiss:h,disableOutsideScroll:g,...m}=e,x=Tl(Es,r),w=Zf(Es,r),v=Qp(r),_=UD(r),b=Bte(r),[S,T]=y.useState(null),N=y.useRef(null),C=st(t,N,x.onContentChange),E=y.useRef(0),P=y.useRef(""),R=y.useRef(0),j=y.useRef(null),M=y.useRef("right"),A=y.useRef(0),I=g?Mf:y.Fragment,X=g?{as:Kte,allowPinchZoom:!0}:void 0,Y=U=>{var ne,me;const V=P.current+U,F=b().filter(pe=>!pe.disabled),D=document.activeElement,G=(ne=F.find(pe=>pe.ref.current===D))==null?void 0:ne.textValue,O=F.map(pe=>pe.textValue),L=ore(O,V,G),ie=(me=F.find(pe=>pe.textValue===L))==null?void 0:me.ref.current;(function pe(xe){P.current=xe,window.clearTimeout(E.current),xe!==""&&(E.current=window.setTimeout(()=>pe(""),1e3))})(V),ie&&setTimeout(()=>ie.focus())};y.useEffect(()=>()=>window.clearTimeout(E.current),[]),fp();const z=y.useCallback(U=>{var F,D;return M.current===((F=j.current)==null?void 0:F.side)&&cre(U,(D=j.current)==null?void 0:D.area)},[]);return i.jsx(Gte,{scope:r,searchRef:P,onItemEnter:y.useCallback(U=>{z(U)&&U.preventDefault()},[z]),onItemLeave:y.useCallback(U=>{var V;z(U)||((V=N.current)==null||V.focus(),T(null))},[z]),onTriggerLeave:y.useCallback(U=>{z(U)&&U.preventDefault()},[z]),pointerGraceTimerRef:R,onPointerGraceIntentChange:y.useCallback(U=>{j.current=U},[]),children:i.jsx(I,{...X,children:i.jsx(Rf,{asChild:!0,trapped:s,onMountAutoFocus:Oe(a,U=>{var V;U.preventDefault(),(V=N.current)==null||V.focus({preventScroll:!0})}),onUnmountAutoFocus:o,children:i.jsx(vl,{asChild:!0,disableOutsidePointerEvents:l,onEscapeKeyDown:u,onPointerDownOutside:d,onFocusOutside:f,onInteractOutside:p,onDismiss:h,children:i.jsx(a4,{asChild:!0,..._,dir:w.dir,orientation:"vertical",loop:n,currentTabStopId:S,onCurrentTabStopIdChange:T,onEntryFocus:Oe(c,U=>{w.isUsingKeyboardRef.current||U.preventDefault()}),preventScrollOnEntryFocus:!0,children:i.jsx(J0,{role:"menu","aria-orientation":"vertical","data-state":oR(x.open),"data-radix-menu-content":"",dir:w.dir,...v,...m,ref:C,style:{outline:"none",...m.style},onKeyDown:Oe(m.onKeyDown,U=>{const F=U.target.closest("[data-radix-menu-content]")===U.currentTarget,D=U.ctrlKey||U.altKey||U.metaKey,G=U.key.length===1;F&&(U.key==="Tab"&&U.preventDefault(),!D&&G&&Y(U.key));const O=N.current;if(U.target!==O||!Ite.includes(U.key))return;U.preventDefault();const ie=b().filter(ne=>!ne.disabled).map(ne=>ne.ref.current);$D.includes(U.key)&&ie.reverse(),are(ie)}),onBlur:Oe(e.onBlur,U=>{U.currentTarget.contains(U.target)||(window.clearTimeout(E.current),P.current="")}),onPointerMove:Oe(e.onPointerMove,of(U=>{const V=U.target,F=A.current!==U.clientX;if(U.currentTarget.contains(V)&&F){const D=U.clientX>A.current?"right":"left";M.current=D,A.current=U.clientX}}))})})})})})})});HD.displayName=Es;var Xte="MenuGroup",c_=y.forwardRef((e,t)=>{const{__scopeMenu:r,...n}=e;return i.jsx(ze.div,{role:"group",...n,ref:t})});c_.displayName=Xte;var Qte="MenuLabel",GD=y.forwardRef((e,t)=>{const{__scopeMenu:r,...n}=e;return i.jsx(ze.div,{...n,ref:t})});GD.displayName=Qte;var N0="MenuItem",sN="menu.itemSelect",Jp=y.forwardRef((e,t)=>{const{disabled:r=!1,onSelect:n,...s}=e,a=y.useRef(null),o=Zf(N0,e.__scopeMenu),l=o_(N0,e.__scopeMenu),c=st(t,a),u=y.useRef(!1),d=()=>{const f=a.current;if(!r&&f){const p=new CustomEvent(sN,{bubbles:!0,cancelable:!0});f.addEventListener(sN,h=>n==null?void 0:n(h),{once:!0}),l1(f,p),p.defaultPrevented?u.current=!1:o.onClose()}};return i.jsx(qD,{...s,ref:c,disabled:r,onClick:Oe(e.onClick,d),onPointerDown:f=>{var p;(p=e.onPointerDown)==null||p.call(e,f),u.current=!0},onPointerUp:Oe(e.onPointerUp,f=>{var p;u.current||(p=f.currentTarget)==null||p.click()}),onKeyDown:Oe(e.onKeyDown,f=>{const p=l.searchRef.current!=="";r||p&&f.key===" "||ly.includes(f.key)&&(f.currentTarget.click(),f.preventDefault())})})});Jp.displayName=N0;var qD=y.forwardRef((e,t)=>{const{__scopeMenu:r,disabled:n=!1,textValue:s,...a}=e,o=o_(N0,r),l=UD(r),c=y.useRef(null),u=st(t,c),[d,f]=y.useState(!1),[p,h]=y.useState("");return y.useEffect(()=>{const g=c.current;g&&h((g.textContent??"").trim())},[a.children]),i.jsx(af.ItemSlot,{scope:r,disabled:n,textValue:s??p,children:i.jsx(i4,{asChild:!0,...l,focusable:!n,children:i.jsx(ze.div,{role:"menuitem","data-highlighted":d?"":void 0,"aria-disabled":n||void 0,"data-disabled":n?"":void 0,...a,ref:u,onPointerMove:Oe(e.onPointerMove,of(g=>{n?o.onItemLeave(g):(o.onItemEnter(g),g.defaultPrevented||g.currentTarget.focus({preventScroll:!0}))})),onPointerLeave:Oe(e.onPointerLeave,of(g=>o.onItemLeave(g))),onFocus:Oe(e.onFocus,()=>f(!0)),onBlur:Oe(e.onBlur,()=>f(!1))})})})}),Jte="MenuCheckboxItem",YD=y.forwardRef((e,t)=>{const{checked:r=!1,onCheckedChange:n,...s}=e;return i.jsx(ZD,{scope:e.__scopeMenu,checked:r,children:i.jsx(Jp,{role:"menuitemcheckbox","aria-checked":j0(r)?"mixed":r,...s,ref:t,"data-state":d_(r),onSelect:Oe(s.onSelect,()=>n==null?void 0:n(j0(r)?!0:!r),{checkForDefaultPrevented:!1})})})});YD.displayName=Jte;var KD="MenuRadioGroup",[Zte,ere]=Cl(KD,{value:void 0,onValueChange:()=>{}}),XD=y.forwardRef((e,t)=>{const{value:r,onValueChange:n,...s}=e,a=hr(n);return i.jsx(Zte,{scope:e.__scopeMenu,value:r,onValueChange:a,children:i.jsx(c_,{...s,ref:t})})});XD.displayName=KD;var QD="MenuRadioItem",JD=y.forwardRef((e,t)=>{const{value:r,...n}=e,s=ere(QD,e.__scopeMenu),a=r===s.value;return i.jsx(ZD,{scope:e.__scopeMenu,checked:a,children:i.jsx(Jp,{role:"menuitemradio","aria-checked":a,...n,ref:t,"data-state":d_(a),onSelect:Oe(n.onSelect,()=>{var o;return(o=s.onValueChange)==null?void 0:o.call(s,r)},{checkForDefaultPrevented:!1})})})});JD.displayName=QD;var u_="MenuItemIndicator",[ZD,tre]=Cl(u_,{checked:!1}),eR=y.forwardRef((e,t)=>{const{__scopeMenu:r,forceMount:n,...s}=e,a=tre(u_,r);return i.jsx(Ir,{present:n||j0(a.checked)||a.checked===!0,children:i.jsx(ze.span,{...s,ref:t,"data-state":d_(a.checked)})})});eR.displayName=u_;var rre="MenuSeparator",tR=y.forwardRef((e,t)=>{const{__scopeMenu:r,...n}=e;return i.jsx(ze.div,{role:"separator","aria-orientation":"horizontal",...n,ref:t})});tR.displayName=rre;var nre="MenuArrow",rR=y.forwardRef((e,t)=>{const{__scopeMenu:r,...n}=e,s=Qp(r);return i.jsx(Z0,{...s,...n,ref:t})});rR.displayName=nre;var sre="MenuSub",[gse,nR]=Cl(sre),Xu="MenuSubTrigger",sR=y.forwardRef((e,t)=>{const r=Tl(Xu,e.__scopeMenu),n=Zf(Xu,e.__scopeMenu),s=nR(Xu,e.__scopeMenu),a=o_(Xu,e.__scopeMenu),o=y.useRef(null),{pointerGraceTimerRef:l,onPointerGraceIntentChange:c}=a,u={__scopeMenu:e.__scopeMenu},d=y.useCallback(()=>{o.current&&window.clearTimeout(o.current),o.current=null},[]);return y.useEffect(()=>d,[d]),y.useEffect(()=>{const f=l.current;return()=>{window.clearTimeout(f),c(null)}},[l,c]),i.jsx(a_,{asChild:!0,...u,children:i.jsx(qD,{id:s.triggerId,"aria-haspopup":"menu","aria-expanded":r.open,"aria-controls":s.contentId,"data-state":oR(r.open),...e,ref:di(t,s.onTriggerChange),onClick:f=>{var p;(p=e.onClick)==null||p.call(e,f),!(e.disabled||f.defaultPrevented)&&(f.currentTarget.focus(),r.open||r.onOpenChange(!0))},onPointerMove:Oe(e.onPointerMove,of(f=>{a.onItemEnter(f),!f.defaultPrevented&&!e.disabled&&!r.open&&!o.current&&(a.onPointerGraceIntentChange(null),o.current=window.setTimeout(()=>{r.onOpenChange(!0),d()},100))})),onPointerLeave:Oe(e.onPointerLeave,of(f=>{var h,g;d();const p=(h=r.content)==null?void 0:h.getBoundingClientRect();if(p){const m=(g=r.content)==null?void 0:g.dataset.side,x=m==="right",w=x?-5:5,v=p[x?"left":"right"],_=p[x?"right":"left"];a.onPointerGraceIntentChange({area:[{x:f.clientX+w,y:f.clientY},{x:v,y:p.top},{x:_,y:p.top},{x:_,y:p.bottom},{x:v,y:p.bottom}],side:m}),window.clearTimeout(l.current),l.current=window.setTimeout(()=>a.onPointerGraceIntentChange(null),300)}else{if(a.onTriggerLeave(f),f.defaultPrevented)return;a.onPointerGraceIntentChange(null)}})),onKeyDown:Oe(e.onKeyDown,f=>{var h;const p=a.searchRef.current!=="";e.disabled||p&&f.key===" "||Lte[n.dir].includes(f.key)&&(r.onOpenChange(!0),(h=r.content)==null||h.focus(),f.preventDefault())})})})});sR.displayName=Xu;var aR="MenuSubContent",iR=y.forwardRef((e,t)=>{const r=VD(Es,e.__scopeMenu),{forceMount:n=r.forceMount,...s}=e,a=Tl(Es,e.__scopeMenu),o=Zf(Es,e.__scopeMenu),l=nR(aR,e.__scopeMenu),c=y.useRef(null),u=st(t,c);return i.jsx(af.Provider,{scope:e.__scopeMenu,children:i.jsx(Ir,{present:n||a.open,children:i.jsx(af.Slot,{scope:e.__scopeMenu,children:i.jsx(l_,{id:l.contentId,"aria-labelledby":l.triggerId,...s,ref:u,align:"start",side:o.dir==="rtl"?"left":"right",disableOutsidePointerEvents:!1,disableOutsideScroll:!1,trapFocus:!1,onOpenAutoFocus:d=>{var f;o.isUsingKeyboardRef.current&&((f=c.current)==null||f.focus()),d.preventDefault()},onCloseAutoFocus:d=>d.preventDefault(),onFocusOutside:Oe(e.onFocusOutside,d=>{d.target!==l.trigger&&a.onOpenChange(!1)}),onEscapeKeyDown:Oe(e.onEscapeKeyDown,d=>{o.onClose(),d.preventDefault()}),onKeyDown:Oe(e.onKeyDown,d=>{var h;const f=d.currentTarget.contains(d.target),p=$te[o.dir].includes(d.key);f&&p&&(a.onOpenChange(!1),(h=l.trigger)==null||h.focus(),d.preventDefault())})})})})})});iR.displayName=aR;function oR(e){return e?"open":"closed"}function j0(e){return e==="indeterminate"}function d_(e){return j0(e)?"indeterminate":e?"checked":"unchecked"}function are(e){const t=document.activeElement;for(const r of e)if(r===t||(r.focus(),document.activeElement!==t))return}function ire(e,t){return e.map((r,n)=>e[(t+n)%e.length])}function ore(e,t,r){const s=t.length>1&&Array.from(t).every(u=>u===t[0])?t[0]:t,a=r?e.indexOf(r):-1;let o=ire(e,Math.max(a,0));s.length===1&&(o=o.filter(u=>u!==r));const c=o.find(u=>u.toLowerCase().startsWith(s.toLowerCase()));return c!==r?c:void 0}function lre(e,t){const{x:r,y:n}=e;let s=!1;for(let a=0,o=t.length-1;a<t.length;o=a++){const l=t[a],c=t[o],u=l.x,d=l.y,f=c.x,p=c.y;d>n!=p>n&&r<(f-u)*(n-d)/(p-d)+u&&(s=!s)}return s}function cre(e,t){if(!t)return!1;const r={x:e.clientX,y:e.clientY};return lre(r,t)}function of(e){return t=>t.pointerType==="mouse"?e(t):void 0}var ure=zD,dre=a_,fre=WD,hre=HD,mre=c_,pre=GD,gre=Jp,xre=YD,vre=XD,yre=JD,wre=eR,_re=tR,bre=rR,Sre=sR,Nre=iR,Zp="DropdownMenu",[jre,xse]=Fr(Zp,[BD]),Pn=BD(),[Ere,lR]=jre(Zp),cR=e=>{const{__scopeDropdownMenu:t,children:r,dir:n,open:s,defaultOpen:a,onOpenChange:o,modal:l=!0}=e,c=Pn(t),u=y.useRef(null),[d,f]=Hn({prop:s,defaultProp:a??!1,onChange:o,caller:Zp});return i.jsx(Ere,{scope:t,triggerId:Er(),triggerRef:u,contentId:Er(),open:d,onOpenChange:f,onOpenToggle:y.useCallback(()=>f(p=>!p),[f]),modal:l,children:i.jsx(ure,{...c,open:d,onOpenChange:f,dir:n,modal:l,children:r})})};cR.displayName=Zp;var uR="DropdownMenuTrigger",dR=y.forwardRef((e,t)=>{const{__scopeDropdownMenu:r,disabled:n=!1,...s}=e,a=lR(uR,r),o=Pn(r);return i.jsx(dre,{asChild:!0,...o,children:i.jsx(ze.button,{type:"button",id:a.triggerId,"aria-haspopup":"menu","aria-expanded":a.open,"aria-controls":a.open?a.contentId:void 0,"data-state":a.open?"open":"closed","data-disabled":n?"":void 0,disabled:n,...s,ref:di(t,a.triggerRef),onPointerDown:Oe(e.onPointerDown,l=>{!n&&l.button===0&&l.ctrlKey===!1&&(a.onOpenToggle(),a.open||l.preventDefault())}),onKeyDown:Oe(e.onKeyDown,l=>{n||(["Enter"," "].includes(l.key)&&a.onOpenToggle(),l.key==="ArrowDown"&&a.onOpenChange(!0),["Enter"," ","ArrowDown"].includes(l.key)&&l.preventDefault())})})})});dR.displayName=uR;var kre="DropdownMenuPortal",fR=e=>{const{__scopeDropdownMenu:t,...r}=e,n=Pn(t);return i.jsx(fre,{...n,...r})};fR.displayName=kre;var hR="DropdownMenuContent",mR=y.forwardRef((e,t)=>{const{__scopeDropdownMenu:r,...n}=e,s=lR(hR,r),a=Pn(r),o=y.useRef(!1);return i.jsx(hre,{id:s.contentId,"aria-labelledby":s.triggerId,...a,...n,ref:t,onCloseAutoFocus:Oe(e.onCloseAutoFocus,l=>{var c;o.current||(c=s.triggerRef.current)==null||c.focus(),o.current=!1,l.preventDefault()}),onInteractOutside:Oe(e.onInteractOutside,l=>{const c=l.detail.originalEvent,u=c.button===0&&c.ctrlKey===!0,d=c.button===2||u;(!s.modal||d)&&(o.current=!0)}),style:{...e.style,"--radix-dropdown-menu-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-dropdown-menu-content-available-width":"var(--radix-popper-available-width)","--radix-dropdown-menu-content-available-height":"var(--radix-popper-available-height)","--radix-dropdown-menu-trigger-width":"var(--radix-popper-anchor-width)","--radix-dropdown-menu-trigger-height":"var(--radix-popper-anchor-height)"}})});mR.displayName=hR;var Cre="DropdownMenuGroup",Tre=y.forwardRef((e,t)=>{const{__scopeDropdownMenu:r,...n}=e,s=Pn(r);return i.jsx(mre,{...s,...n,ref:t})});Tre.displayName=Cre;var Are="DropdownMenuLabel",pR=y.forwardRef((e,t)=>{const{__scopeDropdownMenu:r,...n}=e,s=Pn(r);return i.jsx(pre,{...s,...n,ref:t})});pR.displayName=Are;var Pre="DropdownMenuItem",gR=y.forwardRef((e,t)=>{const{__scopeDropdownMenu:r,...n}=e,s=Pn(r);return i.jsx(gre,{...s,...n,ref:t})});gR.displayName=Pre;var Dre="DropdownMenuCheckboxItem",xR=y.forwardRef((e,t)=>{const{__scopeDropdownMenu:r,...n}=e,s=Pn(r);return i.jsx(xre,{...s,...n,ref:t})});xR.displayName=Dre;var Rre="DropdownMenuRadioGroup",Mre=y.forwardRef((e,t)=>{const{__scopeDropdownMenu:r,...n}=e,s=Pn(r);return i.jsx(vre,{...s,...n,ref:t})});Mre.displayName=Rre;var Ore="DropdownMenuRadioItem",vR=y.forwardRef((e,t)=>{const{__scopeDropdownMenu:r,...n}=e,s=Pn(r);return i.jsx(yre,{...s,...n,ref:t})});vR.displayName=Ore;var Fre="DropdownMenuItemIndicator",yR=y.forwardRef((e,t)=>{const{__scopeDropdownMenu:r,...n}=e,s=Pn(r);return i.jsx(wre,{...s,...n,ref:t})});yR.displayName=Fre;var Ire="DropdownMenuSeparator",wR=y.forwardRef((e,t)=>{const{__scopeDropdownMenu:r,...n}=e,s=Pn(r);return i.jsx(_re,{...s,...n,ref:t})});wR.displayName=Ire;var Lre="DropdownMenuArrow",$re=y.forwardRef((e,t)=>{const{__scopeDropdownMenu:r,...n}=e,s=Pn(r);return i.jsx(bre,{...s,...n,ref:t})});$re.displayName=Lre;var Bre="DropdownMenuSubTrigger",_R=y.forwardRef((e,t)=>{const{__scopeDropdownMenu:r,...n}=e,s=Pn(r);return i.jsx(Sre,{...s,...n,ref:t})});_R.displayName=Bre;var Ure="DropdownMenuSubContent",bR=y.forwardRef((e,t)=>{const{__scopeDropdownMenu:r,...n}=e,s=Pn(r);return i.jsx(Nre,{...s,...n,ref:t,style:{...e.style,"--radix-dropdown-menu-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-dropdown-menu-content-available-width":"var(--radix-popper-available-width)","--radix-dropdown-menu-content-available-height":"var(--radix-popper-available-height)","--radix-dropdown-menu-trigger-width":"var(--radix-popper-anchor-width)","--radix-dropdown-menu-trigger-height":"var(--radix-popper-anchor-height)"}})});bR.displayName=Ure;var zre=cR,Vre=dR,Wre=fR,SR=mR,NR=pR,jR=gR,ER=xR,kR=vR,CR=yR,TR=wR,AR=_R,PR=bR;const lf=zre,cf=Vre,Hre=y.forwardRef(({className:e,inset:t,children:r,...n},s)=>i.jsxs(AR,{ref:s,className:De("flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none focus:bg-accent data-[state=open]:bg-accent",t&&"pl-8",e),...n,children:[r,i.jsx(f1,{className:"ml-auto h-4 w-4"})]}));Hre.displayName=AR.displayName;const Gre=y.forwardRef(({className:e,...t},r)=>i.jsx(PR,{ref:r,className:De("z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-lg data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",e),...t}));Gre.displayName=PR.displayName;const Yc=y.forwardRef(({className:e,sideOffset:t=4,...r},n)=>i.jsx(Wre,{children:i.jsx(SR,{ref:n,sideOffset:t,className:De("z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",e),...r})}));Yc.displayName=SR.displayName;const Pr=y.forwardRef(({className:e,inset:t,...r},n)=>i.jsx(jR,{ref:n,className:De("relative flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",t&&"pl-8",e),...r}));Pr.displayName=jR.displayName;const qre=y.forwardRef(({className:e,children:t,checked:r,...n},s)=>i.jsxs(ER,{ref:s,className:De("relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",e),checked:r,...n,children:[i.jsx("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:i.jsx(CR,{children:i.jsx(Qa,{className:"h-4 w-4"})})}),t]}));qre.displayName=ER.displayName;const Yre=y.forwardRef(({className:e,children:t,...r},n)=>i.jsxs(kR,{ref:n,className:De("relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",e),...r,children:[i.jsx("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:i.jsx(CR,{children:i.jsx(ck,{className:"h-2 w-2 fill-current"})})}),t]}));Yre.displayName=kR.displayName;const Kre=y.forwardRef(({className:e,inset:t,...r},n)=>i.jsx(NR,{ref:n,className:De("px-2 py-1.5 text-sm font-semibold",t&&"pl-8",e),...r}));Kre.displayName=NR.displayName;const E0=y.forwardRef(({className:e,...t},r)=>i.jsx(TR,{ref:r,className:De("-mx-1 my-1 h-px bg-muted",e),...t}));E0.displayName=TR.displayName;const Xre=[{id:"1",action:"Logged in",timestamp:new Date(Date.now()-2*60*60*1e3).toISOString(),type:"login"},{id:"2",action:"Joined meeting",timestamp:new Date(Date.now()-4*60*60*1e3).toISOString(),details:"Monthly Board Meeting",type:"meeting"},{id:"3",action:"Downloaded document",timestamp:new Date(Date.now()-1*24*60*60*1e3).toISOString(),details:"Financial Report Q4.pdf",type:"document"},{id:"4",action:"Voted on poll",timestamp:new Date(Date.now()-2*24*60*60*1e3).toISOString(),details:"Budget Approval 2024",type:"vote"},{id:"5",action:"Logged out",timestamp:new Date(Date.now()-3*24*60*60*1e3).toISOString(),type:"logout"}],DR=({open:e,onOpenChange:t,member:r})=>{const n=o=>{switch(o){case"login":case"logout":return i.jsx(lo,{className:"h-4 w-4"});case"meeting":return i.jsx(en,{className:"h-4 w-4"});case"document":return i.jsx(Hu,{className:"h-4 w-4"});case"vote":return i.jsx(Hu,{className:"h-4 w-4"});default:return i.jsx(Hu,{className:"h-4 w-4"})}},s=o=>{const l={login:"bg-green-100 text-green-800",logout:"bg-gray-100 text-gray-800",meeting:"bg-blue-100 text-blue-800",document:"bg-purple-100 text-purple-800",vote:"bg-orange-100 text-orange-800",other:"bg-gray-100 text-gray-800"};return i.jsx(We,{className:l[o]||l.other,children:o.charAt(0).toUpperCase()+o.slice(1)})},a=o=>{const l=new Date(o),u=(new Date().getTime()-l.getTime())/(1e3*60*60);return u<24?`${Math.floor(u)}h ago`:`${Math.floor(u/24)}d ago`};return i.jsx(Nt,{open:e,onOpenChange:t,children:i.jsxs(bt,{className:"max-w-2xl",children:[i.jsxs(jt,{children:[i.jsxs(Et,{className:"flex items-center space-x-2",children:[i.jsx(Hu,{className:"h-5 w-5"}),i.jsxs("span",{children:["Activity Log - ",r.first_name," ",r.last_name]})]}),i.jsx($t,{children:"Recent activity and actions performed by this member"})]}),i.jsx(Xw,{className:"h-96 w-full",children:i.jsx("div",{className:"space-y-4",children:Xre.map(o=>i.jsxs("div",{className:"flex items-start space-x-4 p-4 border rounded-lg",children:[i.jsx("div",{className:"flex-shrink-0 w-8 h-8 bg-gray-100 rounded-full flex items-center justify-center",children:n(o.type)}),i.jsxs("div",{className:"flex-1 min-w-0",children:[i.jsxs("div",{className:"flex items-center justify-between mb-1",children:[i.jsx("p",{className:"text-sm font-medium text-gray-900",children:o.action}),s(o.type)]}),o.details&&i.jsx("p",{className:"text-sm text-gray-600 mb-2",children:o.details}),i.jsxs("div",{className:"flex items-center text-xs text-gray-500",children:[i.jsx(qr,{className:"h-3 w-3 mr-1"}),a(o.timestamp),i.jsx("span",{className:"mx-2",children:""}),new Date(o.timestamp).toLocaleString()]})]})]},o.id))})})]})})},f_=()=>{const[e,t]=y.useState([]),[r,n]=y.useState([]),[s,a]=y.useState(!0),{user:o}=kt(),{toast:l}=St(),{createMember:c,isCreating:u}=LD(),[d,f]=y.useState([]),p=y.useCallback(async()=>{try{if(!o)return;const{data:C,error:E}=await he.auth.admin.listUsers();if(E){console.error("Error fetching Auth users:",E);return}f(C.users.map(P=>P.email))}catch(C){console.error("Error fetching Auth users:",C)}},[o]),h=y.useCallback(async()=>{a(!0);try{const{data:C,error:E}=await he.from("profiles").select("*").order("created_at",{ascending:!1});if(E){console.error("Profiles fetch error:",E),l({title:"Error",description:"Failed to load members",variant:"destructive"}),t([]);return}const{data:P,error:R}=await he.from("user_roles").select("user_id, role");R&&(console.error("Roles fetch error:",R),l({title:"Warning",description:"Some member roles could not be loaded.",variant:"default"}));const{data:j,error:M}=await he.from("member_invitations").select("*").order("created_at",{ascending:!1});M&&(console.error("Invitations fetch error:",M),l({title:"Warning",description:"Some member invitations could not be loaded.",variant:"default"})),await p();const A=(C==null?void 0:C.map(z=>{var F,D,G,O,L,ie;let U=(P==null?void 0:P.filter(ne=>ne.user_id===z.id))||[];(z.email==="atd@iskconbureau.in"||z.email==="bgd@iskconbureau.in")&&(U.some(me=>me.role==="super_admin")||(U=[{user_id:z.id,role:"super_admin"},...U])),z.email==="admin@iskconbureau.in"&&(U.some(me=>me.role==="admin")||(U=[{user_id:z.id,role:"admin"},...U]));const V=d.includes(z.email);return{id:z.id,email:z.email||"",first_name:((F=z.first_name)==null?void 0:F.trim())||"",last_name:((D=z.last_name)==null?void 0:D.trim())||"",phone:z.phone||"",created_at:z.created_at||"",last_sign_in_at:void 0,roles:U.map(ne=>ne.role),is_suspended:z.is_suspended||!1,isPending:!1,avatar_url:z.avatar_url||"",displayName:(G=z.first_name)!=null&&G.trim()||(O=z.last_name)!=null&&O.trim()?`${((L=z.first_name)==null?void 0:L.trim())||""} ${((ie=z.last_name)==null?void 0:ie.trim())||""}`.trim():z.email||z.id,canLogin:V}}))||[],I=new Set(A.map(z=>z.email)),X=(j||[]).filter(z=>!I.has(z.email)).map(z=>{var U,V,F,D;return{id:`invite-${z.id}`,email:z.email,first_name:z.first_name||"",last_name:z.last_name||"",phone:z.phone||"",created_at:z.created_at||"",last_sign_in_at:void 0,roles:[z.role],is_suspended:!1,isPending:!0,avatar_url:"",displayName:(U=z.first_name)!=null&&U.trim()||(V=z.last_name)!=null&&V.trim()?`${((F=z.first_name)==null?void 0:F.trim())||""} ${((D=z.last_name)==null?void 0:D.trim())||""}`.trim():z.email||z.id,canLogin:!1}}),Y=[...A,...X].sort((z,U)=>new Date(U.created_at).getTime()-new Date(z.created_at).getTime());t(Y)}catch(C){console.error("Error fetching members:",C),l({title:"Error",description:"Failed to load members",variant:"destructive"})}finally{a(!1)}},[l,p]);y.useEffect(()=>{let C,E;return(async()=>{o&&(console.log("Setting up real-time subscriptions..."),await h(),C=he.channel("profiles-changes").on("postgres_changes",{event:"*",schema:"public",table:"profiles"},async R=>{console.log("Profiles real-time change detected:",R),await h()}).subscribe(R=>{console.log("Profiles subscription status:",R)}),E=he.channel("user-roles-changes").on("postgres_changes",{event:"*",schema:"public",table:"user_roles"},async R=>{console.log("User roles real-time change detected:",R),await h()}).subscribe(R=>{console.log("User roles subscription status:",R)}))})(),()=>{C&&(console.log("Cleaning up profiles subscription"),he.removeChannel(C)),E&&(console.log("Cleaning up roles subscription"),he.removeChannel(E))}},[o,h]);const g=y.useCallback((C,E)=>{console.log("Optimistic update for member:",C,E),t(P=>P.map(R=>R.id===C?{...R,...E}:R))},[]),m=async C=>{const E=await c(C);return E&&(await S("Added new member",`Added ${C.firstName} ${C.lastName} as ${C.role.replace("_"," ")}`),await h()),E},x=async(C,E)=>{try{const P=e.find(M=>M.id===C);if((P==null?void 0:P.email)==="atd@iskconbureau.in"&&E!=="super_admin"){l({title:"Access Denied",description:"Cannot change the role of the system super admin",variant:"destructive"});return}console.log("Updating member role:",{memberId:C,newRole:E}),g(C,{roles:[E]});const{error:R}=await he.from("user_roles").delete().eq("user_id",C);if(R)throw console.error("Error deleting existing roles:",R),await h(),R;const{error:j}=await he.from("user_roles").insert({user_id:C,role:E});if(j)throw console.error("Error adding new role:",j),await h(),j;await S("Updated member role",`Changed role to ${E.replace("_"," ")}`),l({title:"Role Updated Successfully",description:`Member role has been changed to ${E.replace("_"," ")}`}),setTimeout(async()=>{await h()},1e3)}catch(P){console.error("Error updating role:",P),l({title:"Role Update Failed",description:P.message||"Failed to update member role",variant:"destructive"})}},w=async C=>{try{const E=e.find(j=>j.id===C);if(!E){l({title:"Delete Failed",description:"Member not found",variant:"destructive"});return}if(E.isPending){const j=C.replace("invite-",""),{error:M}=await he.from("member_invitations").delete().eq("id",j);if(M){l({title:"Delete Failed",description:M.message,variant:"destructive"});return}l({title:"Invitation Deleted",description:"Pending invitation has been removed."}),await h();return}if(E.email==="atd@iskconbureau.in"){l({title:"Access Denied",description:"Cannot delete the system super admin",variant:"destructive"});return}const{error:P}=await he.from("user_roles").delete().eq("user_id",C);P&&console.error("Error deleting user roles:",P);const{error:R}=await he.from("profiles").delete().eq("id",C);if(R)throw console.error("Error deleting profile:",R),R;await S("Deleted member","Removed member from bureau"),l({title:"Member Deleted",description:"Member has been removed successfully"}),await h()}catch(E){console.error("Error deleting member:",E),l({title:"Delete Failed",description:E.message||"Failed to delete member",variant:"destructive"})}},v=async(C,E)=>{try{const P=e.find(j=>j.id===C);if((P==null?void 0:P.email)==="atd@iskconbureau.in"){l({title:"Access Denied",description:"Cannot suspend the system super admin",variant:"destructive"});return}console.log("Suspending member:",{memberId:C,suspend:E});const{error:R}=await he.from("profiles").update({is_suspended:E}).eq("id",C);if(R)throw R;await S(E?"Suspended member":"Unsuspended member",`Account ${E?"suspended":"reactivated"}`),l({title:E?"Member Suspended":"Member Unsuspended",description:`Account has been ${E?"suspended":"reactivated"} successfully`}),await h()}catch(P){console.error("Error suspending member:",P),l({title:"Update Failed",description:P.message||"Failed to update member status",variant:"destructive"})}},_=async C=>{var E;try{const P=e.find(M=>M.id===C);if(!P){l({title:"Error",description:"Member not found",variant:"destructive"});return}console.log("Sending password reset email via Outlook for member:",C);const{data:R,error:j}=await he.functions.invoke("send-otp",{body:{phoneNumber:P.email,name:`${P.first_name} ${P.last_name}`,type:"password_reset",userId:o==null?void 0:o.id}});if(j){if(console.error("Error sending password reset email:",j),(E=j.message)!=null&&E.includes("Microsoft account")){l({title:"Microsoft Account Required",description:"Please connect your Microsoft account in Settings to send password reset emails via Outlook.",variant:"destructive"});return}throw j}console.log("Password reset email sent successfully via Outlook:",R),await S("Reset password",`Password reset email sent via Outlook to ${P.first_name} ${P.last_name}`),l({title:"Password Reset Email Sent via Outlook",description:`A password reset email has been sent to ${P.email} through your connected Outlook account. The temporary password is valid for 24 hours.`})}catch(P){console.error("Error sending password reset email:",P),l({title:"Reset Failed",description:P.message||"Failed to send password reset email via Outlook",variant:"destructive"})}},b=()=>{const C=[["Name","Email","Phone","Role","Join Date"],...e.map(j=>[`${j.first_name} ${j.last_name}`,j.email,j.phone||"",j.roles[0]||"member",new Date(j.created_at).toLocaleDateString()])].map(j=>j.join(",")).join(`
`),E=new Blob([C],{type:"text/csv"}),P=window.URL.createObjectURL(E),R=document.createElement("a");R.href=P,R.download="members-export.csv",R.click(),window.URL.revokeObjectURL(P),l({title:"Export Complete",description:"Members list has been exported successfully"})},S=async(C,E)=>{var P,R;if(o)try{console.log("Activity logged:",{user_id:o.id,action:C,details:E,timestamp:new Date().toISOString()});const j={id:Date.now().toString(),user_id:o.id,action:C,timestamp:new Date().toISOString(),user_name:`${((P=o.user_metadata)==null?void 0:P.first_name)||""} ${((R=o.user_metadata)==null?void 0:R.last_name)||""}`.trim()||o.email||"Unknown User"};n(M=>[j,...M].slice(0,10))}catch(j){console.error("Error logging activity:",j)}};return{members:e,activityLogs:r,loading:s||u,addMember:m,updateMemberRole:x,deleteMember:w,suspendMember:v,resetPassword:_,exportMembers:b,fetchMembers:h,forceRefresh:h,logActivity:S,searchMembers:C=>{const E=(R,j)=>{const M=`${R.first_name} ${R.last_name}`.trim().toLowerCase(),A=`${j.first_name} ${j.last_name}`.trim().toLowerCase();return M.localeCompare(A)};if(!C.trim())return[...e].sort(E);const P=C.toLowerCase();return e.filter(R=>`${R.first_name} ${R.last_name}`.toLowerCase().includes(P)||R.email.toLowerCase().includes(P)||R.roles.some(j=>j.toLowerCase().includes(P))||R.phone&&R.phone.includes(C)).sort(E)},updateMemberOptimistically:g,resetMemberPassword:async(C,E)=>{try{const{error:P}=await he.auth.admin.updateUser(C,{password:E});return P?(l({title:"Password Reset Failed",description:P.message,variant:"destructive"}),!1):(l({title:"Password Reset",description:"Password updated successfully.",variant:"default"}),!0)}catch(P){return l({title:"Password Reset Failed",description:P.message||"Unknown error",variant:"destructive"}),!1}}}},Qre=({open:e,onOpenChange:t,member:r})=>{const[n,s]=y.useState(!1),{suspendMember:a}=f_(),o=new Date(r.created_at).toLocaleDateString(),l=r.roles[0]||"member",c=async()=>{await a(r.id,!r.is_suspended)},u=()=>{s(!0)};return i.jsxs(i.Fragment,{children:[i.jsx(Nt,{open:e,onOpenChange:t,children:i.jsxs(bt,{className:"max-w-2xl",children:[i.jsxs(jt,{children:[i.jsx(Et,{children:"Member Settings"}),i.jsxs($t,{children:["Manage settings and information for ",r.first_name," ",r.last_name]})]}),i.jsxs("div",{className:"space-y-6",children:[i.jsxs(Ye,{children:[i.jsx(ct,{children:i.jsxs(ft,{className:"flex items-center space-x-2",children:[i.jsx(lo,{className:"h-5 w-5"}),i.jsx("span",{children:"Member Information"})]})}),i.jsx(Je,{className:"space-y-4",children:i.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[i.jsxs("div",{children:[i.jsx("label",{className:"text-sm font-medium text-gray-500",children:"First Name"}),i.jsx("p",{className:"text-gray-900",children:r.first_name})]}),i.jsxs("div",{children:[i.jsx("label",{className:"text-sm font-medium text-gray-500",children:"Last Name"}),i.jsx("p",{className:"text-gray-900",children:r.last_name})]}),i.jsxs("div",{children:[i.jsx("label",{className:"text-sm font-medium text-gray-500",children:"Email"}),i.jsxs("p",{className:"text-gray-900 flex items-center space-x-2",children:[i.jsx(ta,{className:"h-4 w-4"}),i.jsx("span",{children:r.email})]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"text-sm font-medium text-gray-500",children:"Phone"}),i.jsxs("p",{className:"text-gray-900 flex items-center space-x-2",children:[i.jsx(_f,{className:"h-4 w-4"}),i.jsx("span",{children:r.phone||"Not provided"})]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"text-sm font-medium text-gray-500",children:"Join Date"}),i.jsxs("p",{className:"text-gray-900 flex items-center space-x-2",children:[i.jsx(en,{className:"h-4 w-4"}),i.jsx("span",{children:o})]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"text-sm font-medium text-gray-500",children:"Status"}),i.jsxs("p",{className:"text-gray-900 flex items-center space-x-2",children:[i.jsx(nl,{className:"h-4 w-4"}),i.jsx(We,{variant:r.is_suspended?"destructive":"secondary",children:r.is_suspended?"Suspended":"Active"})]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"text-sm font-medium text-gray-500",children:"Role"}),i.jsxs("p",{className:"text-gray-900 flex items-center space-x-2",children:[i.jsx(nl,{className:"h-4 w-4"}),i.jsx(We,{children:l})]})]})]})})]}),i.jsxs(Ye,{children:[i.jsxs(ct,{children:[i.jsx(ft,{children:"Account Actions"}),i.jsx(tn,{children:"Manage account settings and permissions"})]}),i.jsxs(Je,{className:"space-y-3",children:[i.jsx(ue,{variant:"outline",className:"w-full justify-start",onClick:c,children:r.is_suspended?"Unsuspend Account":"Suspend Account"}),i.jsx(ue,{variant:"outline",className:"w-full justify-start",onClick:u,children:"View Activity Log"})]})]})]})]})}),i.jsx(DR,{open:n,onOpenChange:s,member:r})]})},Jre=({open:e,onOpenChange:t,member:r,onMemberUpdated:n,onSetPassword:s})=>{var j,M,A,I;const[a,o]=y.useState(r.first_name),[l,c]=y.useState(r.last_name),[u,d]=y.useState(r.email),[f,p]=y.useState(r.phone||""),[h,g]=y.useState(!1),{toast:m}=St(),x=ua(),[w,v]=y.useState({firstName:r.first_name||"",lastName:r.last_name||"",email:r.email||"",phone:r.phone||"",password:""}),[_,b]=y.useState(!1);ke.useEffect(()=>{e&&(o(r.first_name),c(r.last_name),d(r.email),p(r.phone||""))},[r,e]);const S=x.isSuperAdmin||x.isAdmin&&r.email!=="atd@iskconbureau.in"||r.id===((j=x.user)==null?void 0:j.id),T=x.isSuperAdmin||r.id===((M=x.user)==null?void 0:M.id),N=x.isSuperAdmin||x.isAdmin||r.id===((A=x.user)==null?void 0:A.id),C=x.isSuperAdmin||x.isAdmin||r.id===((I=x.user)==null?void 0:I.id),E=async()=>{if(!a.trim()||!l.trim()||!u.trim()){m({title:"Validation Error",description:"First name, last name, and email are required",variant:"destructive"});return}if(!S){m({title:"Access Denied",description:"You don't have permission to edit this member",variant:"destructive"});return}g(!0);try{console.log("Updating member profile:",{id:r.id,firstName:a.trim(),lastName:l.trim(),email:u.trim(),phone:f.trim(),canEditEmail:T,canEditPhone:N,canEditName:C});const X={updated_at:new Date().toISOString()};C&&(X.first_name=a.trim(),X.last_name=l.trim()),T&&u!==r.email&&(X.email=u.trim()),N&&(X.phone=f.trim()||null),console.log("Update data being sent:",X);const{error:Y}=await he.from("profiles").update(X).eq("id",r.id);if(Y){if(console.error("Error updating member:",Y),Y.message.includes("row-level security"))m({title:"Permission Denied",description:"You don't have sufficient permissions to make this update",variant:"destructive"});else throw Y;return}console.log("Member profile updated successfully"),m({title:"Success!",description:`${a} ${l}'s information has been updated`,variant:"default"}),t(!1),setTimeout(()=>{n()},500),w.password&&(x.isAdmin||x.isSuperAdmin)&&s&&await s(r.id,w.password)}catch(X){console.error("Error updating member:",X),m({title:"Update Failed",description:X.message||"Failed to update member information",variant:"destructive"})}finally{g(!1)}},P=()=>{o(r.first_name),c(r.last_name),d(r.email),p(r.phone||""),t(!1)};if(!S)return i.jsx(Nt,{open:e,onOpenChange:t,children:i.jsxs(bt,{className:"max-w-md",children:[i.jsxs(jt,{children:[i.jsxs(Et,{className:"flex items-center space-x-2",children:[i.jsx(nl,{className:"h-5 w-5 text-red-500"}),i.jsx("span",{children:"Access Denied"})]}),i.jsx($t,{children:"You don't have permission to edit this member's information."})]}),i.jsx("div",{className:"pt-4",children:i.jsx(ue,{onClick:()=>t(!1),className:"w-full",children:"Close"})})]})});const R=r.email==="atd@iskconbureau.in";return i.jsx(Nt,{open:e,onOpenChange:t,children:i.jsx(bt,{className:"max-w-md bg-white rounded-xl shadow-xl p-0",children:i.jsxs("div",{className:"p-6",children:[i.jsxs(jt,{children:[i.jsxs(Et,{className:"flex items-center space-x-2 text-2xl font-bold mb-1",children:[i.jsx(lo,{className:"h-6 w-6 text-primary"}),i.jsx("span",{children:"Edit Member Information"}),R&&i.jsx(nl,{className:"h-4 w-4 text-amber-500"})]}),i.jsxs($t,{className:"mb-4 text-gray-600",children:["Update member details.",R&&" This is a protected system account.",!T&&" You can only edit basic information."]})]}),i.jsxs("form",{className:"space-y-6",onSubmit:X=>{X.preventDefault(),E()},children:[i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 mb-2",children:[i.jsxs("div",{children:[i.jsx(Ve,{htmlFor:"firstName",children:"First Name *"}),i.jsx(dt,{id:"firstName",value:a,onChange:X=>o(X.target.value),placeholder:"Enter first name",required:!0})]}),i.jsxs("div",{children:[i.jsx(Ve,{htmlFor:"lastName",children:"Last Name *"}),i.jsx(dt,{id:"lastName",value:l,onChange:X=>c(X.target.value),placeholder:"Enter last name",required:!0})]})]}),i.jsxs("div",{children:[i.jsx(Ve,{htmlFor:"email",children:"Email *"}),i.jsxs("div",{className:"relative",children:[i.jsx(ta,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400"}),i.jsx(dt,{id:"email",value:u,onChange:X=>d(X.target.value),placeholder:"Enter email",required:!0,disabled:!T,className:"pl-10"})]})]}),i.jsxs("div",{children:[i.jsx(Ve,{htmlFor:"phone",children:"Phone Number"}),i.jsxs("div",{className:"relative",children:[i.jsx(_f,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400"}),i.jsx(dt,{id:"phone",value:f,onChange:X=>p(X.target.value),placeholder:"Enter phone number",disabled:!N,className:"pl-10"})]})]}),i.jsxs("div",{children:[i.jsx(Ve,{htmlFor:"password",children:"Set New Password"}),i.jsxs("div",{className:"relative",children:[i.jsx(dt,{id:"password",type:_?"text":"password",value:w.password,onChange:X=>v({...w,password:X.target.value}),placeholder:"Enter new password",disabled:h}),i.jsx(ue,{type:"button",variant:"ghost",size:"sm",className:"absolute right-2 top-1/2 -translate-y-1/2 text-xs",onClick:()=>b(X=>!X),tabIndex:-1,children:_?"Hide":"Show"})]})]}),i.jsxs("div",{className:"flex flex-col md:flex-row gap-2 pt-4 border-t mt-6",children:[i.jsxs(ue,{type:"submit",variant:"destructive",disabled:h,className:"flex-1 flex items-center justify-center",children:[i.jsx(m1,{className:"h-5 w-5 mr-2"}),"Save Changes"]}),i.jsxs(ue,{type:"button",variant:"outline",onClick:P,disabled:h,className:"flex-1 flex items-center justify-center",children:[i.jsx(Cn,{className:"h-5 w-5 mr-2"}),"Cancel"]})]})]})]})})})},Zre=yf("relative w-full rounded-lg border p-4 [&>svg~*]:pl-7 [&>svg+div]:translate-y-[-3px] [&>svg]:absolute [&>svg]:left-4 [&>svg]:top-4 [&>svg]:text-foreground",{variants:{variant:{default:"bg-background text-foreground",destructive:"border-destructive/50 text-destructive dark:border-destructive [&>svg]:text-destructive"}},defaultVariants:{variant:"default"}}),RR=y.forwardRef(({className:e,variant:t,...r},n)=>i.jsx("div",{ref:n,role:"alert",className:De(Zre({variant:t}),e),...r}));RR.displayName="Alert";const ene=y.forwardRef(({className:e,...t},r)=>i.jsx("h5",{ref:r,className:De("mb-1 font-medium leading-none tracking-tight",e),...t}));ene.displayName="AlertTitle";const MR=y.forwardRef(({className:e,...t},r)=>i.jsx("div",{ref:r,className:De("text-sm [&_p]:leading-relaxed",e),...t}));MR.displayName="AlertDescription";const tne=({open:e,onOpenChange:t,targetMember:r,currentSuperAdmin:n,onTransferComplete:s})=>{const[a,o]=y.useState(""),[l,c]=y.useState(!1),{toast:u}=St(),d=`TRANSFER OWNERSHIP TO ${r.first_name} ${r.last_name}`,f=async()=>{if(a!==d){u({title:"Confirmation Required",description:"Please type the exact confirmation text to proceed",variant:"destructive"});return}c(!0);try{console.log("Transferring ownership from",n.email,"to",r.email),await new Promise(p=>setTimeout(p,2e3)),u({title:"Ownership Transferred Successfully",description:`${r.first_name} ${r.last_name} is now the Super Admin. You will be logged out shortly.`}),o(""),t(!1),s(),setTimeout(()=>{window.location.reload()},3e3)}catch(p){console.error("Error transferring ownership:",p),u({title:"Transfer Failed",description:"Failed to transfer ownership. Please try again.",variant:"destructive"})}finally{c(!1)}};return i.jsx(Nt,{open:e,onOpenChange:t,children:i.jsxs(bt,{className:"max-w-md",children:[i.jsxs(jt,{children:[i.jsxs(Et,{className:"flex items-center space-x-2 text-red-600",children:[i.jsx(wv,{className:"h-5 w-5"}),i.jsx("span",{children:"Transfer Ownership"})]}),i.jsx($t,{children:"This action will transfer Super Admin privileges to another member"})]}),i.jsxs("div",{className:"space-y-4",children:[i.jsxs(RR,{className:"border-amber-200 bg-amber-50",children:[i.jsx(p1,{className:"h-4 w-4 text-amber-600"}),i.jsxs(MR,{className:"text-amber-800",children:[i.jsx("strong",{children:"Warning:"})," This action cannot be undone. You will lose Super Admin privileges immediately."]})]}),i.jsxs("div",{className:"bg-gray-50 p-4 rounded-lg",children:[i.jsx("h4",{className:"font-semibold mb-2",children:"Transfer Details:"}),i.jsxs("div",{className:"text-sm space-y-1",children:[i.jsxs("p",{children:[i.jsx("strong",{children:"From:"})," ",n.first_name," ",n.last_name," (",n.email,")"]}),i.jsxs("p",{children:[i.jsx("strong",{children:"To:"})," ",r.first_name," ",r.last_name," (",r.email,")"]})]})]}),i.jsxs("div",{children:[i.jsxs(Ve,{htmlFor:"confirmation",children:["Type the following to confirm:",i.jsx("code",{className:"bg-gray-200 px-1 rounded text-xs ml-1",children:d})]}),i.jsx(dt,{id:"confirmation",value:a,onChange:p=>o(p.target.value),placeholder:"Type confirmation text here...",className:"mt-2"})]}),i.jsxs("div",{className:"flex space-x-2 pt-4",children:[i.jsxs(ue,{onClick:f,disabled:a!==d||l,className:"flex-1 bg-red-600 hover:bg-red-700",children:[i.jsx(wv,{className:"h-4 w-4 mr-2"}),l?"Transferring...":"Transfer Ownership"]}),i.jsx(ue,{variant:"outline",onClick:()=>t(!1),disabled:l,children:"Cancel"})]})]})]})})},rne=({member:e,onRoleChange:t,onDeleteMember:r,onSuspendMember:n,onResetPassword:s,onMemberUpdated:a})=>{const[o,l]=y.useState(!1),[c,u]=y.useState(!1),[d,f]=y.useState(!1),[p,h]=y.useState(!1),[g,m]=y.useState(0),x=ua(),{user:w}=kt(),v=lu(),[_,b]=y.useState(!1),[S,T]=y.useState(null);ke.useEffect(()=>{const ie=me=>{console.log("MemberCard received avatar update:",me.detail),me.detail.userId===e.id&&m(pe=>pe+1)},ne=me=>{console.log("MemberCard received profile update:",me.detail),me.detail.userId===e.id&&m(pe=>pe+1)};return window.addEventListener("avatarUpdated",ie),window.addEventListener("profileUpdated",ne),()=>{window.removeEventListener("avatarUpdated",ie),window.removeEventListener("profileUpdated",ne)}},[e.id]);const N=ie=>{const ne={super_admin:"bg-red-500 text-white",admin:"bg-blue-500 text-white",member:"bg-gray-500 text-white"};return i.jsx(We,{className:ne[ie]||"bg-gray-500 text-white",children:ie==="super_admin"?"Super Admin":ie.replace("_"," ")})},E=((ie,ne)=>{if(ie==="atd@iskconbureau.in"||ie==="bgd@iskconbureau.in")return"super_admin";const me=ne[0]||"member";return me==="secretary"||me==="treasurer"?"member":me})(e.email,e.roles),P=new Date(e.created_at).toLocaleDateString(),R=`${e.first_name} ${e.last_name}`.trim()||e.email,j=()=>{var ie,ne;return{id:(w==null?void 0:w.id)||"",email:(w==null?void 0:w.email)||"",first_name:((ie=w==null?void 0:w.user_metadata)==null?void 0:ie.first_name)||"",last_name:((ne=w==null?void 0:w.user_metadata)==null?void 0:ne.last_name)||"",created_at:new Date().toISOString(),roles:["super_admin"]}},M=async()=>{T(null);try{await r(e.id),b(!1)}catch(ie){T((ie==null?void 0:ie.message)||"Failed to delete member.")}},A=()=>{s&&s(e.id)},I=()=>{a&&a()},X=async ie=>{if(console.log("Role change requested:",{memberId:e.id,newRole:ie,currentRole:E}),ie==="super_admin"&&E!=="super_admin"){h(!0);return}await t(e.id,ie)},Y=()=>{I()},z=x.isSuperAdmin&&e.email!=="atd@iskconbureau.in",U=x.isSuperAdmin&&e.email!=="atd@iskconbureau.in",V=!1,F=x.isSuperAdmin&&e.email!=="atd@iskconbureau.in",D=x.isSuperAdmin,G=x.isSuperAdmin&&E!=="super_admin"&&e.email!=="atd@iskconbureau.in",O=e.email==="atd@iskconbureau.in",L=O;return i.jsxs(i.Fragment,{children:[i.jsx(Ye,{className:"hover:shadow-md transition-shadow",children:i.jsx(Je,{className:`${v?"p-4":"p-6"}`,children:i.jsxs("div",{className:`${v?"flex flex-col space-y-4":"flex items-center justify-between"}`,children:[i.jsxs("div",{className:`${v?"flex flex-col space-y-3":"flex items-center space-x-4"}`,children:[i.jsxs("div",{className:`${v?"flex items-center space-x-3":"flex items-center space-x-4"}`,children:[e.email==="brs@iskconbureau.in"||e.email==="bvs@iskconbureau.in"||e.email==="bps@iskconbureau.in"?i.jsx("img",{src:"/iskcon_logo%20(1).svg",alt:"ISKCON Logo",className:"h-10 w-10 rounded-full object-cover"}):e.avatar_url?i.jsx("img",{src:e.avatar_url,alt:e.displayName||e.first_name||e.email||"User",className:"h-10 w-10 rounded-full object-cover",onError:ie=>{ie.currentTarget.style.display="none"}}):i.jsx("div",{className:"h-10 w-10 rounded-full bg-gray-200 flex items-center justify-center text-lg font-bold text-gray-500",children:(e.displayName||e.first_name||e.email||"U").charAt(0).toUpperCase()}),i.jsxs("div",{className:"min-w-0 flex-1",children:[i.jsxs("h3",{className:`${v?"text-base":"text-lg"} font-semibold text-gray-900 truncate`,children:[e.first_name," ",e.last_name]}),i.jsx("div",{className:"flex items-center gap-2 mb-2",children:i.jsx("span",{className:"font-semibold",children:R})}),i.jsxs("div",{className:`${v?"flex flex-col space-y-1":"flex items-center space-x-4"} ${v?"text-xs":"text-sm"} text-gray-500 mt-1`,children:[i.jsxs("span",{className:"flex items-center space-x-1 min-w-0",children:[i.jsx(ta,{className:"h-4 w-4 flex-shrink-0"}),i.jsx("span",{className:"truncate",children:e.email})]}),e.phone&&i.jsxs("span",{className:"flex items-center space-x-1",children:[i.jsx(_f,{className:"h-4 w-4 flex-shrink-0"}),i.jsx("span",{children:e.phone})]})]})]})]}),i.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[N(E),i.jsxs(We,{variant:"outline",className:"text-xs",children:["Joined ",P]}),O&&i.jsx(We,{className:"bg-gold-500 text-white text-xs",children:"System Admin"}),e.is_suspended&&i.jsxs(We,{className:"bg-red-100 text-red-800 text-xs",children:[i.jsx(Nv,{className:"h-3 w-3 mr-1"}),"Suspended"]}),L&&i.jsxs(We,{className:"bg-amber-100 text-amber-800 text-xs",children:[i.jsx(ti,{className:"h-3 w-3 mr-1"}),"Protected"]})]})]}),i.jsxs("div",{className:`${v?"flex flex-col space-y-3 w-full":"text-right space-y-3"}`,children:[i.jsxs("div",{className:`${v?"w-full":""}`,children:[i.jsx("label",{className:`${v?"text-xs":"text-sm"} text-gray-500 block mb-1`,children:"Role"}),i.jsxs(oa,{value:E,onValueChange:X,disabled:!z||L,children:[i.jsx(As,{className:`${v?"w-full h-8":"w-32"}`,"aria-label":"Change Role",children:i.jsx(la,{})}),i.jsxs(Ps,{children:[x.isSuperAdmin&&i.jsx(zt,{value:"super_admin",children:"Super Admin"}),i.jsx(zt,{value:"admin",children:"Admin"}),i.jsx(zt,{value:"member",children:"Member"})]})]}),!z&&i.jsx("p",{className:"text-xs text-gray-500 mt-1",children:L?"Protected role":"No permission"})]}),i.jsxs(lf,{children:[i.jsx(cf,{asChild:!0,children:i.jsx(ue,{variant:"outline",size:"sm",className:`${v?"h-8 w-8 p-0":""}`,"aria-label":"Member Actions",children:i.jsx(Id,{className:"h-4 w-4"})})}),i.jsx(Yc,{children:i.jsxs(i.Fragment,{children:[G&&i.jsxs(Pr,{onClick:()=>h(!0),children:[i.jsx(wv,{className:"h-4 w-4 mr-2"})," Transfer Ownership"]}),D&&i.jsxs(Pr,{onClick:()=>f(!0),children:[i.jsx(_v,{className:"h-4 w-4 mr-2"})," Edit Member"]}),i.jsxs(Pr,{onClick:()=>l(!0),children:[i.jsx(bf,{className:"h-4 w-4 mr-2"})," Member Settings"]}),i.jsxs(Pr,{onClick:()=>u(!0),children:[i.jsx(Hu,{className:"h-4 w-4 mr-2"})," View Activity"]}),F&&i.jsxs(Pr,{onClick:A,children:[i.jsx(bv,{className:"h-4 w-4 mr-2"})," Reset Password"]}),V,U&&!L&&i.jsxs(i.Fragment,{children:[i.jsx(E0,{}),i.jsxs(Pr,{className:"text-red-600","aria-label":"Delete Member",onClick:()=>b(!0),children:[i.jsx(yr,{className:"h-4 w-4 mr-2"})," Delete Member"]})]})]})})]}),U&&!L&&i.jsx(nu,{children:i.jsxs(jf,{children:[i.jsx(Ef,{asChild:!0,children:i.jsx(ue,{variant:"ghost",size:v?"sm":"icon",className:"text-red-600 hover:bg-red-100 ml-2","aria-label":"Delete Member",onClick:()=>b(!0),children:i.jsx(yr,{className:"h-5 w-5"})})}),i.jsx(su,{children:"Delete Member"})]})})]})]})})}),U&&!L&&i.jsx(H1,{open:_,onOpenChange:b,children:i.jsxs(vp,{children:[i.jsxs(yp,{children:[i.jsx(_p,{children:"Delete Member"}),i.jsxs(bp,{children:["Are you sure you want to delete ",e.first_name," ",e.last_name,"? This action cannot be undone and will permanently remove their account and all associated data."]}),S&&i.jsx("div",{className:"text-red-600 text-sm mt-2",role:"alert",children:S})]}),i.jsxs(wp,{children:[i.jsx(Np,{onClick:()=>b(!1),children:"Cancel"}),i.jsx(Sp,{onClick:M,className:"bg-red-600 hover:bg-red-700",children:"Delete Member"})]})]})}),G&&i.jsx(tne,{open:p,onOpenChange:h,targetMember:e,currentSuperAdmin:j(),onTransferComplete:Y}),D&&i.jsx(Jre,{open:d,onOpenChange:f,member:e,onMemberUpdated:I}),i.jsx(Qre,{open:o,onOpenChange:l,member:e}),i.jsx(DR,{open:c,onOpenChange:u,member:e})]})};console.log(" Member creation function is available for manual execution");const nne=()=>{const[e,t]=y.useState(""),[r,n]=y.useState(!1),{members:s,loading:a,updateMemberRole:o,deleteMember:l,suspendMember:c,resetPassword:u,searchMembers:d,fetchMembers:f}=f_(),p=ua(),h=lu(),g=y.useMemo(()=>d(e),[s,e,d]),m=[{name:"Super Admin",description:"Full system access and super administration",permissions:["All Permissions","Manage Super Admins"],memberCount:s.filter(v=>v.roles.includes("super_admin")&&!v.isPending).length},{name:"Admin",description:"Full system access and administration",permissions:["All Permissions except Super Admin Management"],memberCount:s.filter(v=>v.roles.includes("admin")&&!v.isPending).length},{name:"Member",description:"Standard member access",permissions:["Meeting Access","Document View","Voting"],memberCount:s.filter(v=>(v.roles.includes("member")||v.roles.length===0)&&!v.isPending).length}],x=()=>{const v=[["Name","Email","Phone","Role","Join Date"],...s.map(T=>[`${T.first_name||""} ${T.last_name||""}`,T.email,T.phone||"",T.roles[0]||"member",new Date(T.created_at).toLocaleDateString()])].map(T=>T.join(",")).join(`
`),_=new Blob([v],{type:"text/csv"}),b=window.URL.createObjectURL(_),S=document.createElement("a");S.href=b,S.download="members-export.csv",S.click(),window.URL.revokeObjectURL(b)},w=async()=>{console.log("Member updated - triggering immediate data refresh");try{await f(),console.log("Member data refreshed successfully")}catch(v){console.error("Error refreshing member data:",v)}};return a?i.jsx("div",{className:"w-full h-64 flex items-center justify-center",children:i.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary"})}):i.jsx(i.Fragment,{children:i.jsxs("div",{className:"w-full max-w-full min-h-0 flex flex-col members-container",children:[i.jsx("div",{className:"w-full mb-6",children:i.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4 members-header",children:[i.jsxs("div",{className:"min-w-0 flex-1 members-header-text",children:[i.jsx("h1",{className:`${h?"text-2xl":"text-2xl sm:text-3xl"} font-bold text-foreground mb-1 truncate`,children:"Member Management"}),i.jsx("p",{className:`${h?"text-sm":"text-sm sm:text-base"} text-muted-foreground`,children:"Manage bureau members, roles, and permissions"})]}),i.jsx("div",{className:"flex-shrink-0",children:p.canManageMembers&&i.jsxs(ue,{className:`${h?"w-full":"w-full sm:w-auto"} h-10 sm:h-auto`,onClick:()=>n(!0),"aria-label":"Add Member",children:[i.jsx(Pa,{className:"h-4 w-4 mr-2"}),i.jsx("span",{className:"whitespace-nowrap",children:"Add Member"})]})})]})}),i.jsx("div",{className:"w-full flex-1 min-h-0",children:i.jsxs(bl,{defaultValue:"members",className:"w-full h-full flex flex-col",children:[i.jsx("div",{className:"w-full mb-6",children:i.jsxs(So,{className:`w-full grid grid-cols-2 ${h?"h-auto members-tabs-list":"h-10"}`,children:[i.jsx(Vn,{value:"members",className:`${h?"text-xs px-2 py-3 flex-1 members-tabs-trigger":"text-xs sm:text-sm"} truncate`,children:h?`Members (${s.filter(v=>!v.isPending).length})`:`Members (${s.filter(v=>!v.isPending).length})`}),i.jsx(Vn,{value:"roles",className:`${h?"text-xs px-2 py-3 flex-1 members-tabs-trigger":"text-xs sm:text-sm"} truncate`,children:"Roles & Permissions"})]})}),i.jsxs(zr,{value:"members",className:"w-full flex-1 min-h-0 mt-0",children:[i.jsx("div",{className:"w-full mb-6",children:i.jsxs("div",{className:`flex ${h?"flex-col members-search-section":"flex-col sm:flex-row"} gap-4`,children:[i.jsx("div",{className:"flex-1 min-w-0",children:i.jsxs("div",{className:"relative",children:[i.jsx(q0,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-muted-foreground flex-shrink-0"}),i.jsx(Ep,{placeholder:"Search members by name, email, phone, or role...",value:e,onChange:v=>t(v.target.value),className:"pl-10 h-10"})]})}),p.canManageMembers&&i.jsx("div",{className:"flex-shrink-0",children:i.jsxs(ue,{variant:"outline",onClick:x,className:`${h?"w-full":"w-full sm:w-auto"} h-10`,"aria-label":"Export Member List",children:[i.jsx(js,{className:"h-4 w-4 mr-2"}),i.jsx("span",{className:"whitespace-nowrap",children:"Export List"})]})})]})}),i.jsx("div",{className:"w-full",children:g.length===0?i.jsx(Ye,{className:"w-full",children:i.jsxs(Je,{className:`${h?"p-4":"p-6 sm:p-8"} text-center`,children:[i.jsx(mr,{className:"h-12 w-12 text-muted-foreground mx-auto mb-4"}),i.jsx("h3",{className:`${h?"text-base":"text-lg"} font-medium text-foreground mb-2`,children:e?"No members found":"No members yet"}),i.jsx("p",{className:`${h?"text-xs":"text-sm"} text-muted-foreground mb-4`,children:e?"Try adjusting your search criteria":"Get started by adding your first member"}),!e&&p.canManageMembers&&i.jsxs(ue,{onClick:()=>n(!0),className:`${h?"w-full text-sm py-2":"w-full sm:w-auto"}`,"aria-label":"Add Member",children:[i.jsx(Pa,{className:"h-4 w-4 mr-2"}),"Add Member"]})]})}):i.jsx("div",{className:"w-full space-y-4 sm:space-y-6",children:g.map(v=>i.jsx(rne,{member:v,onRoleChange:async(_,b)=>{await o(_,b),await w()},onDeleteMember:async _=>{await l(_),await w()},onSuspendMember:async(_,b)=>{c&&(await c(_,b),await w())},onResetPassword:_=>{u&&u(_)},onMemberUpdated:w},v.id))})})]}),i.jsx(zr,{value:"roles",className:"w-full flex-1 min-h-0 mt-0",children:i.jsx("div",{className:"w-full space-y-4 sm:space-y-6",children:m.map((v,_)=>i.jsxs(Ye,{className:"w-full hover:shadow-md transition-shadow p-2 sm:p-4",children:[i.jsx(ct,{className:`${h?"p-4 pb-3":"pb-4"}`,children:i.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-start sm:justify-between gap-4",children:[i.jsxs("div",{className:"min-w-0 flex-1",children:[i.jsx(ft,{className:`${h?"text-base":"text-lg sm:text-xl"} mb-2 leading-tight`,children:v.name}),i.jsx(tn,{className:`${h?"text-xs":"text-sm"} leading-relaxed`,children:v.description})]}),i.jsx("div",{className:"flex-shrink-0",children:i.jsxs(We,{className:"bg-primary text-primary-foreground rounded-full px-3 py-1 text-xs",children:[v.memberCount," member",v.memberCount!==1?"s":""]})})]})}),i.jsx(Je,{className:`${h?"p-4 pt-0":"pt-0"}`,children:i.jsxs("div",{children:[i.jsxs("h4",{className:`font-semibold mb-3 flex items-center ${h?"text-xs":"text-sm"}`,children:[i.jsx(nl,{className:"h-4 w-4 mr-2 flex-shrink-0"}),"Permissions"]}),i.jsx("div",{className:"flex flex-wrap gap-2",children:v.permissions.map((b,S)=>i.jsx(We,{variant:"secondary",className:"text-xs",children:b},S))})]})})]},_))})})]})}),p.canManageMembers&&i.jsx(Ote,{open:r,onOpenChange:n,onMemberAdded:async()=>{n(!1),await w()}})]})})},OR=y.forwardRef(({...e},t)=>i.jsx("nav",{ref:t,"aria-label":"breadcrumb",...e}));OR.displayName="Breadcrumb";const FR=y.forwardRef(({className:e,...t},r)=>i.jsx("ol",{ref:r,className:De("flex flex-wrap items-center gap-1.5 break-words text-sm text-muted-foreground sm:gap-2.5",e),...t}));FR.displayName="BreadcrumbList";const pm=y.forwardRef(({className:e,...t},r)=>i.jsx("li",{ref:r,className:De("inline-flex items-center gap-1.5",e),...t}));pm.displayName="BreadcrumbItem";const cy=y.forwardRef(({asChild:e,className:t,...r},n)=>{const s=e?RE:"a";return i.jsx(s,{ref:n,className:De("transition-colors hover:text-foreground",t),...r})});cy.displayName="BreadcrumbLink";const uy=y.forwardRef(({className:e,...t},r)=>i.jsx("span",{ref:r,role:"link","aria-disabled":"true","aria-current":"page",className:De("font-normal text-foreground",e),...t}));uy.displayName="BreadcrumbPage";const dy=({children:e,className:t,...r})=>i.jsx("li",{role:"presentation","aria-hidden":"true",className:De("[&>svg]:size-3.5",t),...r,children:e??i.jsx(f1,{})});dy.displayName="BreadcrumbSeparator";const sne=({folders:e,userProfiles:t,onFolderClick:r,onDeleteFolder:n,canAccessLockedFolders:s=!1,viewMode:a="card",selectedIds:o=[],onSelectionChange:l,parentId:c=null})=>{const{unlockFolder:u}=jp(),d=ua();St();const f=g=>{const m=t[g];return m?`${m.first_name} ${m.last_name}`:"Unknown User"},p=async(g,m)=>{await n(g)},h=g=>{l&&(o.includes(g)?l(o.filter(m=>m!==g)):l([...o,g]))};return e.length===0?null:a==="list"?i.jsxs("div",{className:"mb-4 sm:mb-6",children:[i.jsxs("h3",{className:"text-base sm:text-lg font-semibold text-foreground mb-3 sm:mb-4 flex items-center",children:[i.jsx(ac,{className:"h-4 w-4 sm:h-5 sm:w-5 mr-2 text-blue-500"}),"Folders (",e.length,")"]}),i.jsx("div",{className:"space-y-1",children:e.filter(g=>g.parent_folder_id===c).map(g=>i.jsxs("div",{className:"bg-card border rounded-lg p-3 hover:bg-muted/30 transition-colors cursor-pointer group flex items-center justify-between",onClick:()=>r(g.id),children:[i.jsx("input",{type:"checkbox",checked:o.includes(g.id),onChange:m=>{m.stopPropagation(),h(g.id)},onClick:m=>m.stopPropagation(),className:"mr-2"}),g.is_locked?i.jsx(ti,{className:"h-5 w-5 text-red-500 flex-shrink-0"}):i.jsx(ac,{className:"h-5 w-5 text-blue-500 flex-shrink-0"}),i.jsx("span",{className:`font-medium truncate text-sm ${g.is_locked?"text-red-700":""}`,children:g.name}),s&&i.jsx("div",{onClick:m=>m.stopPropagation(),children:i.jsxs(lf,{children:[i.jsx(cf,{asChild:!0,children:i.jsx(ue,{variant:"ghost",size:"sm",className:"h-7 w-7 p-0 opacity-0 group-hover:opacity-100 transition-opacity",children:i.jsx(Id,{className:"h-4 w-4"})})}),i.jsx(Yc,{align:"end",className:"w-40",children:i.jsxs(Pr,{className:"text-red-600 focus:text-red-600",onClick:()=>n(g.id),children:[i.jsx(yr,{className:"h-4 w-4 mr-2"}),"Delete"]})})]})})]},`folder-list-${g.id}`))})]}):i.jsxs("div",{className:"mb-4 sm:mb-6",children:[i.jsxs("h3",{className:"text-base sm:text-lg font-semibold text-foreground mb-3 sm:mb-4 flex items-center",children:[i.jsx(ac,{className:"h-4 w-4 sm:h-5 sm:w-5 mr-2 text-blue-500"}),"Folders (",e.length,")"]}),i.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-4",children:e.filter(g=>g.parent_folder_id===c).map(g=>i.jsxs("div",{className:"bg-card border rounded-lg p-3 sm:p-4 hover:bg-muted/30 transition-colors cursor-pointer group mb-2 flex flex-col",onClick:()=>r(g.id),children:[i.jsxs("div",{className:"flex items-center space-x-2 mb-2",children:[i.jsx("input",{type:"checkbox",checked:o.includes(g.id),onChange:m=>{m.stopPropagation(),h(g.id)},onClick:m=>m.stopPropagation(),className:"mr-2"}),g.is_locked?i.jsx(ti,{className:"h-5 w-5 sm:h-6 sm:w-6 text-red-500 flex-shrink-0"}):i.jsx(ac,{className:"h-5 w-5 sm:h-6 sm:w-6 text-blue-500 flex-shrink-0"}),i.jsx("span",{className:`font-medium truncate text-sm sm:text-base ${g.is_locked?"text-red-700":""}`,children:g.name})]}),g.is_locked&&(d.isAdmin||d.isSuperAdmin)&&i.jsx("div",{className:"absolute top-2 right-2 z-10",children:i.jsx(ue,{variant:"ghost",size:"icon",className:"text-red-600",title:"Unlock folder",onClick:m=>{m.stopPropagation(),u.mutate(g.id)},children:i.jsx(ti,{className:"h-5 w-5"})})}),g.is_locked&&i.jsx(We,{variant:"destructive",className:"text-xs mb-2",children:"LOCKED"}),i.jsxs("div",{className:"text-xs text-muted-foreground space-y-1 flex-1",children:[i.jsxs("div",{children:["Modified: ",vt(new Date(g.updated_at),"MMM dd, yyyy")]}),i.jsxs("div",{className:"truncate",children:["Created by: ",f(g.created_by)]})]}),s&&i.jsx("div",{onClick:m=>m.stopPropagation(),className:"mt-2",children:i.jsxs(lf,{children:[i.jsx(cf,{asChild:!0,children:i.jsx(ue,{variant:"ghost",size:"sm",className:"h-7 w-7 sm:h-8 sm:w-8 p-0 opacity-0 group-hover:opacity-100 transition-opacity",children:i.jsx(Id,{className:"h-3 w-3 sm:h-4 sm:w-4"})})}),i.jsx(Yc,{align:"end",className:"w-40",children:i.jsxs(Pr,{className:"text-red-600 focus:text-red-600",onClick:()=>p(g.id,g.name),children:[i.jsx(yr,{className:"h-4 w-4 mr-2"}),"Delete"]})})]})})]},`folder-card-${g.id}`))})]})},ane=({isOpen:e,documentName:t,folders:r,currentFolderId:n,onClose:s,onMove:a,onCopy:o})=>{const[l,c]=y.useState(null),[u,d]=y.useState("move"),[f,p]=y.useState(!1);ke.useEffect(()=>{c(null),d("move")},[e]);const h=async()=>{p(!0),u==="move"?await a(l):await o(l),p(!1),s()};return i.jsx(Nt,{open:e,onOpenChange:s,children:i.jsxs(bt,{children:[i.jsxs(jt,{children:[i.jsx(Et,{children:u==="move"?"Move Document":"Copy Document"}),i.jsxs($t,{children:["Select a folder to ",u,' "',t,'" into.']})]}),i.jsxs("div",{className:"space-y-4",children:[i.jsxs("div",{children:[i.jsx(Ve,{htmlFor:"targetFolder",children:"Target Folder"}),i.jsxs(oa,{value:l||"root",onValueChange:g=>c(g==="root"?null:g),children:[i.jsx(As,{children:i.jsx(la,{placeholder:"Select folder"})}),i.jsxs(Ps,{children:[i.jsx(zt,{value:"root",children:"Root (No parent)"}),r.map(g=>i.jsx(zt,{value:g.id,children:g.name},g.id))]})]})]}),i.jsxs("div",{className:"flex gap-2",children:[i.jsx(ue,{variant:u==="move"?"default":"outline",onClick:()=>d("move"),disabled:u==="move",children:"Move"}),i.jsx(ue,{variant:u==="copy"?"default":"outline",onClick:()=>d("copy"),disabled:u==="copy",children:"Copy"})]}),i.jsxs("div",{className:"flex justify-end space-x-2",children:[i.jsx(ue,{variant:"outline",onClick:s,disabled:f,children:"Cancel"}),i.jsx(ue,{onClick:h,disabled:f,children:u==="move"?"Move":"Copy"})]})]})]})})},ine=({documents:e,userProfiles:t,currentUserId:r,canDeleteDocument:n,onViewDocument:s,onDownloadDocument:a,onToggleImportant:o,onRenameDocument:l,onCopyDocument:c,onDeleteDocument:u,onMoveDocument:d,onCopyToFolder:f,onDragStart:p,folders:h,viewMode:g="card",selectedIds:m=[],onSelectionChange:x})=>{const[w,v]=y.useState(null),[_,b]=y.useState(!1),[S,T]=y.useState(null),{userRole:N}=ua(),C=e.length>0&&e.every(F=>m.includes(F.id)),E=m.length>0&&!C,P=()=>{C?x==null||x([]):x==null||x(e.map(F=>F.id))},R=F=>{const D=m.includes(F)?m.filter(G=>G!==F):[...m,F];x==null||x(D)},j=F=>{const D=t[F];return D?`${D.first_name} ${D.last_name}`:"Unknown User"},M=F=>{if(F===null)return"N/A";const D=["Bytes","KB","MB","GB"],G=Math.floor(Math.log(F)/Math.log(1024));return Math.round(F/Math.pow(1024,G)*100)/100+" "+D[G]},A=F=>{v(F),p(F)},I=()=>{v(null)},X=(F,D)=>{D.target.closest("button")||D.target.closest('[role="menu"]')||s(F)},Y=F=>{T(F),b(!0)},z=()=>{b(!1),T(null)},U=async F=>{S&&await d(S.id,F)},V=async F=>{S&&await f(S.id,F)};return e.length===0?null:g==="list"?i.jsxs("div",{children:[i.jsxs("div",{className:"flex items-center justify-between mb-3 sm:mb-4",children:[i.jsxs("h3",{className:"text-base sm:text-lg font-semibold text-foreground flex items-center",children:[i.jsx(tr,{className:"h-4 w-4 sm:h-5 sm:w-5 mr-2 text-gray-500"}),"Documents (",e.length,")"]}),e.length>0&&i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx(Za,{checked:C,indeterminate:E,onCheckedChange:P,"aria-label":"Select all documents"}),i.jsx("span",{className:"text-sm text-muted-foreground",children:m.length>0&&`${m.length} selected`})]})]}),i.jsx("div",{className:"space-y-1",children:e.map(F=>{var D;return i.jsxs("div",{draggable:!0,onDragStart:()=>A(F.id),onDragEnd:I,onClick:G=>X(F,G),className:`bg-card border rounded-lg p-3 hover:bg-muted/30 transition-colors cursor-pointer group relative flex items-center justify-between ${w===F.id?"opacity-50":""}`,children:[i.jsxs("div",{className:"flex items-center space-x-3 flex-1 min-w-0",children:[i.jsx(Za,{checked:m.includes(F.id),onCheckedChange:()=>R(F.id),"aria-label":`Select ${F.name}`,onClick:G=>G.stopPropagation()}),i.jsx(tr,{className:"h-5 w-5 text-gray-500 flex-shrink-0"}),i.jsxs("div",{className:"flex-1 min-w-0",children:[i.jsxs("div",{className:"flex items-center space-x-2",children:[i.jsx("span",{className:"font-medium truncate text-sm",children:F.name}),F.is_important&&i.jsx(Sv,{className:"h-3 w-3 text-yellow-500 fill-current flex-shrink-0"})]}),i.jsxs("div",{className:"text-xs text-muted-foreground mt-1",children:[((D=F.mime_type)==null?void 0:D.split("/")[1])||"Unknown","  ",M(F.file_size),"  Modified ",vt(new Date(F.updated_at),"MMM dd, yyyy"),"  by ",j(F.uploaded_by)]})]})]}),i.jsx("div",{className:"absolute top-2 right-2 z-10",onClick:G=>G.stopPropagation(),children:i.jsxs(lf,{children:[i.jsx(cf,{asChild:!0,children:i.jsx(ue,{variant:"ghost",size:"sm",className:"h-7 w-7 p-0 opacity-70 hover:opacity-100 transition-opacity",children:i.jsx(Id,{className:"h-4 w-4"})})}),i.jsxs(Yc,{align:"end",className:"w-40",children:[i.jsxs(Pr,{onClick:()=>s(F),children:[i.jsx(Or,{className:"h-4 w-4 mr-2"}),"View"]}),n(F)&&i.jsxs(i.Fragment,{children:[i.jsxs(Pr,{onClick:()=>l(F),children:[i.jsx(_v,{className:"h-4 w-4 mr-2"}),"Rename"]}),i.jsxs(Pr,{onClick:()=>c(F.id),children:[i.jsx(Bm,{className:"h-4 w-4 mr-2"}),"Duplicate File"]}),i.jsxs(Pr,{onClick:()=>Y(F),children:[i.jsx(Ab,{className:"h-4 w-4 mr-2"}),"Move/Copy to Folder"]})]}),i.jsx(E0,{}),n(F)&&i.jsxs(Pr,{onClick:()=>u(F.id,F.name),children:[i.jsx(yr,{className:"h-4 w-4 mr-2 text-red-600"}),i.jsx("span",{className:"text-red-600",children:"Delete"})]})]})]})})]},F.id)})})]}):i.jsxs("div",{children:[i.jsxs("div",{className:"flex items-center justify-between mb-3 sm:mb-4",children:[i.jsxs("h3",{className:"text-base sm:text-lg font-semibold text-foreground flex items-center",children:[i.jsx(tr,{className:"h-4 w-4 sm:h-5 sm:w-5 mr-2 text-gray-500"}),"Documents (",e.length,")"]}),e.length>0&&i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx(Za,{checked:C,indeterminate:E,onCheckedChange:P,"aria-label":"Select all documents"}),i.jsx("span",{className:"text-sm text-muted-foreground",children:m.length>0&&`${m.length} selected`})]})]}),i.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-4",children:e.map(F=>{var D;return i.jsxs("div",{className:"bg-card border rounded-lg p-4 shadow-sm hover:shadow-md transition-shadow relative group flex flex-col",draggable:!0,onDragStart:()=>A(F.id),onDragEnd:I,onClick:G=>X(F,G),children:[i.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[i.jsx(Za,{checked:m.includes(F.id),onCheckedChange:()=>R(F.id),"aria-label":`Select ${F.name}`,onClick:G=>G.stopPropagation()}),i.jsx(tr,{className:"h-5 w-5 text-gray-500 flex-shrink-0"}),i.jsx("span",{className:"font-medium truncate text-sm flex-1",children:F.name}),F.is_important&&i.jsx(Sv,{className:"h-4 w-4 text-yellow-500 fill-current flex-shrink-0"})]}),i.jsxs("div",{className:"text-xs text-muted-foreground space-y-1 flex-1",children:[i.jsxs("div",{children:["Type: ",((D=F.mime_type)==null?void 0:D.split("/")[1])||"Unknown"]}),i.jsxs("div",{children:["Size: ",M(F.file_size)]}),i.jsxs("div",{children:["Modified: ",vt(new Date(F.updated_at),"MMM dd, yyyy")]}),i.jsxs("div",{children:["Uploaded by: ",j(F.uploaded_by)]})]}),(N==="admin"||N==="super_admin")&&i.jsx("div",{className:"absolute bottom-3 right-3 z-10",children:i.jsx(nu,{children:i.jsxs(jf,{children:[i.jsx(Ef,{asChild:!0,children:i.jsx("span",{children:i.jsx(kw,{documentId:F.id,documentName:F.name,documentType:"document",buttonClassName:"h-6 w-6 px-1 py-1 text-xs flex items-center justify-center",iconOnly:!0})})}),i.jsx(su,{children:"View Analytics"})]})})}),i.jsx("div",{className:"absolute top-2 right-2 z-10",onClick:G=>G.stopPropagation(),children:i.jsxs(lf,{children:[i.jsx(cf,{asChild:!0,children:i.jsx(ue,{variant:"ghost",size:"sm",className:"h-7 w-7 p-0 opacity-70 hover:opacity-100 transition-opacity",children:i.jsx(Id,{className:"h-4 w-4"})})}),i.jsxs(Yc,{align:"end",className:"w-40",children:[i.jsxs(Pr,{onClick:()=>s(F),children:[i.jsx(Or,{className:"h-4 w-4 mr-2"}),"View"]}),n(F)&&i.jsxs(i.Fragment,{children:[i.jsxs(Pr,{onClick:()=>l(F),children:[i.jsx(_v,{className:"h-4 w-4 mr-2"}),"Rename"]}),i.jsxs(Pr,{onClick:()=>c(F.id),children:[i.jsx(Bm,{className:"h-4 w-4 mr-2"}),"Duplicate File"]}),i.jsxs(Pr,{onClick:()=>Y(F),children:[i.jsx(Ab,{className:"h-4 w-4 mr-2"}),"Move/Copy to Folder"]})]}),i.jsx(E0,{}),n(F)&&i.jsxs(Pr,{onClick:()=>u(F.id,F.name),children:[i.jsx(yr,{className:"h-4 w-4 mr-2 text-red-600"}),i.jsx("span",{className:"text-red-600",children:"Delete"})]})]})]})})]},F.id)})}),i.jsx(ane,{isOpen:_,documentName:(S==null?void 0:S.name)||"",folders:h,currentFolderId:(S==null?void 0:S.folder_id)||null,onClose:z,onMove:U,onCopy:V})]})},one=({isOpen:e,onClose:t,onUpload:r,currentFolderId:n})=>{const[s,a]=y.useState([]),[o,l]=y.useState(!1),{toast:c}=St(),u=h=>{const g=Array.from(h.target.files||[]);g.length>0&&a(m=>[...m,...g])},d=h=>{a(g=>g.filter((m,x)=>x!==h))},f=async()=>{if(s.length===0){c({title:"No Files Selected",description:"Please select at least one file to upload",variant:"destructive"});return}l(!0);try{await r(s,n||void 0),a([]),t()}catch{}finally{l(!1)}},p=h=>{const g=["Bytes","KB","MB","GB"],m=Math.floor(Math.log(h)/Math.log(1024));return Math.round(h/Math.pow(1024,m)*100)/100+" "+g[m]};return i.jsx(Nt,{open:e,onOpenChange:t,children:i.jsxs(bt,{children:[i.jsxs("button",{type:"button","aria-label":"Close",onClick:t,className:"absolute top-2 right-2 p-2 rounded hover:bg-gray-100 focus:outline-none z-20",children:[i.jsx("span",{className:"sr-only",children:"Close"}),i.jsx("svg",{className:"h-5 w-5",fill:"none",stroke:"currentColor",strokeWidth:"2",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M6 18L18 6M6 6l12 12"})})]}),i.jsxs(jt,{children:[i.jsx(Et,{children:"Upload Documents"}),i.jsxs($t,{children:["Select one or more files to upload to the document repository",n&&" (will be uploaded to current folder)"]})]}),i.jsxs("div",{className:"space-y-4",children:[i.jsxs("div",{className:"flex gap-2",children:[i.jsxs("div",{children:[i.jsx(Ve,{htmlFor:"file",children:"Upload Files"}),i.jsx("input",{id:"file",type:"file",multiple:!0,onChange:u,accept:".pdf,.doc,.docx,.xls,.xlsx,.ppt,.pptx,.txt,.jpg,.jpeg,.png",className:"flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-base ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium file:text-foreground placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 md:text-sm"})]}),i.jsxs("div",{children:[i.jsx(Ve,{htmlFor:"folder",children:"Upload Folder"}),i.jsx("input",{id:"folder",type:"file",multiple:!0,webkitdirectory:"",directory:"",onChange:u,className:"flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-base ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium file:text-foreground placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 md:text-sm"})]})]}),s.length>0&&i.jsxs("div",{className:"space-y-2",children:[i.jsxs(Ve,{children:["Selected Files (",s.length,")"]}),i.jsx("div",{className:"max-h-40 overflow-y-auto space-y-2",children:s.map((h,g)=>i.jsxs("div",{className:"flex items-center justify-between p-2 bg-gray-50 rounded border",children:[i.jsxs("div",{className:"flex-1 min-w-0",children:[i.jsx("p",{className:"text-sm font-medium truncate",children:h.name}),i.jsx("p",{className:"text-xs text-gray-500",children:p(h.size)})]}),i.jsx(ue,{variant:"ghost",size:"sm",onClick:()=>d(g),className:"ml-2 h-6 w-6 p-0",children:i.jsx(Cn,{className:"h-4 w-4"})})]},g))})]}),i.jsxs("div",{className:"flex justify-end space-x-2",children:[i.jsx(ue,{variant:"outline",onClick:t,disabled:o,children:"Cancel"}),i.jsxs(ue,{onClick:f,disabled:s.length===0||o,children:[i.jsx(g1,{className:"h-4 w-4 mr-2"}),o?"Uploading...":`Upload ${s.length} File${s.length!==1?"s":""}`]})]})]})]})})},lne=({isOpen:e,document:t,onClose:r,onRename:n})=>{const[s,a]=y.useState("");ke.useEffect(()=>{t&&a(t.name)},[t]);const o=async()=>{s.trim()&&(await n(s),r())};return i.jsx(Nt,{open:e,onOpenChange:r,children:i.jsxs(bt,{children:[i.jsxs(jt,{children:[i.jsx(Et,{children:"Rename Document"}),i.jsx($t,{children:"Enter a new name for the document"})]}),i.jsxs("div",{className:"space-y-4",children:[i.jsxs("div",{children:[i.jsx(Ve,{htmlFor:"newName",children:"Document Name"}),i.jsx(dt,{id:"newName",value:s,onChange:l=>a(l.target.value),placeholder:"Enter new document name"})]}),i.jsxs("div",{className:"flex justify-end space-x-2",children:[i.jsx(ue,{variant:"outline",onClick:r,children:"Cancel"}),i.jsx(ue,{onClick:o,disabled:!s.trim(),children:"Rename"})]})]})]})})},aN=({isOpen:e,onClose:t,inline:r=!1})=>{const[n,s]=y.useState([]),[a,o]=y.useState(!1),[l,c]=y.useState([]),{toast:u}=St(),d=n.length>0&&n.every(S=>l.includes(S.id)),f=l.length>0&&!d,p=()=>{c(d?[]:n.map(S=>S.id))},h=S=>{c(T=>T.includes(S)?T.filter(N=>N!==S):[...T,S])},g=async()=>{o(!0);try{const{data:S,error:T}=await he.from("recycle_bin").select("*").order("deleted_at",{ascending:!1});if(T)throw T;s((S||[]).map(N=>({...N,is_important:N.is_important||!1,is_hidden:N.is_hidden||!1})))}catch(S){console.error("Error fetching trash items:",S),u({title:"Error",description:"Failed to load trash items",variant:"destructive"})}finally{o(!1)}},m=async S=>{try{const{error:T}=await he.rpc("restore_from_recycle_bin",{_recycle_bin_id:S});if(T)throw T;u({title:"Success",description:"Item restored successfully"}),g()}catch(T){console.error("Error restoring item:",T),u({title:"Error",description:"Failed to restore item",variant:"destructive"})}},x=async S=>{if(confirm("Are you sure you want to permanently delete this item? This action cannot be undone."))try{const{error:T}=await he.from("recycle_bin").delete().eq("id",S);if(T)throw T;u({title:"Success",description:"Item permanently deleted"}),g()}catch(T){console.error("Error permanently deleting item:",T),u({title:"Error",description:"Failed to permanently delete item",variant:"destructive"})}},w=async()=>{if(l.length!==0)try{for(const S of l)await he.rpc("restore_from_recycle_bin",{_recycle_bin_id:S});c([]),u({title:"Success",description:`${l.length} item(s) restored successfully`}),g()}catch(S){console.error("Error restoring items:",S),u({title:"Error",description:"Failed to restore items",variant:"destructive"})}},v=async()=>{if(l.length!==0&&confirm(`Are you sure you want to permanently delete ${l.length} item(s)? This action cannot be undone.`))try{for(const S of l)await he.from("recycle_bin").delete().eq("id",S);c([]),u({title:"Success",description:`${l.length} item(s) permanently deleted`}),g()}catch(S){console.error("Error deleting items:",S),u({title:"Error",description:"Failed to delete items",variant:"destructive"})}},_=S=>{if(!S)return"Unknown";const T=["Bytes","KB","MB","GB"],N=Math.floor(Math.log(S)/Math.log(1024));return Math.round(S/Math.pow(1024,N)*100)/100+" "+T[N]};y.useEffect(()=>{e&&g()},[e]);const b=i.jsxs(i.Fragment,{children:[!r&&i.jsxs(jt,{children:[i.jsxs(Et,{className:"flex items-center gap-2",children:[i.jsx(yr,{className:"h-5 w-5"}),"Trash"]}),i.jsx($t,{children:"Items in trash will be permanently deleted after 30 days"})]}),a?i.jsx("div",{className:"flex items-center justify-center py-8",children:i.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary"})}):n.length===0?i.jsxs("div",{className:"text-center py-8 text-gray-500",children:[i.jsx(yr,{className:"h-12 w-12 mx-auto mb-4 text-gray-300"}),i.jsx("p",{className:"text-lg font-medium",children:"Trash is empty"}),i.jsx("p",{className:"text-sm mt-2",children:"Deleted documents will appear here"})]}):i.jsxs("div",{className:"space-y-4",children:[l.length>0&&i.jsxs("div",{className:"flex items-center gap-2 p-3 bg-blue-50 border border-blue-200 rounded-lg",children:[i.jsxs("span",{className:"text-sm font-medium text-blue-900",children:[l.length," item(s) selected"]}),i.jsxs("div",{className:"flex items-center gap-2 ml-auto",children:[i.jsxs(ue,{variant:"outline",size:"sm",onClick:w,className:"text-green-600 hover:bg-green-100",children:[i.jsx(bv,{className:"h-4 w-4 mr-1"}),"Restore All"]}),i.jsxs(ue,{variant:"destructive",size:"sm",onClick:v,children:[i.jsx(yr,{className:"h-4 w-4 mr-1"}),"Delete All"]})]})]}),i.jsxs(Ff,{children:[i.jsx(If,{children:i.jsxs(mi,{children:[i.jsx(dr,{className:"w-[50px]",children:i.jsx(Za,{checked:d,indeterminate:f,onCheckedChange:p,"aria-label":"Select all items"})}),i.jsx(dr,{children:"Name"}),i.jsx(dr,{children:"Size"}),i.jsx(dr,{children:"Deleted"}),i.jsx(dr,{children:"Auto-delete"}),i.jsx(dr,{children:"Actions"})]})}),i.jsx(Lf,{children:n.map(S=>i.jsxs(mi,{children:[i.jsx(fr,{children:i.jsx(Za,{checked:l.includes(S.id),onCheckedChange:()=>h(S.id),"aria-label":`Select ${S.name}`})}),i.jsx(fr,{children:i.jsxs("div",{className:"flex items-center space-x-2",children:[i.jsx("span",{className:"font-medium",children:S.name}),S.is_important&&i.jsx(We,{variant:"secondary",className:"text-xs",children:"Important"})]})}),i.jsx(fr,{children:_(S.file_size)}),i.jsx(fr,{children:vt(new Date(S.deleted_at),"MMM dd, yyyy")}),i.jsx(fr,{children:vt(new Date(S.permanent_delete_at),"MMM dd, yyyy")}),i.jsx(fr,{children:i.jsxs("div",{className:"flex items-center space-x-2",children:[i.jsxs(ue,{size:"sm",variant:"outline",onClick:()=>m(S.id),children:[i.jsx(bv,{className:"h-4 w-4 mr-1"}),"Restore"]}),i.jsxs(ue,{size:"sm",variant:"destructive",onClick:()=>x(S.id),children:[i.jsx(yr,{className:"h-4 w-4 mr-1"}),"Delete"]})]})})]},S.id))})]})]})]});return r?b:i.jsx(Nt,{open:e,onOpenChange:t,children:i.jsx(bt,{className:"max-w-4xl max-h-[80vh] overflow-y-auto",children:b})})};function Uh(e){throw new Error('Could not dynamically require "'+e+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var IR={exports:{}};/*!

JSZip v3.10.1 - A JavaScript class for generating and reading zip files
<http://stuartk.com/jszip>

(c) 2009-2016 Stuart Knightley <stuart [at] stuartk.com>
Dual licenced under the MIT license or GPLv3. See https://raw.github.com/Stuk/jszip/main/LICENSE.markdown.

JSZip uses the library pako released under the MIT license :
https://github.com/nodeca/pako/blob/main/LICENSE
*/(function(e,t){(function(r){e.exports=r()})(function(){return function r(n,s,a){function o(u,d){if(!s[u]){if(!n[u]){var f=typeof Uh=="function"&&Uh;if(!d&&f)return f(u,!0);if(l)return l(u,!0);var p=new Error("Cannot find module '"+u+"'");throw p.code="MODULE_NOT_FOUND",p}var h=s[u]={exports:{}};n[u][0].call(h.exports,function(g){var m=n[u][1][g];return o(m||g)},h,h.exports,r,n,s,a)}return s[u].exports}for(var l=typeof Uh=="function"&&Uh,c=0;c<a.length;c++)o(a[c]);return o}({1:[function(r,n,s){var a=r("./utils"),o=r("./support"),l="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";s.encode=function(c){for(var u,d,f,p,h,g,m,x=[],w=0,v=c.length,_=v,b=a.getTypeOf(c)!=="string";w<c.length;)_=v-w,f=b?(u=c[w++],d=w<v?c[w++]:0,w<v?c[w++]:0):(u=c.charCodeAt(w++),d=w<v?c.charCodeAt(w++):0,w<v?c.charCodeAt(w++):0),p=u>>2,h=(3&u)<<4|d>>4,g=1<_?(15&d)<<2|f>>6:64,m=2<_?63&f:64,x.push(l.charAt(p)+l.charAt(h)+l.charAt(g)+l.charAt(m));return x.join("")},s.decode=function(c){var u,d,f,p,h,g,m=0,x=0,w="data:";if(c.substr(0,w.length)===w)throw new Error("Invalid base64 input, it looks like a data url.");var v,_=3*(c=c.replace(/[^A-Za-z0-9+/=]/g,"")).length/4;if(c.charAt(c.length-1)===l.charAt(64)&&_--,c.charAt(c.length-2)===l.charAt(64)&&_--,_%1!=0)throw new Error("Invalid base64 input, bad content length.");for(v=o.uint8array?new Uint8Array(0|_):new Array(0|_);m<c.length;)u=l.indexOf(c.charAt(m++))<<2|(p=l.indexOf(c.charAt(m++)))>>4,d=(15&p)<<4|(h=l.indexOf(c.charAt(m++)))>>2,f=(3&h)<<6|(g=l.indexOf(c.charAt(m++))),v[x++]=u,h!==64&&(v[x++]=d),g!==64&&(v[x++]=f);return v}},{"./support":30,"./utils":32}],2:[function(r,n,s){var a=r("./external"),o=r("./stream/DataWorker"),l=r("./stream/Crc32Probe"),c=r("./stream/DataLengthProbe");function u(d,f,p,h,g){this.compressedSize=d,this.uncompressedSize=f,this.crc32=p,this.compression=h,this.compressedContent=g}u.prototype={getContentWorker:function(){var d=new o(a.Promise.resolve(this.compressedContent)).pipe(this.compression.uncompressWorker()).pipe(new c("data_length")),f=this;return d.on("end",function(){if(this.streamInfo.data_length!==f.uncompressedSize)throw new Error("Bug : uncompressed data size mismatch")}),d},getCompressedWorker:function(){return new o(a.Promise.resolve(this.compressedContent)).withStreamInfo("compressedSize",this.compressedSize).withStreamInfo("uncompressedSize",this.uncompressedSize).withStreamInfo("crc32",this.crc32).withStreamInfo("compression",this.compression)}},u.createWorkerFrom=function(d,f,p){return d.pipe(new l).pipe(new c("uncompressedSize")).pipe(f.compressWorker(p)).pipe(new c("compressedSize")).withStreamInfo("compression",f)},n.exports=u},{"./external":6,"./stream/Crc32Probe":25,"./stream/DataLengthProbe":26,"./stream/DataWorker":27}],3:[function(r,n,s){var a=r("./stream/GenericWorker");s.STORE={magic:"\0\0",compressWorker:function(){return new a("STORE compression")},uncompressWorker:function(){return new a("STORE decompression")}},s.DEFLATE=r("./flate")},{"./flate":7,"./stream/GenericWorker":28}],4:[function(r,n,s){var a=r("./utils"),o=function(){for(var l,c=[],u=0;u<256;u++){l=u;for(var d=0;d<8;d++)l=1&l?3988292384^l>>>1:l>>>1;c[u]=l}return c}();n.exports=function(l,c){return l!==void 0&&l.length?a.getTypeOf(l)!=="string"?function(u,d,f,p){var h=o,g=p+f;u^=-1;for(var m=p;m<g;m++)u=u>>>8^h[255&(u^d[m])];return-1^u}(0|c,l,l.length,0):function(u,d,f,p){var h=o,g=p+f;u^=-1;for(var m=p;m<g;m++)u=u>>>8^h[255&(u^d.charCodeAt(m))];return-1^u}(0|c,l,l.length,0):0}},{"./utils":32}],5:[function(r,n,s){s.base64=!1,s.binary=!1,s.dir=!1,s.createFolders=!0,s.date=null,s.compression=null,s.compressionOptions=null,s.comment=null,s.unixPermissions=null,s.dosPermissions=null},{}],6:[function(r,n,s){var a=null;a=typeof Promise<"u"?Promise:r("lie"),n.exports={Promise:a}},{lie:37}],7:[function(r,n,s){var a=typeof Uint8Array<"u"&&typeof Uint16Array<"u"&&typeof Uint32Array<"u",o=r("pako"),l=r("./utils"),c=r("./stream/GenericWorker"),u=a?"uint8array":"array";function d(f,p){c.call(this,"FlateWorker/"+f),this._pako=null,this._pakoAction=f,this._pakoOptions=p,this.meta={}}s.magic="\b\0",l.inherits(d,c),d.prototype.processChunk=function(f){this.meta=f.meta,this._pako===null&&this._createPako(),this._pako.push(l.transformTo(u,f.data),!1)},d.prototype.flush=function(){c.prototype.flush.call(this),this._pako===null&&this._createPako(),this._pako.push([],!0)},d.prototype.cleanUp=function(){c.prototype.cleanUp.call(this),this._pako=null},d.prototype._createPako=function(){this._pako=new o[this._pakoAction]({raw:!0,level:this._pakoOptions.level||-1});var f=this;this._pako.onData=function(p){f.push({data:p,meta:f.meta})}},s.compressWorker=function(f){return new d("Deflate",f)},s.uncompressWorker=function(){return new d("Inflate",{})}},{"./stream/GenericWorker":28,"./utils":32,pako:38}],8:[function(r,n,s){function a(h,g){var m,x="";for(m=0;m<g;m++)x+=String.fromCharCode(255&h),h>>>=8;return x}function o(h,g,m,x,w,v){var _,b,S=h.file,T=h.compression,N=v!==u.utf8encode,C=l.transformTo("string",v(S.name)),E=l.transformTo("string",u.utf8encode(S.name)),P=S.comment,R=l.transformTo("string",v(P)),j=l.transformTo("string",u.utf8encode(P)),M=E.length!==S.name.length,A=j.length!==P.length,I="",X="",Y="",z=S.dir,U=S.date,V={crc32:0,compressedSize:0,uncompressedSize:0};g&&!m||(V.crc32=h.crc32,V.compressedSize=h.compressedSize,V.uncompressedSize=h.uncompressedSize);var F=0;g&&(F|=8),N||!M&&!A||(F|=2048);var D=0,G=0;z&&(D|=16),w==="UNIX"?(G=798,D|=function(L,ie){var ne=L;return L||(ne=ie?16893:33204),(65535&ne)<<16}(S.unixPermissions,z)):(G=20,D|=function(L){return 63&(L||0)}(S.dosPermissions)),_=U.getUTCHours(),_<<=6,_|=U.getUTCMinutes(),_<<=5,_|=U.getUTCSeconds()/2,b=U.getUTCFullYear()-1980,b<<=4,b|=U.getUTCMonth()+1,b<<=5,b|=U.getUTCDate(),M&&(X=a(1,1)+a(d(C),4)+E,I+="up"+a(X.length,2)+X),A&&(Y=a(1,1)+a(d(R),4)+j,I+="uc"+a(Y.length,2)+Y);var O="";return O+=`
\0`,O+=a(F,2),O+=T.magic,O+=a(_,2),O+=a(b,2),O+=a(V.crc32,4),O+=a(V.compressedSize,4),O+=a(V.uncompressedSize,4),O+=a(C.length,2),O+=a(I.length,2),{fileRecord:f.LOCAL_FILE_HEADER+O+C+I,dirRecord:f.CENTRAL_FILE_HEADER+a(G,2)+O+a(R.length,2)+"\0\0\0\0"+a(D,4)+a(x,4)+C+I+R}}var l=r("../utils"),c=r("../stream/GenericWorker"),u=r("../utf8"),d=r("../crc32"),f=r("../signature");function p(h,g,m,x){c.call(this,"ZipFileWorker"),this.bytesWritten=0,this.zipComment=g,this.zipPlatform=m,this.encodeFileName=x,this.streamFiles=h,this.accumulate=!1,this.contentBuffer=[],this.dirRecords=[],this.currentSourceOffset=0,this.entriesCount=0,this.currentFile=null,this._sources=[]}l.inherits(p,c),p.prototype.push=function(h){var g=h.meta.percent||0,m=this.entriesCount,x=this._sources.length;this.accumulate?this.contentBuffer.push(h):(this.bytesWritten+=h.data.length,c.prototype.push.call(this,{data:h.data,meta:{currentFile:this.currentFile,percent:m?(g+100*(m-x-1))/m:100}}))},p.prototype.openedSource=function(h){this.currentSourceOffset=this.bytesWritten,this.currentFile=h.file.name;var g=this.streamFiles&&!h.file.dir;if(g){var m=o(h,g,!1,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);this.push({data:m.fileRecord,meta:{percent:0}})}else this.accumulate=!0},p.prototype.closedSource=function(h){this.accumulate=!1;var g=this.streamFiles&&!h.file.dir,m=o(h,g,!0,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);if(this.dirRecords.push(m.dirRecord),g)this.push({data:function(x){return f.DATA_DESCRIPTOR+a(x.crc32,4)+a(x.compressedSize,4)+a(x.uncompressedSize,4)}(h),meta:{percent:100}});else for(this.push({data:m.fileRecord,meta:{percent:0}});this.contentBuffer.length;)this.push(this.contentBuffer.shift());this.currentFile=null},p.prototype.flush=function(){for(var h=this.bytesWritten,g=0;g<this.dirRecords.length;g++)this.push({data:this.dirRecords[g],meta:{percent:100}});var m=this.bytesWritten-h,x=function(w,v,_,b,S){var T=l.transformTo("string",S(b));return f.CENTRAL_DIRECTORY_END+"\0\0\0\0"+a(w,2)+a(w,2)+a(v,4)+a(_,4)+a(T.length,2)+T}(this.dirRecords.length,m,h,this.zipComment,this.encodeFileName);this.push({data:x,meta:{percent:100}})},p.prototype.prepareNextSource=function(){this.previous=this._sources.shift(),this.openedSource(this.previous.streamInfo),this.isPaused?this.previous.pause():this.previous.resume()},p.prototype.registerPrevious=function(h){this._sources.push(h);var g=this;return h.on("data",function(m){g.processChunk(m)}),h.on("end",function(){g.closedSource(g.previous.streamInfo),g._sources.length?g.prepareNextSource():g.end()}),h.on("error",function(m){g.error(m)}),this},p.prototype.resume=function(){return!!c.prototype.resume.call(this)&&(!this.previous&&this._sources.length?(this.prepareNextSource(),!0):this.previous||this._sources.length||this.generatedError?void 0:(this.end(),!0))},p.prototype.error=function(h){var g=this._sources;if(!c.prototype.error.call(this,h))return!1;for(var m=0;m<g.length;m++)try{g[m].error(h)}catch{}return!0},p.prototype.lock=function(){c.prototype.lock.call(this);for(var h=this._sources,g=0;g<h.length;g++)h[g].lock()},n.exports=p},{"../crc32":4,"../signature":23,"../stream/GenericWorker":28,"../utf8":31,"../utils":32}],9:[function(r,n,s){var a=r("../compressions"),o=r("./ZipFileWorker");s.generateWorker=function(l,c,u){var d=new o(c.streamFiles,u,c.platform,c.encodeFileName),f=0;try{l.forEach(function(p,h){f++;var g=function(v,_){var b=v||_,S=a[b];if(!S)throw new Error(b+" is not a valid compression method !");return S}(h.options.compression,c.compression),m=h.options.compressionOptions||c.compressionOptions||{},x=h.dir,w=h.date;h._compressWorker(g,m).withStreamInfo("file",{name:p,dir:x,date:w,comment:h.comment||"",unixPermissions:h.unixPermissions,dosPermissions:h.dosPermissions}).pipe(d)}),d.entriesCount=f}catch(p){d.error(p)}return d}},{"../compressions":3,"./ZipFileWorker":8}],10:[function(r,n,s){function a(){if(!(this instanceof a))return new a;if(arguments.length)throw new Error("The constructor with parameters has been removed in JSZip 3.0, please check the upgrade guide.");this.files=Object.create(null),this.comment=null,this.root="",this.clone=function(){var o=new a;for(var l in this)typeof this[l]!="function"&&(o[l]=this[l]);return o}}(a.prototype=r("./object")).loadAsync=r("./load"),a.support=r("./support"),a.defaults=r("./defaults"),a.version="3.10.1",a.loadAsync=function(o,l){return new a().loadAsync(o,l)},a.external=r("./external"),n.exports=a},{"./defaults":5,"./external":6,"./load":11,"./object":15,"./support":30}],11:[function(r,n,s){var a=r("./utils"),o=r("./external"),l=r("./utf8"),c=r("./zipEntries"),u=r("./stream/Crc32Probe"),d=r("./nodejsUtils");function f(p){return new o.Promise(function(h,g){var m=p.decompressed.getContentWorker().pipe(new u);m.on("error",function(x){g(x)}).on("end",function(){m.streamInfo.crc32!==p.decompressed.crc32?g(new Error("Corrupted zip : CRC32 mismatch")):h()}).resume()})}n.exports=function(p,h){var g=this;return h=a.extend(h||{},{base64:!1,checkCRC32:!1,optimizedBinaryString:!1,createFolders:!1,decodeFileName:l.utf8decode}),d.isNode&&d.isStream(p)?o.Promise.reject(new Error("JSZip can't accept a stream when loading a zip file.")):a.prepareContent("the loaded zip file",p,!0,h.optimizedBinaryString,h.base64).then(function(m){var x=new c(h);return x.load(m),x}).then(function(m){var x=[o.Promise.resolve(m)],w=m.files;if(h.checkCRC32)for(var v=0;v<w.length;v++)x.push(f(w[v]));return o.Promise.all(x)}).then(function(m){for(var x=m.shift(),w=x.files,v=0;v<w.length;v++){var _=w[v],b=_.fileNameStr,S=a.resolve(_.fileNameStr);g.file(S,_.decompressed,{binary:!0,optimizedBinaryString:!0,date:_.date,dir:_.dir,comment:_.fileCommentStr.length?_.fileCommentStr:null,unixPermissions:_.unixPermissions,dosPermissions:_.dosPermissions,createFolders:h.createFolders}),_.dir||(g.file(S).unsafeOriginalName=b)}return x.zipComment.length&&(g.comment=x.zipComment),g})}},{"./external":6,"./nodejsUtils":14,"./stream/Crc32Probe":25,"./utf8":31,"./utils":32,"./zipEntries":33}],12:[function(r,n,s){var a=r("../utils"),o=r("../stream/GenericWorker");function l(c,u){o.call(this,"Nodejs stream input adapter for "+c),this._upstreamEnded=!1,this._bindStream(u)}a.inherits(l,o),l.prototype._bindStream=function(c){var u=this;(this._stream=c).pause(),c.on("data",function(d){u.push({data:d,meta:{percent:0}})}).on("error",function(d){u.isPaused?this.generatedError=d:u.error(d)}).on("end",function(){u.isPaused?u._upstreamEnded=!0:u.end()})},l.prototype.pause=function(){return!!o.prototype.pause.call(this)&&(this._stream.pause(),!0)},l.prototype.resume=function(){return!!o.prototype.resume.call(this)&&(this._upstreamEnded?this.end():this._stream.resume(),!0)},n.exports=l},{"../stream/GenericWorker":28,"../utils":32}],13:[function(r,n,s){var a=r("readable-stream").Readable;function o(l,c,u){a.call(this,c),this._helper=l;var d=this;l.on("data",function(f,p){d.push(f)||d._helper.pause(),u&&u(p)}).on("error",function(f){d.emit("error",f)}).on("end",function(){d.push(null)})}r("../utils").inherits(o,a),o.prototype._read=function(){this._helper.resume()},n.exports=o},{"../utils":32,"readable-stream":16}],14:[function(r,n,s){n.exports={isNode:typeof Buffer<"u",newBufferFrom:function(a,o){if(Buffer.from&&Buffer.from!==Uint8Array.from)return Buffer.from(a,o);if(typeof a=="number")throw new Error('The "data" argument must not be a number');return new Buffer(a,o)},allocBuffer:function(a){if(Buffer.alloc)return Buffer.alloc(a);var o=new Buffer(a);return o.fill(0),o},isBuffer:function(a){return Buffer.isBuffer(a)},isStream:function(a){return a&&typeof a.on=="function"&&typeof a.pause=="function"&&typeof a.resume=="function"}}},{}],15:[function(r,n,s){function a(S,T,N){var C,E=l.getTypeOf(T),P=l.extend(N||{},d);P.date=P.date||new Date,P.compression!==null&&(P.compression=P.compression.toUpperCase()),typeof P.unixPermissions=="string"&&(P.unixPermissions=parseInt(P.unixPermissions,8)),P.unixPermissions&&16384&P.unixPermissions&&(P.dir=!0),P.dosPermissions&&16&P.dosPermissions&&(P.dir=!0),P.dir&&(S=w(S)),P.createFolders&&(C=x(S))&&v.call(this,C,!0);var R=E==="string"&&P.binary===!1&&P.base64===!1;N&&N.binary!==void 0||(P.binary=!R),(T instanceof f&&T.uncompressedSize===0||P.dir||!T||T.length===0)&&(P.base64=!1,P.binary=!0,T="",P.compression="STORE",E="string");var j=null;j=T instanceof f||T instanceof c?T:g.isNode&&g.isStream(T)?new m(S,T):l.prepareContent(S,T,P.binary,P.optimizedBinaryString,P.base64);var M=new p(S,j,P);this.files[S]=M}var o=r("./utf8"),l=r("./utils"),c=r("./stream/GenericWorker"),u=r("./stream/StreamHelper"),d=r("./defaults"),f=r("./compressedObject"),p=r("./zipObject"),h=r("./generate"),g=r("./nodejsUtils"),m=r("./nodejs/NodejsStreamInputAdapter"),x=function(S){S.slice(-1)==="/"&&(S=S.substring(0,S.length-1));var T=S.lastIndexOf("/");return 0<T?S.substring(0,T):""},w=function(S){return S.slice(-1)!=="/"&&(S+="/"),S},v=function(S,T){return T=T!==void 0?T:d.createFolders,S=w(S),this.files[S]||a.call(this,S,null,{dir:!0,createFolders:T}),this.files[S]};function _(S){return Object.prototype.toString.call(S)==="[object RegExp]"}var b={load:function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},forEach:function(S){var T,N,C;for(T in this.files)C=this.files[T],(N=T.slice(this.root.length,T.length))&&T.slice(0,this.root.length)===this.root&&S(N,C)},filter:function(S){var T=[];return this.forEach(function(N,C){S(N,C)&&T.push(C)}),T},file:function(S,T,N){if(arguments.length!==1)return S=this.root+S,a.call(this,S,T,N),this;if(_(S)){var C=S;return this.filter(function(P,R){return!R.dir&&C.test(P)})}var E=this.files[this.root+S];return E&&!E.dir?E:null},folder:function(S){if(!S)return this;if(_(S))return this.filter(function(E,P){return P.dir&&S.test(E)});var T=this.root+S,N=v.call(this,T),C=this.clone();return C.root=N.name,C},remove:function(S){S=this.root+S;var T=this.files[S];if(T||(S.slice(-1)!=="/"&&(S+="/"),T=this.files[S]),T&&!T.dir)delete this.files[S];else for(var N=this.filter(function(E,P){return P.name.slice(0,S.length)===S}),C=0;C<N.length;C++)delete this.files[N[C].name];return this},generate:function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},generateInternalStream:function(S){var T,N={};try{if((N=l.extend(S||{},{streamFiles:!1,compression:"STORE",compressionOptions:null,type:"",platform:"DOS",comment:null,mimeType:"application/zip",encodeFileName:o.utf8encode})).type=N.type.toLowerCase(),N.compression=N.compression.toUpperCase(),N.type==="binarystring"&&(N.type="string"),!N.type)throw new Error("No output type specified.");l.checkSupport(N.type),N.platform!=="darwin"&&N.platform!=="freebsd"&&N.platform!=="linux"&&N.platform!=="sunos"||(N.platform="UNIX"),N.platform==="win32"&&(N.platform="DOS");var C=N.comment||this.comment||"";T=h.generateWorker(this,N,C)}catch(E){(T=new c("error")).error(E)}return new u(T,N.type||"string",N.mimeType)},generateAsync:function(S,T){return this.generateInternalStream(S).accumulate(T)},generateNodeStream:function(S,T){return(S=S||{}).type||(S.type="nodebuffer"),this.generateInternalStream(S).toNodejsStream(T)}};n.exports=b},{"./compressedObject":2,"./defaults":5,"./generate":9,"./nodejs/NodejsStreamInputAdapter":12,"./nodejsUtils":14,"./stream/GenericWorker":28,"./stream/StreamHelper":29,"./utf8":31,"./utils":32,"./zipObject":35}],16:[function(r,n,s){n.exports=r("stream")},{stream:void 0}],17:[function(r,n,s){var a=r("./DataReader");function o(l){a.call(this,l);for(var c=0;c<this.data.length;c++)l[c]=255&l[c]}r("../utils").inherits(o,a),o.prototype.byteAt=function(l){return this.data[this.zero+l]},o.prototype.lastIndexOfSignature=function(l){for(var c=l.charCodeAt(0),u=l.charCodeAt(1),d=l.charCodeAt(2),f=l.charCodeAt(3),p=this.length-4;0<=p;--p)if(this.data[p]===c&&this.data[p+1]===u&&this.data[p+2]===d&&this.data[p+3]===f)return p-this.zero;return-1},o.prototype.readAndCheckSignature=function(l){var c=l.charCodeAt(0),u=l.charCodeAt(1),d=l.charCodeAt(2),f=l.charCodeAt(3),p=this.readData(4);return c===p[0]&&u===p[1]&&d===p[2]&&f===p[3]},o.prototype.readData=function(l){if(this.checkOffset(l),l===0)return[];var c=this.data.slice(this.zero+this.index,this.zero+this.index+l);return this.index+=l,c},n.exports=o},{"../utils":32,"./DataReader":18}],18:[function(r,n,s){var a=r("../utils");function o(l){this.data=l,this.length=l.length,this.index=0,this.zero=0}o.prototype={checkOffset:function(l){this.checkIndex(this.index+l)},checkIndex:function(l){if(this.length<this.zero+l||l<0)throw new Error("End of data reached (data length = "+this.length+", asked index = "+l+"). Corrupted zip ?")},setIndex:function(l){this.checkIndex(l),this.index=l},skip:function(l){this.setIndex(this.index+l)},byteAt:function(){},readInt:function(l){var c,u=0;for(this.checkOffset(l),c=this.index+l-1;c>=this.index;c--)u=(u<<8)+this.byteAt(c);return this.index+=l,u},readString:function(l){return a.transformTo("string",this.readData(l))},readData:function(){},lastIndexOfSignature:function(){},readAndCheckSignature:function(){},readDate:function(){var l=this.readInt(4);return new Date(Date.UTC(1980+(l>>25&127),(l>>21&15)-1,l>>16&31,l>>11&31,l>>5&63,(31&l)<<1))}},n.exports=o},{"../utils":32}],19:[function(r,n,s){var a=r("./Uint8ArrayReader");function o(l){a.call(this,l)}r("../utils").inherits(o,a),o.prototype.readData=function(l){this.checkOffset(l);var c=this.data.slice(this.zero+this.index,this.zero+this.index+l);return this.index+=l,c},n.exports=o},{"../utils":32,"./Uint8ArrayReader":21}],20:[function(r,n,s){var a=r("./DataReader");function o(l){a.call(this,l)}r("../utils").inherits(o,a),o.prototype.byteAt=function(l){return this.data.charCodeAt(this.zero+l)},o.prototype.lastIndexOfSignature=function(l){return this.data.lastIndexOf(l)-this.zero},o.prototype.readAndCheckSignature=function(l){return l===this.readData(4)},o.prototype.readData=function(l){this.checkOffset(l);var c=this.data.slice(this.zero+this.index,this.zero+this.index+l);return this.index+=l,c},n.exports=o},{"../utils":32,"./DataReader":18}],21:[function(r,n,s){var a=r("./ArrayReader");function o(l){a.call(this,l)}r("../utils").inherits(o,a),o.prototype.readData=function(l){if(this.checkOffset(l),l===0)return new Uint8Array(0);var c=this.data.subarray(this.zero+this.index,this.zero+this.index+l);return this.index+=l,c},n.exports=o},{"../utils":32,"./ArrayReader":17}],22:[function(r,n,s){var a=r("../utils"),o=r("../support"),l=r("./ArrayReader"),c=r("./StringReader"),u=r("./NodeBufferReader"),d=r("./Uint8ArrayReader");n.exports=function(f){var p=a.getTypeOf(f);return a.checkSupport(p),p!=="string"||o.uint8array?p==="nodebuffer"?new u(f):o.uint8array?new d(a.transformTo("uint8array",f)):new l(a.transformTo("array",f)):new c(f)}},{"../support":30,"../utils":32,"./ArrayReader":17,"./NodeBufferReader":19,"./StringReader":20,"./Uint8ArrayReader":21}],23:[function(r,n,s){s.LOCAL_FILE_HEADER="PK",s.CENTRAL_FILE_HEADER="PK",s.CENTRAL_DIRECTORY_END="PK",s.ZIP64_CENTRAL_DIRECTORY_LOCATOR="PK\x07",s.ZIP64_CENTRAL_DIRECTORY_END="PK",s.DATA_DESCRIPTOR="PK\x07\b"},{}],24:[function(r,n,s){var a=r("./GenericWorker"),o=r("../utils");function l(c){a.call(this,"ConvertWorker to "+c),this.destType=c}o.inherits(l,a),l.prototype.processChunk=function(c){this.push({data:o.transformTo(this.destType,c.data),meta:c.meta})},n.exports=l},{"../utils":32,"./GenericWorker":28}],25:[function(r,n,s){var a=r("./GenericWorker"),o=r("../crc32");function l(){a.call(this,"Crc32Probe"),this.withStreamInfo("crc32",0)}r("../utils").inherits(l,a),l.prototype.processChunk=function(c){this.streamInfo.crc32=o(c.data,this.streamInfo.crc32||0),this.push(c)},n.exports=l},{"../crc32":4,"../utils":32,"./GenericWorker":28}],26:[function(r,n,s){var a=r("../utils"),o=r("./GenericWorker");function l(c){o.call(this,"DataLengthProbe for "+c),this.propName=c,this.withStreamInfo(c,0)}a.inherits(l,o),l.prototype.processChunk=function(c){if(c){var u=this.streamInfo[this.propName]||0;this.streamInfo[this.propName]=u+c.data.length}o.prototype.processChunk.call(this,c)},n.exports=l},{"../utils":32,"./GenericWorker":28}],27:[function(r,n,s){var a=r("../utils"),o=r("./GenericWorker");function l(c){o.call(this,"DataWorker");var u=this;this.dataIsReady=!1,this.index=0,this.max=0,this.data=null,this.type="",this._tickScheduled=!1,c.then(function(d){u.dataIsReady=!0,u.data=d,u.max=d&&d.length||0,u.type=a.getTypeOf(d),u.isPaused||u._tickAndRepeat()},function(d){u.error(d)})}a.inherits(l,o),l.prototype.cleanUp=function(){o.prototype.cleanUp.call(this),this.data=null},l.prototype.resume=function(){return!!o.prototype.resume.call(this)&&(!this._tickScheduled&&this.dataIsReady&&(this._tickScheduled=!0,a.delay(this._tickAndRepeat,[],this)),!0)},l.prototype._tickAndRepeat=function(){this._tickScheduled=!1,this.isPaused||this.isFinished||(this._tick(),this.isFinished||(a.delay(this._tickAndRepeat,[],this),this._tickScheduled=!0))},l.prototype._tick=function(){if(this.isPaused||this.isFinished)return!1;var c=null,u=Math.min(this.max,this.index+16384);if(this.index>=this.max)return this.end();switch(this.type){case"string":c=this.data.substring(this.index,u);break;case"uint8array":c=this.data.subarray(this.index,u);break;case"array":case"nodebuffer":c=this.data.slice(this.index,u)}return this.index=u,this.push({data:c,meta:{percent:this.max?this.index/this.max*100:0}})},n.exports=l},{"../utils":32,"./GenericWorker":28}],28:[function(r,n,s){function a(o){this.name=o||"default",this.streamInfo={},this.generatedError=null,this.extraStreamInfo={},this.isPaused=!0,this.isFinished=!1,this.isLocked=!1,this._listeners={data:[],end:[],error:[]},this.previous=null}a.prototype={push:function(o){this.emit("data",o)},end:function(){if(this.isFinished)return!1;this.flush();try{this.emit("end"),this.cleanUp(),this.isFinished=!0}catch(o){this.emit("error",o)}return!0},error:function(o){return!this.isFinished&&(this.isPaused?this.generatedError=o:(this.isFinished=!0,this.emit("error",o),this.previous&&this.previous.error(o),this.cleanUp()),!0)},on:function(o,l){return this._listeners[o].push(l),this},cleanUp:function(){this.streamInfo=this.generatedError=this.extraStreamInfo=null,this._listeners=[]},emit:function(o,l){if(this._listeners[o])for(var c=0;c<this._listeners[o].length;c++)this._listeners[o][c].call(this,l)},pipe:function(o){return o.registerPrevious(this)},registerPrevious:function(o){if(this.isLocked)throw new Error("The stream '"+this+"' has already been used.");this.streamInfo=o.streamInfo,this.mergeStreamInfo(),this.previous=o;var l=this;return o.on("data",function(c){l.processChunk(c)}),o.on("end",function(){l.end()}),o.on("error",function(c){l.error(c)}),this},pause:function(){return!this.isPaused&&!this.isFinished&&(this.isPaused=!0,this.previous&&this.previous.pause(),!0)},resume:function(){if(!this.isPaused||this.isFinished)return!1;var o=this.isPaused=!1;return this.generatedError&&(this.error(this.generatedError),o=!0),this.previous&&this.previous.resume(),!o},flush:function(){},processChunk:function(o){this.push(o)},withStreamInfo:function(o,l){return this.extraStreamInfo[o]=l,this.mergeStreamInfo(),this},mergeStreamInfo:function(){for(var o in this.extraStreamInfo)Object.prototype.hasOwnProperty.call(this.extraStreamInfo,o)&&(this.streamInfo[o]=this.extraStreamInfo[o])},lock:function(){if(this.isLocked)throw new Error("The stream '"+this+"' has already been used.");this.isLocked=!0,this.previous&&this.previous.lock()},toString:function(){var o="Worker "+this.name;return this.previous?this.previous+" -> "+o:o}},n.exports=a},{}],29:[function(r,n,s){var a=r("../utils"),o=r("./ConvertWorker"),l=r("./GenericWorker"),c=r("../base64"),u=r("../support"),d=r("../external"),f=null;if(u.nodestream)try{f=r("../nodejs/NodejsStreamOutputAdapter")}catch{}function p(g,m){return new d.Promise(function(x,w){var v=[],_=g._internalType,b=g._outputType,S=g._mimeType;g.on("data",function(T,N){v.push(T),m&&m(N)}).on("error",function(T){v=[],w(T)}).on("end",function(){try{var T=function(N,C,E){switch(N){case"blob":return a.newBlob(a.transformTo("arraybuffer",C),E);case"base64":return c.encode(C);default:return a.transformTo(N,C)}}(b,function(N,C){var E,P=0,R=null,j=0;for(E=0;E<C.length;E++)j+=C[E].length;switch(N){case"string":return C.join("");case"array":return Array.prototype.concat.apply([],C);case"uint8array":for(R=new Uint8Array(j),E=0;E<C.length;E++)R.set(C[E],P),P+=C[E].length;return R;case"nodebuffer":return Buffer.concat(C);default:throw new Error("concat : unsupported type '"+N+"'")}}(_,v),S);x(T)}catch(N){w(N)}v=[]}).resume()})}function h(g,m,x){var w=m;switch(m){case"blob":case"arraybuffer":w="uint8array";break;case"base64":w="string"}try{this._internalType=w,this._outputType=m,this._mimeType=x,a.checkSupport(w),this._worker=g.pipe(new o(w)),g.lock()}catch(v){this._worker=new l("error"),this._worker.error(v)}}h.prototype={accumulate:function(g){return p(this,g)},on:function(g,m){var x=this;return g==="data"?this._worker.on(g,function(w){m.call(x,w.data,w.meta)}):this._worker.on(g,function(){a.delay(m,arguments,x)}),this},resume:function(){return a.delay(this._worker.resume,[],this._worker),this},pause:function(){return this._worker.pause(),this},toNodejsStream:function(g){if(a.checkSupport("nodestream"),this._outputType!=="nodebuffer")throw new Error(this._outputType+" is not supported by this method");return new f(this,{objectMode:this._outputType!=="nodebuffer"},g)}},n.exports=h},{"../base64":1,"../external":6,"../nodejs/NodejsStreamOutputAdapter":13,"../support":30,"../utils":32,"./ConvertWorker":24,"./GenericWorker":28}],30:[function(r,n,s){if(s.base64=!0,s.array=!0,s.string=!0,s.arraybuffer=typeof ArrayBuffer<"u"&&typeof Uint8Array<"u",s.nodebuffer=typeof Buffer<"u",s.uint8array=typeof Uint8Array<"u",typeof ArrayBuffer>"u")s.blob=!1;else{var a=new ArrayBuffer(0);try{s.blob=new Blob([a],{type:"application/zip"}).size===0}catch{try{var o=new(self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder);o.append(a),s.blob=o.getBlob("application/zip").size===0}catch{s.blob=!1}}}try{s.nodestream=!!r("readable-stream").Readable}catch{s.nodestream=!1}},{"readable-stream":16}],31:[function(r,n,s){for(var a=r("./utils"),o=r("./support"),l=r("./nodejsUtils"),c=r("./stream/GenericWorker"),u=new Array(256),d=0;d<256;d++)u[d]=252<=d?6:248<=d?5:240<=d?4:224<=d?3:192<=d?2:1;u[254]=u[254]=1;function f(){c.call(this,"utf-8 decode"),this.leftOver=null}function p(){c.call(this,"utf-8 encode")}s.utf8encode=function(h){return o.nodebuffer?l.newBufferFrom(h,"utf-8"):function(g){var m,x,w,v,_,b=g.length,S=0;for(v=0;v<b;v++)(64512&(x=g.charCodeAt(v)))==55296&&v+1<b&&(64512&(w=g.charCodeAt(v+1)))==56320&&(x=65536+(x-55296<<10)+(w-56320),v++),S+=x<128?1:x<2048?2:x<65536?3:4;for(m=o.uint8array?new Uint8Array(S):new Array(S),v=_=0;_<S;v++)(64512&(x=g.charCodeAt(v)))==55296&&v+1<b&&(64512&(w=g.charCodeAt(v+1)))==56320&&(x=65536+(x-55296<<10)+(w-56320),v++),x<128?m[_++]=x:(x<2048?m[_++]=192|x>>>6:(x<65536?m[_++]=224|x>>>12:(m[_++]=240|x>>>18,m[_++]=128|x>>>12&63),m[_++]=128|x>>>6&63),m[_++]=128|63&x);return m}(h)},s.utf8decode=function(h){return o.nodebuffer?a.transformTo("nodebuffer",h).toString("utf-8"):function(g){var m,x,w,v,_=g.length,b=new Array(2*_);for(m=x=0;m<_;)if((w=g[m++])<128)b[x++]=w;else if(4<(v=u[w]))b[x++]=65533,m+=v-1;else{for(w&=v===2?31:v===3?15:7;1<v&&m<_;)w=w<<6|63&g[m++],v--;1<v?b[x++]=65533:w<65536?b[x++]=w:(w-=65536,b[x++]=55296|w>>10&1023,b[x++]=56320|1023&w)}return b.length!==x&&(b.subarray?b=b.subarray(0,x):b.length=x),a.applyFromCharCode(b)}(h=a.transformTo(o.uint8array?"uint8array":"array",h))},a.inherits(f,c),f.prototype.processChunk=function(h){var g=a.transformTo(o.uint8array?"uint8array":"array",h.data);if(this.leftOver&&this.leftOver.length){if(o.uint8array){var m=g;(g=new Uint8Array(m.length+this.leftOver.length)).set(this.leftOver,0),g.set(m,this.leftOver.length)}else g=this.leftOver.concat(g);this.leftOver=null}var x=function(v,_){var b;for((_=_||v.length)>v.length&&(_=v.length),b=_-1;0<=b&&(192&v[b])==128;)b--;return b<0||b===0?_:b+u[v[b]]>_?b:_}(g),w=g;x!==g.length&&(o.uint8array?(w=g.subarray(0,x),this.leftOver=g.subarray(x,g.length)):(w=g.slice(0,x),this.leftOver=g.slice(x,g.length))),this.push({data:s.utf8decode(w),meta:h.meta})},f.prototype.flush=function(){this.leftOver&&this.leftOver.length&&(this.push({data:s.utf8decode(this.leftOver),meta:{}}),this.leftOver=null)},s.Utf8DecodeWorker=f,a.inherits(p,c),p.prototype.processChunk=function(h){this.push({data:s.utf8encode(h.data),meta:h.meta})},s.Utf8EncodeWorker=p},{"./nodejsUtils":14,"./stream/GenericWorker":28,"./support":30,"./utils":32}],32:[function(r,n,s){var a=r("./support"),o=r("./base64"),l=r("./nodejsUtils"),c=r("./external");function u(m){return m}function d(m,x){for(var w=0;w<m.length;++w)x[w]=255&m.charCodeAt(w);return x}r("setimmediate"),s.newBlob=function(m,x){s.checkSupport("blob");try{return new Blob([m],{type:x})}catch{try{var w=new(self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder);return w.append(m),w.getBlob(x)}catch{throw new Error("Bug : can't construct the Blob.")}}};var f={stringifyByChunk:function(m,x,w){var v=[],_=0,b=m.length;if(b<=w)return String.fromCharCode.apply(null,m);for(;_<b;)x==="array"||x==="nodebuffer"?v.push(String.fromCharCode.apply(null,m.slice(_,Math.min(_+w,b)))):v.push(String.fromCharCode.apply(null,m.subarray(_,Math.min(_+w,b)))),_+=w;return v.join("")},stringifyByChar:function(m){for(var x="",w=0;w<m.length;w++)x+=String.fromCharCode(m[w]);return x},applyCanBeUsed:{uint8array:function(){try{return a.uint8array&&String.fromCharCode.apply(null,new Uint8Array(1)).length===1}catch{return!1}}(),nodebuffer:function(){try{return a.nodebuffer&&String.fromCharCode.apply(null,l.allocBuffer(1)).length===1}catch{return!1}}()}};function p(m){var x=65536,w=s.getTypeOf(m),v=!0;if(w==="uint8array"?v=f.applyCanBeUsed.uint8array:w==="nodebuffer"&&(v=f.applyCanBeUsed.nodebuffer),v)for(;1<x;)try{return f.stringifyByChunk(m,w,x)}catch{x=Math.floor(x/2)}return f.stringifyByChar(m)}function h(m,x){for(var w=0;w<m.length;w++)x[w]=m[w];return x}s.applyFromCharCode=p;var g={};g.string={string:u,array:function(m){return d(m,new Array(m.length))},arraybuffer:function(m){return g.string.uint8array(m).buffer},uint8array:function(m){return d(m,new Uint8Array(m.length))},nodebuffer:function(m){return d(m,l.allocBuffer(m.length))}},g.array={string:p,array:u,arraybuffer:function(m){return new Uint8Array(m).buffer},uint8array:function(m){return new Uint8Array(m)},nodebuffer:function(m){return l.newBufferFrom(m)}},g.arraybuffer={string:function(m){return p(new Uint8Array(m))},array:function(m){return h(new Uint8Array(m),new Array(m.byteLength))},arraybuffer:u,uint8array:function(m){return new Uint8Array(m)},nodebuffer:function(m){return l.newBufferFrom(new Uint8Array(m))}},g.uint8array={string:p,array:function(m){return h(m,new Array(m.length))},arraybuffer:function(m){return m.buffer},uint8array:u,nodebuffer:function(m){return l.newBufferFrom(m)}},g.nodebuffer={string:p,array:function(m){return h(m,new Array(m.length))},arraybuffer:function(m){return g.nodebuffer.uint8array(m).buffer},uint8array:function(m){return h(m,new Uint8Array(m.length))},nodebuffer:u},s.transformTo=function(m,x){if(x=x||"",!m)return x;s.checkSupport(m);var w=s.getTypeOf(x);return g[w][m](x)},s.resolve=function(m){for(var x=m.split("/"),w=[],v=0;v<x.length;v++){var _=x[v];_==="."||_===""&&v!==0&&v!==x.length-1||(_===".."?w.pop():w.push(_))}return w.join("/")},s.getTypeOf=function(m){return typeof m=="string"?"string":Object.prototype.toString.call(m)==="[object Array]"?"array":a.nodebuffer&&l.isBuffer(m)?"nodebuffer":a.uint8array&&m instanceof Uint8Array?"uint8array":a.arraybuffer&&m instanceof ArrayBuffer?"arraybuffer":void 0},s.checkSupport=function(m){if(!a[m.toLowerCase()])throw new Error(m+" is not supported by this platform")},s.MAX_VALUE_16BITS=65535,s.MAX_VALUE_32BITS=-1,s.pretty=function(m){var x,w,v="";for(w=0;w<(m||"").length;w++)v+="\\x"+((x=m.charCodeAt(w))<16?"0":"")+x.toString(16).toUpperCase();return v},s.delay=function(m,x,w){setImmediate(function(){m.apply(w||null,x||[])})},s.inherits=function(m,x){function w(){}w.prototype=x.prototype,m.prototype=new w},s.extend=function(){var m,x,w={};for(m=0;m<arguments.length;m++)for(x in arguments[m])Object.prototype.hasOwnProperty.call(arguments[m],x)&&w[x]===void 0&&(w[x]=arguments[m][x]);return w},s.prepareContent=function(m,x,w,v,_){return c.Promise.resolve(x).then(function(b){return a.blob&&(b instanceof Blob||["[object File]","[object Blob]"].indexOf(Object.prototype.toString.call(b))!==-1)&&typeof FileReader<"u"?new c.Promise(function(S,T){var N=new FileReader;N.onload=function(C){S(C.target.result)},N.onerror=function(C){T(C.target.error)},N.readAsArrayBuffer(b)}):b}).then(function(b){var S=s.getTypeOf(b);return S?(S==="arraybuffer"?b=s.transformTo("uint8array",b):S==="string"&&(_?b=o.decode(b):w&&v!==!0&&(b=function(T){return d(T,a.uint8array?new Uint8Array(T.length):new Array(T.length))}(b))),b):c.Promise.reject(new Error("Can't read the data of '"+m+"'. Is it in a supported JavaScript type (String, Blob, ArrayBuffer, etc) ?"))})}},{"./base64":1,"./external":6,"./nodejsUtils":14,"./support":30,setimmediate:54}],33:[function(r,n,s){var a=r("./reader/readerFor"),o=r("./utils"),l=r("./signature"),c=r("./zipEntry"),u=r("./support");function d(f){this.files=[],this.loadOptions=f}d.prototype={checkSignature:function(f){if(!this.reader.readAndCheckSignature(f)){this.reader.index-=4;var p=this.reader.readString(4);throw new Error("Corrupted zip or bug: unexpected signature ("+o.pretty(p)+", expected "+o.pretty(f)+")")}},isSignature:function(f,p){var h=this.reader.index;this.reader.setIndex(f);var g=this.reader.readString(4)===p;return this.reader.setIndex(h),g},readBlockEndOfCentral:function(){this.diskNumber=this.reader.readInt(2),this.diskWithCentralDirStart=this.reader.readInt(2),this.centralDirRecordsOnThisDisk=this.reader.readInt(2),this.centralDirRecords=this.reader.readInt(2),this.centralDirSize=this.reader.readInt(4),this.centralDirOffset=this.reader.readInt(4),this.zipCommentLength=this.reader.readInt(2);var f=this.reader.readData(this.zipCommentLength),p=u.uint8array?"uint8array":"array",h=o.transformTo(p,f);this.zipComment=this.loadOptions.decodeFileName(h)},readBlockZip64EndOfCentral:function(){this.zip64EndOfCentralSize=this.reader.readInt(8),this.reader.skip(4),this.diskNumber=this.reader.readInt(4),this.diskWithCentralDirStart=this.reader.readInt(4),this.centralDirRecordsOnThisDisk=this.reader.readInt(8),this.centralDirRecords=this.reader.readInt(8),this.centralDirSize=this.reader.readInt(8),this.centralDirOffset=this.reader.readInt(8),this.zip64ExtensibleData={};for(var f,p,h,g=this.zip64EndOfCentralSize-44;0<g;)f=this.reader.readInt(2),p=this.reader.readInt(4),h=this.reader.readData(p),this.zip64ExtensibleData[f]={id:f,length:p,value:h}},readBlockZip64EndOfCentralLocator:function(){if(this.diskWithZip64CentralDirStart=this.reader.readInt(4),this.relativeOffsetEndOfZip64CentralDir=this.reader.readInt(8),this.disksCount=this.reader.readInt(4),1<this.disksCount)throw new Error("Multi-volumes zip are not supported")},readLocalFiles:function(){var f,p;for(f=0;f<this.files.length;f++)p=this.files[f],this.reader.setIndex(p.localHeaderOffset),this.checkSignature(l.LOCAL_FILE_HEADER),p.readLocalPart(this.reader),p.handleUTF8(),p.processAttributes()},readCentralDir:function(){var f;for(this.reader.setIndex(this.centralDirOffset);this.reader.readAndCheckSignature(l.CENTRAL_FILE_HEADER);)(f=new c({zip64:this.zip64},this.loadOptions)).readCentralPart(this.reader),this.files.push(f);if(this.centralDirRecords!==this.files.length&&this.centralDirRecords!==0&&this.files.length===0)throw new Error("Corrupted zip or bug: expected "+this.centralDirRecords+" records in central dir, got "+this.files.length)},readEndOfCentral:function(){var f=this.reader.lastIndexOfSignature(l.CENTRAL_DIRECTORY_END);if(f<0)throw this.isSignature(0,l.LOCAL_FILE_HEADER)?new Error("Corrupted zip: can't find end of central directory"):new Error("Can't find end of central directory : is this a zip file ? If it is, see https://stuk.github.io/jszip/documentation/howto/read_zip.html");this.reader.setIndex(f);var p=f;if(this.checkSignature(l.CENTRAL_DIRECTORY_END),this.readBlockEndOfCentral(),this.diskNumber===o.MAX_VALUE_16BITS||this.diskWithCentralDirStart===o.MAX_VALUE_16BITS||this.centralDirRecordsOnThisDisk===o.MAX_VALUE_16BITS||this.centralDirRecords===o.MAX_VALUE_16BITS||this.centralDirSize===o.MAX_VALUE_32BITS||this.centralDirOffset===o.MAX_VALUE_32BITS){if(this.zip64=!0,(f=this.reader.lastIndexOfSignature(l.ZIP64_CENTRAL_DIRECTORY_LOCATOR))<0)throw new Error("Corrupted zip: can't find the ZIP64 end of central directory locator");if(this.reader.setIndex(f),this.checkSignature(l.ZIP64_CENTRAL_DIRECTORY_LOCATOR),this.readBlockZip64EndOfCentralLocator(),!this.isSignature(this.relativeOffsetEndOfZip64CentralDir,l.ZIP64_CENTRAL_DIRECTORY_END)&&(this.relativeOffsetEndOfZip64CentralDir=this.reader.lastIndexOfSignature(l.ZIP64_CENTRAL_DIRECTORY_END),this.relativeOffsetEndOfZip64CentralDir<0))throw new Error("Corrupted zip: can't find the ZIP64 end of central directory");this.reader.setIndex(this.relativeOffsetEndOfZip64CentralDir),this.checkSignature(l.ZIP64_CENTRAL_DIRECTORY_END),this.readBlockZip64EndOfCentral()}var h=this.centralDirOffset+this.centralDirSize;this.zip64&&(h+=20,h+=12+this.zip64EndOfCentralSize);var g=p-h;if(0<g)this.isSignature(p,l.CENTRAL_FILE_HEADER)||(this.reader.zero=g);else if(g<0)throw new Error("Corrupted zip: missing "+Math.abs(g)+" bytes.")},prepareReader:function(f){this.reader=a(f)},load:function(f){this.prepareReader(f),this.readEndOfCentral(),this.readCentralDir(),this.readLocalFiles()}},n.exports=d},{"./reader/readerFor":22,"./signature":23,"./support":30,"./utils":32,"./zipEntry":34}],34:[function(r,n,s){var a=r("./reader/readerFor"),o=r("./utils"),l=r("./compressedObject"),c=r("./crc32"),u=r("./utf8"),d=r("./compressions"),f=r("./support");function p(h,g){this.options=h,this.loadOptions=g}p.prototype={isEncrypted:function(){return(1&this.bitFlag)==1},useUTF8:function(){return(2048&this.bitFlag)==2048},readLocalPart:function(h){var g,m;if(h.skip(22),this.fileNameLength=h.readInt(2),m=h.readInt(2),this.fileName=h.readData(this.fileNameLength),h.skip(m),this.compressedSize===-1||this.uncompressedSize===-1)throw new Error("Bug or corrupted zip : didn't get enough information from the central directory (compressedSize === -1 || uncompressedSize === -1)");if((g=function(x){for(var w in d)if(Object.prototype.hasOwnProperty.call(d,w)&&d[w].magic===x)return d[w];return null}(this.compressionMethod))===null)throw new Error("Corrupted zip : compression "+o.pretty(this.compressionMethod)+" unknown (inner file : "+o.transformTo("string",this.fileName)+")");this.decompressed=new l(this.compressedSize,this.uncompressedSize,this.crc32,g,h.readData(this.compressedSize))},readCentralPart:function(h){this.versionMadeBy=h.readInt(2),h.skip(2),this.bitFlag=h.readInt(2),this.compressionMethod=h.readString(2),this.date=h.readDate(),this.crc32=h.readInt(4),this.compressedSize=h.readInt(4),this.uncompressedSize=h.readInt(4);var g=h.readInt(2);if(this.extraFieldsLength=h.readInt(2),this.fileCommentLength=h.readInt(2),this.diskNumberStart=h.readInt(2),this.internalFileAttributes=h.readInt(2),this.externalFileAttributes=h.readInt(4),this.localHeaderOffset=h.readInt(4),this.isEncrypted())throw new Error("Encrypted zip are not supported");h.skip(g),this.readExtraFields(h),this.parseZIP64ExtraField(h),this.fileComment=h.readData(this.fileCommentLength)},processAttributes:function(){this.unixPermissions=null,this.dosPermissions=null;var h=this.versionMadeBy>>8;this.dir=!!(16&this.externalFileAttributes),h==0&&(this.dosPermissions=63&this.externalFileAttributes),h==3&&(this.unixPermissions=this.externalFileAttributes>>16&65535),this.dir||this.fileNameStr.slice(-1)!=="/"||(this.dir=!0)},parseZIP64ExtraField:function(){if(this.extraFields[1]){var h=a(this.extraFields[1].value);this.uncompressedSize===o.MAX_VALUE_32BITS&&(this.uncompressedSize=h.readInt(8)),this.compressedSize===o.MAX_VALUE_32BITS&&(this.compressedSize=h.readInt(8)),this.localHeaderOffset===o.MAX_VALUE_32BITS&&(this.localHeaderOffset=h.readInt(8)),this.diskNumberStart===o.MAX_VALUE_32BITS&&(this.diskNumberStart=h.readInt(4))}},readExtraFields:function(h){var g,m,x,w=h.index+this.extraFieldsLength;for(this.extraFields||(this.extraFields={});h.index+4<w;)g=h.readInt(2),m=h.readInt(2),x=h.readData(m),this.extraFields[g]={id:g,length:m,value:x};h.setIndex(w)},handleUTF8:function(){var h=f.uint8array?"uint8array":"array";if(this.useUTF8())this.fileNameStr=u.utf8decode(this.fileName),this.fileCommentStr=u.utf8decode(this.fileComment);else{var g=this.findExtraFieldUnicodePath();if(g!==null)this.fileNameStr=g;else{var m=o.transformTo(h,this.fileName);this.fileNameStr=this.loadOptions.decodeFileName(m)}var x=this.findExtraFieldUnicodeComment();if(x!==null)this.fileCommentStr=x;else{var w=o.transformTo(h,this.fileComment);this.fileCommentStr=this.loadOptions.decodeFileName(w)}}},findExtraFieldUnicodePath:function(){var h=this.extraFields[28789];if(h){var g=a(h.value);return g.readInt(1)!==1||c(this.fileName)!==g.readInt(4)?null:u.utf8decode(g.readData(h.length-5))}return null},findExtraFieldUnicodeComment:function(){var h=this.extraFields[25461];if(h){var g=a(h.value);return g.readInt(1)!==1||c(this.fileComment)!==g.readInt(4)?null:u.utf8decode(g.readData(h.length-5))}return null}},n.exports=p},{"./compressedObject":2,"./compressions":3,"./crc32":4,"./reader/readerFor":22,"./support":30,"./utf8":31,"./utils":32}],35:[function(r,n,s){function a(g,m,x){this.name=g,this.dir=x.dir,this.date=x.date,this.comment=x.comment,this.unixPermissions=x.unixPermissions,this.dosPermissions=x.dosPermissions,this._data=m,this._dataBinary=x.binary,this.options={compression:x.compression,compressionOptions:x.compressionOptions}}var o=r("./stream/StreamHelper"),l=r("./stream/DataWorker"),c=r("./utf8"),u=r("./compressedObject"),d=r("./stream/GenericWorker");a.prototype={internalStream:function(g){var m=null,x="string";try{if(!g)throw new Error("No output type specified.");var w=(x=g.toLowerCase())==="string"||x==="text";x!=="binarystring"&&x!=="text"||(x="string"),m=this._decompressWorker();var v=!this._dataBinary;v&&!w&&(m=m.pipe(new c.Utf8EncodeWorker)),!v&&w&&(m=m.pipe(new c.Utf8DecodeWorker))}catch(_){(m=new d("error")).error(_)}return new o(m,x,"")},async:function(g,m){return this.internalStream(g).accumulate(m)},nodeStream:function(g,m){return this.internalStream(g||"nodebuffer").toNodejsStream(m)},_compressWorker:function(g,m){if(this._data instanceof u&&this._data.compression.magic===g.magic)return this._data.getCompressedWorker();var x=this._decompressWorker();return this._dataBinary||(x=x.pipe(new c.Utf8EncodeWorker)),u.createWorkerFrom(x,g,m)},_decompressWorker:function(){return this._data instanceof u?this._data.getContentWorker():this._data instanceof d?this._data:new l(this._data)}};for(var f=["asText","asBinary","asNodeBuffer","asUint8Array","asArrayBuffer"],p=function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},h=0;h<f.length;h++)a.prototype[f[h]]=p;n.exports=a},{"./compressedObject":2,"./stream/DataWorker":27,"./stream/GenericWorker":28,"./stream/StreamHelper":29,"./utf8":31}],36:[function(r,n,s){(function(a){var o,l,c=a.MutationObserver||a.WebKitMutationObserver;if(c){var u=0,d=new c(g),f=a.document.createTextNode("");d.observe(f,{characterData:!0}),o=function(){f.data=u=++u%2}}else if(a.setImmediate||a.MessageChannel===void 0)o="document"in a&&"onreadystatechange"in a.document.createElement("script")?function(){var m=a.document.createElement("script");m.onreadystatechange=function(){g(),m.onreadystatechange=null,m.parentNode.removeChild(m),m=null},a.document.documentElement.appendChild(m)}:function(){setTimeout(g,0)};else{var p=new a.MessageChannel;p.port1.onmessage=g,o=function(){p.port2.postMessage(0)}}var h=[];function g(){var m,x;l=!0;for(var w=h.length;w;){for(x=h,h=[],m=-1;++m<w;)x[m]();w=h.length}l=!1}n.exports=function(m){h.push(m)!==1||l||o()}}).call(this,typeof pn<"u"?pn:typeof self<"u"?self:typeof window<"u"?window:{})},{}],37:[function(r,n,s){var a=r("immediate");function o(){}var l={},c=["REJECTED"],u=["FULFILLED"],d=["PENDING"];function f(w){if(typeof w!="function")throw new TypeError("resolver must be a function");this.state=d,this.queue=[],this.outcome=void 0,w!==o&&m(this,w)}function p(w,v,_){this.promise=w,typeof v=="function"&&(this.onFulfilled=v,this.callFulfilled=this.otherCallFulfilled),typeof _=="function"&&(this.onRejected=_,this.callRejected=this.otherCallRejected)}function h(w,v,_){a(function(){var b;try{b=v(_)}catch(S){return l.reject(w,S)}b===w?l.reject(w,new TypeError("Cannot resolve promise with itself")):l.resolve(w,b)})}function g(w){var v=w&&w.then;if(w&&(typeof w=="object"||typeof w=="function")&&typeof v=="function")return function(){v.apply(w,arguments)}}function m(w,v){var _=!1;function b(N){_||(_=!0,l.reject(w,N))}function S(N){_||(_=!0,l.resolve(w,N))}var T=x(function(){v(S,b)});T.status==="error"&&b(T.value)}function x(w,v){var _={};try{_.value=w(v),_.status="success"}catch(b){_.status="error",_.value=b}return _}(n.exports=f).prototype.finally=function(w){if(typeof w!="function")return this;var v=this.constructor;return this.then(function(_){return v.resolve(w()).then(function(){return _})},function(_){return v.resolve(w()).then(function(){throw _})})},f.prototype.catch=function(w){return this.then(null,w)},f.prototype.then=function(w,v){if(typeof w!="function"&&this.state===u||typeof v!="function"&&this.state===c)return this;var _=new this.constructor(o);return this.state!==d?h(_,this.state===u?w:v,this.outcome):this.queue.push(new p(_,w,v)),_},p.prototype.callFulfilled=function(w){l.resolve(this.promise,w)},p.prototype.otherCallFulfilled=function(w){h(this.promise,this.onFulfilled,w)},p.prototype.callRejected=function(w){l.reject(this.promise,w)},p.prototype.otherCallRejected=function(w){h(this.promise,this.onRejected,w)},l.resolve=function(w,v){var _=x(g,v);if(_.status==="error")return l.reject(w,_.value);var b=_.value;if(b)m(w,b);else{w.state=u,w.outcome=v;for(var S=-1,T=w.queue.length;++S<T;)w.queue[S].callFulfilled(v)}return w},l.reject=function(w,v){w.state=c,w.outcome=v;for(var _=-1,b=w.queue.length;++_<b;)w.queue[_].callRejected(v);return w},f.resolve=function(w){return w instanceof this?w:l.resolve(new this(o),w)},f.reject=function(w){var v=new this(o);return l.reject(v,w)},f.all=function(w){var v=this;if(Object.prototype.toString.call(w)!=="[object Array]")return this.reject(new TypeError("must be an array"));var _=w.length,b=!1;if(!_)return this.resolve([]);for(var S=new Array(_),T=0,N=-1,C=new this(o);++N<_;)E(w[N],N);return C;function E(P,R){v.resolve(P).then(function(j){S[R]=j,++T!==_||b||(b=!0,l.resolve(C,S))},function(j){b||(b=!0,l.reject(C,j))})}},f.race=function(w){var v=this;if(Object.prototype.toString.call(w)!=="[object Array]")return this.reject(new TypeError("must be an array"));var _=w.length,b=!1;if(!_)return this.resolve([]);for(var S=-1,T=new this(o);++S<_;)N=w[S],v.resolve(N).then(function(C){b||(b=!0,l.resolve(T,C))},function(C){b||(b=!0,l.reject(T,C))});var N;return T}},{immediate:36}],38:[function(r,n,s){var a={};(0,r("./lib/utils/common").assign)(a,r("./lib/deflate"),r("./lib/inflate"),r("./lib/zlib/constants")),n.exports=a},{"./lib/deflate":39,"./lib/inflate":40,"./lib/utils/common":41,"./lib/zlib/constants":44}],39:[function(r,n,s){var a=r("./zlib/deflate"),o=r("./utils/common"),l=r("./utils/strings"),c=r("./zlib/messages"),u=r("./zlib/zstream"),d=Object.prototype.toString,f=0,p=-1,h=0,g=8;function m(w){if(!(this instanceof m))return new m(w);this.options=o.assign({level:p,method:g,chunkSize:16384,windowBits:15,memLevel:8,strategy:h,to:""},w||{});var v=this.options;v.raw&&0<v.windowBits?v.windowBits=-v.windowBits:v.gzip&&0<v.windowBits&&v.windowBits<16&&(v.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new u,this.strm.avail_out=0;var _=a.deflateInit2(this.strm,v.level,v.method,v.windowBits,v.memLevel,v.strategy);if(_!==f)throw new Error(c[_]);if(v.header&&a.deflateSetHeader(this.strm,v.header),v.dictionary){var b;if(b=typeof v.dictionary=="string"?l.string2buf(v.dictionary):d.call(v.dictionary)==="[object ArrayBuffer]"?new Uint8Array(v.dictionary):v.dictionary,(_=a.deflateSetDictionary(this.strm,b))!==f)throw new Error(c[_]);this._dict_set=!0}}function x(w,v){var _=new m(v);if(_.push(w,!0),_.err)throw _.msg||c[_.err];return _.result}m.prototype.push=function(w,v){var _,b,S=this.strm,T=this.options.chunkSize;if(this.ended)return!1;b=v===~~v?v:v===!0?4:0,typeof w=="string"?S.input=l.string2buf(w):d.call(w)==="[object ArrayBuffer]"?S.input=new Uint8Array(w):S.input=w,S.next_in=0,S.avail_in=S.input.length;do{if(S.avail_out===0&&(S.output=new o.Buf8(T),S.next_out=0,S.avail_out=T),(_=a.deflate(S,b))!==1&&_!==f)return this.onEnd(_),!(this.ended=!0);S.avail_out!==0&&(S.avail_in!==0||b!==4&&b!==2)||(this.options.to==="string"?this.onData(l.buf2binstring(o.shrinkBuf(S.output,S.next_out))):this.onData(o.shrinkBuf(S.output,S.next_out)))}while((0<S.avail_in||S.avail_out===0)&&_!==1);return b===4?(_=a.deflateEnd(this.strm),this.onEnd(_),this.ended=!0,_===f):b!==2||(this.onEnd(f),!(S.avail_out=0))},m.prototype.onData=function(w){this.chunks.push(w)},m.prototype.onEnd=function(w){w===f&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=o.flattenChunks(this.chunks)),this.chunks=[],this.err=w,this.msg=this.strm.msg},s.Deflate=m,s.deflate=x,s.deflateRaw=function(w,v){return(v=v||{}).raw=!0,x(w,v)},s.gzip=function(w,v){return(v=v||{}).gzip=!0,x(w,v)}},{"./utils/common":41,"./utils/strings":42,"./zlib/deflate":46,"./zlib/messages":51,"./zlib/zstream":53}],40:[function(r,n,s){var a=r("./zlib/inflate"),o=r("./utils/common"),l=r("./utils/strings"),c=r("./zlib/constants"),u=r("./zlib/messages"),d=r("./zlib/zstream"),f=r("./zlib/gzheader"),p=Object.prototype.toString;function h(m){if(!(this instanceof h))return new h(m);this.options=o.assign({chunkSize:16384,windowBits:0,to:""},m||{});var x=this.options;x.raw&&0<=x.windowBits&&x.windowBits<16&&(x.windowBits=-x.windowBits,x.windowBits===0&&(x.windowBits=-15)),!(0<=x.windowBits&&x.windowBits<16)||m&&m.windowBits||(x.windowBits+=32),15<x.windowBits&&x.windowBits<48&&!(15&x.windowBits)&&(x.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new d,this.strm.avail_out=0;var w=a.inflateInit2(this.strm,x.windowBits);if(w!==c.Z_OK)throw new Error(u[w]);this.header=new f,a.inflateGetHeader(this.strm,this.header)}function g(m,x){var w=new h(x);if(w.push(m,!0),w.err)throw w.msg||u[w.err];return w.result}h.prototype.push=function(m,x){var w,v,_,b,S,T,N=this.strm,C=this.options.chunkSize,E=this.options.dictionary,P=!1;if(this.ended)return!1;v=x===~~x?x:x===!0?c.Z_FINISH:c.Z_NO_FLUSH,typeof m=="string"?N.input=l.binstring2buf(m):p.call(m)==="[object ArrayBuffer]"?N.input=new Uint8Array(m):N.input=m,N.next_in=0,N.avail_in=N.input.length;do{if(N.avail_out===0&&(N.output=new o.Buf8(C),N.next_out=0,N.avail_out=C),(w=a.inflate(N,c.Z_NO_FLUSH))===c.Z_NEED_DICT&&E&&(T=typeof E=="string"?l.string2buf(E):p.call(E)==="[object ArrayBuffer]"?new Uint8Array(E):E,w=a.inflateSetDictionary(this.strm,T)),w===c.Z_BUF_ERROR&&P===!0&&(w=c.Z_OK,P=!1),w!==c.Z_STREAM_END&&w!==c.Z_OK)return this.onEnd(w),!(this.ended=!0);N.next_out&&(N.avail_out!==0&&w!==c.Z_STREAM_END&&(N.avail_in!==0||v!==c.Z_FINISH&&v!==c.Z_SYNC_FLUSH)||(this.options.to==="string"?(_=l.utf8border(N.output,N.next_out),b=N.next_out-_,S=l.buf2string(N.output,_),N.next_out=b,N.avail_out=C-b,b&&o.arraySet(N.output,N.output,_,b,0),this.onData(S)):this.onData(o.shrinkBuf(N.output,N.next_out)))),N.avail_in===0&&N.avail_out===0&&(P=!0)}while((0<N.avail_in||N.avail_out===0)&&w!==c.Z_STREAM_END);return w===c.Z_STREAM_END&&(v=c.Z_FINISH),v===c.Z_FINISH?(w=a.inflateEnd(this.strm),this.onEnd(w),this.ended=!0,w===c.Z_OK):v!==c.Z_SYNC_FLUSH||(this.onEnd(c.Z_OK),!(N.avail_out=0))},h.prototype.onData=function(m){this.chunks.push(m)},h.prototype.onEnd=function(m){m===c.Z_OK&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=o.flattenChunks(this.chunks)),this.chunks=[],this.err=m,this.msg=this.strm.msg},s.Inflate=h,s.inflate=g,s.inflateRaw=function(m,x){return(x=x||{}).raw=!0,g(m,x)},s.ungzip=g},{"./utils/common":41,"./utils/strings":42,"./zlib/constants":44,"./zlib/gzheader":47,"./zlib/inflate":49,"./zlib/messages":51,"./zlib/zstream":53}],41:[function(r,n,s){var a=typeof Uint8Array<"u"&&typeof Uint16Array<"u"&&typeof Int32Array<"u";s.assign=function(c){for(var u=Array.prototype.slice.call(arguments,1);u.length;){var d=u.shift();if(d){if(typeof d!="object")throw new TypeError(d+"must be non-object");for(var f in d)d.hasOwnProperty(f)&&(c[f]=d[f])}}return c},s.shrinkBuf=function(c,u){return c.length===u?c:c.subarray?c.subarray(0,u):(c.length=u,c)};var o={arraySet:function(c,u,d,f,p){if(u.subarray&&c.subarray)c.set(u.subarray(d,d+f),p);else for(var h=0;h<f;h++)c[p+h]=u[d+h]},flattenChunks:function(c){var u,d,f,p,h,g;for(u=f=0,d=c.length;u<d;u++)f+=c[u].length;for(g=new Uint8Array(f),u=p=0,d=c.length;u<d;u++)h=c[u],g.set(h,p),p+=h.length;return g}},l={arraySet:function(c,u,d,f,p){for(var h=0;h<f;h++)c[p+h]=u[d+h]},flattenChunks:function(c){return[].concat.apply([],c)}};s.setTyped=function(c){c?(s.Buf8=Uint8Array,s.Buf16=Uint16Array,s.Buf32=Int32Array,s.assign(s,o)):(s.Buf8=Array,s.Buf16=Array,s.Buf32=Array,s.assign(s,l))},s.setTyped(a)},{}],42:[function(r,n,s){var a=r("./common"),o=!0,l=!0;try{String.fromCharCode.apply(null,[0])}catch{o=!1}try{String.fromCharCode.apply(null,new Uint8Array(1))}catch{l=!1}for(var c=new a.Buf8(256),u=0;u<256;u++)c[u]=252<=u?6:248<=u?5:240<=u?4:224<=u?3:192<=u?2:1;function d(f,p){if(p<65537&&(f.subarray&&l||!f.subarray&&o))return String.fromCharCode.apply(null,a.shrinkBuf(f,p));for(var h="",g=0;g<p;g++)h+=String.fromCharCode(f[g]);return h}c[254]=c[254]=1,s.string2buf=function(f){var p,h,g,m,x,w=f.length,v=0;for(m=0;m<w;m++)(64512&(h=f.charCodeAt(m)))==55296&&m+1<w&&(64512&(g=f.charCodeAt(m+1)))==56320&&(h=65536+(h-55296<<10)+(g-56320),m++),v+=h<128?1:h<2048?2:h<65536?3:4;for(p=new a.Buf8(v),m=x=0;x<v;m++)(64512&(h=f.charCodeAt(m)))==55296&&m+1<w&&(64512&(g=f.charCodeAt(m+1)))==56320&&(h=65536+(h-55296<<10)+(g-56320),m++),h<128?p[x++]=h:(h<2048?p[x++]=192|h>>>6:(h<65536?p[x++]=224|h>>>12:(p[x++]=240|h>>>18,p[x++]=128|h>>>12&63),p[x++]=128|h>>>6&63),p[x++]=128|63&h);return p},s.buf2binstring=function(f){return d(f,f.length)},s.binstring2buf=function(f){for(var p=new a.Buf8(f.length),h=0,g=p.length;h<g;h++)p[h]=f.charCodeAt(h);return p},s.buf2string=function(f,p){var h,g,m,x,w=p||f.length,v=new Array(2*w);for(h=g=0;h<w;)if((m=f[h++])<128)v[g++]=m;else if(4<(x=c[m]))v[g++]=65533,h+=x-1;else{for(m&=x===2?31:x===3?15:7;1<x&&h<w;)m=m<<6|63&f[h++],x--;1<x?v[g++]=65533:m<65536?v[g++]=m:(m-=65536,v[g++]=55296|m>>10&1023,v[g++]=56320|1023&m)}return d(v,g)},s.utf8border=function(f,p){var h;for((p=p||f.length)>f.length&&(p=f.length),h=p-1;0<=h&&(192&f[h])==128;)h--;return h<0||h===0?p:h+c[f[h]]>p?h:p}},{"./common":41}],43:[function(r,n,s){n.exports=function(a,o,l,c){for(var u=65535&a|0,d=a>>>16&65535|0,f=0;l!==0;){for(l-=f=2e3<l?2e3:l;d=d+(u=u+o[c++]|0)|0,--f;);u%=65521,d%=65521}return u|d<<16|0}},{}],44:[function(r,n,s){n.exports={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8}},{}],45:[function(r,n,s){var a=function(){for(var o,l=[],c=0;c<256;c++){o=c;for(var u=0;u<8;u++)o=1&o?3988292384^o>>>1:o>>>1;l[c]=o}return l}();n.exports=function(o,l,c,u){var d=a,f=u+c;o^=-1;for(var p=u;p<f;p++)o=o>>>8^d[255&(o^l[p])];return-1^o}},{}],46:[function(r,n,s){var a,o=r("../utils/common"),l=r("./trees"),c=r("./adler32"),u=r("./crc32"),d=r("./messages"),f=0,p=4,h=0,g=-2,m=-1,x=4,w=2,v=8,_=9,b=286,S=30,T=19,N=2*b+1,C=15,E=3,P=258,R=P+E+1,j=42,M=113,A=1,I=2,X=3,Y=4;function z(k,le){return k.msg=d[le],le}function U(k){return(k<<1)-(4<k?9:0)}function V(k){for(var le=k.length;0<=--le;)k[le]=0}function F(k){var le=k.state,ce=le.pending;ce>k.avail_out&&(ce=k.avail_out),ce!==0&&(o.arraySet(k.output,le.pending_buf,le.pending_out,ce,k.next_out),k.next_out+=ce,le.pending_out+=ce,k.total_out+=ce,k.avail_out-=ce,le.pending-=ce,le.pending===0&&(le.pending_out=0))}function D(k,le){l._tr_flush_block(k,0<=k.block_start?k.block_start:-1,k.strstart-k.block_start,le),k.block_start=k.strstart,F(k.strm)}function G(k,le){k.pending_buf[k.pending++]=le}function O(k,le){k.pending_buf[k.pending++]=le>>>8&255,k.pending_buf[k.pending++]=255&le}function L(k,le){var ce,H,K=k.max_chain_length,oe=k.strstart,W=k.prev_length,J=k.nice_match,B=k.strstart>k.w_size-R?k.strstart-(k.w_size-R):0,ae=k.window,de=k.w_mask,Q=k.prev,fe=k.strstart+P,Ce=ae[oe+W-1],Ne=ae[oe+W];k.prev_length>=k.good_match&&(K>>=2),J>k.lookahead&&(J=k.lookahead);do if(ae[(ce=le)+W]===Ne&&ae[ce+W-1]===Ce&&ae[ce]===ae[oe]&&ae[++ce]===ae[oe+1]){oe+=2,ce++;do;while(ae[++oe]===ae[++ce]&&ae[++oe]===ae[++ce]&&ae[++oe]===ae[++ce]&&ae[++oe]===ae[++ce]&&ae[++oe]===ae[++ce]&&ae[++oe]===ae[++ce]&&ae[++oe]===ae[++ce]&&ae[++oe]===ae[++ce]&&oe<fe);if(H=P-(fe-oe),oe=fe-P,W<H){if(k.match_start=le,J<=(W=H))break;Ce=ae[oe+W-1],Ne=ae[oe+W]}}while((le=Q[le&de])>B&&--K!=0);return W<=k.lookahead?W:k.lookahead}function ie(k){var le,ce,H,K,oe,W,J,B,ae,de,Q=k.w_size;do{if(K=k.window_size-k.lookahead-k.strstart,k.strstart>=Q+(Q-R)){for(o.arraySet(k.window,k.window,Q,Q,0),k.match_start-=Q,k.strstart-=Q,k.block_start-=Q,le=ce=k.hash_size;H=k.head[--le],k.head[le]=Q<=H?H-Q:0,--ce;);for(le=ce=Q;H=k.prev[--le],k.prev[le]=Q<=H?H-Q:0,--ce;);K+=Q}if(k.strm.avail_in===0)break;if(W=k.strm,J=k.window,B=k.strstart+k.lookahead,ae=K,de=void 0,de=W.avail_in,ae<de&&(de=ae),ce=de===0?0:(W.avail_in-=de,o.arraySet(J,W.input,W.next_in,de,B),W.state.wrap===1?W.adler=c(W.adler,J,de,B):W.state.wrap===2&&(W.adler=u(W.adler,J,de,B)),W.next_in+=de,W.total_in+=de,de),k.lookahead+=ce,k.lookahead+k.insert>=E)for(oe=k.strstart-k.insert,k.ins_h=k.window[oe],k.ins_h=(k.ins_h<<k.hash_shift^k.window[oe+1])&k.hash_mask;k.insert&&(k.ins_h=(k.ins_h<<k.hash_shift^k.window[oe+E-1])&k.hash_mask,k.prev[oe&k.w_mask]=k.head[k.ins_h],k.head[k.ins_h]=oe,oe++,k.insert--,!(k.lookahead+k.insert<E)););}while(k.lookahead<R&&k.strm.avail_in!==0)}function ne(k,le){for(var ce,H;;){if(k.lookahead<R){if(ie(k),k.lookahead<R&&le===f)return A;if(k.lookahead===0)break}if(ce=0,k.lookahead>=E&&(k.ins_h=(k.ins_h<<k.hash_shift^k.window[k.strstart+E-1])&k.hash_mask,ce=k.prev[k.strstart&k.w_mask]=k.head[k.ins_h],k.head[k.ins_h]=k.strstart),ce!==0&&k.strstart-ce<=k.w_size-R&&(k.match_length=L(k,ce)),k.match_length>=E)if(H=l._tr_tally(k,k.strstart-k.match_start,k.match_length-E),k.lookahead-=k.match_length,k.match_length<=k.max_lazy_match&&k.lookahead>=E){for(k.match_length--;k.strstart++,k.ins_h=(k.ins_h<<k.hash_shift^k.window[k.strstart+E-1])&k.hash_mask,ce=k.prev[k.strstart&k.w_mask]=k.head[k.ins_h],k.head[k.ins_h]=k.strstart,--k.match_length!=0;);k.strstart++}else k.strstart+=k.match_length,k.match_length=0,k.ins_h=k.window[k.strstart],k.ins_h=(k.ins_h<<k.hash_shift^k.window[k.strstart+1])&k.hash_mask;else H=l._tr_tally(k,0,k.window[k.strstart]),k.lookahead--,k.strstart++;if(H&&(D(k,!1),k.strm.avail_out===0))return A}return k.insert=k.strstart<E-1?k.strstart:E-1,le===p?(D(k,!0),k.strm.avail_out===0?X:Y):k.last_lit&&(D(k,!1),k.strm.avail_out===0)?A:I}function me(k,le){for(var ce,H,K;;){if(k.lookahead<R){if(ie(k),k.lookahead<R&&le===f)return A;if(k.lookahead===0)break}if(ce=0,k.lookahead>=E&&(k.ins_h=(k.ins_h<<k.hash_shift^k.window[k.strstart+E-1])&k.hash_mask,ce=k.prev[k.strstart&k.w_mask]=k.head[k.ins_h],k.head[k.ins_h]=k.strstart),k.prev_length=k.match_length,k.prev_match=k.match_start,k.match_length=E-1,ce!==0&&k.prev_length<k.max_lazy_match&&k.strstart-ce<=k.w_size-R&&(k.match_length=L(k,ce),k.match_length<=5&&(k.strategy===1||k.match_length===E&&4096<k.strstart-k.match_start)&&(k.match_length=E-1)),k.prev_length>=E&&k.match_length<=k.prev_length){for(K=k.strstart+k.lookahead-E,H=l._tr_tally(k,k.strstart-1-k.prev_match,k.prev_length-E),k.lookahead-=k.prev_length-1,k.prev_length-=2;++k.strstart<=K&&(k.ins_h=(k.ins_h<<k.hash_shift^k.window[k.strstart+E-1])&k.hash_mask,ce=k.prev[k.strstart&k.w_mask]=k.head[k.ins_h],k.head[k.ins_h]=k.strstart),--k.prev_length!=0;);if(k.match_available=0,k.match_length=E-1,k.strstart++,H&&(D(k,!1),k.strm.avail_out===0))return A}else if(k.match_available){if((H=l._tr_tally(k,0,k.window[k.strstart-1]))&&D(k,!1),k.strstart++,k.lookahead--,k.strm.avail_out===0)return A}else k.match_available=1,k.strstart++,k.lookahead--}return k.match_available&&(H=l._tr_tally(k,0,k.window[k.strstart-1]),k.match_available=0),k.insert=k.strstart<E-1?k.strstart:E-1,le===p?(D(k,!0),k.strm.avail_out===0?X:Y):k.last_lit&&(D(k,!1),k.strm.avail_out===0)?A:I}function pe(k,le,ce,H,K){this.good_length=k,this.max_lazy=le,this.nice_length=ce,this.max_chain=H,this.func=K}function xe(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=v,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new o.Buf16(2*N),this.dyn_dtree=new o.Buf16(2*(2*S+1)),this.bl_tree=new o.Buf16(2*(2*T+1)),V(this.dyn_ltree),V(this.dyn_dtree),V(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new o.Buf16(C+1),this.heap=new o.Buf16(2*b+1),V(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new o.Buf16(2*b+1),V(this.depth),this.l_buf=0,this.lit_bufsize=0,this.last_lit=0,this.d_buf=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}function Ae(k){var le;return k&&k.state?(k.total_in=k.total_out=0,k.data_type=w,(le=k.state).pending=0,le.pending_out=0,le.wrap<0&&(le.wrap=-le.wrap),le.status=le.wrap?j:M,k.adler=le.wrap===2?0:1,le.last_flush=f,l._tr_init(le),h):z(k,g)}function ge(k){var le=Ae(k);return le===h&&function(ce){ce.window_size=2*ce.w_size,V(ce.head),ce.max_lazy_match=a[ce.level].max_lazy,ce.good_match=a[ce.level].good_length,ce.nice_match=a[ce.level].nice_length,ce.max_chain_length=a[ce.level].max_chain,ce.strstart=0,ce.block_start=0,ce.lookahead=0,ce.insert=0,ce.match_length=ce.prev_length=E-1,ce.match_available=0,ce.ins_h=0}(k.state),le}function je(k,le,ce,H,K,oe){if(!k)return g;var W=1;if(le===m&&(le=6),H<0?(W=0,H=-H):15<H&&(W=2,H-=16),K<1||_<K||ce!==v||H<8||15<H||le<0||9<le||oe<0||x<oe)return z(k,g);H===8&&(H=9);var J=new xe;return(k.state=J).strm=k,J.wrap=W,J.gzhead=null,J.w_bits=H,J.w_size=1<<J.w_bits,J.w_mask=J.w_size-1,J.hash_bits=K+7,J.hash_size=1<<J.hash_bits,J.hash_mask=J.hash_size-1,J.hash_shift=~~((J.hash_bits+E-1)/E),J.window=new o.Buf8(2*J.w_size),J.head=new o.Buf16(J.hash_size),J.prev=new o.Buf16(J.w_size),J.lit_bufsize=1<<K+6,J.pending_buf_size=4*J.lit_bufsize,J.pending_buf=new o.Buf8(J.pending_buf_size),J.d_buf=1*J.lit_bufsize,J.l_buf=3*J.lit_bufsize,J.level=le,J.strategy=oe,J.method=ce,ge(k)}a=[new pe(0,0,0,0,function(k,le){var ce=65535;for(ce>k.pending_buf_size-5&&(ce=k.pending_buf_size-5);;){if(k.lookahead<=1){if(ie(k),k.lookahead===0&&le===f)return A;if(k.lookahead===0)break}k.strstart+=k.lookahead,k.lookahead=0;var H=k.block_start+ce;if((k.strstart===0||k.strstart>=H)&&(k.lookahead=k.strstart-H,k.strstart=H,D(k,!1),k.strm.avail_out===0)||k.strstart-k.block_start>=k.w_size-R&&(D(k,!1),k.strm.avail_out===0))return A}return k.insert=0,le===p?(D(k,!0),k.strm.avail_out===0?X:Y):(k.strstart>k.block_start&&(D(k,!1),k.strm.avail_out),A)}),new pe(4,4,8,4,ne),new pe(4,5,16,8,ne),new pe(4,6,32,32,ne),new pe(4,4,16,16,me),new pe(8,16,32,32,me),new pe(8,16,128,128,me),new pe(8,32,128,256,me),new pe(32,128,258,1024,me),new pe(32,258,258,4096,me)],s.deflateInit=function(k,le){return je(k,le,v,15,8,0)},s.deflateInit2=je,s.deflateReset=ge,s.deflateResetKeep=Ae,s.deflateSetHeader=function(k,le){return k&&k.state?k.state.wrap!==2?g:(k.state.gzhead=le,h):g},s.deflate=function(k,le){var ce,H,K,oe;if(!k||!k.state||5<le||le<0)return k?z(k,g):g;if(H=k.state,!k.output||!k.input&&k.avail_in!==0||H.status===666&&le!==p)return z(k,k.avail_out===0?-5:g);if(H.strm=k,ce=H.last_flush,H.last_flush=le,H.status===j)if(H.wrap===2)k.adler=0,G(H,31),G(H,139),G(H,8),H.gzhead?(G(H,(H.gzhead.text?1:0)+(H.gzhead.hcrc?2:0)+(H.gzhead.extra?4:0)+(H.gzhead.name?8:0)+(H.gzhead.comment?16:0)),G(H,255&H.gzhead.time),G(H,H.gzhead.time>>8&255),G(H,H.gzhead.time>>16&255),G(H,H.gzhead.time>>24&255),G(H,H.level===9?2:2<=H.strategy||H.level<2?4:0),G(H,255&H.gzhead.os),H.gzhead.extra&&H.gzhead.extra.length&&(G(H,255&H.gzhead.extra.length),G(H,H.gzhead.extra.length>>8&255)),H.gzhead.hcrc&&(k.adler=u(k.adler,H.pending_buf,H.pending,0)),H.gzindex=0,H.status=69):(G(H,0),G(H,0),G(H,0),G(H,0),G(H,0),G(H,H.level===9?2:2<=H.strategy||H.level<2?4:0),G(H,3),H.status=M);else{var W=v+(H.w_bits-8<<4)<<8;W|=(2<=H.strategy||H.level<2?0:H.level<6?1:H.level===6?2:3)<<6,H.strstart!==0&&(W|=32),W+=31-W%31,H.status=M,O(H,W),H.strstart!==0&&(O(H,k.adler>>>16),O(H,65535&k.adler)),k.adler=1}if(H.status===69)if(H.gzhead.extra){for(K=H.pending;H.gzindex<(65535&H.gzhead.extra.length)&&(H.pending!==H.pending_buf_size||(H.gzhead.hcrc&&H.pending>K&&(k.adler=u(k.adler,H.pending_buf,H.pending-K,K)),F(k),K=H.pending,H.pending!==H.pending_buf_size));)G(H,255&H.gzhead.extra[H.gzindex]),H.gzindex++;H.gzhead.hcrc&&H.pending>K&&(k.adler=u(k.adler,H.pending_buf,H.pending-K,K)),H.gzindex===H.gzhead.extra.length&&(H.gzindex=0,H.status=73)}else H.status=73;if(H.status===73)if(H.gzhead.name){K=H.pending;do{if(H.pending===H.pending_buf_size&&(H.gzhead.hcrc&&H.pending>K&&(k.adler=u(k.adler,H.pending_buf,H.pending-K,K)),F(k),K=H.pending,H.pending===H.pending_buf_size)){oe=1;break}oe=H.gzindex<H.gzhead.name.length?255&H.gzhead.name.charCodeAt(H.gzindex++):0,G(H,oe)}while(oe!==0);H.gzhead.hcrc&&H.pending>K&&(k.adler=u(k.adler,H.pending_buf,H.pending-K,K)),oe===0&&(H.gzindex=0,H.status=91)}else H.status=91;if(H.status===91)if(H.gzhead.comment){K=H.pending;do{if(H.pending===H.pending_buf_size&&(H.gzhead.hcrc&&H.pending>K&&(k.adler=u(k.adler,H.pending_buf,H.pending-K,K)),F(k),K=H.pending,H.pending===H.pending_buf_size)){oe=1;break}oe=H.gzindex<H.gzhead.comment.length?255&H.gzhead.comment.charCodeAt(H.gzindex++):0,G(H,oe)}while(oe!==0);H.gzhead.hcrc&&H.pending>K&&(k.adler=u(k.adler,H.pending_buf,H.pending-K,K)),oe===0&&(H.status=103)}else H.status=103;if(H.status===103&&(H.gzhead.hcrc?(H.pending+2>H.pending_buf_size&&F(k),H.pending+2<=H.pending_buf_size&&(G(H,255&k.adler),G(H,k.adler>>8&255),k.adler=0,H.status=M)):H.status=M),H.pending!==0){if(F(k),k.avail_out===0)return H.last_flush=-1,h}else if(k.avail_in===0&&U(le)<=U(ce)&&le!==p)return z(k,-5);if(H.status===666&&k.avail_in!==0)return z(k,-5);if(k.avail_in!==0||H.lookahead!==0||le!==f&&H.status!==666){var J=H.strategy===2?function(B,ae){for(var de;;){if(B.lookahead===0&&(ie(B),B.lookahead===0)){if(ae===f)return A;break}if(B.match_length=0,de=l._tr_tally(B,0,B.window[B.strstart]),B.lookahead--,B.strstart++,de&&(D(B,!1),B.strm.avail_out===0))return A}return B.insert=0,ae===p?(D(B,!0),B.strm.avail_out===0?X:Y):B.last_lit&&(D(B,!1),B.strm.avail_out===0)?A:I}(H,le):H.strategy===3?function(B,ae){for(var de,Q,fe,Ce,Ne=B.window;;){if(B.lookahead<=P){if(ie(B),B.lookahead<=P&&ae===f)return A;if(B.lookahead===0)break}if(B.match_length=0,B.lookahead>=E&&0<B.strstart&&(Q=Ne[fe=B.strstart-1])===Ne[++fe]&&Q===Ne[++fe]&&Q===Ne[++fe]){Ce=B.strstart+P;do;while(Q===Ne[++fe]&&Q===Ne[++fe]&&Q===Ne[++fe]&&Q===Ne[++fe]&&Q===Ne[++fe]&&Q===Ne[++fe]&&Q===Ne[++fe]&&Q===Ne[++fe]&&fe<Ce);B.match_length=P-(Ce-fe),B.match_length>B.lookahead&&(B.match_length=B.lookahead)}if(B.match_length>=E?(de=l._tr_tally(B,1,B.match_length-E),B.lookahead-=B.match_length,B.strstart+=B.match_length,B.match_length=0):(de=l._tr_tally(B,0,B.window[B.strstart]),B.lookahead--,B.strstart++),de&&(D(B,!1),B.strm.avail_out===0))return A}return B.insert=0,ae===p?(D(B,!0),B.strm.avail_out===0?X:Y):B.last_lit&&(D(B,!1),B.strm.avail_out===0)?A:I}(H,le):a[H.level].func(H,le);if(J!==X&&J!==Y||(H.status=666),J===A||J===X)return k.avail_out===0&&(H.last_flush=-1),h;if(J===I&&(le===1?l._tr_align(H):le!==5&&(l._tr_stored_block(H,0,0,!1),le===3&&(V(H.head),H.lookahead===0&&(H.strstart=0,H.block_start=0,H.insert=0))),F(k),k.avail_out===0))return H.last_flush=-1,h}return le!==p?h:H.wrap<=0?1:(H.wrap===2?(G(H,255&k.adler),G(H,k.adler>>8&255),G(H,k.adler>>16&255),G(H,k.adler>>24&255),G(H,255&k.total_in),G(H,k.total_in>>8&255),G(H,k.total_in>>16&255),G(H,k.total_in>>24&255)):(O(H,k.adler>>>16),O(H,65535&k.adler)),F(k),0<H.wrap&&(H.wrap=-H.wrap),H.pending!==0?h:1)},s.deflateEnd=function(k){var le;return k&&k.state?(le=k.state.status)!==j&&le!==69&&le!==73&&le!==91&&le!==103&&le!==M&&le!==666?z(k,g):(k.state=null,le===M?z(k,-3):h):g},s.deflateSetDictionary=function(k,le){var ce,H,K,oe,W,J,B,ae,de=le.length;if(!k||!k.state||(oe=(ce=k.state).wrap)===2||oe===1&&ce.status!==j||ce.lookahead)return g;for(oe===1&&(k.adler=c(k.adler,le,de,0)),ce.wrap=0,de>=ce.w_size&&(oe===0&&(V(ce.head),ce.strstart=0,ce.block_start=0,ce.insert=0),ae=new o.Buf8(ce.w_size),o.arraySet(ae,le,de-ce.w_size,ce.w_size,0),le=ae,de=ce.w_size),W=k.avail_in,J=k.next_in,B=k.input,k.avail_in=de,k.next_in=0,k.input=le,ie(ce);ce.lookahead>=E;){for(H=ce.strstart,K=ce.lookahead-(E-1);ce.ins_h=(ce.ins_h<<ce.hash_shift^ce.window[H+E-1])&ce.hash_mask,ce.prev[H&ce.w_mask]=ce.head[ce.ins_h],ce.head[ce.ins_h]=H,H++,--K;);ce.strstart=H,ce.lookahead=E-1,ie(ce)}return ce.strstart+=ce.lookahead,ce.block_start=ce.strstart,ce.insert=ce.lookahead,ce.lookahead=0,ce.match_length=ce.prev_length=E-1,ce.match_available=0,k.next_in=J,k.input=B,k.avail_in=W,ce.wrap=oe,h},s.deflateInfo="pako deflate (from Nodeca project)"},{"../utils/common":41,"./adler32":43,"./crc32":45,"./messages":51,"./trees":52}],47:[function(r,n,s){n.exports=function(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}},{}],48:[function(r,n,s){n.exports=function(a,o){var l,c,u,d,f,p,h,g,m,x,w,v,_,b,S,T,N,C,E,P,R,j,M,A,I;l=a.state,c=a.next_in,A=a.input,u=c+(a.avail_in-5),d=a.next_out,I=a.output,f=d-(o-a.avail_out),p=d+(a.avail_out-257),h=l.dmax,g=l.wsize,m=l.whave,x=l.wnext,w=l.window,v=l.hold,_=l.bits,b=l.lencode,S=l.distcode,T=(1<<l.lenbits)-1,N=(1<<l.distbits)-1;e:do{_<15&&(v+=A[c++]<<_,_+=8,v+=A[c++]<<_,_+=8),C=b[v&T];t:for(;;){if(v>>>=E=C>>>24,_-=E,(E=C>>>16&255)===0)I[d++]=65535&C;else{if(!(16&E)){if(!(64&E)){C=b[(65535&C)+(v&(1<<E)-1)];continue t}if(32&E){l.mode=12;break e}a.msg="invalid literal/length code",l.mode=30;break e}P=65535&C,(E&=15)&&(_<E&&(v+=A[c++]<<_,_+=8),P+=v&(1<<E)-1,v>>>=E,_-=E),_<15&&(v+=A[c++]<<_,_+=8,v+=A[c++]<<_,_+=8),C=S[v&N];r:for(;;){if(v>>>=E=C>>>24,_-=E,!(16&(E=C>>>16&255))){if(!(64&E)){C=S[(65535&C)+(v&(1<<E)-1)];continue r}a.msg="invalid distance code",l.mode=30;break e}if(R=65535&C,_<(E&=15)&&(v+=A[c++]<<_,(_+=8)<E&&(v+=A[c++]<<_,_+=8)),h<(R+=v&(1<<E)-1)){a.msg="invalid distance too far back",l.mode=30;break e}if(v>>>=E,_-=E,(E=d-f)<R){if(m<(E=R-E)&&l.sane){a.msg="invalid distance too far back",l.mode=30;break e}if(M=w,(j=0)===x){if(j+=g-E,E<P){for(P-=E;I[d++]=w[j++],--E;);j=d-R,M=I}}else if(x<E){if(j+=g+x-E,(E-=x)<P){for(P-=E;I[d++]=w[j++],--E;);if(j=0,x<P){for(P-=E=x;I[d++]=w[j++],--E;);j=d-R,M=I}}}else if(j+=x-E,E<P){for(P-=E;I[d++]=w[j++],--E;);j=d-R,M=I}for(;2<P;)I[d++]=M[j++],I[d++]=M[j++],I[d++]=M[j++],P-=3;P&&(I[d++]=M[j++],1<P&&(I[d++]=M[j++]))}else{for(j=d-R;I[d++]=I[j++],I[d++]=I[j++],I[d++]=I[j++],2<(P-=3););P&&(I[d++]=I[j++],1<P&&(I[d++]=I[j++]))}break}}break}}while(c<u&&d<p);c-=P=_>>3,v&=(1<<(_-=P<<3))-1,a.next_in=c,a.next_out=d,a.avail_in=c<u?u-c+5:5-(c-u),a.avail_out=d<p?p-d+257:257-(d-p),l.hold=v,l.bits=_}},{}],49:[function(r,n,s){var a=r("../utils/common"),o=r("./adler32"),l=r("./crc32"),c=r("./inffast"),u=r("./inftrees"),d=1,f=2,p=0,h=-2,g=1,m=852,x=592;function w(j){return(j>>>24&255)+(j>>>8&65280)+((65280&j)<<8)+((255&j)<<24)}function v(){this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new a.Buf16(320),this.work=new a.Buf16(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}function _(j){var M;return j&&j.state?(M=j.state,j.total_in=j.total_out=M.total=0,j.msg="",M.wrap&&(j.adler=1&M.wrap),M.mode=g,M.last=0,M.havedict=0,M.dmax=32768,M.head=null,M.hold=0,M.bits=0,M.lencode=M.lendyn=new a.Buf32(m),M.distcode=M.distdyn=new a.Buf32(x),M.sane=1,M.back=-1,p):h}function b(j){var M;return j&&j.state?((M=j.state).wsize=0,M.whave=0,M.wnext=0,_(j)):h}function S(j,M){var A,I;return j&&j.state?(I=j.state,M<0?(A=0,M=-M):(A=1+(M>>4),M<48&&(M&=15)),M&&(M<8||15<M)?h:(I.window!==null&&I.wbits!==M&&(I.window=null),I.wrap=A,I.wbits=M,b(j))):h}function T(j,M){var A,I;return j?(I=new v,(j.state=I).window=null,(A=S(j,M))!==p&&(j.state=null),A):h}var N,C,E=!0;function P(j){if(E){var M;for(N=new a.Buf32(512),C=new a.Buf32(32),M=0;M<144;)j.lens[M++]=8;for(;M<256;)j.lens[M++]=9;for(;M<280;)j.lens[M++]=7;for(;M<288;)j.lens[M++]=8;for(u(d,j.lens,0,288,N,0,j.work,{bits:9}),M=0;M<32;)j.lens[M++]=5;u(f,j.lens,0,32,C,0,j.work,{bits:5}),E=!1}j.lencode=N,j.lenbits=9,j.distcode=C,j.distbits=5}function R(j,M,A,I){var X,Y=j.state;return Y.window===null&&(Y.wsize=1<<Y.wbits,Y.wnext=0,Y.whave=0,Y.window=new a.Buf8(Y.wsize)),I>=Y.wsize?(a.arraySet(Y.window,M,A-Y.wsize,Y.wsize,0),Y.wnext=0,Y.whave=Y.wsize):(I<(X=Y.wsize-Y.wnext)&&(X=I),a.arraySet(Y.window,M,A-I,X,Y.wnext),(I-=X)?(a.arraySet(Y.window,M,A-I,I,0),Y.wnext=I,Y.whave=Y.wsize):(Y.wnext+=X,Y.wnext===Y.wsize&&(Y.wnext=0),Y.whave<Y.wsize&&(Y.whave+=X))),0}s.inflateReset=b,s.inflateReset2=S,s.inflateResetKeep=_,s.inflateInit=function(j){return T(j,15)},s.inflateInit2=T,s.inflate=function(j,M){var A,I,X,Y,z,U,V,F,D,G,O,L,ie,ne,me,pe,xe,Ae,ge,je,k,le,ce,H,K=0,oe=new a.Buf8(4),W=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];if(!j||!j.state||!j.output||!j.input&&j.avail_in!==0)return h;(A=j.state).mode===12&&(A.mode=13),z=j.next_out,X=j.output,V=j.avail_out,Y=j.next_in,I=j.input,U=j.avail_in,F=A.hold,D=A.bits,G=U,O=V,le=p;e:for(;;)switch(A.mode){case g:if(A.wrap===0){A.mode=13;break}for(;D<16;){if(U===0)break e;U--,F+=I[Y++]<<D,D+=8}if(2&A.wrap&&F===35615){oe[A.check=0]=255&F,oe[1]=F>>>8&255,A.check=l(A.check,oe,2,0),D=F=0,A.mode=2;break}if(A.flags=0,A.head&&(A.head.done=!1),!(1&A.wrap)||(((255&F)<<8)+(F>>8))%31){j.msg="incorrect header check",A.mode=30;break}if((15&F)!=8){j.msg="unknown compression method",A.mode=30;break}if(D-=4,k=8+(15&(F>>>=4)),A.wbits===0)A.wbits=k;else if(k>A.wbits){j.msg="invalid window size",A.mode=30;break}A.dmax=1<<k,j.adler=A.check=1,A.mode=512&F?10:12,D=F=0;break;case 2:for(;D<16;){if(U===0)break e;U--,F+=I[Y++]<<D,D+=8}if(A.flags=F,(255&A.flags)!=8){j.msg="unknown compression method",A.mode=30;break}if(57344&A.flags){j.msg="unknown header flags set",A.mode=30;break}A.head&&(A.head.text=F>>8&1),512&A.flags&&(oe[0]=255&F,oe[1]=F>>>8&255,A.check=l(A.check,oe,2,0)),D=F=0,A.mode=3;case 3:for(;D<32;){if(U===0)break e;U--,F+=I[Y++]<<D,D+=8}A.head&&(A.head.time=F),512&A.flags&&(oe[0]=255&F,oe[1]=F>>>8&255,oe[2]=F>>>16&255,oe[3]=F>>>24&255,A.check=l(A.check,oe,4,0)),D=F=0,A.mode=4;case 4:for(;D<16;){if(U===0)break e;U--,F+=I[Y++]<<D,D+=8}A.head&&(A.head.xflags=255&F,A.head.os=F>>8),512&A.flags&&(oe[0]=255&F,oe[1]=F>>>8&255,A.check=l(A.check,oe,2,0)),D=F=0,A.mode=5;case 5:if(1024&A.flags){for(;D<16;){if(U===0)break e;U--,F+=I[Y++]<<D,D+=8}A.length=F,A.head&&(A.head.extra_len=F),512&A.flags&&(oe[0]=255&F,oe[1]=F>>>8&255,A.check=l(A.check,oe,2,0)),D=F=0}else A.head&&(A.head.extra=null);A.mode=6;case 6:if(1024&A.flags&&(U<(L=A.length)&&(L=U),L&&(A.head&&(k=A.head.extra_len-A.length,A.head.extra||(A.head.extra=new Array(A.head.extra_len)),a.arraySet(A.head.extra,I,Y,L,k)),512&A.flags&&(A.check=l(A.check,I,L,Y)),U-=L,Y+=L,A.length-=L),A.length))break e;A.length=0,A.mode=7;case 7:if(2048&A.flags){if(U===0)break e;for(L=0;k=I[Y+L++],A.head&&k&&A.length<65536&&(A.head.name+=String.fromCharCode(k)),k&&L<U;);if(512&A.flags&&(A.check=l(A.check,I,L,Y)),U-=L,Y+=L,k)break e}else A.head&&(A.head.name=null);A.length=0,A.mode=8;case 8:if(4096&A.flags){if(U===0)break e;for(L=0;k=I[Y+L++],A.head&&k&&A.length<65536&&(A.head.comment+=String.fromCharCode(k)),k&&L<U;);if(512&A.flags&&(A.check=l(A.check,I,L,Y)),U-=L,Y+=L,k)break e}else A.head&&(A.head.comment=null);A.mode=9;case 9:if(512&A.flags){for(;D<16;){if(U===0)break e;U--,F+=I[Y++]<<D,D+=8}if(F!==(65535&A.check)){j.msg="header crc mismatch",A.mode=30;break}D=F=0}A.head&&(A.head.hcrc=A.flags>>9&1,A.head.done=!0),j.adler=A.check=0,A.mode=12;break;case 10:for(;D<32;){if(U===0)break e;U--,F+=I[Y++]<<D,D+=8}j.adler=A.check=w(F),D=F=0,A.mode=11;case 11:if(A.havedict===0)return j.next_out=z,j.avail_out=V,j.next_in=Y,j.avail_in=U,A.hold=F,A.bits=D,2;j.adler=A.check=1,A.mode=12;case 12:if(M===5||M===6)break e;case 13:if(A.last){F>>>=7&D,D-=7&D,A.mode=27;break}for(;D<3;){if(U===0)break e;U--,F+=I[Y++]<<D,D+=8}switch(A.last=1&F,D-=1,3&(F>>>=1)){case 0:A.mode=14;break;case 1:if(P(A),A.mode=20,M!==6)break;F>>>=2,D-=2;break e;case 2:A.mode=17;break;case 3:j.msg="invalid block type",A.mode=30}F>>>=2,D-=2;break;case 14:for(F>>>=7&D,D-=7&D;D<32;){if(U===0)break e;U--,F+=I[Y++]<<D,D+=8}if((65535&F)!=(F>>>16^65535)){j.msg="invalid stored block lengths",A.mode=30;break}if(A.length=65535&F,D=F=0,A.mode=15,M===6)break e;case 15:A.mode=16;case 16:if(L=A.length){if(U<L&&(L=U),V<L&&(L=V),L===0)break e;a.arraySet(X,I,Y,L,z),U-=L,Y+=L,V-=L,z+=L,A.length-=L;break}A.mode=12;break;case 17:for(;D<14;){if(U===0)break e;U--,F+=I[Y++]<<D,D+=8}if(A.nlen=257+(31&F),F>>>=5,D-=5,A.ndist=1+(31&F),F>>>=5,D-=5,A.ncode=4+(15&F),F>>>=4,D-=4,286<A.nlen||30<A.ndist){j.msg="too many length or distance symbols",A.mode=30;break}A.have=0,A.mode=18;case 18:for(;A.have<A.ncode;){for(;D<3;){if(U===0)break e;U--,F+=I[Y++]<<D,D+=8}A.lens[W[A.have++]]=7&F,F>>>=3,D-=3}for(;A.have<19;)A.lens[W[A.have++]]=0;if(A.lencode=A.lendyn,A.lenbits=7,ce={bits:A.lenbits},le=u(0,A.lens,0,19,A.lencode,0,A.work,ce),A.lenbits=ce.bits,le){j.msg="invalid code lengths set",A.mode=30;break}A.have=0,A.mode=19;case 19:for(;A.have<A.nlen+A.ndist;){for(;pe=(K=A.lencode[F&(1<<A.lenbits)-1])>>>16&255,xe=65535&K,!((me=K>>>24)<=D);){if(U===0)break e;U--,F+=I[Y++]<<D,D+=8}if(xe<16)F>>>=me,D-=me,A.lens[A.have++]=xe;else{if(xe===16){for(H=me+2;D<H;){if(U===0)break e;U--,F+=I[Y++]<<D,D+=8}if(F>>>=me,D-=me,A.have===0){j.msg="invalid bit length repeat",A.mode=30;break}k=A.lens[A.have-1],L=3+(3&F),F>>>=2,D-=2}else if(xe===17){for(H=me+3;D<H;){if(U===0)break e;U--,F+=I[Y++]<<D,D+=8}D-=me,k=0,L=3+(7&(F>>>=me)),F>>>=3,D-=3}else{for(H=me+7;D<H;){if(U===0)break e;U--,F+=I[Y++]<<D,D+=8}D-=me,k=0,L=11+(127&(F>>>=me)),F>>>=7,D-=7}if(A.have+L>A.nlen+A.ndist){j.msg="invalid bit length repeat",A.mode=30;break}for(;L--;)A.lens[A.have++]=k}}if(A.mode===30)break;if(A.lens[256]===0){j.msg="invalid code -- missing end-of-block",A.mode=30;break}if(A.lenbits=9,ce={bits:A.lenbits},le=u(d,A.lens,0,A.nlen,A.lencode,0,A.work,ce),A.lenbits=ce.bits,le){j.msg="invalid literal/lengths set",A.mode=30;break}if(A.distbits=6,A.distcode=A.distdyn,ce={bits:A.distbits},le=u(f,A.lens,A.nlen,A.ndist,A.distcode,0,A.work,ce),A.distbits=ce.bits,le){j.msg="invalid distances set",A.mode=30;break}if(A.mode=20,M===6)break e;case 20:A.mode=21;case 21:if(6<=U&&258<=V){j.next_out=z,j.avail_out=V,j.next_in=Y,j.avail_in=U,A.hold=F,A.bits=D,c(j,O),z=j.next_out,X=j.output,V=j.avail_out,Y=j.next_in,I=j.input,U=j.avail_in,F=A.hold,D=A.bits,A.mode===12&&(A.back=-1);break}for(A.back=0;pe=(K=A.lencode[F&(1<<A.lenbits)-1])>>>16&255,xe=65535&K,!((me=K>>>24)<=D);){if(U===0)break e;U--,F+=I[Y++]<<D,D+=8}if(pe&&!(240&pe)){for(Ae=me,ge=pe,je=xe;pe=(K=A.lencode[je+((F&(1<<Ae+ge)-1)>>Ae)])>>>16&255,xe=65535&K,!(Ae+(me=K>>>24)<=D);){if(U===0)break e;U--,F+=I[Y++]<<D,D+=8}F>>>=Ae,D-=Ae,A.back+=Ae}if(F>>>=me,D-=me,A.back+=me,A.length=xe,pe===0){A.mode=26;break}if(32&pe){A.back=-1,A.mode=12;break}if(64&pe){j.msg="invalid literal/length code",A.mode=30;break}A.extra=15&pe,A.mode=22;case 22:if(A.extra){for(H=A.extra;D<H;){if(U===0)break e;U--,F+=I[Y++]<<D,D+=8}A.length+=F&(1<<A.extra)-1,F>>>=A.extra,D-=A.extra,A.back+=A.extra}A.was=A.length,A.mode=23;case 23:for(;pe=(K=A.distcode[F&(1<<A.distbits)-1])>>>16&255,xe=65535&K,!((me=K>>>24)<=D);){if(U===0)break e;U--,F+=I[Y++]<<D,D+=8}if(!(240&pe)){for(Ae=me,ge=pe,je=xe;pe=(K=A.distcode[je+((F&(1<<Ae+ge)-1)>>Ae)])>>>16&255,xe=65535&K,!(Ae+(me=K>>>24)<=D);){if(U===0)break e;U--,F+=I[Y++]<<D,D+=8}F>>>=Ae,D-=Ae,A.back+=Ae}if(F>>>=me,D-=me,A.back+=me,64&pe){j.msg="invalid distance code",A.mode=30;break}A.offset=xe,A.extra=15&pe,A.mode=24;case 24:if(A.extra){for(H=A.extra;D<H;){if(U===0)break e;U--,F+=I[Y++]<<D,D+=8}A.offset+=F&(1<<A.extra)-1,F>>>=A.extra,D-=A.extra,A.back+=A.extra}if(A.offset>A.dmax){j.msg="invalid distance too far back",A.mode=30;break}A.mode=25;case 25:if(V===0)break e;if(L=O-V,A.offset>L){if((L=A.offset-L)>A.whave&&A.sane){j.msg="invalid distance too far back",A.mode=30;break}ie=L>A.wnext?(L-=A.wnext,A.wsize-L):A.wnext-L,L>A.length&&(L=A.length),ne=A.window}else ne=X,ie=z-A.offset,L=A.length;for(V<L&&(L=V),V-=L,A.length-=L;X[z++]=ne[ie++],--L;);A.length===0&&(A.mode=21);break;case 26:if(V===0)break e;X[z++]=A.length,V--,A.mode=21;break;case 27:if(A.wrap){for(;D<32;){if(U===0)break e;U--,F|=I[Y++]<<D,D+=8}if(O-=V,j.total_out+=O,A.total+=O,O&&(j.adler=A.check=A.flags?l(A.check,X,O,z-O):o(A.check,X,O,z-O)),O=V,(A.flags?F:w(F))!==A.check){j.msg="incorrect data check",A.mode=30;break}D=F=0}A.mode=28;case 28:if(A.wrap&&A.flags){for(;D<32;){if(U===0)break e;U--,F+=I[Y++]<<D,D+=8}if(F!==(4294967295&A.total)){j.msg="incorrect length check",A.mode=30;break}D=F=0}A.mode=29;case 29:le=1;break e;case 30:le=-3;break e;case 31:return-4;case 32:default:return h}return j.next_out=z,j.avail_out=V,j.next_in=Y,j.avail_in=U,A.hold=F,A.bits=D,(A.wsize||O!==j.avail_out&&A.mode<30&&(A.mode<27||M!==4))&&R(j,j.output,j.next_out,O-j.avail_out)?(A.mode=31,-4):(G-=j.avail_in,O-=j.avail_out,j.total_in+=G,j.total_out+=O,A.total+=O,A.wrap&&O&&(j.adler=A.check=A.flags?l(A.check,X,O,j.next_out-O):o(A.check,X,O,j.next_out-O)),j.data_type=A.bits+(A.last?64:0)+(A.mode===12?128:0)+(A.mode===20||A.mode===15?256:0),(G==0&&O===0||M===4)&&le===p&&(le=-5),le)},s.inflateEnd=function(j){if(!j||!j.state)return h;var M=j.state;return M.window&&(M.window=null),j.state=null,p},s.inflateGetHeader=function(j,M){var A;return j&&j.state&&2&(A=j.state).wrap?((A.head=M).done=!1,p):h},s.inflateSetDictionary=function(j,M){var A,I=M.length;return j&&j.state?(A=j.state).wrap!==0&&A.mode!==11?h:A.mode===11&&o(1,M,I,0)!==A.check?-3:R(j,M,I,I)?(A.mode=31,-4):(A.havedict=1,p):h},s.inflateInfo="pako inflate (from Nodeca project)"},{"../utils/common":41,"./adler32":43,"./crc32":45,"./inffast":48,"./inftrees":50}],50:[function(r,n,s){var a=r("../utils/common"),o=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],l=[16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78],c=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0],u=[16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64];n.exports=function(d,f,p,h,g,m,x,w){var v,_,b,S,T,N,C,E,P,R=w.bits,j=0,M=0,A=0,I=0,X=0,Y=0,z=0,U=0,V=0,F=0,D=null,G=0,O=new a.Buf16(16),L=new a.Buf16(16),ie=null,ne=0;for(j=0;j<=15;j++)O[j]=0;for(M=0;M<h;M++)O[f[p+M]]++;for(X=R,I=15;1<=I&&O[I]===0;I--);if(I<X&&(X=I),I===0)return g[m++]=20971520,g[m++]=20971520,w.bits=1,0;for(A=1;A<I&&O[A]===0;A++);for(X<A&&(X=A),j=U=1;j<=15;j++)if(U<<=1,(U-=O[j])<0)return-1;if(0<U&&(d===0||I!==1))return-1;for(L[1]=0,j=1;j<15;j++)L[j+1]=L[j]+O[j];for(M=0;M<h;M++)f[p+M]!==0&&(x[L[f[p+M]]++]=M);if(N=d===0?(D=ie=x,19):d===1?(D=o,G-=257,ie=l,ne-=257,256):(D=c,ie=u,-1),j=A,T=m,z=M=F=0,b=-1,S=(V=1<<(Y=X))-1,d===1&&852<V||d===2&&592<V)return 1;for(;;){for(C=j-z,P=x[M]<N?(E=0,x[M]):x[M]>N?(E=ie[ne+x[M]],D[G+x[M]]):(E=96,0),v=1<<j-z,A=_=1<<Y;g[T+(F>>z)+(_-=v)]=C<<24|E<<16|P|0,_!==0;);for(v=1<<j-1;F&v;)v>>=1;if(v!==0?(F&=v-1,F+=v):F=0,M++,--O[j]==0){if(j===I)break;j=f[p+x[M]]}if(X<j&&(F&S)!==b){for(z===0&&(z=X),T+=A,U=1<<(Y=j-z);Y+z<I&&!((U-=O[Y+z])<=0);)Y++,U<<=1;if(V+=1<<Y,d===1&&852<V||d===2&&592<V)return 1;g[b=F&S]=X<<24|Y<<16|T-m|0}}return F!==0&&(g[T+F]=j-z<<24|64<<16|0),w.bits=X,0}},{"../utils/common":41}],51:[function(r,n,s){n.exports={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"}},{}],52:[function(r,n,s){var a=r("../utils/common"),o=0,l=1;function c(K){for(var oe=K.length;0<=--oe;)K[oe]=0}var u=0,d=29,f=256,p=f+1+d,h=30,g=19,m=2*p+1,x=15,w=16,v=7,_=256,b=16,S=17,T=18,N=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0],C=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],E=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7],P=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],R=new Array(2*(p+2));c(R);var j=new Array(2*h);c(j);var M=new Array(512);c(M);var A=new Array(256);c(A);var I=new Array(d);c(I);var X,Y,z,U=new Array(h);function V(K,oe,W,J,B){this.static_tree=K,this.extra_bits=oe,this.extra_base=W,this.elems=J,this.max_length=B,this.has_stree=K&&K.length}function F(K,oe){this.dyn_tree=K,this.max_code=0,this.stat_desc=oe}function D(K){return K<256?M[K]:M[256+(K>>>7)]}function G(K,oe){K.pending_buf[K.pending++]=255&oe,K.pending_buf[K.pending++]=oe>>>8&255}function O(K,oe,W){K.bi_valid>w-W?(K.bi_buf|=oe<<K.bi_valid&65535,G(K,K.bi_buf),K.bi_buf=oe>>w-K.bi_valid,K.bi_valid+=W-w):(K.bi_buf|=oe<<K.bi_valid&65535,K.bi_valid+=W)}function L(K,oe,W){O(K,W[2*oe],W[2*oe+1])}function ie(K,oe){for(var W=0;W|=1&K,K>>>=1,W<<=1,0<--oe;);return W>>>1}function ne(K,oe,W){var J,B,ae=new Array(x+1),de=0;for(J=1;J<=x;J++)ae[J]=de=de+W[J-1]<<1;for(B=0;B<=oe;B++){var Q=K[2*B+1];Q!==0&&(K[2*B]=ie(ae[Q]++,Q))}}function me(K){var oe;for(oe=0;oe<p;oe++)K.dyn_ltree[2*oe]=0;for(oe=0;oe<h;oe++)K.dyn_dtree[2*oe]=0;for(oe=0;oe<g;oe++)K.bl_tree[2*oe]=0;K.dyn_ltree[2*_]=1,K.opt_len=K.static_len=0,K.last_lit=K.matches=0}function pe(K){8<K.bi_valid?G(K,K.bi_buf):0<K.bi_valid&&(K.pending_buf[K.pending++]=K.bi_buf),K.bi_buf=0,K.bi_valid=0}function xe(K,oe,W,J){var B=2*oe,ae=2*W;return K[B]<K[ae]||K[B]===K[ae]&&J[oe]<=J[W]}function Ae(K,oe,W){for(var J=K.heap[W],B=W<<1;B<=K.heap_len&&(B<K.heap_len&&xe(oe,K.heap[B+1],K.heap[B],K.depth)&&B++,!xe(oe,J,K.heap[B],K.depth));)K.heap[W]=K.heap[B],W=B,B<<=1;K.heap[W]=J}function ge(K,oe,W){var J,B,ae,de,Q=0;if(K.last_lit!==0)for(;J=K.pending_buf[K.d_buf+2*Q]<<8|K.pending_buf[K.d_buf+2*Q+1],B=K.pending_buf[K.l_buf+Q],Q++,J===0?L(K,B,oe):(L(K,(ae=A[B])+f+1,oe),(de=N[ae])!==0&&O(K,B-=I[ae],de),L(K,ae=D(--J),W),(de=C[ae])!==0&&O(K,J-=U[ae],de)),Q<K.last_lit;);L(K,_,oe)}function je(K,oe){var W,J,B,ae=oe.dyn_tree,de=oe.stat_desc.static_tree,Q=oe.stat_desc.has_stree,fe=oe.stat_desc.elems,Ce=-1;for(K.heap_len=0,K.heap_max=m,W=0;W<fe;W++)ae[2*W]!==0?(K.heap[++K.heap_len]=Ce=W,K.depth[W]=0):ae[2*W+1]=0;for(;K.heap_len<2;)ae[2*(B=K.heap[++K.heap_len]=Ce<2?++Ce:0)]=1,K.depth[B]=0,K.opt_len--,Q&&(K.static_len-=de[2*B+1]);for(oe.max_code=Ce,W=K.heap_len>>1;1<=W;W--)Ae(K,ae,W);for(B=fe;W=K.heap[1],K.heap[1]=K.heap[K.heap_len--],Ae(K,ae,1),J=K.heap[1],K.heap[--K.heap_max]=W,K.heap[--K.heap_max]=J,ae[2*B]=ae[2*W]+ae[2*J],K.depth[B]=(K.depth[W]>=K.depth[J]?K.depth[W]:K.depth[J])+1,ae[2*W+1]=ae[2*J+1]=B,K.heap[1]=B++,Ae(K,ae,1),2<=K.heap_len;);K.heap[--K.heap_max]=K.heap[1],function(Ne,Xe){var it,at,ht,Ke,Bt,Te,Re=Xe.dyn_tree,tt=Xe.max_code,Dt=Xe.stat_desc.static_tree,or=Xe.stat_desc.has_stree,Xt=Xe.stat_desc.extra_bits,Qt=Xe.stat_desc.extra_base,Pt=Xe.stat_desc.max_length,Jt=0;for(Ke=0;Ke<=x;Ke++)Ne.bl_count[Ke]=0;for(Re[2*Ne.heap[Ne.heap_max]+1]=0,it=Ne.heap_max+1;it<m;it++)Pt<(Ke=Re[2*Re[2*(at=Ne.heap[it])+1]+1]+1)&&(Ke=Pt,Jt++),Re[2*at+1]=Ke,tt<at||(Ne.bl_count[Ke]++,Bt=0,Qt<=at&&(Bt=Xt[at-Qt]),Te=Re[2*at],Ne.opt_len+=Te*(Ke+Bt),or&&(Ne.static_len+=Te*(Dt[2*at+1]+Bt)));if(Jt!==0){do{for(Ke=Pt-1;Ne.bl_count[Ke]===0;)Ke--;Ne.bl_count[Ke]--,Ne.bl_count[Ke+1]+=2,Ne.bl_count[Pt]--,Jt-=2}while(0<Jt);for(Ke=Pt;Ke!==0;Ke--)for(at=Ne.bl_count[Ke];at!==0;)tt<(ht=Ne.heap[--it])||(Re[2*ht+1]!==Ke&&(Ne.opt_len+=(Ke-Re[2*ht+1])*Re[2*ht],Re[2*ht+1]=Ke),at--)}}(K,oe),ne(ae,Ce,K.bl_count)}function k(K,oe,W){var J,B,ae=-1,de=oe[1],Q=0,fe=7,Ce=4;for(de===0&&(fe=138,Ce=3),oe[2*(W+1)+1]=65535,J=0;J<=W;J++)B=de,de=oe[2*(J+1)+1],++Q<fe&&B===de||(Q<Ce?K.bl_tree[2*B]+=Q:B!==0?(B!==ae&&K.bl_tree[2*B]++,K.bl_tree[2*b]++):Q<=10?K.bl_tree[2*S]++:K.bl_tree[2*T]++,ae=B,Ce=(Q=0)===de?(fe=138,3):B===de?(fe=6,3):(fe=7,4))}function le(K,oe,W){var J,B,ae=-1,de=oe[1],Q=0,fe=7,Ce=4;for(de===0&&(fe=138,Ce=3),J=0;J<=W;J++)if(B=de,de=oe[2*(J+1)+1],!(++Q<fe&&B===de)){if(Q<Ce)for(;L(K,B,K.bl_tree),--Q!=0;);else B!==0?(B!==ae&&(L(K,B,K.bl_tree),Q--),L(K,b,K.bl_tree),O(K,Q-3,2)):Q<=10?(L(K,S,K.bl_tree),O(K,Q-3,3)):(L(K,T,K.bl_tree),O(K,Q-11,7));ae=B,Ce=(Q=0)===de?(fe=138,3):B===de?(fe=6,3):(fe=7,4)}}c(U);var ce=!1;function H(K,oe,W,J){O(K,(u<<1)+(J?1:0),3),function(B,ae,de,Q){pe(B),G(B,de),G(B,~de),a.arraySet(B.pending_buf,B.window,ae,de,B.pending),B.pending+=de}(K,oe,W)}s._tr_init=function(K){ce||(function(){var oe,W,J,B,ae,de=new Array(x+1);for(B=J=0;B<d-1;B++)for(I[B]=J,oe=0;oe<1<<N[B];oe++)A[J++]=B;for(A[J-1]=B,B=ae=0;B<16;B++)for(U[B]=ae,oe=0;oe<1<<C[B];oe++)M[ae++]=B;for(ae>>=7;B<h;B++)for(U[B]=ae<<7,oe=0;oe<1<<C[B]-7;oe++)M[256+ae++]=B;for(W=0;W<=x;W++)de[W]=0;for(oe=0;oe<=143;)R[2*oe+1]=8,oe++,de[8]++;for(;oe<=255;)R[2*oe+1]=9,oe++,de[9]++;for(;oe<=279;)R[2*oe+1]=7,oe++,de[7]++;for(;oe<=287;)R[2*oe+1]=8,oe++,de[8]++;for(ne(R,p+1,de),oe=0;oe<h;oe++)j[2*oe+1]=5,j[2*oe]=ie(oe,5);X=new V(R,N,f+1,p,x),Y=new V(j,C,0,h,x),z=new V(new Array(0),E,0,g,v)}(),ce=!0),K.l_desc=new F(K.dyn_ltree,X),K.d_desc=new F(K.dyn_dtree,Y),K.bl_desc=new F(K.bl_tree,z),K.bi_buf=0,K.bi_valid=0,me(K)},s._tr_stored_block=H,s._tr_flush_block=function(K,oe,W,J){var B,ae,de=0;0<K.level?(K.strm.data_type===2&&(K.strm.data_type=function(Q){var fe,Ce=4093624447;for(fe=0;fe<=31;fe++,Ce>>>=1)if(1&Ce&&Q.dyn_ltree[2*fe]!==0)return o;if(Q.dyn_ltree[18]!==0||Q.dyn_ltree[20]!==0||Q.dyn_ltree[26]!==0)return l;for(fe=32;fe<f;fe++)if(Q.dyn_ltree[2*fe]!==0)return l;return o}(K)),je(K,K.l_desc),je(K,K.d_desc),de=function(Q){var fe;for(k(Q,Q.dyn_ltree,Q.l_desc.max_code),k(Q,Q.dyn_dtree,Q.d_desc.max_code),je(Q,Q.bl_desc),fe=g-1;3<=fe&&Q.bl_tree[2*P[fe]+1]===0;fe--);return Q.opt_len+=3*(fe+1)+5+5+4,fe}(K),B=K.opt_len+3+7>>>3,(ae=K.static_len+3+7>>>3)<=B&&(B=ae)):B=ae=W+5,W+4<=B&&oe!==-1?H(K,oe,W,J):K.strategy===4||ae===B?(O(K,2+(J?1:0),3),ge(K,R,j)):(O(K,4+(J?1:0),3),function(Q,fe,Ce,Ne){var Xe;for(O(Q,fe-257,5),O(Q,Ce-1,5),O(Q,Ne-4,4),Xe=0;Xe<Ne;Xe++)O(Q,Q.bl_tree[2*P[Xe]+1],3);le(Q,Q.dyn_ltree,fe-1),le(Q,Q.dyn_dtree,Ce-1)}(K,K.l_desc.max_code+1,K.d_desc.max_code+1,de+1),ge(K,K.dyn_ltree,K.dyn_dtree)),me(K),J&&pe(K)},s._tr_tally=function(K,oe,W){return K.pending_buf[K.d_buf+2*K.last_lit]=oe>>>8&255,K.pending_buf[K.d_buf+2*K.last_lit+1]=255&oe,K.pending_buf[K.l_buf+K.last_lit]=255&W,K.last_lit++,oe===0?K.dyn_ltree[2*W]++:(K.matches++,oe--,K.dyn_ltree[2*(A[W]+f+1)]++,K.dyn_dtree[2*D(oe)]++),K.last_lit===K.lit_bufsize-1},s._tr_align=function(K){O(K,2,3),L(K,_,R),function(oe){oe.bi_valid===16?(G(oe,oe.bi_buf),oe.bi_buf=0,oe.bi_valid=0):8<=oe.bi_valid&&(oe.pending_buf[oe.pending++]=255&oe.bi_buf,oe.bi_buf>>=8,oe.bi_valid-=8)}(K)}},{"../utils/common":41}],53:[function(r,n,s){n.exports=function(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}},{}],54:[function(r,n,s){(function(a){(function(o,l){if(!o.setImmediate){var c,u,d,f,p=1,h={},g=!1,m=o.document,x=Object.getPrototypeOf&&Object.getPrototypeOf(o);x=x&&x.setTimeout?x:o,c={}.toString.call(o.process)==="[object process]"?function(b){process.nextTick(function(){v(b)})}:function(){if(o.postMessage&&!o.importScripts){var b=!0,S=o.onmessage;return o.onmessage=function(){b=!1},o.postMessage("","*"),o.onmessage=S,b}}()?(f="setImmediate$"+Math.random()+"$",o.addEventListener?o.addEventListener("message",_,!1):o.attachEvent("onmessage",_),function(b){o.postMessage(f+b,"*")}):o.MessageChannel?((d=new MessageChannel).port1.onmessage=function(b){v(b.data)},function(b){d.port2.postMessage(b)}):m&&"onreadystatechange"in m.createElement("script")?(u=m.documentElement,function(b){var S=m.createElement("script");S.onreadystatechange=function(){v(b),S.onreadystatechange=null,u.removeChild(S),S=null},u.appendChild(S)}):function(b){setTimeout(v,0,b)},x.setImmediate=function(b){typeof b!="function"&&(b=new Function(""+b));for(var S=new Array(arguments.length-1),T=0;T<S.length;T++)S[T]=arguments[T+1];var N={callback:b,args:S};return h[p]=N,c(p),p++},x.clearImmediate=w}function w(b){delete h[b]}function v(b){if(g)setTimeout(v,0,b);else{var S=h[b];if(S){g=!0;try{(function(T){var N=T.callback,C=T.args;switch(C.length){case 0:N();break;case 1:N(C[0]);break;case 2:N(C[0],C[1]);break;case 3:N(C[0],C[1],C[2]);break;default:N.apply(l,C)}})(S)}finally{w(b),g=!1}}}}function _(b){b.source===o&&typeof b.data=="string"&&b.data.indexOf(f)===0&&v(+b.data.slice(f.length))}})(typeof self>"u"?a===void 0?this:a:self)}).call(this,typeof pn<"u"?pn:typeof self<"u"?self:typeof window<"u"?window:{})},{}]},{},[10])(10)})})(IR);var cne=IR.exports;const une=fy(cne),zh=()=>{const{folderId:e,docId:t}=UL(),r=_o(),{user:n}=kt(),s=ua(),{toast:a}=St(),[o,l]=y.useState(""),[c,u]=y.useState(!1),[d,f]=y.useState(!1),[p,h]=y.useState(null),[g,m]=y.useState("card"),[x,w]=y.useState([]),[v,_]=y.useState(!1),[b,S]=y.useState(!1),[T,N]=y.useState(""),[C,E]=y.useState(e||void 0),[P,R]=y.useState(!1),[j,M]=y.useState(e||null),[A,I]=y.useState(t?{id:t}:null),{documents:X,folders:Y,userProfiles:z,uploadDocument:U,createFolder:V,deleteDocument:F,deleteFolder:D,renameDocumentMutation:G,moveDocument:O,refreshDocuments:L,toggleImportant:ie}=jp(j),[ne,me]=y.useState([]),[pe,xe]=y.useState([]);y.useEffect(()=>{(async()=>{const{data:Re,error:tt}=await he.from("documents").select("*");!tt&&Re&&xe(Re)})()},[]),ke.useEffect(()=>{if(M(e||null),t&&pe.length>0){const Te=pe.find(Re=>Re.id===t);I(Te||null)}else I(null);E(e||void 0)},[e,t,pe]);const Ae=!!o.trim(),ge=j||"";function je(Te,Re){const tt=[];function Dt(or){Te.filter(Xt=>Xt.parent_folder_id===or).forEach(Xt=>{tt.push(Xt),Dt(Xt.id)})}return Dt(Re),tt}const k=y.useMemo(()=>Y?Ae?Y.filter(Re=>Re.name&&Re.name.toLowerCase().includes(o.toLowerCase())):j?Y.find(Re=>Re.id===j)?je(Y,j):[]:Y.filter(Re=>(Re.parent_folder_id??"")===""):[],[Y,j,o,Ae]),le=y.useMemo(()=>X?Ae?X.filter(Te=>Te.name&&Te.name.toLowerCase().includes(o.toLowerCase())):X.filter(Te=>(Te.folder_id??"")===ge):[],[X,ge,o,Ae]),H=(()=>{if(!j||!Y||Y.length===0)return[];const Te=[];let Re=j,tt=0;const Dt=10;for(;Re&&tt<Dt;){const or=Y.find(Xt=>Xt.id===Re);if(or)Te.unshift(or),Re=or.parent_folder_id||null;else break;tt++}return Te})(),K=async Te=>{try{return await D.mutateAsync(Te),a({title:"Success",description:"Folder deleted successfully"}),!0}catch(Re){return a({title:"Error",description:Re.message||"Failed to delete folder",variant:"destructive"}),!1}},oe=async(Te,Re)=>{await O.mutateAsync({documentId:Te,targetFolderId:Re})},W=async(Te,Re)=>{try{await F.mutateAsync(Te),a({title:"Success",description:`"${Re}" moved to trash`})}catch(tt){a({title:"Error",description:tt.message||"Failed to delete document",variant:"destructive"})}},J=async()=>{if(x.length!==0)try{const Te=le.filter(Re=>x.includes(Re.id));for(const Re of Te)await F.mutateAsync(Re.id);w([]),a({title:"Success",description:`${Te.length} document(s) moved to trash`})}catch(Te){a({title:"Error",description:Te.message||"Failed to delete documents",variant:"destructive"})}},B=async()=>{if(x.length===0)return;const Te=le.filter(Qt=>x.includes(Qt.id));if(Te.length===1){const Qt=Te[0];if(typeof Qt.file_path=="string"&&Qt.file_path){const Pt=document.createElement("a");Pt.href=Qt.file_path,Pt.download=Qt.name||"document",Pt.target="_blank",Pt.rel="noopener noreferrer",document.body.appendChild(Pt),Pt.click(),document.body.removeChild(Pt),a({title:"Download Started",description:"Started download for 1 document."})}else a({title:"No Download",description:"No downloadable document found.",variant:"destructive"});return}const Re=new une;let tt=0;for(const Qt of Te)if(typeof Qt.file_path=="string"&&Qt.file_path)try{const Pt=await fetch(Qt.file_path);if(!Pt.ok)continue;const Jt=await Pt.blob();Re.file(Qt.name||`document-${Qt.id}`,Jt),tt++}catch{}if(tt===0){a({title:"No Download",description:"No downloadable documents found.",variant:"destructive"});return}const Dt=await Re.generateAsync({type:"blob"}),or=URL.createObjectURL(Dt),Xt=document.createElement("a");Xt.href=or,Xt.download=`documents-${Date.now()}.zip`,document.body.appendChild(Xt),Xt.click(),document.body.removeChild(Xt),setTimeout(()=>URL.revokeObjectURL(or),1e4),a({title:"Download Started",description:`Started download for ${tt} documents as ZIP.`})},ae=async Te=>{if(x.length!==0)try{const Re=le.filter(tt=>x.includes(tt.id));for(const tt of Re)await ie.mutateAsync({documentId:tt.id,isImportant:Te});w([]),a({title:"Success",description:`${Re.length} document(s) ${Te?"marked as":"unmarked from"} important`})}catch(Re){a({title:"Error",description:Re.message||"Failed to update documents",variant:"destructive"})}},de=Te=>{w(Te)},Q=(Te,Re="")=>Te??Re;function fe(Te,Re){if(!Te||!Re)return"Folder";const tt=Te.find(Dt=>Dt.id===Re);return tt&&typeof tt.name=="string"&&tt.name.length>0?tt.name:"Folder"}const Ce=async(Te,Re)=>{a({title:"Copy",description:`Copy document ${Te} to folder ${Re}`})},Ne=Te=>s.isAdmin||s.isSuperAdmin,Xe=async()=>{if(!T.trim()){a({title:"Invalid Folder Name",description:"Please enter a folder name",variant:"destructive"});return}R(!0);try{await V(T.trim(),C)&&(N(""),E(j||void 0),S(!1),a({title:"Success",description:"Folder created successfully"}))}catch(Te){a({title:"Error",description:Te.message||"Failed to create folder",variant:"destructive"})}finally{R(!1)}},it=Te=>{r(`/documents/folder/${Te}`),M(Te)},at=Te=>{r(j?`/documents/folder/${j}/doc/${Te.id}`:`/documents/doc/${Te.id}`),I(Te)},ht=async()=>{if(ne.length!==0)try{for(const Te of ne)await K(Te);me([]),a({title:"Success",description:`${ne.length} folder(s) deleted`})}catch(Te){a({title:"Error",description:Te.message||"Failed to delete folders",variant:"destructive"})}},Ke=async()=>{if(ne.length===0)return;const Te=ne.some(Re=>{const tt=Y.find(Dt=>Dt.id===Re);return tt&&tt.is_locked});try{const{error:Re}=await he.from("folders").update({is_locked:!Te}).in("id",ne);if(Re)throw Re;a({title:"Success",description:Te?"Folder(s) unlocked.":"Folder(s) locked."}),await L()}catch(Re){a({title:"Error",description:Re.message||"Failed to update lock state.",variant:"destructive"})}};if(!Y||!X)return i.jsx("div",{className:"flex items-center justify-center h-64",children:i.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary"})});const Bt=k.length===0&&le.length===0;if(j){const Te=Y.find(Re=>Re.id===j);if(Te&&Te.is_locked&&!(s.isAdmin||s.isSuperAdmin))return i.jsxs("div",{className:"flex flex-col items-center justify-center h-64",children:[i.jsx(ti,{className:"h-12 w-12 text-red-500 mb-4"}),i.jsx("h2",{className:"text-2xl font-bold text-red-700 mb-2",children:"Locked Folder"}),i.jsx("p",{className:"text-lg text-muted-foreground",children:"You do not have access to this folder."})]})}return i.jsxs("div",{className:"max-w-7xl mx-auto px-0 sm:px-6 lg:px-8 py-6 space-y-4",children:[i.jsxs("div",{className:"flex flex-col md:flex-row md:items-center md:justify-between gap-4",children:[i.jsxs("div",{className:"flex items-center gap-3",children:[j&&i.jsxs(ue,{variant:"ghost",size:"sm",onClick:()=>{r("/documents"),M(null)},title:"Go back",children:[i.jsx(G0,{className:"h-4 w-4"}),i.jsx("span",{children:"Back"})]}),i.jsx("h1",{className:"text-2xl font-bold",children:j?fe(Y,j):"Document Repository"})]}),i.jsxs("div",{className:"flex gap-2",children:[!v&&i.jsxs(ue,{onClick:()=>u(!0),className:"bg-[#8E1616] hover:bg-[#7A1414] text-white flex items-center gap-2",children:[i.jsx(Pa,{className:"h-4 w-4"})," Upload"]}),i.jsxs(ue,{variant:v?"default":"outline",onClick:()=>_(!v),className:"flex items-center gap-2",children:[i.jsx(yr,{className:"h-4 w-4"}),v?"Exit Trash":"Trash"]}),i.jsx(ue,{variant:g==="card"?"default":"ghost",size:"icon",onClick:()=>m("card"),children:i.jsx(bF,{className:"h-4 w-4"})}),i.jsx(ue,{variant:g==="list"?"default":"ghost",size:"icon",onClick:()=>m("list"),children:i.jsx(SF,{className:"h-4 w-4"})})]})]}),i.jsx("div",{className:"bg-muted/50 rounded-lg p-4",children:i.jsx(OR,{children:i.jsxs(FR,{children:[i.jsx(pm,{children:i.jsxs(cy,{onClick:()=>{M(null),_(!1)},className:"cursor-pointer flex items-center gap-1",children:[i.jsx(wf,{className:"h-4 w-4"})," Home"]})}),v&&i.jsxs(i.Fragment,{children:[i.jsx(dy,{}),i.jsx(pm,{children:i.jsxs(uy,{className:"flex items-center gap-1",children:[i.jsx(yr,{className:"h-4 w-4"})," Trash"]})})]}),!v&&H.map((Te,Re)=>i.jsxs(ke.Fragment,{children:[i.jsx(dy,{}),i.jsx(pm,{children:Re===H.length-1?i.jsx(uy,{children:Te.name}):i.jsx(cy,{onClick:()=>M(Te.id),className:"cursor-pointer",children:Te.name})})]},Te.id))]})})}),i.jsxs("div",{className:"relative flex items-center gap-2 mb-4 w-full max-w-md",children:[i.jsx(q0,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400 pointer-events-none"}),i.jsx(Ep,{type:"text",placeholder:"Search documents and folders...",value:o||"",onChange:Te=>l(Te.target.value),className:"pl-10 bg-background border-input"})]}),x.length>0&&i.jsxs("div",{className:"flex items-center gap-2 p-3 bg-blue-50 border border-blue-200 rounded-lg",children:[i.jsxs("span",{className:"text-sm font-medium text-blue-900",children:[x.length," document(s) selected"]}),i.jsxs("div",{className:"flex items-center gap-2 ml-auto",children:[i.jsxs(ue,{variant:"outline",size:"sm",onClick:B,className:"text-blue-600 hover:bg-blue-100",children:[i.jsx(js,{className:"h-4 w-4 mr-1"}),"Download"]}),i.jsxs(ue,{variant:"outline",size:"sm",onClick:()=>ae(!0),className:"text-yellow-600 hover:bg-yellow-100",children:[i.jsx(Sv,{className:"h-4 w-4 mr-1"}),"Mark Important"]}),i.jsxs(ue,{variant:"outline",size:"sm",onClick:()=>ae(!1),className:"text-gray-600 hover:bg-gray-100",children:[i.jsx(MF,{className:"h-4 w-4 mr-1"}),"Unmark Important"]}),(s.isAdmin||s.isSuperAdmin)&&i.jsxs(ue,{variant:"destructive",size:"sm",onClick:J,children:[i.jsx(yr,{className:"h-4 w-4 mr-1"}),"Delete"]})]})]}),v?i.jsxs("div",{className:"space-y-4",children:[i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsxs("h2",{className:"text-xl font-semibold flex items-center gap-2",children:[i.jsx(yr,{className:"h-5 w-5"}),"Recycle Bin"]}),i.jsx("p",{className:"text-sm text-muted-foreground",children:"Items will be permanently deleted after 30 days"})]}),i.jsx(aN,{isOpen:!0,onClose:()=>_(!1),inline:!0})]}):Bt?i.jsx("div",{className:"text-center text-muted-foreground py-12 text-lg",children:"No documents or folders found."}):i.jsxs(i.Fragment,{children:[i.jsxs("div",{className:"flex items-center justify-between mb-2",children:[i.jsxs("h2",{className:"text-xl font-semibold flex items-center gap-2",children:[i.jsx(ac,{className:"h-5 w-5"}),"Folders"]}),i.jsxs(Nt,{open:b,onOpenChange:S,children:[i.jsx(BT,{asChild:!0,children:i.jsxs(ue,{variant:"outline",size:"sm",children:[i.jsx(Pa,{className:"h-4 w-4 mr-2"}),"New Folder"]})}),i.jsxs(bt,{children:[i.jsxs(jt,{children:[i.jsx(Et,{children:"Create New Folder"}),i.jsx($t,{children:"Create a new folder to organize your documents"})]}),i.jsxs("div",{className:"space-y-4",children:[i.jsxs("div",{children:[i.jsx(Ve,{htmlFor:"folderName",children:"Folder Name"}),i.jsx(dt,{id:"folderName",value:T,onChange:Te=>N(Te.target.value),placeholder:"Enter folder name",onKeyDown:Te=>{Te.key==="Enter"&&!P&&Xe()}})]}),Y.length>0&&i.jsxs("div",{children:[i.jsx(Ve,{htmlFor:"parentFolder",children:"Parent Folder (Optional)"}),i.jsxs(oa,{value:C||"root",onValueChange:Te=>E(Te==="root"?void 0:Te),children:[i.jsx(As,{children:i.jsx(la,{placeholder:"Select parent folder (or leave empty for root)"})}),i.jsxs(Ps,{children:[i.jsx(zt,{value:"root",children:"Root (No parent)"}),Y.map(Te=>i.jsx(zt,{value:Te.id,children:Te.name},Te.id))]})]})]}),i.jsxs("div",{className:"flex justify-end space-x-2",children:[i.jsx(ue,{variant:"outline",onClick:()=>S(!1),disabled:P,children:"Cancel"}),i.jsxs(ue,{onClick:Xe,disabled:P,children:[i.jsx(ac,{className:"h-4 w-4 mr-2"}),P?"Creating...":"Create Folder"]})]})]})]})]})]}),ne.length>0&&i.jsxs("div",{className:"flex items-center gap-2 p-3 bg-red-50 border border-red-200 rounded-lg my-2",children:[i.jsxs("span",{className:"text-sm font-medium text-red-900",children:[ne.length," folder(s) selected"]}),i.jsxs(ue,{variant:"destructive",size:"sm",onClick:ht,children:[i.jsx(yr,{className:"h-4 w-4 mr-1"}),"Delete Selected Folders"]}),(s.isAdmin||s.isSuperAdmin)&&i.jsx(ue,{variant:"outline",size:"sm",onClick:Ke,children:ne.some(Te=>{const Re=Y.find(tt=>tt.id===Te);return Re&&Re.is_locked})?i.jsxs(i.Fragment,{children:[i.jsx(jF,{className:"h-4 w-4 mr-1"}),"Unlock"]}):i.jsxs(i.Fragment,{children:[i.jsx(ti,{className:"h-4 w-4 mr-1"}),"Lock"]})})]}),i.jsx(sne,{folders:k.map(Te=>({...Te,name:Q(Te.name,"Untitled"),id:Q(Te.id,"")})),userProfiles:z||{},onFolderClick:it,onDeleteFolder:K,canAccessLockedFolders:!0,viewMode:g,selectedIds:ne,onSelectionChange:me,parentId:j||null}),i.jsx(ine,{documents:le.map(Te=>({...Te,name:Q(Te.name,"Untitled"),id:Q(Te.id,"")})),userProfiles:z||{},currentUserId:n==null?void 0:n.id,canDeleteDocument:Ne,onViewDocument:at,onDownloadDocument:()=>{},onToggleImportant:()=>{},onRenameDocument:h,onCopyDocument:async Te=>{try{const Re=le.find(Xt=>Xt.id===Te);if(!Re){a({title:"Error",description:"Document not found",variant:"destructive"});return}const tt=await fetch(Re.file_path);if(!tt.ok)throw new Error("Failed to download file");const Dt=await tt.blob(),or=new File([Dt],`Copy of ${Re.name}`,{type:Re.mime_type||Dt.type});await U(or,Re.folder_id||void 0),a({title:"Success",description:"File duplicated successfully"})}catch(Re){a({title:"Error",description:Re.message||"Failed to duplicate file",variant:"destructive"})}},onDeleteDocument:W,onMoveDocument:oe,onCopyToFolder:Ce,onDragStart:()=>{},folders:Y,viewMode:g,selectedIds:x,onSelectionChange:de})]}),i.jsx(one,{isOpen:c,onClose:()=>u(!1),onUpload:async(Te,Re)=>{try{const tt={},Dt=new Set,or=[];for(const yn of Te){const pt=(yn.webkitRelativePath||yn.name).split("/").filter(Boolean);if(pt.length>1){const xt=pt.slice(0,-1).join("/");Dt.add(xt),or.push({file:yn,folderPath:xt})}else or.push({file:yn,folderPath:""})}const Xt=Array.from(Dt).sort((yn,Ze)=>yn.split("/").length-Ze.split("/").length);for(const yn of Xt){const Ze=yn.split("/");let pt=Re||j||void 0,xt="";for(let _r=0;_r<Ze.length;_r++)if(xt=xt?xt+"/"+Ze[_r]:Ze[_r],!tt[xt]){let on=xt.includes("/")?xt.substring(0,xt.lastIndexOf("/")):"",ms=on?tt[on]:Re||j||void 0;const Xn=await V(Ze[_r],ms);if(!Xn||!Xn.id)throw new Error("Failed to create folder: "+Ze[_r]);tt[xt]=Xn.id}}let Qt=0,Pt=0;const Jt=[];for(const{file:yn,folderPath:Ze}of or)try{let pt=Re||j||void 0;Ze&&(pt=tt[Ze]),await U(yn,pt),Qt++}catch(pt){Pt++,Jt.push(`${yn.name}: ${pt.message}`)}u(!1),Qt>0&&a({title:"Upload Complete",description:`Successfully uploaded ${Qt} file${Qt!==1?"s":""}${Pt>0?` (${Pt} failed)`:""}`}),Pt>0&&a({title:"Upload Errors",description:`Failed to upload ${Pt} file${Pt!==1?"s":""}: ${Jt.slice(0,3).join(", ")}${Jt.length>3?"...":""}`,variant:"destructive"})}catch(tt){a({title:"Error",description:tt.message||"Failed to upload documents",variant:"destructive"})}},currentFolderId:j}),i.jsx(lne,{isOpen:!!p,document:p,onClose:()=>h(null),onRename:async Te=>{try{await G.mutateAsync({documentId:p==null?void 0:p.id,newName:Te}),h(null),a({title:"Success",description:"Document renamed successfully"})}catch{a({title:"Error",description:"Failed to rename document",variant:"destructive"})}}}),i.jsx(aN,{isOpen:d,onClose:()=>f(!1)}),i.jsx(K1,{isOpen:!!A,onClose:()=>{r(j?`/documents/folder/${j}`:"/documents"),I(null)},document:A,documentType:"document"})]})},dne=({email:e,onBack:t,onOpenInOutlook:r})=>{var u,d;const n=f=>new Date(f).toLocaleDateString("en-US",{weekday:"long",year:"numeric",month:"long",day:"numeric",hour:"numeric",minute:"2-digit",hour12:!0}),s=f=>f==="high"?i.jsx(We,{variant:"destructive",className:"text-xs",children:"High Priority"}):null,a=f=>f.replace(/<[^>]*>/g,"").replace(/&nbsp;/g," ").replace(/&amp;/g,"&").replace(/&lt;/g,"<").replace(/&gt;/g,">").replace(/&quot;/g,'"').trim(),o=f=>{navigator.clipboard.writeText(f)},l=[],c=[];return i.jsxs("div",{className:"max-w-4xl mx-auto p-6",children:[i.jsxs("div",{className:"flex items-center gap-4 mb-6",children:[i.jsxs(ue,{variant:"ghost",onClick:t,className:"flex items-center gap-2","aria-label":"Back to Inbox",children:[i.jsx(G0,{className:"h-4 w-4"}),"Back to Inbox"]}),i.jsx(ue,{variant:"outline",onClick:()=>r(e),className:"flex items-center gap-2 ml-auto","aria-label":"Open in Outlook",children:i.jsx(nu,{children:i.jsxs(jf,{children:[i.jsx(Ef,{asChild:!0,children:i.jsx(Ta,{className:"h-4 w-4"})}),i.jsx(su,{children:"Open in Outlook"})]})})})]}),i.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 overflow-hidden shadow-sm",children:[i.jsx("div",{className:"border-b border-gray-100 p-6",children:i.jsxs("div",{className:"space-y-4",children:[i.jsxs("div",{className:"flex items-start justify-between gap-4",children:[i.jsx("h1",{className:"text-xl font-semibold text-gray-900 flex-1",children:e.subject||"No Subject"}),s(e.importance)]}),i.jsxs("div",{className:"space-y-2",children:[i.jsxs("div",{className:"flex items-center gap-3",children:[i.jsx("div",{className:"w-10 h-10 bg-blue-500 rounded-full flex items-center justify-center flex-shrink-0",children:i.jsx(lo,{className:"h-5 w-5 text-white"})}),i.jsx("div",{className:"flex-1 min-w-0",children:i.jsxs("div",{className:"flex items-center gap-3",children:[i.jsx("span",{className:"text-sm font-medium text-gray-700 w-12",children:"From:"}),i.jsx("span",{className:"font-medium text-gray-900",children:((u=e.from)==null?void 0:u.name)||"Unknown Sender"}),i.jsxs("span",{className:"text-sm text-gray-600",children:["<",((d=e.from)==null?void 0:d.address)||"",">"]}),i.jsx("button",{onClick:()=>{var f;return o(((f=e.from)==null?void 0:f.address)||"")},className:"text-blue-600 hover:text-blue-800 transition-colors p-1",title:"Copy email address",children:i.jsx(Bm,{className:"h-3 w-3"})})]})})]}),i.jsxs("div",{className:"flex items-center gap-3",children:[i.jsx("div",{className:"w-10 h-10 bg-green-500 rounded-full flex items-center justify-center flex-shrink-0",children:i.jsx("span",{className:"text-xs font-semibold text-white",children:"TO"})}),i.jsx("div",{className:"flex-1",children:i.jsxs("div",{className:"flex items-center gap-3",children:[i.jsx("span",{className:"text-sm font-medium text-gray-700 w-12",children:"To:"}),i.jsx("span",{className:"text-sm text-gray-900",children:"Me"}),i.jsx("button",{onClick:()=>o("current-user@email.com"),className:"text-blue-600 hover:text-blue-800 transition-colors p-1",title:"Copy email address",children:i.jsx(Bm,{className:"h-3 w-3"})})]})})]}),l.length>0&&i.jsxs("div",{className:"flex items-center gap-3",children:[i.jsx("div",{className:"w-10 h-10 bg-yellow-500 rounded-full flex items-center justify-center flex-shrink-0",children:i.jsx("span",{className:"text-xs font-semibold text-white",children:"CC"})}),i.jsx("div",{className:"flex-1",children:i.jsxs("div",{className:"flex items-center gap-3",children:[i.jsx("span",{className:"text-sm font-medium text-gray-700 w-12",children:"Cc:"}),i.jsx("span",{className:"text-sm text-gray-900",children:l.join(", ")})]})})]}),c.length>0&&i.jsxs("div",{className:"flex items-center gap-3",children:[i.jsx("div",{className:"w-10 h-10 bg-purple-500 rounded-full flex items-center justify-center flex-shrink-0",children:i.jsx("span",{className:"text-xs font-semibold text-white",children:"BCC"})}),i.jsx("div",{className:"flex-1",children:i.jsxs("div",{className:"flex items-center gap-3",children:[i.jsx("span",{className:"text-sm font-medium text-gray-700 w-12",children:"Bcc:"}),i.jsx("span",{className:"text-sm text-gray-900",children:c.join(", ")})]})})]}),i.jsxs("div",{className:"flex items-center gap-3 pt-3 border-t border-gray-200 mt-4",children:[i.jsx(en,{className:"h-4 w-4 text-gray-400"}),i.jsxs("span",{className:"text-sm text-gray-600",children:["Sent: ",n(e.receivedDateTime||"")]}),e.hasAttachments&&i.jsxs("div",{className:"flex items-center gap-1 ml-4",children:[i.jsx(Ic,{className:"h-4 w-4 text-gray-400"}),i.jsx("span",{className:"text-sm text-gray-600",children:"Has attachments"})]})]})]})]})}),i.jsx("div",{className:"p-6",children:a(e.body)?i.jsx("div",{className:"bg-gray-50 border border-gray-200 rounded-md p-4",children:i.jsx("div",{className:"text-gray-800 text-sm leading-relaxed whitespace-pre-wrap font-mono",children:a(e.body)})}):i.jsx("div",{className:"bg-gray-50 border border-gray-200 rounded-md p-4 text-center",children:i.jsx("p",{className:"text-gray-500 italic",children:"This email has no content."})})}),i.jsx("div",{className:"border-t border-gray-100 p-4 bg-gray-50",children:i.jsx("div",{className:"flex items-center justify-between",children:i.jsxs("div",{className:"text-xs text-gray-500",children:["Message ID: ",e.id.substring(0,20),"..."]})})})]})]})},fne=()=>{const[e,t]=y.useState(""),[r,n]=y.useState(null),{emails:s,loading:a,fetchEmails:o,markAsRead:l}=zT(),c=25,u=s.filter(v=>v.subject.toLowerCase().includes(e.toLowerCase())||v.from.name.toLowerCase().includes(e.toLowerCase())||v.from.address.toLowerCase().includes(e.toLowerCase())),d=u.slice(0,c),f=u.length>c,p=v=>{const _=new Date(v),S=(new Date().getTime()-_.getTime())/(1e3*60*60);return S<24?_.toLocaleTimeString("en-US",{hour:"numeric",minute:"2-digit",hour12:!0}):S<168?_.toLocaleDateString("en-US",{weekday:"short"}):_.toLocaleDateString("en-US",{month:"short",day:"numeric"})},h=v=>v==="high"?i.jsx(We,{variant:"destructive",className:"text-xs",children:"High Priority"}):null,g=v=>{const _=`https://outlook.office.com/mail/inbox/id/${v.id}`;window.open(_,"_blank","noopener,noreferrer")},m=()=>{window.open("https://outlook.office.com/mail/inbox","_blank","noopener,noreferrer")},x=async v=>{await l(v.id),n(v)},w=()=>{n(null)};return r?i.jsx(dne,{email:r,onBack:w,onOpenInOutlook:g}):i.jsxs("div",{className:"max-w-7xl mx-auto p-6 space-y-6",children:[i.jsxs("div",{className:"flex flex-col space-y-2",children:[i.jsx("h1",{className:"text-2xl font-semibold text-gray-900",children:"Email"}),i.jsx("p",{className:"text-sm text-gray-600",children:"Manage your communications"})]}),i.jsxs("div",{className:"flex flex-col sm:flex-row gap-4 items-start sm:items-center",children:[i.jsx("div",{className:"flex-1 max-w-md",children:i.jsxs("div",{className:"relative",children:[i.jsx(q0,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400"}),i.jsx(dt,{placeholder:"Search emails by subject, sender, or address",className:"pl-10 border-gray-300 focus:border-blue-500 focus:ring-blue-500",value:e,onChange:v=>t(v.target.value)})]})}),i.jsxs(ue,{variant:"outline",onClick:o,disabled:a,className:"flex items-center gap-2 border-gray-300 hover:bg-gray-50","aria-label":"Refresh Email List",children:[i.jsx(os,{className:`h-4 w-4 ${a?"animate-spin":""}`}),"Refresh"]})]}),i.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 overflow-hidden",children:[!a&&d.length>0&&i.jsx("div",{className:"px-6 py-3 bg-gray-50 border-b border-gray-200",children:i.jsxs("p",{className:"text-sm text-gray-600",children:["Showing ",d.length," of ",u.length," emails",f&&` (${u.length-c} more available)`]})}),a?i.jsx("div",{className:"flex items-center justify-center py-16",children:i.jsxs("div",{className:"flex flex-col items-center space-y-4",children:[i.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-500"}),i.jsx("p",{className:"text-sm text-gray-500",children:"Loading emails..."})]})}):d.length>0?i.jsx("div",{className:"divide-y divide-gray-100 text-sm",children:i.jsx("div",{className:"overflow-x-auto",children:d.map((v,_)=>{var b;return i.jsx("div",{className:`group hover:bg-gray-50 transition-colors cursor-pointer ${v.isRead?"":"bg-blue-50/30"}`,onClick:()=>x(v),children:i.jsx("div",{className:"px-6 py-4",children:i.jsxs("div",{className:"flex items-start justify-between gap-4",children:[i.jsxs("div",{className:"flex items-start gap-3 flex-1 min-w-0",children:[!v.isRead&&i.jsx(ck,{className:"h-2 w-2 fill-blue-500 text-blue-500 mt-2 flex-shrink-0"}),i.jsxs("div",{className:"flex-1 min-w-0",children:[i.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[i.jsx("span",{className:`text-sm truncate ${v.isRead?"font-medium text-gray-700":"font-semibold text-gray-900"}`,children:((b=v.from)==null?void 0:b.name)||"Unknown Sender"}),v.hasAttachments&&i.jsx(Ic,{className:"h-3 w-3 text-gray-400 flex-shrink-0"}),h(v.importance)]}),i.jsx("div",{className:"mb-1",children:i.jsx("span",{className:`text-sm ${v.isRead?"text-gray-700":"font-semibold text-gray-900"} line-clamp-1`,children:v.subject||"No Subject"})}),i.jsxs("p",{className:"text-sm text-gray-600 line-clamp-1",children:[v.body.replace(/<[^>]*>/g,"").substring(0,100),v.body.replace(/<[^>]*>/g,"").length>100?"...":""]})]})]}),i.jsxs("div",{className:"flex items-center gap-3 flex-shrink-0",children:[i.jsx("span",{className:"text-xs text-gray-500 min-w-fit",children:p(v.receivedDateTime||"")}),i.jsxs(ue,{variant:"ghost",size:"sm",onClick:S=>{S.stopPropagation(),g(v)},className:"opacity-0 group-hover:opacity-100 transition-opacity h-8 px-3 text-blue-600 hover:bg-blue-100","aria-label":"Open in Outlook",children:[i.jsx(Ta,{className:"h-3 w-3 mr-1"}),"Open"]})]})]})})},v.id||_)})})}):i.jsx("div",{className:"text-center py-16",children:i.jsxs("div",{className:"flex flex-col items-center space-y-4",children:[i.jsx("div",{className:"w-16 h-16 bg-gray-100 rounded-full flex items-center justify-center",children:i.jsx(ta,{className:"h-8 w-8 text-gray-400"})}),i.jsxs("div",{className:"space-y-2",children:[i.jsx("h3",{className:"text-lg font-medium text-gray-900",children:e?"No emails found":"No emails"}),i.jsx("p",{className:"text-sm text-gray-500 max-w-sm",children:e?"Try adjusting your search terms":s.length===0?"Connect your Microsoft account in Settings to view emails":"All caught up! No new emails to show."})]})]})})]}),f&&i.jsx("div",{className:"mt-4 text-center",children:i.jsx(ue,{variant:"outline",onClick:m,className:"text-blue-600 hover:bg-blue-100",children:"View More in Outlook"})})]})},hne=({open:e,onOpenChange:t})=>{const[r,n]=y.useState(""),[s,a]=y.useState(""),[o,l]=y.useState("present"),[c,u]=y.useState("physical"),[d,f]=y.useState(""),[p,h]=y.useState(!1),{markAttendance:g,attendanceRecords:m=[]}=Qf(),{meetings:x}=_l(),{user:w}=kt(),v=x.filter(N=>{if(!w)return!1;const C=Array.isArray(N.attendees)&&N.attendees.some(P=>P.user_id===w.id)||Array.isArray(N.manual_attendees)&&N.manual_attendees.some(P=>P.email===w.email),E=m.some(P=>P.meeting_id===N.id&&P.user_id===w.id);return C&&!E}),_=x.find(N=>N.id===r);y.useEffect(()=>{e&&(n(""),a(""),l("present"),u("physical"),f(""))},[e]);const b=async()=>{if(!(!r||!w)){h(!0);try{await g({meetingId:r,userId:w.id,status:o,type:c,joinTime:o!=="absent"?new Date:void 0,notes:d})&&t(!1)}catch(N){console.error("Error marking attendance:",N)}finally{h(!1)}}},S=N=>{const C=new Date,E=new Date(N.start_time),P=new Date(N.end_time);return C>=E&&C<=P?i.jsx(We,{className:"bg-green-500 text-white",children:"Live"}):C<E?i.jsx(We,{className:"bg-blue-500 text-white",children:"Upcoming"}):i.jsx(We,{variant:"secondary",children:"Completed"})},T=N=>{const C=new Date(N.start_time);return{date:vt(C,"MMM dd, yyyy"),time:vt(C,"h:mm a"),isOnline:N.meeting_type==="online"||N.teams_join_url}};return i.jsx(Nt,{open:e,onOpenChange:t,children:i.jsxs(bt,{className:"sm:max-w-[600px]",children:[i.jsxs(jt,{children:[i.jsxs(Et,{className:"flex items-center space-x-2",children:[i.jsx(sl,{className:"h-5 w-5"}),i.jsx("span",{children:"Mark Attendance"})]}),i.jsx($t,{children:"Record attendance for a meeting"})]}),i.jsxs("div",{className:"space-y-6",children:[i.jsxs("div",{className:"space-y-2",children:[i.jsx(Ve,{htmlFor:"meeting",children:"Select Meeting"}),i.jsxs(oa,{value:r,onValueChange:n,children:[i.jsx(As,{children:i.jsx(la,{placeholder:"Choose a meeting"})}),i.jsx(Ps,{children:v.map(N=>{const C=T(N);return i.jsx(zt,{value:N.id,children:i.jsx("div",{className:"flex items-center justify-between w-full",children:i.jsxs("div",{children:[i.jsx("div",{className:"font-medium",children:N.title}),i.jsxs("div",{className:"text-sm text-gray-500 flex items-center space-x-2",children:[i.jsxs("span",{className:"flex items-center space-x-1",children:[i.jsx(en,{className:"h-3 w-3"}),i.jsx("span",{children:C.date})]}),i.jsxs("span",{className:"flex items-center space-x-1",children:[i.jsx(qr,{className:"h-3 w-3"}),i.jsx("span",{children:C.time})]}),C.isOnline?i.jsx(ra,{className:"h-3 w-3"}):i.jsx(ri,{className:"h-3 w-3"})]})]})})},N.id)})})]}),_&&i.jsxs("div",{className:"flex items-center space-x-2 mt-2",children:[S(_),i.jsx("span",{className:"text-sm text-gray-500",children:_.location||"Online Meeting"})]})]}),_&&_.meeting_type==="hybrid"&&i.jsxs("div",{className:"space-y-2",children:[i.jsx(Ve,{children:"Attendance Type"}),i.jsxs("div",{className:"flex space-x-2",children:[i.jsxs(ue,{variant:c==="physical"?"default":"outline",size:"sm",onClick:()=>u("physical"),children:[i.jsx(ri,{className:"h-4 w-4 mr-2"}),"In Person"]}),i.jsxs(ue,{variant:c==="online"?"default":"outline",size:"sm",onClick:()=>u("online"),children:[i.jsx(ra,{className:"h-4 w-4 mr-2"}),"Online"]})]})]}),i.jsxs("div",{className:"space-y-2",children:[i.jsx(Ve,{children:"Attendance Status"}),i.jsxs("div",{className:"flex space-x-2",children:[i.jsx(ue,{variant:o==="present"?"default":"outline",size:"sm",onClick:()=>l("present"),className:o==="present"?"bg-green-500 hover:bg-green-600":"",children:"Present"}),i.jsx(ue,{variant:o==="late"?"default":"outline",size:"sm",onClick:()=>l("late"),className:o==="late"?"bg-yellow-500 hover:bg-yellow-600":"",children:"Late"}),i.jsx(ue,{variant:o==="absent"?"default":"outline",size:"sm",onClick:()=>l("absent"),className:o==="absent"?"bg-red-500 hover:bg-red-600":"",children:"Absent"})]})]}),i.jsxs("div",{className:"space-y-2",children:[i.jsx(Ve,{htmlFor:"notes",children:"Notes (Optional)"}),i.jsx(Ma,{id:"notes",value:d,onChange:N=>f(N.target.value),placeholder:"Any additional notes about the attendance...",rows:3})]}),i.jsxs("div",{className:"flex justify-end space-x-2 pt-4 border-t",children:[i.jsx(ue,{variant:"outline",onClick:()=>t(!1),children:"Cancel"}),i.jsxs(ue,{onClick:b,disabled:p||!r,className:"bg-primary hover:bg-primary/90",children:[i.jsx(sl,{className:"h-4 w-4 mr-2"}),p?"Recording...":"Mark Attendance"]})]})]})]})})},mne=({open:e,onOpenChange:t})=>{var _;const[r,n]=y.useState([]),[s,a]=y.useState(!1),[o,l]=y.useState("current_month"),{generateAttendanceReport:c}=Qf(),u=()=>{const b=[{id:"1",first_name:"Arjun",last_name:"Sharma",email:"arjun.sharma@example.com"},{id:"2",first_name:"Priya",last_name:"Patel",email:"priya.patel@example.com"},{id:"3",first_name:"Rahul",last_name:"Gupta",email:"rahul.gupta@example.com"},{id:"4",first_name:"Kavita",last_name:"Singh",email:"kavita.singh@example.com"},{id:"5",first_name:"Amit",last_name:"Kumar",email:"amit.kumar@example.com"},{id:"6",first_name:"Sneha",last_name:"Joshi",email:"sneha.joshi@example.com"},{id:"7",first_name:"Vikram",last_name:"Reddy",email:"vikram.reddy@example.com"},{id:"8",first_name:"Meera",last_name:"Nair",email:"meera.nair@example.com"}],S=[],T=new Date;return b.forEach((N,C)=>{const E=5+Math.floor(Math.random()*4);for(let P=0;P<E;P++){const R=new Date(T.getTime()-Math.random()*30*24*60*60*1e3),j=C<3?[.8,.15,.05]:C<6?[.6,.25,.15]:[.4,.3,.3],M=Math.random();let A="present";M<j[2]?A="absent":M<j[1]+j[2]&&(A="late"),S.push({id:`${N.id}-${P}`,meeting_id:`meeting-${P+1}`,user_id:N.id,attendance_status:A,duration_minutes:A==="absent"?0:45+Math.floor(Math.random()*60),created_at:R.toISOString(),profiles:N})}}),S};y.useEffect(()=>{e&&f()},[e,o]);const d=()=>{const b=new Date;switch(o){case"current_week":return{start:Ts(b),end:Yd(b)};case"last_week":return{start:Ts(H2(b)),end:Yd(H2(b))};case"current_month":return{start:Mr(b),end:Ja(b)};case"last_month":return{start:Mr(sx(b,1)),end:Ja(sx(b,1))};case"last_3_months":return{start:Mr(sx(b,2)),end:Ja(b)};default:return{start:Mr(b),end:Ja(b)}}},f=async()=>{a(!0);try{const{start:b,end:S}=d(),T=await c(void 0,b,S);if(!T||T.length===0){const N=u();n(N)}else n(T)}catch(b){console.error("Error loading report data:",b);const S=u();n(S)}finally{a(!1)}},p=()=>{if(!r.length)return{totalMeetings:0,avgAttendance:0,totalMembers:0,activeMembers:0};const b=[...new Set(r.map(E=>E.meeting_id))],S=[...new Set(r.map(E=>E.user_id))],T=[...new Set(r.filter(E=>E.attendance_status==="present"||E.attendance_status==="late").map(E=>E.user_id))],N=b.length,C=r.length>0?Math.round(r.filter(E=>E.attendance_status==="present"||E.attendance_status==="late").length/r.length*100):0;return{totalMeetings:N,avgAttendance:C,totalMembers:S.length,activeMembers:T.length}},h=()=>{const b=r.reduce((S,T)=>{var E,P,R;const N=T.user_id,C=`${(E=T.profiles)==null?void 0:E.first_name} ${(P=T.profiles)==null?void 0:P.last_name}`;switch(S[N]||(S[N]={name:C,email:(R=T.profiles)==null?void 0:R.email,totalMeetings:0,attended:0,late:0,absent:0,totalDuration:0,averageDuration:0,attendanceStreak:0,lastAttendance:null}),S[N].totalMeetings++,T.attendance_status){case"present":S[N].attended++,S[N].lastAttendance=T.created_at;break;case"late":S[N].late++,S[N].lastAttendance=T.created_at;break;case"absent":S[N].absent++;break}return T.duration_minutes&&(S[N].totalDuration+=T.duration_minutes),S},{});return Object.values(b).forEach(S=>{S.totalMeetings>0&&(S.averageDuration=Math.round(S.totalDuration/S.totalMeetings),S.attendanceRate=Math.round((S.attended+S.late)/S.totalMeetings*100))}),Object.values(b).sort((S,T)=>T.attendanceRate-S.attendanceRate)},g=()=>{const b=r.reduce((S,T)=>{var E,P,R;const N=T.user_id,C=`${(E=T.profiles)==null?void 0:E.first_name} ${(P=T.profiles)==null?void 0:P.last_name}`;switch(S[N]||(S[N]={name:C,email:(R=T.profiles)==null?void 0:R.email,totalMeetings:0,attended:0,late:0,absent:0,totalDuration:0}),S[N].totalMeetings++,T.attendance_status){case"present":S[N].attended++;break;case"late":S[N].late++;break;case"absent":S[N].absent++;break}return T.duration_minutes&&(S[N].totalDuration+=T.duration_minutes),S},{});return Object.values(b)},m=()=>{const S=["Member,Email,Total Meetings,Attended,Late,Absent,Attendance Rate,Total Duration (hours)",...g().map(E=>[E.name,E.email,E.totalMeetings,E.attended,E.late,E.absent,`${Math.round((E.attended+E.late)/E.totalMeetings*100)}%`,`${Math.round(E.totalDuration/60*100)/100}`].join(","))].join(`
`),T=new Blob([S],{type:"text/csv"}),N=URL.createObjectURL(T),C=document.createElement("a");C.href=N,C.download=`attendance_analytics_${o}_${vt(new Date,"yyyy-MM-dd")}.csv`,C.click(),URL.revokeObjectURL(N)},x=p(),w=h(),v=g();return i.jsx(Nt,{open:e,onOpenChange:t,children:i.jsxs(bt,{className:"sm:max-w-[1200px] max-h-[90vh] overflow-y-auto",children:[i.jsxs(jt,{children:[i.jsxs(Et,{className:"flex items-center space-x-2",children:[i.jsx(Wi,{className:"h-5 w-5"}),i.jsx("span",{children:"Attendance Analytics & Reports"})]}),i.jsxs($t,{children:["Comprehensive attendance analytics with member-wise insights and tracking",r.length>0&&((_=r[0].profiles)==null?void 0:_.first_name)==="Arjun"&&i.jsx("span",{className:"text-orange-600 font-medium",children:" (Sample Data)"})]})]}),i.jsxs("div",{className:"space-y-6",children:[i.jsxs("div",{className:"flex justify-between items-center",children:[i.jsxs(oa,{value:o,onValueChange:l,children:[i.jsx(As,{className:"w-[200px]",children:i.jsx(la,{placeholder:"Select period"})}),i.jsxs(Ps,{children:[i.jsx(zt,{value:"current_week",children:"Current Week"}),i.jsx(zt,{value:"last_week",children:"Last Week"}),i.jsx(zt,{value:"current_month",children:"Current Month"}),i.jsx(zt,{value:"last_month",children:"Last Month"}),i.jsx(zt,{value:"last_3_months",children:"Last 3 Months"})]})]}),i.jsxs(ue,{onClick:m,variant:"outline",children:[i.jsx(js,{className:"h-4 w-4 mr-2"}),"Download Report"]})]}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6",children:[i.jsxs(Ye,{children:[i.jsx(ct,{className:"pb-2",children:i.jsx(ft,{className:"text-sm font-medium text-gray-600",children:"Total Meetings"})}),i.jsxs(Je,{children:[i.jsx("div",{className:"text-2xl font-bold text-blue-600",children:x.totalMeetings}),i.jsx("p",{className:"text-xs text-gray-500",children:"In selected period"})]})]}),i.jsxs(Ye,{children:[i.jsx(ct,{className:"pb-2",children:i.jsx(ft,{className:"text-sm font-medium text-gray-600",children:"Average Attendance"})}),i.jsxs(Je,{children:[i.jsxs("div",{className:"text-2xl font-bold text-green-600",children:[x.avgAttendance,"%"]}),i.jsx("p",{className:"text-xs text-gray-500",children:"Overall attendance rate"})]})]}),i.jsxs(Ye,{children:[i.jsx(ct,{className:"pb-2",children:i.jsx(ft,{className:"text-sm font-medium text-gray-600",children:"Total Members"})}),i.jsxs(Je,{children:[i.jsx("div",{className:"text-2xl font-bold text-purple-600",children:x.totalMembers}),i.jsx("p",{className:"text-xs text-gray-500",children:"Registered members"})]})]}),i.jsxs(Ye,{children:[i.jsx(ct,{className:"pb-2",children:i.jsx(ft,{className:"text-sm font-medium text-gray-600",children:"Active Members"})}),i.jsxs(Je,{children:[i.jsx("div",{className:"text-2xl font-bold text-orange-600",children:x.activeMembers}),i.jsx("p",{className:"text-xs text-gray-500",children:"With attendance records"})]})]})]}),i.jsxs(bl,{defaultValue:"summary",className:"space-y-4",children:[i.jsxs(So,{className:"grid w-full grid-cols-2",children:[i.jsx(Vn,{value:"summary",children:"Member Summary"}),i.jsx(Vn,{value:"analytics",children:"Detailed Analytics"})]}),i.jsx(zr,{value:"summary",children:i.jsxs(Ye,{children:[i.jsx(ct,{children:i.jsxs(ft,{className:"flex items-center space-x-2",children:[i.jsx(mr,{className:"h-4 w-4"}),i.jsx("span",{children:"Member Attendance Summary"})]})}),i.jsx(Je,{children:s?i.jsx("div",{className:"flex items-center justify-center py-8",children:i.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary"})}):v.length>0?i.jsx("div",{className:"rounded-md border",children:i.jsxs(Ff,{children:[i.jsx(If,{children:i.jsxs(mi,{children:[i.jsx(dr,{children:"Member"}),i.jsx(dr,{children:"Total Meetings"}),i.jsx(dr,{children:"Present"}),i.jsx(dr,{children:"Late"}),i.jsx(dr,{children:"Absent"}),i.jsx(dr,{children:"Attendance Rate"}),i.jsx(dr,{children:"Total Time"})]})}),i.jsx(Lf,{children:v.map((b,S)=>{const T=Math.round((b.attended+b.late)/b.totalMeetings*100);return i.jsxs(mi,{children:[i.jsx(fr,{children:i.jsxs("div",{children:[i.jsx("div",{className:"font-medium",children:b.name}),i.jsx("div",{className:"text-sm text-gray-500",children:b.email})]})}),i.jsx(fr,{children:b.totalMeetings}),i.jsx(fr,{children:i.jsx(We,{className:"bg-green-100 text-green-800 border-green-200",children:b.attended})}),i.jsx(fr,{children:i.jsx(We,{className:"bg-yellow-100 text-yellow-800 border-yellow-200",children:b.late})}),i.jsx(fr,{children:i.jsx(We,{className:"bg-red-100 text-red-800 border-red-200",children:b.absent})}),i.jsx(fr,{children:i.jsxs(We,{variant:T>=80?"default":T>=60?"secondary":"destructive",children:[T,"%"]})}),i.jsx(fr,{children:i.jsxs("div",{className:"flex items-center space-x-1",children:[i.jsx(qr,{className:"h-3 w-3"}),i.jsxs("span",{children:[Math.round(b.totalDuration/60*100)/100,"h"]})]})})]},S)})})]})}):i.jsxs("div",{className:"text-center text-muted-foreground py-8",children:[i.jsx(Wi,{className:"h-12 w-12 mx-auto mb-4 opacity-50"}),i.jsx("p",{children:"No attendance data available for selected period"})]})})]})}),i.jsx(zr,{value:"analytics",children:i.jsxs(Ye,{children:[i.jsx(ct,{children:i.jsxs(ft,{className:"flex items-center space-x-2",children:[i.jsx(LF,{className:"h-4 w-4"}),i.jsx("span",{children:"Detailed Member Analytics"})]})}),i.jsx(Je,{children:s?i.jsx("div",{className:"flex items-center justify-center py-8",children:i.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary"})}):w.length>0?i.jsx("div",{className:"space-y-4",children:w.map((b,S)=>i.jsxs(Ye,{className:"p-4",children:[i.jsxs("div",{className:"flex justify-between items-start mb-3",children:[i.jsxs("div",{children:[i.jsx("h3",{className:"font-semibold text-lg",children:b.name}),i.jsx("p",{className:"text-sm text-gray-500",children:b.email})]}),i.jsxs(We,{variant:b.attendanceRate>=80?"default":b.attendanceRate>=60?"secondary":"destructive",className:"text-sm",children:[b.attendanceRate,"% Attendance"]})]}),i.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-5 gap-4 text-sm",children:[i.jsxs("div",{className:"text-center",children:[i.jsx("div",{className:"text-lg font-bold text-blue-600",children:b.totalMeetings}),i.jsx("div",{className:"text-gray-500",children:"Total Meetings"})]}),i.jsxs("div",{className:"text-center",children:[i.jsx("div",{className:"text-lg font-bold text-green-600",children:b.attended}),i.jsx("div",{className:"text-gray-500",children:"Present"})]}),i.jsxs("div",{className:"text-center",children:[i.jsx("div",{className:"text-lg font-bold text-yellow-600",children:b.late}),i.jsx("div",{className:"text-gray-500",children:"Late"})]}),i.jsxs("div",{className:"text-center",children:[i.jsx("div",{className:"text-lg font-bold text-red-600",children:b.absent}),i.jsx("div",{className:"text-gray-500",children:"Absent"})]}),i.jsxs("div",{className:"text-center",children:[i.jsxs("div",{className:"text-lg font-bold text-purple-600",children:[b.averageDuration,"m"]}),i.jsx("div",{className:"text-gray-500",children:"Avg Duration"})]})]}),b.lastAttendance&&i.jsx("div",{className:"mt-3 pt-3 border-t",children:i.jsxs("div",{className:"flex items-center text-sm text-gray-600",children:[i.jsx(sl,{className:"h-4 w-4 mr-1"}),"Last attendance: ",vt(dm(b.lastAttendance),"MMM dd, yyyy")]})})]},S))}):i.jsxs("div",{className:"text-center text-muted-foreground py-8",children:[i.jsx(OF,{className:"h-12 w-12 mx-auto mb-4 opacity-50"}),i.jsx("p",{children:"No detailed analytics available for selected period"})]})})]})})]})]})]})})},pne=()=>{const[e,t]=y.useState(!1),[r,n]=y.useState(!1),[s,a]=y.useState(!1),[o,l]=y.useState(!1),[c,u]=y.useState(null),[d,f]=y.useState(null),[p,h]=y.useState(null),[g,m]=y.useState(null),[x,w]=y.useState(!1),[v,_]=y.useState(null),[b,S]=ke.useState(null),[T,N]=y.useState(!1),[C,E]=y.useState(null),[P,R]=y.useState(null),[j,M]=y.useState(!1),[A,I]=y.useState(!1),[X,Y]=y.useState([]),[z,U]=y.useState(null),{meetings:V=[],loading:F,fetchMeetings:D}=_l(),{attendanceRecords:G=[],loading:O,markAttendance:L,fetchAttendance:ie}=Qf(),{user:ne}=kt(),me=ua();St();const{members:pe}=f_();ke.useEffect(()=>{!F&&V.length===0&&D()},[F,V.length,D]),y.useEffect(()=>{typeof ie=="function"&&ie()},[]),y.useEffect(()=>{if(!ne)return;const B=new Date,ae=new Date(B.getTime()-24*60*60*1e3),de=V.filter(Q=>{if(!Q.start_time)return!1;const fe=new Date(Q.start_time);return fe<ae||fe>B?!1:!G.some(Ne=>Ne.meeting_id===Q.id&&Ne.user_id===ne.id)});de.length>0&&(Y(de),U(de[0]),I(!0))},[V,G,ne]),y.useMemo(()=>{let B=!1;if(!ne||F||O)return{thisMonthAttended:0,attendanceRate:0,pendingCheckIns:0};const ae=new Date,de=Mr(ae),Q=Ja(ae),fe=V.filter(ht=>{if(!ht.start_time)return B=!0,!1;try{const Ke=dm(ht.start_time);return Ke>=de&&Ke<=Q&&Ke<=ae}catch{return B=!0,!1}}),Ce=G.filter(ht=>ht.user_id===ne.id&&ht.attendance_status==="present"&&fe.some(Ke=>Ke.id===ht.meeting_id)),Ne=fe.length,Xe=Ce.length,it=Ne>0?Math.round(Xe/Ne*100):0,at=V.filter(ht=>{if(!ht.start_time||!ht.end_time)return B=!0,!1;try{const Ke=dm(ht.start_time),Bt=dm(ht.end_time),Te=new Date(Ke.getTime()-60*60*1e3),Re=ae>=Te&&ae<=Bt,tt=G.some(Dt=>Dt.meeting_id===ht.id&&Dt.user_id===ne.id);return Re&&!tt}catch{return B=!0,!1}}).length;return S(B?"Some meetings have invalid or missing date data and were skipped.":null),{thisMonthAttended:Xe,attendanceRate:it,pendingCheckIns:at}},[V,G,ne,F,O]);const xe=(B,ae,de)=>`${B||""} ${ae||""}`.trim()||de||"Unknown",Ae=B=>B||"Untitled",ge=B=>B?new Date(B).toLocaleDateString():"-",k=[...pe.map(B=>{var Ne;const ae=G.filter(Xe=>Xe.user_id===B.id&&Xe.attendance_status==="present"),de=V.length,Q=ae.length,fe=de>0?Math.round(Q/de*100):0,Ce=ae.length>0?(Ne=V.find(Xe=>Xe.id===ae[ae.length-1].meeting_id))==null?void 0:Ne.start_time:null;return{id:B.id,name:xe(B.first_name,B.last_name,B.email),email:B.email,totalMeetings:de,attendedCount:Q,attendancePercent:fe,lastAttended:Ce}})].sort((B,ae)=>B.name.localeCompare(ae.name)),le=V.map(B=>{const ae=Array.isArray(B.meeting_attendees)?B.meeting_attendees.map(Ne=>{var Xe,it,at,ht;return{user_id:Ne.user_id,email:((Xe=pe.find(Ke=>Ke.id===Ne.user_id))==null?void 0:Xe.email)||Ne.user_id,full_name:pe.find(Ke=>Ke.id===Ne.user_id)?xe((it=pe.find(Ke=>Ke.id===Ne.user_id))==null?void 0:it.first_name,(at=pe.find(Ke=>Ke.id===Ne.user_id))==null?void 0:at.last_name,(ht=pe.find(Ke=>Ke.id===Ne.user_id))==null?void 0:ht.email):Ne.user_id,isManual:!1}}):[],de=Array.isArray(B.manual_attendees)?B.manual_attendees.map(Ne=>({user_id:typeof Ne=="string"?Ne:Ne.email,email:typeof Ne=="string"?Ne:Ne.email,full_name:typeof Ne=="string"?Ne:Ne.email,isManual:!0})):[],Q=[...ae,...de],fe=Q.map(Ne=>{const Xe=G.find(it=>it.meeting_id===B.id&&(it.user_id===Ne.user_id||it.user_id===Ne.email));return{...Ne,attendance_status:Xe?Xe.attendance_status:null,attendance_type:Xe?Xe.attendance_type:null,notes:Xe?Xe.notes:""}}),Ce=fe.filter(Ne=>Ne.attendance_status==="present");return{id:B.id||"",name:Ae(B.title??""),date:B.start_time,totalInvited:Q.length,totalPresent:Ce.length,attendees:fe,meeting:B}}),ce=me.isAdmin||me.isSuperAdmin,H=ce?k:k.filter(B=>B.id===(ne==null?void 0:ne.id)),K=async(B,ae)=>{if(!z||!ne)return;await L({meetingId:z.id,userId:ne.id,status:B,type:"physical",notes:ae});const de=X.filter(Q=>Q.id!==z.id);Y(de),de.length>0?U(de[0]):I(!1)};if(F||O)return i.jsxs("div",{className:"flex flex-col items-center justify-center h-64 gap-4",children:[i.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary"}),i.jsx("div",{className:"text-muted-foreground",children:"Loading attendance data..."})]});if(V.length===0)return i.jsxs("div",{className:"flex flex-col items-center justify-center h-64 gap-4",children:[i.jsx(Wi,{className:"w-10 h-10 text-muted-foreground"}),i.jsx("div",{className:"text-lg font-semibold",children:"No meetings found"}),i.jsx("div",{className:"text-muted-foreground",children:"Meetings will appear here once scheduled."})]});const oe=()=>{if(!g)return;const B=V.map(Q=>{const fe=G.find(Ce=>Ce.user_id===g.id&&Ce.meeting_id===Q.id);return{Meeting:Ae(Q.title??""),Date:ge(Q.start_time),Status:fe?fe.attendance_status:"absent",Type:fe?fe.attendance_type:"",Notes:fe?fe.notes:""}}),ae=gs.json_to_sheet(B),de=gs.book_new();gs.book_append_sheet(de,ae,"Attendance"),fm(de,`${g.first_name||""}_${g.last_name||""}_attendance.xlsx`)},W=B=>{if(!B)return;const ae=B.attendees.map(fe=>({Meeting:B.name,Date:ge(B.date),Name:fe.full_name,Email:fe.email,Status:fe.attendance_status||"absent",Type:fe.attendance_type||"",Notes:fe.notes||""})),de=gs.json_to_sheet(ae),Q=gs.book_new();gs.book_append_sheet(Q,de,"Attendance"),fm(Q,`${B.name.replace(/\s+/g,"_")}_attendance.xlsx`)},J=()=>{const B=le.flatMap(Q=>Q.attendees.map(fe=>({Meeting:Q.name,Date:ge(Q.date),Name:fe.full_name,Email:fe.email,Status:fe.attendance_status||"absent",Type:fe.attendance_type||"",Notes:fe.notes||""}))),ae=gs.json_to_sheet(B),de=gs.book_new();gs.book_append_sheet(de,ae,"All Attendance"),fm(de,"all_meetings_attendance.xlsx")};return i.jsxs("div",{className:"w-full max-w-5xl mx-auto p-4",children:[b&&i.jsx("div",{className:"mb-4 text-sm text-yellow-700 bg-yellow-100 rounded px-3 py-2",children:b}),i.jsxs(bl,{defaultValue:"members",className:"w-full",children:[i.jsxs(So,{className:"mb-4",children:[i.jsx(Vn,{value:"members",children:"Member Attendance"}),i.jsx(Vn,{value:"meetings",children:"Meeting Attendance"})]}),i.jsx(zr,{value:"members",children:i.jsx("div",{className:"grid gap-4",children:H.length===0?i.jsx(Ye,{className:"flex flex-col items-center justify-center py-8",children:i.jsx("div",{className:"text-muted-foreground",children:"No members found."})}):H.map(B=>i.jsxs(Ye,{className:"hover:shadow-lg transition-shadow",children:[i.jsxs(ct,{className:"flex flex-row items-center justify-between gap-2",children:[i.jsxs("div",{children:[i.jsx(ft,{className:"text-lg",children:B.name}),i.jsx(tn,{children:B.email})]}),i.jsxs("div",{className:"flex gap-2 items-center",children:[i.jsxs(We,{variant:"outline",children:[B.attendancePercent,"%"]}),i.jsx(ue,{size:"icon",variant:"ghost","aria-label":"Expand Member",onClick:()=>h(p===B.id?null:B.id),children:p===B.id?i.jsx(h1,{}):i.jsx(Zc,{})})]})]}),p===B.id&&i.jsx(Je,{children:i.jsxs("div",{className:"flex flex-col gap-2",children:[i.jsxs("div",{className:"flex gap-4",children:[i.jsxs("div",{children:[i.jsx("span",{className:"font-semibold",children:"Total Meetings:"})," ",B.totalMeetings]}),i.jsxs("div",{children:[i.jsx("span",{className:"font-semibold",children:"Attended:"})," ",B.attendedCount]}),i.jsxs("div",{children:[i.jsx("span",{className:"font-semibold",children:"Last Attended:"})," ",ge(B.lastAttended)]})]}),i.jsx(ue,{size:"sm",variant:"outline","aria-label":"View Attendance History",onClick:()=>{const ae=pe.find(de=>de.id===B.id);m(ae||null),w(!0)},children:"View Attendance History"})]})})]},B.id))})}),i.jsxs(zr,{value:"meetings",children:[i.jsx("div",{className:"flex justify-end mb-2",children:i.jsx(ue,{size:"sm",variant:"outline",onClick:J,children:"Download All Meetings Attendance (Excel)"})}),i.jsx("div",{className:"grid gap-4",children:le.length===0?i.jsx(Ye,{className:"flex flex-col items-center justify-center py-8",children:i.jsx("div",{className:"text-muted-foreground",children:"No meetings found."})}):le.map(B=>i.jsxs(Ye,{className:"hover:shadow-lg transition-shadow",children:[i.jsxs(ct,{className:"flex flex-row items-center justify-between gap-2",children:[i.jsxs("div",{children:[i.jsx(ft,{className:"text-lg",children:B.name}),i.jsxs(tn,{children:["Date: ",ge(B.date)]})]}),i.jsxs("div",{className:"flex gap-2 items-center",children:[i.jsxs(We,{variant:"outline",children:[B.totalPresent,"/",B.totalInvited," Present"]}),i.jsx(ue,{size:"sm",variant:"outline",onClick:()=>W(B),children:"Download Excel"}),i.jsx(ue,{size:"icon",variant:"ghost","aria-label":"Details",onClick:()=>{E(B.meeting),N(!0)},children:i.jsx(nu,{children:i.jsxs(jf,{children:[i.jsx(Ef,{asChild:!0,children:i.jsx(Or,{})}),i.jsx(su,{children:"Details"})]})})})]})]}),d===B.id&&i.jsx(Je,{children:i.jsxs("div",{className:"flex flex-col gap-2",children:[i.jsx("div",{className:"flex gap-4 flex-wrap",children:me.canMarkAttendanceOnly&&i.jsx(ue,{size:"sm",variant:"outline",onClick:()=>{u(B.meeting),t(!0)},children:"Mark Attendance"})}),i.jsxs("div",{className:"mt-2",children:[i.jsx("div",{className:"font-semibold mb-1",children:"Attendees"}),i.jsx("div",{className:"overflow-x-auto",children:i.jsxs("table",{className:"min-w-full text-sm",children:[i.jsx("thead",{children:i.jsxs("tr",{children:[i.jsx("th",{scope:"col",className:"px-2 py-1 text-left",children:"Name"}),i.jsx("th",{scope:"col",className:"px-2 py-1 text-left",children:"Email"}),i.jsx("th",{scope:"col",className:"px-2 py-1",children:"Status"})]})}),i.jsx("tbody",{children:B.attendees.map((ae,de)=>i.jsxs("tr",{children:[i.jsx("td",{className:"px-2 py-1",children:ae.full_name}),i.jsx("td",{className:"px-2 py-1",children:ae.email}),i.jsxs("td",{className:"px-2 py-1 text-center",children:[ae.attendance_status==="present"?i.jsx("span",{className:"inline-block px-2 py-1 bg-green-100 text-green-800 rounded-full",children:"Present"}):i.jsx("span",{className:"inline-block px-2 py-1 bg-red-100 text-red-800 rounded-full",children:"Absent"}),ce&&i.jsx(ue,{size:"sm",variant:"ghost",className:"ml-2 px-2 py-0.5 text-xs",onClick:()=>{R({...ae,meetingId:B.id,attendance_status:ae.attendance_status||"present",attendance_type:ae.attendance_type||"physical",notes:ae.notes||""}),M(!0)},children:"Edit"})]})]},de))})]})})]})]})})]},B.id))})]})]}),i.jsx(hne,{open:e,onOpenChange:t}),i.jsx(mne,{open:s,onOpenChange:a}),i.jsx(Nt,{open:T,onOpenChange:N,children:i.jsxs(bt,{className:"max-w-xl min-w-[350px] w-full max-h-[70vh] flex flex-col overflow-y-auto p-4",children:[i.jsx(jt,{children:i.jsxs(Et,{children:["Meeting Details: ",C?Ae(C.title):""]})}),C&&i.jsxs(i.Fragment,{children:[i.jsxs("div",{className:"mb-2 text-sm text-muted-foreground",children:["Date: ",ge(C.start_time)]}),i.jsxs("div",{className:"mb-4",children:[i.jsx("div",{className:"font-semibold mb-1",children:"Attendees"}),i.jsx("div",{className:"overflow-x-auto rounded border",children:(()=>{const B=le.find(ae=>ae.id===C.id);return!B||B.attendees.length===0?i.jsx("div",{className:"text-muted-foreground p-2",children:"No attendees found."}):i.jsxs("table",{className:"min-w-full text-sm",children:[i.jsx("thead",{children:i.jsxs("tr",{children:[i.jsx("th",{scope:"col",className:"px-2 py-1 text-left",children:"Name"}),i.jsx("th",{scope:"col",className:"px-2 py-1 text-left",children:"Email"}),i.jsx("th",{scope:"col",className:"px-2 py-1",children:"Status"})]})}),i.jsx("tbody",{children:B.attendees.map((ae,de)=>i.jsxs("tr",{children:[i.jsx("td",{className:"px-2 py-1 whitespace-nowrap",children:ae.full_name}),i.jsx("td",{className:"px-2 py-1 whitespace-nowrap",children:ae.email}),i.jsxs("td",{className:"px-2 py-1 text-center",children:[ae.attendance_status==="present"?i.jsx("span",{className:"inline-block px-2 py-1 bg-green-100 text-green-800 rounded-full",children:"Present"}):ae.attendance_status==="late"?i.jsx("span",{className:"inline-block px-2 py-1 bg-yellow-100 text-yellow-800 rounded-full",children:"Late"}):ae.attendance_status==="absent"?i.jsx("span",{className:"inline-block px-2 py-1 bg-red-100 text-red-800 rounded-full",children:"Absent"}):i.jsx("span",{className:"inline-block px-2 py-1 bg-gray-100 text-gray-800 rounded-full",children:"Not Marked"}),ce&&i.jsx(ue,{size:"sm",variant:"ghost",className:"ml-2 px-2 py-0.5 text-xs",onClick:()=>{R({...ae,meetingId:C.id,attendance_status:ae.attendance_status||"present",attendance_type:ae.attendance_type||"physical",notes:ae.notes||""}),M(!0)},children:"Edit"})]})]},de))})]})})()})]})]}),i.jsx("div",{className:"flex justify-end mt-4",children:i.jsx(O2,{asChild:!0,children:i.jsx(ue,{size:"sm",variant:"ghost",children:"Close"})})})]})}),i.jsx(Nt,{open:x,onOpenChange:w,children:i.jsxs(bt,{className:"max-w-xl min-w-[350px] w-full max-h-[70vh] flex flex-col overflow-y-auto p-4",children:[i.jsxs(jt,{children:[i.jsxs(Et,{children:["Attendance History for ",g?xe(g.first_name,g.last_name,g.email):""]}),g&&i.jsx(ue,{size:"sm",variant:"outline",className:"ml-2",onClick:oe,children:"Download Excel"})]}),i.jsx("div",{className:"overflow-x-auto max-h-[50vh] px-2 rounded border",children:i.jsxs("table",{className:"min-w-full text-sm",children:[i.jsx("thead",{children:i.jsxs("tr",{children:[i.jsx("th",{className:"px-4 py-2 text-left",children:"Meeting"}),i.jsx("th",{className:"px-4 py-2",children:"Date"}),i.jsx("th",{className:"px-4 py-2",children:"Status"})]})}),i.jsx("tbody",{children:g&&V.map((B,ae)=>{const de=G.find(Q=>Q.user_id===g.id&&Q.meeting_id===B.id);return i.jsxs("tr",{children:[i.jsx("td",{className:"px-4 py-2 whitespace-nowrap",children:Ae(B.title)}),i.jsx("td",{className:"px-4 py-2 text-center whitespace-nowrap",children:ge(B.start_time)}),i.jsxs("td",{className:"px-4 py-2 text-center",children:[de&&de.attendance_status==="present"?i.jsx("span",{className:"inline-block px-2 py-1 bg-green-100 text-green-800 rounded-full",children:"Present"}):de&&de.attendance_status==="late"?i.jsx("span",{className:"inline-block px-2 py-1 bg-yellow-100 text-yellow-800 rounded-full",children:"Late"}):i.jsx("span",{className:"inline-block px-2 py-1 bg-red-100 text-red-800 rounded-full",children:"Absent"}),ce&&i.jsx(ue,{size:"sm",variant:"ghost",className:"ml-2 px-2 py-0.5 text-xs",onClick:()=>{R(de?{...de,meetingId:B.id}:{meetingId:B.id,user_id:g.id,attendance_status:"absent",attendance_type:"physical",notes:""}),M(!0)},children:"Edit"})]})]},ae)})})]})}),i.jsx("div",{className:"flex justify-end mt-4",children:i.jsx(O2,{asChild:!0,children:i.jsx(ue,{size:"sm",variant:"ghost",children:"Close"})})})]})}),j&&P&&i.jsx(Nt,{open:j,onOpenChange:M,children:i.jsxs(bt,{className:"max-w-md",children:[i.jsx(jt,{children:i.jsx(Et,{children:"Edit Attendance"})}),i.jsxs("form",{onSubmit:async B=>{B.preventDefault(),await L({meetingId:P.meetingId,userId:P.user_id,status:P.attendance_status,type:P.attendance_type||"physical",notes:P.notes||""}),M(!1)},className:"space-y-4",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block mb-1 font-medium",children:"Status"}),i.jsxs("select",{className:"w-full border rounded px-2 py-1",value:P.attendance_status,onChange:B=>R(ae=>({...ae,attendance_status:B.target.value})),children:[i.jsx("option",{value:"present",children:"Present"}),i.jsx("option",{value:"late",children:"Late"}),i.jsx("option",{value:"absent",children:"Absent"})]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block mb-1 font-medium",children:"Type"}),i.jsxs("select",{className:"w-full border rounded px-2 py-1",value:P.attendance_type||"physical",onChange:B=>R(ae=>({...ae,attendance_type:B.target.value})),children:[i.jsx("option",{value:"physical",children:"Physical"}),i.jsx("option",{value:"online",children:"Online"})]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block mb-1 font-medium",children:"Notes"}),i.jsx("textarea",{className:"w-full border rounded px-2 py-1",value:P.notes||"",onChange:B=>R(ae=>({...ae,notes:B.target.value}))})]}),i.jsxs("div",{className:"flex justify-end gap-2",children:[i.jsx(ue,{type:"button",variant:"outline",onClick:()=>M(!1),children:"Cancel"}),i.jsx(ue,{type:"submit",children:"Save"})]})]})]})}),A&&z&&i.jsx(Nt,{open:A,onOpenChange:()=>{},children:i.jsxs(bt,{className:"max-w-md",children:[i.jsxs(jt,{children:[i.jsx(Et,{children:"Mark Your Attendance"}),i.jsxs($t,{children:["Please mark your attendance for the meeting: ",i.jsx("b",{children:Ae(z.title)})," on ",ge(z.start_time)," before proceeding."]})]}),i.jsxs("form",{onSubmit:async B=>{B.preventDefault();const ae=B.target,de=ae.elements.namedItem("status").value,Q=ae.elements.namedItem("notes").value;await K(de,Q)},className:"space-y-4",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block mb-1 font-medium",children:"Status"}),i.jsxs("select",{name:"status",className:"w-full border rounded px-2 py-1",children:[i.jsx("option",{value:"present",children:"Present"}),i.jsx("option",{value:"late",children:"Late"}),i.jsx("option",{value:"absent",children:"Absent"})]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block mb-1 font-medium",children:"Notes"}),i.jsx("textarea",{name:"notes",className:"w-full border rounded px-2 py-1"})]}),i.jsx("div",{className:"flex justify-end gap-2",children:i.jsx(ue,{type:"submit",children:"Save"})})]})]})})]})},gne=()=>{const[e,t]=y.useState(!1),{user:r}=kt(),{toast:n}=St(),s=async(d,f)=>{t(!0);try{let p={};switch(d){case"meetings":const{data:h}=await he.from("meetings").select(`
              *,
              meeting_attendees(user_id, status),
              profiles!meetings_created_by_fkey(first_name, last_name)
            `).order("start_time",{ascending:!1});p=h||[];break;case"documents":const{data:g}=await he.from("documents").select(`
              *,
              profiles!documents_uploaded_by_fkey(first_name, last_name),
              document_views(view_started_at, time_spent_seconds)
            `).order("created_at",{ascending:!1});p=g||[];break;case"document_analytics":const{data:m}=await he.from("document_views").select(`
              *,
              documents(name, folder),
              profiles!document_views_user_id_fkey(first_name, last_name, email)
            `).order("view_started_at",{ascending:!1});p=m||[];break;case"voting":const{data:x}=await he.from("polls").select(`
              *,
              poll_votes(vote, voted_at),
              profiles!polls_created_by_fkey(first_name, last_name)
            `).order("created_at",{ascending:!1});p=x||[];break;case"comprehensive":const[w,v,_,b]=await Promise.all([he.from("meetings").select("*").order("start_time",{ascending:!1}),he.from("documents").select("*").order("created_at",{ascending:!1}),he.from("polls").select("*").order("created_at",{ascending:!1}),he.from("document_views").select(`
              *,
              documents(name, folder),
              profiles!document_views_user_id_fkey(first_name, last_name, email)
            `).order("view_started_at",{ascending:!1})]);p={meetings:w.data||[],documents:v.data||[],polls:_.data||[],document_analytics:b.data||[]};break}return p}catch(p){return console.error("Error generating report:",p),n({title:"Report Generation Failed",description:p.message||"Failed to generate report",variant:"destructive"}),null}finally{t(!1)}},a=(d,f)=>{if(!d.length){n({title:"No Data",description:"No data available to download",variant:"destructive"});return}const p=Object.keys(d[0]),h=[p.join(","),...d.map(w=>p.map(v=>{const _=w[v];return typeof _=="object"&&_!==null?`"${JSON.stringify(_).replace(/"/g,'""')}"`:`"${String(_||"").replace(/"/g,'""')}"`}).join(","))].join(`
`),g=new Blob([h],{type:"text/csv;charset=utf-8;"}),m=document.createElement("a"),x=URL.createObjectURL(g);m.setAttribute("href",x),m.setAttribute("download",`${f}.csv`),m.style.visibility="hidden",document.body.appendChild(m),m.click(),document.body.removeChild(m),n({title:"Success",description:`${f}.csv downloaded successfully`})},o=async(d,f)=>{const p=l(d,f),h=window.open("","_blank");h&&(h.document.write(p),h.document.close(),h.focus(),setTimeout(()=>{h.print()},500)),n({title:"PDF Report",description:"Print dialog opened. Choose 'Save as PDF' in print options."})},l=(d,f)=>{const p=new Date().toLocaleDateString();return`
      <!DOCTYPE html>
      <html>
        <head>
          <title>ISKCON Bureau Report - ${f}</title>
          <style>
            body { font-family: Arial, sans-serif; margin: 20px; }
            .header { text-align: center; margin-bottom: 30px; }
            .logo { max-width: 100px; margin: 0 auto 20px; }
            table { width: 100%; border-collapse: collapse; margin-top: 20px; }
            th, td { border: 1px solid #ddd; padding: 8px; text-align: left; }
            th { background-color: #f2f2f2; }
            .summary { background-color: #f9f9f9; padding: 15px; margin-bottom: 20px; }
          </style>
        </head>
        <body>
          <div class="header">
            <img src="/lovable-uploads/7ccf6269-31c1-46b9-bc5c-60b58a22c03e.png" alt="ISKCON Logo" class="logo">
            <h1>ISKCON Bureau Management</h1>
            <h2>${f.charAt(0).toUpperCase()+f.slice(1)} Report</h2>
            <p>Generated on: ${p}</p>
          </div>
          
          <div class="summary">
            <h3>Summary</h3>
            <p>Total Records: ${Array.isArray(d)?d.length:Object.values(d).reduce((h,g)=>h+(Array.isArray(g)?g.length:0),0)}</p>
          </div>
          
          ${c(d,f)}
        </body>
      </html>
    `},c=(d,f)=>f==="comprehensive"?Object.entries(d).map(([p,h])=>`
        <h3>${p.charAt(0).toUpperCase()+p.slice(1)}</h3>
        ${u(h)}
      `).join(""):u(d),u=d=>{if(!d.length)return"<p>No data available</p>";const f=Object.keys(d[0]);return`
      <table>
        <thead>
          <tr>
            ${f.map(p=>`<th>${p.replace(/_/g," ").toUpperCase()}</th>`).join("")}
          </tr>
        </thead>
        <tbody>
          ${d.map(p=>`
            <tr>
              ${f.map(h=>{const g=p[h];return typeof g=="object"&&g!==null?`<td>${JSON.stringify(g)}</td>`:`<td>${g||""}</td>`}).join("")}
            </tr>
          `).join("")}
        </tbody>
      </table>
    `};return{loading:e,generateReport:s,downloadCSV:a,downloadPDF:o}},xne=()=>{const[e,t]=y.useState(""),[r,n]=y.useState({}),[s,a]=y.useState(!1),[o,l]=y.useState(!1),{loading:c,generateReport:u,downloadCSV:d,downloadPDF:f}=gne(),p=[{value:"meetings",label:"Meetings Report",icon:en},{value:"documents",label:"Documents Report",icon:tr},{value:"document_analytics",label:"Document Analytics Report",icon:Or},{value:"voting",label:"Voting Report",icon:Wi},{value:"members",label:"Members Report",icon:mr},{value:"comprehensive",label:"Comprehensive Report",icon:tr}],h=async g=>{if(!e){alert("Please select a report type");return}const m=await u(e,r.start&&r.end?r:void 0);if(m)if(g==="csv"){const x=`${e}_report_${new Date().toISOString().split("T")[0]}`;Array.isArray(m)?d(m,x):Object.entries(m).forEach(([w,v])=>{d(v,`${w}_${x}`)})}else f(m,e)};return i.jsxs("div",{className:"space-y-6",children:[i.jsxs("div",{children:[i.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"Reports & Analytics"}),i.jsx("p",{className:"text-gray-600",children:"Generate and download comprehensive reports"})]}),i.jsxs(Ye,{children:[i.jsxs(ct,{children:[i.jsx(ft,{children:"Generate Report"}),i.jsx(tn,{children:"Select the type of report you want to generate and download"})]}),i.jsxs(Je,{className:"space-y-4",children:[i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[i.jsxs("div",{children:[i.jsx("label",{className:"text-sm font-medium mb-2 block",children:"Report Type"}),i.jsxs(oa,{value:e,onValueChange:t,children:[i.jsx(As,{children:i.jsx(la,{placeholder:"Select report type"})}),i.jsx(Ps,{children:p.map(g=>i.jsx(zt,{value:g.value,children:i.jsxs("div",{className:"flex items-center space-x-2",children:[i.jsx(g.icon,{className:"h-4 w-4"}),i.jsx("span",{children:g.label})]})},g.value))})]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"text-sm font-medium mb-2 block",children:"Start Date (Optional)"}),i.jsxs(nf,{open:s,onOpenChange:a,children:[i.jsx(sf,{asChild:!0,children:i.jsxs(ue,{variant:"outline",className:"w-full justify-start text-left font-normal",children:[i.jsx(en,{className:"mr-2 h-4 w-4"}),r.start?vt(r.start,"PPP"):"Pick start date"]})}),i.jsx(Gc,{className:"w-auto p-0",children:i.jsx(rf,{mode:"single",selected:r.start,onSelect:g=>{n(m=>({...m,start:g})),a(!1)},initialFocus:!0})})]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"text-sm font-medium mb-2 block",children:"End Date (Optional)"}),i.jsxs(nf,{open:o,onOpenChange:l,children:[i.jsx(sf,{asChild:!0,children:i.jsxs(ue,{variant:"outline",className:"w-full justify-start text-left font-normal",children:[i.jsx(en,{className:"mr-2 h-4 w-4"}),r.end?vt(r.end,"PPP"):"Pick end date"]})}),i.jsx(Gc,{className:"w-auto p-0",children:i.jsx(rf,{mode:"single",selected:r.end,onSelect:g=>{n(m=>({...m,end:g})),l(!1)},initialFocus:!0})})]})]})]}),i.jsxs("div",{className:"flex space-x-4",children:[i.jsxs(ue,{onClick:()=>h("csv"),disabled:!e||c,className:"flex items-center space-x-2",children:[i.jsx(js,{className:"h-4 w-4"}),i.jsx("span",{children:"Download CSV"})]}),i.jsxs(ue,{onClick:()=>h("pdf"),disabled:!e||c,variant:"outline",className:"flex items-center space-x-2",children:[i.jsx(tr,{className:"h-4 w-4"}),i.jsx("span",{children:"Download PDF"})]})]})]})]}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6",children:[i.jsx(Ye,{children:i.jsx(Je,{className:"p-6",children:i.jsxs("div",{className:"flex items-center space-x-2",children:[i.jsx(en,{className:"h-8 w-8 text-blue-600"}),i.jsxs("div",{children:[i.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Total Meetings"}),i.jsx("p",{className:"text-2xl font-bold",children:"24"})]})]})})}),i.jsx(Ye,{children:i.jsx(Je,{className:"p-6",children:i.jsxs("div",{className:"flex items-center space-x-2",children:[i.jsx(tr,{className:"h-8 w-8 text-green-600"}),i.jsxs("div",{children:[i.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Documents"}),i.jsx("p",{className:"text-2xl font-bold",children:"156"})]})]})})}),i.jsx(Ye,{children:i.jsx(Je,{className:"p-6",children:i.jsxs("div",{className:"flex items-center space-x-2",children:[i.jsx(Or,{className:"h-8 w-8 text-purple-600"}),i.jsxs("div",{children:[i.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Document Views"}),i.jsx("p",{className:"text-2xl font-bold",children:"1,024"})]})]})})}),i.jsx(Ye,{children:i.jsx(Je,{className:"p-6",children:i.jsxs("div",{className:"flex items-center space-x-2",children:[i.jsx(mr,{className:"h-8 w-8 text-orange-600"}),i.jsxs("div",{children:[i.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Members"}),i.jsx("p",{className:"text-2xl font-bold",children:"42"})]})]})})})]})]})},vne=()=>{const[e,t]=y.useState(!1),[r,n]=y.useState(null),[s,a]=y.useState("prompt"),[o,l]=y.useState(!1),[c,u]=y.useState(!1),{user:d}=kt(),f=()=>{const v=typeof window<"u"&&window.Capacitor&&window.Capacitor.isNative===!0,_=typeof navigator<"u"&&/Android|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent),b=v||_;return l(b),console.log("Platform detected:",b?"Native/Mobile":"Web"),b},p=()=>(console.log("Checking web push support..."),typeof window>"u"||typeof navigator>"u"?(console.log("Window or navigator not available"),!1):"serviceWorker"in navigator?"PushManager"in window?"Notification"in window?(console.log("Web push is supported"),!0):(console.log("Notification API not supported"),!1):(console.log("Push Manager not supported"),!1):(console.log("Service Worker not supported"),!1)),h=async()=>{if(o)try{const{PushNotifications:v}=await no(async()=>{const{PushNotifications:b}=await import("./index-cAwRCpH1.js");return{PushNotifications:b}},[]),_=await v.checkPermissions();return console.log("Native permission status:",_.receive),_.receive}catch(v){return console.log("Error checking native permissions:",v),"prompt"}else{if(typeof window>"u"||!("Notification"in window))return"denied";const v=Notification.permission;return console.log("Web notification permission:",v),v}},g=async()=>{try{console.log("Initializing native push notifications...");const{PushNotifications:v}=await no(async()=>{const{PushNotifications:b}=await import("./index-cAwRCpH1.js");return{PushNotifications:b}},[]);t(!0);const _=await h();a(_),_==="granted"&&(await v.register(),v.addListener("registration",async b=>{console.log("Native push registration success:",b.value),n(b.value),d&&b.value&&await x(b.value)}),v.addListener("registrationError",b=>{console.error("Native push registration error:",b),t(!1)}),v.addListener("pushNotificationReceived",b=>{console.log("Push received:",b),gt.success(b.title||"New notification",{description:b.body})}),v.addListener("pushNotificationActionPerformed",b=>{console.log("Push action performed:",b);const S=b.notification.data;S!=null&&S.module&&(window.location.hash=`#/${S.module}${S.id?`/${S.id}`:""}`)}))}catch(v){console.log("Native push notifications not available:",v),p()?await m():t(!1)}},m=async()=>{try{console.log("Initializing web push notifications...");const v=p();if(t(v),!v)return;const _=await h();if(a(_),!o)try{const b=await navigator.serviceWorker.register("/sw.js");if(console.log("Service Worker registered for web"),_==="granted"){const S=`web-${Date.now()}`;n(S),d&&await x(S)}}catch(b){console.log("Service Worker registration failed:",b)}}catch(v){console.error("Web push initialization error:",v),t(!1)}},x=async v=>{try{const{error:_}=await he.from("profiles").update({push_token:v,updated_at:new Date().toISOString()}).eq("id",d==null?void 0:d.id);if(_)throw _;console.log("Push token saved successfully")}catch(_){console.error("Error saving push token:",_)}},w=async()=>{u(!0);try{if(console.log("Requesting notification permission..."),o){const{PushNotifications:v}=await no(async()=>{const{PushNotifications:b}=await import("./index-cAwRCpH1.js");return{PushNotifications:b}},[]),_=await v.requestPermissions();console.log("Native permission result:",_),a(_.receive),_.receive==="granted"?(await v.register(),gt.success("Push notifications enabled!"),await g()):gt.error("Push notifications permission denied")}else if("Notification"in window){const v=await Notification.requestPermission();console.log("Web permission result:",v),a(v),v==="granted"?(gt.success("Push notifications enabled!"),await m()):gt.error("Push notifications permission denied")}else gt.error("Notifications not supported in this browser")}catch(v){console.error("Permission request error:",v),gt.error("Failed to request notification permission")}finally{u(!1)}};return y.useEffect(()=>{if(d){const v=setTimeout(async()=>{const _=f(),b=await h();a(b),_?await g():await m()},1e3);return()=>clearTimeout(v)}},[d]),{isSupported:e,token:r,permissionStatus:s,requestPermission:w,isNative:o,isLoading:c}},yne=()=>{const{isSupported:e,permissionStatus:t,requestPermission:r,isNative:n,isLoading:s}=vne(),a=()=>{if(s)return i.jsx(Dg,{className:"h-4 w-4 animate-spin text-gray-400"});switch(t){case"granted":return i.jsx(Bo,{className:"h-4 w-4 text-green-500"});case"denied":return i.jsx(ea,{className:"h-4 w-4 text-red-500"});case"prompt-with-rationale":return i.jsx(ea,{className:"h-4 w-4 text-yellow-500"});default:return i.jsx(Bo,{className:"h-4 w-4 text-gray-400"})}},o=()=>{if(s)return i.jsx(We,{variant:"secondary",children:"Checking..."});switch(t){case"granted":return i.jsx(We,{className:"bg-green-100 text-green-800",children:"Enabled"});case"denied":return i.jsx(We,{variant:"destructive",children:"Disabled"});case"prompt-with-rationale":return i.jsx(We,{variant:"secondary",children:"Needs Permission"});default:return i.jsx(We,{variant:"secondary",children:"Not Set"})}},l=()=>n?i.jsx(DF,{className:"h-4 w-4"}):i.jsx(TF,{className:"h-4 w-4"}),c=()=>i.jsx(We,{variant:"outline",className:"ml-2",children:n?"Mobile App":"Web Browser"}),u=t==="granted",d=t!=="granted"&&e&&!s,f=()=>e?t==="denied"?n?"Notifications are blocked. Please enable them in your device Settings > Apps > ISKCON Management Portal > Notifications.":"Please enable notifications in your browser settings to receive important updates.":t==="prompt-with-rationale"?"This app needs permission to send you important notifications about meetings, votes, and documents.":null:n?"Push notifications are not available on this device. Please check your device settings.":"Your browser does not support web push notifications. Try using Chrome, Firefox, or Edge.",p=()=>{alert(n?"Please go to your device Settings > Apps > ISKCON Management Portal > Notifications and enable them manually.":"Please click on the lock icon in your browser address bar and enable notifications.")};return i.jsxs("div",{className:"space-y-6",children:[i.jsxs("div",{children:[i.jsx("h3",{className:"text-lg font-semibold mb-2",children:"Notification Settings"}),i.jsx("p",{className:"text-sm text-gray-600",children:"Configure how you want to receive notifications from the ISKCON Bureau Management Portal"})]}),i.jsxs(Ye,{children:[i.jsxs(ct,{children:[i.jsxs(ft,{className:"flex items-center space-x-2",children:[l(),i.jsx("span",{children:"Push Notifications"}),o(),c()]}),i.jsxs(tn,{children:["Receive instant notifications for meetings, voting, documents, and other important updates",!e&&i.jsx("span",{className:"block mt-2 text-red-600 font-medium",children:"Push notifications are not supported on this platform"})]})]}),i.jsxs(Je,{className:"space-y-4",children:[i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsxs("div",{className:"flex items-center space-x-2",children:[a(),i.jsx(Ve,{children:"Push Notifications"}),e&&i.jsx(We,{variant:"outline",className:"text-xs",children:n?"Native":"Web Push"})]}),i.jsxs("div",{className:"flex items-center space-x-2",children:[d&&i.jsx(ue,{onClick:r,size:"sm",className:"bg-primary hover:bg-primary/90",disabled:s,children:s?i.jsxs(i.Fragment,{children:[i.jsx(Dg,{className:"h-4 w-4 mr-2 animate-spin"}),"Requesting..."]}):"Enable Notifications"}),!e&&i.jsx(We,{variant:"outline",className:"text-red-600",children:"Not Supported"})]})]}),!e&&i.jsx("div",{className:"p-4 bg-yellow-50 border border-yellow-200 rounded-lg",children:i.jsxs("div",{className:"flex items-start space-x-2",children:[i.jsx($F,{className:"h-5 w-5 text-yellow-500 mt-0.5"}),i.jsxs("div",{children:[i.jsx("p",{className:"text-sm font-medium text-yellow-800",children:"Platform Not Supported"}),i.jsx("p",{className:"text-sm text-yellow-700 mt-1",children:f()})]})]})}),u&&i.jsxs("div",{className:"space-y-3 pl-6 border-l-2 border-green-200",children:[i.jsx("p",{className:"text-sm text-green-600 font-medium",children:" Notifications are enabled and working!"}),i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsx(Ve,{htmlFor:"meeting-notifications",children:"Meeting Notifications"}),i.jsx(ws,{id:"meeting-notifications",defaultChecked:!0})]}),i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsx(Ve,{htmlFor:"voting-notifications",children:"Voting & Poll Notifications"}),i.jsx(ws,{id:"voting-notifications",defaultChecked:!0})]}),i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsx(Ve,{htmlFor:"document-notifications",children:"Document Notifications"}),i.jsx(ws,{id:"document-notifications",defaultChecked:!0})]}),i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsx(Ve,{htmlFor:"email-notifications",children:"Email Notifications"}),i.jsx(ws,{id:"email-notifications",defaultChecked:!0})]})]}),(t==="denied"||t==="prompt-with-rationale")&&e&&i.jsx("div",{className:"p-4 bg-red-50 border border-red-200 rounded-lg",children:i.jsxs("div",{className:"flex items-start space-x-2",children:[i.jsx(ea,{className:"h-5 w-5 text-red-500 mt-0.5"}),i.jsxs("div",{children:[i.jsx("p",{className:"text-sm font-medium text-red-800",children:t==="denied"?"Notifications Blocked":"Permission Required"}),i.jsx("p",{className:"text-sm text-red-600 mt-1",children:f()}),i.jsxs("div",{className:"flex gap-2 mt-2",children:[i.jsx(ue,{onClick:r,size:"sm",variant:"outline",className:"border-red-300 text-red-700 hover:bg-red-50",disabled:s,children:s?i.jsxs(i.Fragment,{children:[i.jsx(Dg,{className:"h-4 w-4 mr-2 animate-spin"}),"Trying..."]}):t==="denied"?"Try Again":"Grant Permission"}),t==="denied"&&n&&i.jsxs(ue,{onClick:p,size:"sm",variant:"outline",className:"border-blue-300 text-blue-700 hover:bg-blue-50",children:[i.jsx(bf,{className:"h-4 w-4 mr-2"}),"Device Settings"]})]})]})]})})]})]}),i.jsxs(Ye,{children:[i.jsxs(ct,{children:[i.jsxs(ft,{className:"flex items-center space-x-2",children:[i.jsx(_F,{className:"h-5 w-5"}),i.jsx("span",{children:"In-App Notifications"}),i.jsx(We,{className:"bg-blue-100 text-blue-800",children:"Always On"})]}),i.jsx(tn,{children:"Notifications that appear within the application interface"})]}),i.jsxs(Je,{className:"space-y-3",children:[i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsx(Ve,{children:"Toast Notifications"}),i.jsx(ws,{defaultChecked:!0,disabled:!0})]}),i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsx(Ve,{children:"Notification Bell"}),i.jsx(ws,{defaultChecked:!0,disabled:!0})]}),i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsx(Ve,{children:"Sound Alerts"}),i.jsx(ws,{defaultChecked:!0})]})]})]})]})},wne=({currentImageUrl:e,onImageUpdate:t})=>{const{user:r}=kt(),{toast:n}=St(),[s,a]=y.useState(!1),[o,l]=y.useState(0),c=e,u=async d=>{var h;const f=(h=d.target.files)==null?void 0:h[0];if(!f||!r)return;if(!["image/png","image/jpeg","image/jpg"].includes(f.type)){n({title:"Invalid File Type",description:"Only PNG and JPEG images are supported.",variant:"destructive"});return}if(f.size>5*1024*1024){n({title:"File Too Large",description:"Please select an image smaller than 5MB.",variant:"destructive"});return}a(!0);try{const g=f.name.split(".").pop(),m=`${r.id}/profile.${g}`,{error:x}=await he.storage.from("profile-images").upload(m,f,{upsert:!0});if(x)throw x;const{data:{publicUrl:w}}=he.storage.from("profile-images").getPublicUrl(m),v=`${w}?t=${Date.now()}`,{error:_}=await he.from("profiles").upsert({id:r.id,avatar_url:v,updated_at:new Date().toISOString()});if(_)throw _;l(b=>b+1),t(v),setTimeout(()=>{const b={profile:{avatar_url:v},userId:r.id};console.log("Dispatching profile update event:",b),window.dispatchEvent(new CustomEvent("profileUpdated",{detail:b})),window.dispatchEvent(new CustomEvent("avatarUpdated",{detail:{avatarUrl:v,userId:r.id}}))},200),n({title:"Profile Image Updated",description:"Your profile image has been updated successfully."})}catch(g){console.error("Image upload error:",g),n({title:"Upload Failed",description:g.message||"Failed to upload profile image",variant:"destructive"})}finally{a(!1)}};return i.jsx("div",{className:"space-y-4",children:i.jsxs("div",{className:"flex items-center space-x-6",children:[i.jsx("div",{className:"w-24 h-24 bg-gray-100 rounded-full flex items-center justify-center overflow-hidden",children:c?i.jsx("img",{src:`${c}${c.includes("?")?"&":"?"}v=${o}`,alt:"Profile",className:"w-full h-full object-cover"},o):i.jsx(lo,{className:"h-12 w-12 text-gray-400"})}),i.jsxs("div",{className:"flex-1",children:[i.jsx("input",{type:"file",accept:"image/png,image/jpeg,image/jpg",onChange:u,className:"hidden",id:"profile-image-upload"}),i.jsx("label",{htmlFor:"profile-image-upload",children:i.jsx(ue,{variant:"outline",disabled:s,asChild:!0,children:i.jsxs("span",{className:"cursor-pointer",children:[i.jsx(g1,{className:"h-4 w-4 mr-2"}),s?"Uploading...":"Upload Image"]})})}),i.jsx("p",{className:"text-sm text-gray-500 mt-2",children:"Recommended: Square image, at least 200x200 pixels (PNG, JPEG only, max 5MB)"})]})]})})},iN=()=>{const{isConnected:e,isExpired:t,loading:r,disconnectMicrosoft:n,forceRefresh:s,lastError:a}=cu(),{toast:o}=St(),l=()=>r?{icon:os,color:"bg-blue-100 text-blue-800 border-blue-200",text:"Checking...",description:"Verifying Microsoft 365 connection"}:e&&!t?{icon:as,color:"bg-green-100 text-green-800 border-green-200",text:"Microsoft 365 Connected",description:"Microsoft 365 services are available and tokens are automatically refreshed"}:t||a&&(a.includes("invalid_grant")||a.includes("AADSTS50173")||a.includes("expired"))?{icon:ea,color:"bg-red-100 text-red-800 border-red-200",text:"Authentication Expired",description:"Microsoft account authentication has expired. This usually happens after a password change, security policy update, or when tokens are revoked. Please disconnect and reconnect your account."}:a?{icon:ro,color:"bg-red-100 text-red-800 border-red-200",text:"Connection Error",description:a}:{icon:ro,color:"bg-gray-100 text-gray-800 border-gray-200",text:"Not Connected",description:"Connect your Microsoft account in Settings to access Outlook, Teams, and SharePoint"},c=()=>{s(),o({title:"Refreshing Connection",description:"Checking and refreshing Microsoft 365 connection..."})},u=async()=>{await n(),o({title:"Microsoft Account Disconnected",description:"You can now reconnect with fresh authentication credentials.",variant:"default"})},d=()=>{const g=new CustomEvent("navigate-to-module",{detail:{module:"settings"}});window.dispatchEvent(g),o({title:"Go to Settings",description:"Navigate to Settings  Integrations to reconnect your Microsoft account."})},f=l(),p=f.icon,h=t||a&&(a.includes("invalid_grant")||a.includes("AADSTS50173")||a.includes("expired"));return i.jsx(nu,{children:i.jsxs(jf,{children:[i.jsx(Ef,{asChild:!0,children:i.jsxs("div",{className:"flex items-center space-x-2",children:[i.jsxs(We,{variant:"outline",className:`${f.color} border flex items-center space-x-1 px-2 py-1`,children:[i.jsx(p,{className:`h-3 w-3 ${r?"animate-spin":""}`}),i.jsx("span",{className:"text-xs font-medium",children:f.text})]}),!r&&i.jsx("div",{className:"flex items-center space-x-1",children:h?i.jsxs(i.Fragment,{children:[i.jsxs(ue,{variant:"ghost",size:"sm",onClick:u,className:"h-6 px-2 text-red-600 hover:text-red-700 hover:bg-red-50",children:[i.jsx(Pb,{className:"h-3 w-3 mr-1"}),i.jsx("span",{className:"text-xs",children:"Disconnect"})]}),i.jsxs(ue,{variant:"ghost",size:"sm",onClick:d,className:"h-6 px-2 text-blue-600 hover:text-blue-700 hover:bg-blue-50",children:[i.jsx(Ta,{className:"h-3 w-3 mr-1"}),i.jsx("span",{className:"text-xs",children:"Reconnect"})]})]}):i.jsxs(i.Fragment,{children:[!h&&i.jsx(ue,{variant:"ghost",size:"sm",onClick:c,className:"h-6 w-6 p-0",children:i.jsx(os,{className:"h-3 w-3"})}),(e||a)&&i.jsx(ue,{variant:"ghost",size:"sm",onClick:u,className:"h-6 w-6 p-0 text-red-600 hover:text-red-700",children:i.jsx(Pb,{className:"h-3 w-3"})})]})})]})}),i.jsx(su,{children:i.jsxs("div",{className:"max-w-xs",children:[i.jsx("p",{className:"text-sm mb-2",children:f.description}),!e&&!h&&i.jsx("p",{className:"text-xs text-muted-foreground",children:"Go to Settings  Integrations to connect"}),h&&i.jsxs("div",{className:"space-y-2",children:[i.jsxs("div",{className:"p-2 bg-red-50 rounded border border-red-200",children:[i.jsx("p",{className:"text-xs text-red-800 font-medium mb-1",children:" Action Required: Reconnect Microsoft Account"}),i.jsxs("div",{className:"space-y-1",children:[i.jsx("p",{className:"text-xs text-red-700",children:i.jsx("strong",{children:"Quick Fix:"})}),i.jsxs("p",{className:"text-xs text-red-600",children:['1. Click "Disconnect" button above',i.jsx("br",{}),'2. Click "Reconnect" to go to Settings',i.jsx("br",{}),'3. Click "Connect Microsoft 365" again',i.jsx("br",{}),"4. Sign in with admin@iskconbureau.in"]})]})]}),i.jsx("p",{className:"text-xs text-muted-foreground",children:"This happens when passwords change or tokens are revoked by Microsoft security policies."})]})]})})]})})},_ne=({onSuccess:e})=>{const[t,r]=y.useState(!1),{toast:n}=St(),{user:s}=kt(),{isConnected:a,disconnectMicrosoft:o,canAttemptConnection:l}=cu(),c=async()=>{try{return(await fetch(window.location.origin+"/favicon.ico",{method:"HEAD",cache:"no-cache"})).ok}catch{return!1}},u=y.useCallback(async()=>{if(!s){n({title:"Authentication Required",description:"Please sign in first before connecting your Microsoft account.",variant:"destructive"});return}if(!l){n({title:"Rate Limited",description:"Too many connection attempts. Please wait before trying again.",variant:"destructive"});return}r(!0);try{if(!await c()){n({title:"Network Connection Error",description:"Unable to connect to the internet. Please check your network connection and try again.",variant:"destructive"}),r(!1);return}try{localStorage.removeItem("microsoft_auth_error"),localStorage.removeItem("microsoft_auth_last_error"),sessionStorage.removeItem("microsoft_auth_user_id"),sessionStorage.removeItem("microsoft_auth_nonce"),sessionStorage.removeItem("microsoft_auth_timestamp")}catch(C){console.warn("Storage cleanup warning:",C)}const f="44391516-babe-4072-8422-a4fc8a79fbde",p="b2333ef6-3378-4d02-b9b9-d8e66d9dfa3d",h=window.location.origin,g=`${h}/microsoft/callback`,m=s.id,x=Math.random().toString(36).substring(2,15)+Math.random().toString(36).substring(2,15);console.log("Microsoft OAuth Configuration:",{clientId:f,tenantId:p,baseUrl:h,redirectUri:g,userId:m,timestamp:new Date().toISOString()});try{const C=await fetch(g,{method:"HEAD",cache:"no-cache"});if(!C.ok&&C.status!==404){n({title:"Configuration Error",description:"The redirect URL is not accessible. This may be a temporary network issue.",variant:"destructive"}),r(!1);return}}catch{n({title:"Network Error",description:"Unable to verify redirect URL. Please check your internet connection.",variant:"destructive"}),r(!1);return}try{sessionStorage.setItem("microsoft_auth_user_id",m),sessionStorage.setItem("microsoft_auth_nonce",x),sessionStorage.setItem("microsoft_auth_timestamp",Date.now().toString())}catch(C){console.error("Session storage error:",C),n({title:"Storage Error",description:"Unable to store session data. Please enable cookies and try again.",variant:"destructive"}),r(!1);return}const w=["openid","profile","email","offline_access","https://graph.microsoft.com/User.Read","https://graph.microsoft.com/Mail.ReadWrite","https://graph.microsoft.com/Calendars.ReadWrite","https://graph.microsoft.com/Files.ReadWrite.All"].join(" "),v=new URLSearchParams({client_id:f,response_type:"code",redirect_uri:g,scope:w,response_mode:"query",state:m,nonce:x,prompt:"consent",access_type:"offline"}),_=`https://login.microsoftonline.com/${p}/oauth2/v2.0/authorize?${v.toString()}`;console.log("Opening Microsoft OAuth in new window with tenant-specific endpoint...");const b=window.open(_,"microsoft-auth","width=500,height=600,scrollbars=yes,resizable=yes");if(!b){n({title:"Popup Blocked",description:"Please allow popups for this site and try again. You may need to disable ad blockers.",variant:"destructive"}),r(!1);return}let S,T;const N=()=>{S&&clearInterval(S),T&&clearInterval(T)};S=setInterval(()=>{try{b.closed&&(N(),r(!1),setTimeout(()=>{window.location.reload()},1e3))}catch(C){console.warn("Popup monitoring error:",C)}},1e3),T=setInterval(async()=>{await c()||(b.closed||b.close(),N(),r(!1),n({title:"Network Connection Lost",description:"Network connection was lost during authentication. Please check your connection and try again.",variant:"destructive"}))},5e3),setTimeout(()=>{b.closed||(b.close(),N(),r(!1),n({title:"Authentication Timeout",description:"Microsoft authentication took too long. This may be due to network issues. Please try again.",variant:"destructive"}))},5*60*1e3)}catch(d){console.error("Microsoft OAuth initialization error:",d),r(!1);let f=`Failed to initialize Microsoft connection: ${d.message}`;d.message.includes("NetworkError")||d.message.includes("ERR_NAME_NOT_RESOLVED")?f="Network connection error. Please check your internet connection and try again.":d.message.includes("popup")&&(f="Popup was blocked. Please allow popups for this site and try again."),n({title:"Connection Failed",description:f,variant:"destructive"})}},[s,n,l]);return y.useEffect(()=>{a&&e&&(console.log("Microsoft connected, calling onSuccess"),e())},[a,e]),y.useEffect(()=>{(a||!l)&&r(!1)},[a,l]),a?i.jsxs("div",{className:"space-y-4",children:[i.jsx(iN,{}),i.jsxs("div",{className:"p-4 bg-green-50 rounded-lg border border-green-200",children:[i.jsx("h4",{className:"font-medium text-green-800 mb-2",children:"Microsoft 365 Connected"}),i.jsx("p",{className:"text-sm text-green-700 mb-3",children:"Your Microsoft account is connected. You can now access Outlook, Teams, and SharePoint features."}),i.jsx(ue,{onClick:o,variant:"outline",className:"text-red-600 border-red-200 hover:bg-red-50",children:"Disconnect Microsoft Account"})]})]}):i.jsxs("div",{className:"space-y-4",children:[i.jsx(iN,{}),!l&&i.jsx("div",{className:"p-3 bg-yellow-50 rounded-lg border border-yellow-200",children:i.jsx("p",{className:"text-sm text-yellow-800",children:"Connection rate limited. Please wait before trying again."})}),i.jsxs("div",{className:"p-3 bg-blue-50 rounded-lg border border-blue-200",children:[i.jsx("h4",{className:"font-medium text-blue-800 mb-2",children:"Connection Tips:"}),i.jsxs("ul",{className:"text-sm text-blue-700 space-y-1",children:[i.jsx("li",{children:" Ensure you have a stable internet connection"}),i.jsx("li",{children:" Make sure popups are allowed for this site"}),i.jsx("li",{children:" Use admin@iskconbureau.in when prompted"}),i.jsx("li",{children:" Try disabling ad blockers if issues persist"}),i.jsx("li",{children:" Clear browser cache if connection fails"})]})]}),i.jsx(ue,{onClick:u,disabled:t||!l,className:"w-full bg-blue-600 hover:bg-blue-700 text-white",children:t?i.jsxs("div",{className:"flex items-center space-x-2",children:[i.jsx("div",{className:"animate-spin h-4 w-4 border-2 border-white border-t-transparent rounded-full"}),i.jsx("span",{children:"Connecting to Microsoft..."})]}):i.jsxs("div",{className:"flex items-center space-x-2",children:[i.jsx("svg",{className:"w-5 h-5",viewBox:"0 0 24 24",fill:"currentColor",children:i.jsx("path",{d:"M11.4 24H0V12.6h11.4V24zM24 24H12.6V12.6H24V24zM11.4 11.4H0V0h11.4v11.4zM24 11.4H12.6V0H24v11.4z"})}),i.jsx("span",{children:"Connect Microsoft 365"})]})})]})};var oN={};const bne=[{value:"profile",label:"Profile"},{value:"integrations",label:"Integrations"},{value:"notifications",label:"Notifications"},{value:"auto-refresh",label:"Auto-Refresh"},{value:"backup",label:"Backup & Restore"}],Sne=()=>{const{user:e,session:t}=kt(),{profile:r,updateProfile:n,refreshProfile:s}=Df(),{toast:a}=St(),[o,l]=y.useState(!1),[c,u]=y.useState(""),[d,f]=y.useState({first_name:"",last_name:"",phone:""}),[p,h]=y.useState({pollsEnabled:!0,pollsInterval:5,outlookSyncEnabled:!0,outlookSyncInterval:10,transcriptEnabled:!0,transcriptInterval:15}),[g,m]=y.useState("profile"),{isAdmin:x,isSuperAdmin:w}=ua(),v=bne.filter(C=>C.value==="auto-refresh"?x||w:C.value!=="backup"),_=y.useCallback(()=>{r&&(f({first_name:r.first_name||"",last_name:r.last_name||"",phone:r.phone||""}),u(r.avatar_url||""))},[r]);y.useEffect(()=>{_()},[_]);const b=async()=>{try{await n(d),l(!1)}catch(C){console.error("Error saving profile:",C)}},S=()=>{_(),l(!1)},T=y.useCallback(C=>{console.log("Image updated in settings:",C),u(C);const E=setTimeout(()=>{s()},500);return()=>clearTimeout(E)},[s]),N=async()=>{if(!e||!t){a({title:"Error",description:"You must be logged in to download a backup.",variant:"destructive"}),console.error("No user or session:",{user:e,session:t});return}try{const C=t.access_token;if(console.log("Session:",t),console.log("Access Token:",C),!C){a({title:"Error",description:"No access token found.",variant:"destructive"}),console.error("No access token in session:",t);return}const E=await fetch(`${oN.NEXT_PUBLIC_SUPABASE_URL}/functions/v1/export-backup`,{method:"POST",headers:{Authorization:`Bearer ${C}`,apikey:oN.NEXT_PUBLIC_SUPABASE_ANON_KEY||"","Content-Type":"application/json"}});if(!E.ok){a({title:"Error",description:"Failed to download backup.",variant:"destructive"}),console.error("Backup fetch failed:",E.status,await E.text());return}const P=await E.blob(),R=window.URL.createObjectURL(P),j=document.createElement("a");j.href=R,j.download="iskcon-portal-backup.json",document.body.appendChild(j),j.click(),j.remove(),window.URL.revokeObjectURL(R),a({title:"Backup Downloaded",description:"Backup file has been downloaded.",variant:"default"})}catch(C){a({title:"Error",description:"An error occurred while downloading backup.",variant:"destructive"}),console.error("Backup error:",C)}};return i.jsxs(i.Fragment,{children:[i.jsx("div",{className:"settings-mobile-dropdown",children:i.jsx("select",{value:g,onChange:C=>m(C.target.value),className:"w-full p-2 rounded border mb-4",children:v.map(C=>i.jsx("option",{value:C.value,children:C.label},C.value))})}),i.jsxs(bl,{defaultValue:g,value:g,onValueChange:m,className:"space-y-6",children:[i.jsx(So,{className:"settings-tabs-list",children:v.map(C=>i.jsx(Vn,{value:C.value,className:"flex items-center space-x-2",children:C.label},C.value))}),i.jsx(zr,{value:"profile",children:i.jsxs(Ye,{children:[i.jsxs(ct,{children:[i.jsxs(ft,{className:"flex items-center space-x-2",children:[i.jsx(lo,{className:"h-5 w-5"}),i.jsx("span",{children:"Profile Information"})]}),i.jsx(tn,{children:"Update your personal information and profile details"})]}),i.jsxs(Je,{className:"space-y-6",children:[i.jsx(wne,{currentImageUrl:c,onImageUpdate:T}),i.jsx("div",{className:"flex items-center space-x-4",children:i.jsxs("div",{className:"flex-1",children:[i.jsxs("h3",{className:"text-lg font-semibold",children:[r==null?void 0:r.first_name," ",r==null?void 0:r.last_name]}),i.jsx("p",{className:"text-gray-600",children:w?"Super Admin":x?"Admin":"Member"}),i.jsx(We,{variant:"secondary",className:"mt-1",children:w?"Super Admin":x?"Admin":"Member"})]})}),i.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[i.jsxs("div",{children:[i.jsx(Ve,{htmlFor:"first_name",children:"First Name"}),i.jsx(dt,{id:"first_name",value:d.first_name,onChange:C=>f(E=>({...E,first_name:C.target.value})),disabled:!o})]}),i.jsxs("div",{children:[i.jsx(Ve,{htmlFor:"last_name",children:"Last Name"}),i.jsx(dt,{id:"last_name",value:d.last_name,onChange:C=>f(E=>({...E,last_name:C.target.value})),disabled:!o})]}),i.jsxs("div",{children:[i.jsx(Ve,{htmlFor:"phone",children:"Phone"}),i.jsx(dt,{id:"phone",value:d.phone,onChange:C=>f(E=>({...E,phone:C.target.value})),disabled:!o})]})]}),i.jsxs("div",{children:[i.jsx(Ve,{htmlFor:"email",children:"Email"}),i.jsx(dt,{id:"email",value:(e==null?void 0:e.email)||"",disabled:!0,className:"bg-gray-50"}),i.jsx("p",{className:"text-sm text-gray-500 mt-1",children:"Email cannot be changed from this interface"})]}),i.jsx("div",{className:"flex space-x-2",children:o?i.jsxs(i.Fragment,{children:[i.jsx(ue,{onClick:b,children:"Save Changes"}),i.jsx(ue,{variant:"outline",onClick:S,children:"Cancel"})]}):i.jsxs(ue,{onClick:()=>l(!0),children:[i.jsx(bf,{className:"h-4 w-4 mr-2"}),"Edit Profile"]})})]})]})}),i.jsx(zr,{value:"integrations",children:i.jsxs(Ye,{children:[i.jsxs(ct,{children:[i.jsxs(ft,{className:"flex items-center space-x-2",children:[i.jsx(PF,{className:"h-5 w-5"}),i.jsx("span",{children:"Microsoft 365 Integration"})]}),i.jsx(tn,{children:"Connect your Microsoft 365 account to access Outlook, Teams, and SharePoint features"})]}),i.jsx(Je,{children:i.jsx(_ne,{})})]})}),i.jsx(zr,{value:"notifications",children:i.jsx(yne,{})}),i.jsx(zr,{value:"auto-refresh",children:i.jsxs(Ye,{children:[i.jsxs(ct,{children:[i.jsxs(ft,{className:"flex items-center space-x-2",children:[i.jsx(os,{className:"h-5 w-5"}),i.jsx("span",{children:"Auto-Refresh Settings"})]}),i.jsx(tn,{children:"Control how often the portal automatically refreshes data. Reducing frequency can improve performance."})]}),i.jsxs(Je,{className:"space-y-6",children:[i.jsxs("div",{className:"space-y-4",children:[i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsxs("div",{children:[i.jsx("h4",{className:"font-medium",children:"Polls Refresh"}),i.jsx("p",{className:"text-sm text-gray-500",children:"Check for expired polls and updates"})]}),i.jsx(ws,{checked:p.pollsEnabled,onCheckedChange:C=>h(E=>({...E,pollsEnabled:C}))})]}),p.pollsEnabled&&i.jsxs("div",{className:"flex items-center space-x-2",children:[i.jsx(Ve,{htmlFor:"polls-interval",children:"Interval (minutes):"}),i.jsx(dt,{id:"polls-interval",type:"number",min:"1",max:"60",value:p.pollsInterval,onChange:C=>h(E=>({...E,pollsInterval:parseInt(C.target.value)||5})),className:"w-20"})]})]}),i.jsxs("div",{className:"space-y-4",children:[i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsxs("div",{children:[i.jsx("h4",{className:"font-medium",children:"Outlook Sync"}),i.jsx("p",{className:"text-sm text-gray-500",children:"Sync meetings from Microsoft Outlook"})]}),i.jsx(ws,{checked:p.outlookSyncEnabled,onCheckedChange:C=>h(E=>({...E,outlookSyncEnabled:C}))})]}),p.outlookSyncEnabled&&i.jsxs("div",{className:"flex items-center space-x-2",children:[i.jsx(Ve,{htmlFor:"outlook-interval",children:"Interval (minutes):"}),i.jsx(dt,{id:"outlook-interval",type:"number",min:"5",max:"60",value:p.outlookSyncInterval,onChange:C=>h(E=>({...E,outlookSyncInterval:parseInt(C.target.value)||10})),className:"w-20"})]})]}),i.jsxs("div",{className:"space-y-4",children:[i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsxs("div",{children:[i.jsx("h4",{className:"font-medium",children:"Transcript Processing"}),i.jsx("p",{className:"text-sm text-gray-500",children:"Process meeting transcripts automatically"})]}),i.jsx(ws,{checked:p.transcriptEnabled,onCheckedChange:C=>h(E=>({...E,transcriptEnabled:C}))})]}),p.transcriptEnabled&&i.jsxs("div",{className:"flex items-center space-x-2",children:[i.jsx(Ve,{htmlFor:"transcript-interval",children:"Interval (minutes):"}),i.jsx(dt,{id:"transcript-interval",type:"number",min:"5",max:"60",value:p.transcriptInterval,onChange:C=>h(E=>({...E,transcriptInterval:parseInt(C.target.value)||15})),className:"w-20"})]})]}),i.jsx("div",{className:"pt-4 border-t",children:i.jsxs("p",{className:"text-sm text-gray-500",children:[i.jsx("strong",{children:"Note:"})," These settings will take effect after you refresh the page. Reducing refresh frequency can improve performance but may result in slightly delayed data updates."]})})]})]})}),i.jsx(zr,{value:"backup",children:i.jsxs(Ye,{children:[i.jsxs(ct,{children:[i.jsxs(ft,{className:"flex items-center space-x-2",children:[i.jsx(nl,{className:"h-5 w-5"}),i.jsx("span",{children:"Backup & Restore"})]}),i.jsx(tn,{children:"Download a backup of all critical portal data. Use this to safeguard against data loss."})]}),i.jsxs(Je,{className:"space-y-6",children:[i.jsx(ue,{variant:"default",onClick:N,className:"bg-blue-600 hover:bg-blue-700 text-white",children:"Download Backup"}),i.jsx("p",{className:"text-sm text-gray-500",children:"This will export all users, meetings, documents, folders, and other essential data as a backup file."})]})]})})]})]})};var Nne=Object.defineProperty,jne=Object.defineProperties,Ene=Object.getOwnPropertyDescriptors,k0=Object.getOwnPropertySymbols,LR=Object.prototype.hasOwnProperty,$R=Object.prototype.propertyIsEnumerable,lN=(e,t,r)=>t in e?Nne(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,kne=(e,t)=>{for(var r in t||(t={}))LR.call(t,r)&&lN(e,r,t[r]);if(k0)for(var r of k0(t))$R.call(t,r)&&lN(e,r,t[r]);return e},Cne=(e,t)=>jne(e,Ene(t)),Tne=(e,t)=>{var r={};for(var n in e)LR.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(e!=null&&k0)for(var n of k0(e))t.indexOf(n)<0&&$R.call(e,n)&&(r[n]=e[n]);return r};function Ane(e){let t=setTimeout(e,0),r=setTimeout(e,10),n=setTimeout(e,50);return[t,r,n]}function Pne(e){let t=y.useRef();return y.useEffect(()=>{t.current=e}),t.current}var Dne=18,BR=40,Rne=`${BR}px`,Mne=["[data-lastpass-icon-root]","com-1password-button","[data-dashlanecreated]",'[style$="2147483647 !important;"]'].join(",");function One({containerRef:e,inputRef:t,pushPasswordManagerStrategy:r,isFocused:n}){let[s,a]=y.useState(!1),[o,l]=y.useState(!1),[c,u]=y.useState(!1),d=y.useMemo(()=>r==="none"?!1:(r==="increase-width"||r==="experimental-no-flickering")&&s&&o,[s,o,r]),f=y.useCallback(()=>{let p=e.current,h=t.current;if(!p||!h||c||r==="none")return;let g=p,m=g.getBoundingClientRect().left+g.offsetWidth,x=g.getBoundingClientRect().top+g.offsetHeight/2,w=m-Dne,v=x;document.querySelectorAll(Mne).length===0&&document.elementFromPoint(w,v)===p||(a(!0),u(!0))},[e,t,c,r]);return y.useEffect(()=>{let p=e.current;if(!p||r==="none")return;function h(){let m=window.innerWidth-p.getBoundingClientRect().right;l(m>=BR)}h();let g=setInterval(h,1e3);return()=>{clearInterval(g)}},[e,r]),y.useEffect(()=>{let p=n||document.activeElement===t.current;if(r==="none"||!p)return;let h=setTimeout(f,0),g=setTimeout(f,2e3),m=setTimeout(f,5e3),x=setTimeout(()=>{u(!0)},6e3);return()=>{clearTimeout(h),clearTimeout(g),clearTimeout(m),clearTimeout(x)}},[t,n,r,f]),{hasPWMBadge:s,willPushPWMBadge:d,PWM_BADGE_SPACE_WIDTH:Rne}}var UR=y.createContext({}),zR=y.forwardRef((e,t)=>{var r=e,{value:n,onChange:s,maxLength:a,textAlign:o="left",pattern:l,placeholder:c,inputMode:u="numeric",onComplete:d,pushPasswordManagerStrategy:f="increase-width",pasteTransformer:p,containerClassName:h,noScriptCSSFallback:g=Fne,render:m,children:x}=r,w=Tne(r,["value","onChange","maxLength","textAlign","pattern","placeholder","inputMode","onComplete","pushPasswordManagerStrategy","pasteTransformer","containerClassName","noScriptCSSFallback","render","children"]),v,_,b,S,T;let[N,C]=y.useState(typeof w.defaultValue=="string"?w.defaultValue:""),E=n??N,P=Pne(E),R=y.useCallback(k=>{s==null||s(k),C(k)},[s]),j=y.useMemo(()=>l?typeof l=="string"?new RegExp(l):l:null,[l]),M=y.useRef(null),A=y.useRef(null),I=y.useRef({value:E,onChange:R,isIOS:typeof window<"u"&&((_=(v=window==null?void 0:window.CSS)==null?void 0:v.supports)==null?void 0:_.call(v,"-webkit-touch-callout","none"))}),X=y.useRef({prev:[(b=M.current)==null?void 0:b.selectionStart,(S=M.current)==null?void 0:S.selectionEnd,(T=M.current)==null?void 0:T.selectionDirection]});y.useImperativeHandle(t,()=>M.current,[]),y.useEffect(()=>{let k=M.current,le=A.current;if(!k||!le)return;I.current.value!==k.value&&I.current.onChange(k.value),X.current.prev=[k.selectionStart,k.selectionEnd,k.selectionDirection];function ce(){if(document.activeElement!==k){D(null),O(null);return}let oe=k.selectionStart,W=k.selectionEnd,J=k.selectionDirection,B=k.maxLength,ae=k.value,de=X.current.prev,Q=-1,fe=-1,Ce;if(ae.length!==0&&oe!==null&&W!==null){let at=oe===W,ht=oe===ae.length&&ae.length<B;if(at&&!ht){let Ke=oe;if(Ke===0)Q=0,fe=1,Ce="forward";else if(Ke===B)Q=Ke-1,fe=Ke,Ce="backward";else if(B>1&&ae.length>1){let Bt=0;if(de[0]!==null&&de[1]!==null){Ce=Ke<de[1]?"backward":"forward";let Te=de[0]===de[1]&&de[0]<B;Ce==="backward"&&!Te&&(Bt=-1)}Q=Bt+Ke,fe=Bt+Ke+1}}Q!==-1&&fe!==-1&&Q!==fe&&M.current.setSelectionRange(Q,fe,Ce)}let Ne=Q!==-1?Q:oe,Xe=fe!==-1?fe:W,it=Ce??J;D(Ne),O(Xe),X.current.prev=[Ne,Xe,it]}if(document.addEventListener("selectionchange",ce,{capture:!0}),ce(),document.activeElement===k&&V(!0),!document.getElementById("input-otp-style")){let oe=document.createElement("style");if(oe.id="input-otp-style",document.head.appendChild(oe),oe.sheet){let W="background: transparent !important; color: transparent !important; border-color: transparent !important; opacity: 0 !important; box-shadow: none !important; -webkit-box-shadow: none !important; -webkit-text-fill-color: transparent !important;";Bu(oe.sheet,"[data-input-otp]::selection { background: transparent !important; color: transparent !important; }"),Bu(oe.sheet,`[data-input-otp]:autofill { ${W} }`),Bu(oe.sheet,`[data-input-otp]:-webkit-autofill { ${W} }`),Bu(oe.sheet,"@supports (-webkit-touch-callout: none) { [data-input-otp] { letter-spacing: -.6em !important; font-weight: 100 !important; font-stretch: ultra-condensed; font-optical-sizing: none !important; left: -1px !important; right: 1px !important; } }"),Bu(oe.sheet,"[data-input-otp] + * { pointer-events: all !important; }")}}let H=()=>{le&&le.style.setProperty("--root-height",`${k.clientHeight}px`)};H();let K=new ResizeObserver(H);return K.observe(k),()=>{document.removeEventListener("selectionchange",ce,{capture:!0}),K.disconnect()}},[]);let[Y,z]=y.useState(!1),[U,V]=y.useState(!1),[F,D]=y.useState(null),[G,O]=y.useState(null);y.useEffect(()=>{Ane(()=>{var k,le,ce,H;(k=M.current)==null||k.dispatchEvent(new Event("input"));let K=(le=M.current)==null?void 0:le.selectionStart,oe=(ce=M.current)==null?void 0:ce.selectionEnd,W=(H=M.current)==null?void 0:H.selectionDirection;K!==null&&oe!==null&&(D(K),O(oe),X.current.prev=[K,oe,W])})},[E,U]),y.useEffect(()=>{P!==void 0&&E!==P&&P.length<a&&E.length===a&&(d==null||d(E))},[a,d,P,E]);let L=One({containerRef:A,inputRef:M,pushPasswordManagerStrategy:f,isFocused:U}),ie=y.useCallback(k=>{let le=k.currentTarget.value.slice(0,a);if(le.length>0&&j&&!j.test(le)){k.preventDefault();return}typeof P=="string"&&le.length<P.length&&document.dispatchEvent(new Event("selectionchange")),R(le)},[a,R,P,j]),ne=y.useCallback(()=>{var k;if(M.current){let le=Math.min(M.current.value.length,a-1),ce=M.current.value.length;(k=M.current)==null||k.setSelectionRange(le,ce),D(le),O(ce)}V(!0)},[a]),me=y.useCallback(k=>{var le,ce;let H=M.current;if(!p&&(!I.current.isIOS||!k.clipboardData||!H))return;let K=k.clipboardData.getData("text/plain"),oe=p?p(K):K;k.preventDefault();let W=(le=M.current)==null?void 0:le.selectionStart,J=(ce=M.current)==null?void 0:ce.selectionEnd,B=(W!==J?E.slice(0,W)+oe+E.slice(J):E.slice(0,W)+oe+E.slice(W)).slice(0,a);if(B.length>0&&j&&!j.test(B))return;H.value=B,R(B);let ae=Math.min(B.length,a-1),de=B.length;H.setSelectionRange(ae,de),D(ae),O(de)},[a,R,j,E]),pe=y.useMemo(()=>({position:"relative",cursor:w.disabled?"default":"text",userSelect:"none",WebkitUserSelect:"none",pointerEvents:"none"}),[w.disabled]),xe=y.useMemo(()=>({position:"absolute",inset:0,width:L.willPushPWMBadge?`calc(100% + ${L.PWM_BADGE_SPACE_WIDTH})`:"100%",clipPath:L.willPushPWMBadge?`inset(0 ${L.PWM_BADGE_SPACE_WIDTH} 0 0)`:void 0,height:"100%",display:"flex",textAlign:o,opacity:"1",color:"transparent",pointerEvents:"all",background:"transparent",caretColor:"transparent",border:"0 solid transparent",outline:"0 solid transparent",boxShadow:"none",lineHeight:"1",letterSpacing:"-.5em",fontSize:"var(--root-height)",fontFamily:"monospace",fontVariantNumeric:"tabular-nums"}),[L.PWM_BADGE_SPACE_WIDTH,L.willPushPWMBadge,o]),Ae=y.useMemo(()=>y.createElement("input",Cne(kne({autoComplete:w.autoComplete||"one-time-code"},w),{"data-input-otp":!0,"data-input-otp-placeholder-shown":E.length===0||void 0,"data-input-otp-mss":F,"data-input-otp-mse":G,inputMode:u,pattern:j==null?void 0:j.source,"aria-placeholder":c,style:xe,maxLength:a,value:E,ref:M,onPaste:k=>{var le;me(k),(le=w.onPaste)==null||le.call(w,k)},onChange:ie,onMouseOver:k=>{var le;z(!0),(le=w.onMouseOver)==null||le.call(w,k)},onMouseLeave:k=>{var le;z(!1),(le=w.onMouseLeave)==null||le.call(w,k)},onFocus:k=>{var le;ne(),(le=w.onFocus)==null||le.call(w,k)},onBlur:k=>{var le;V(!1),(le=w.onBlur)==null||le.call(w,k)}})),[ie,ne,me,u,xe,a,G,F,w,j==null?void 0:j.source,E]),ge=y.useMemo(()=>({slots:Array.from({length:a}).map((k,le)=>{var ce;let H=U&&F!==null&&G!==null&&(F===G&&le===F||le>=F&&le<G),K=E[le]!==void 0?E[le]:null,oe=E[0]!==void 0?null:(ce=c==null?void 0:c[le])!=null?ce:null;return{char:K,placeholderChar:oe,isActive:H,hasFakeCaret:H&&K===null}}),isFocused:U,isHovering:!w.disabled&&Y}),[U,Y,a,G,F,w.disabled,E]),je=y.useMemo(()=>m?m(ge):y.createElement(UR.Provider,{value:ge},x),[x,ge,m]);return y.createElement(y.Fragment,null,g!==null&&y.createElement("noscript",null,y.createElement("style",null,g)),y.createElement("div",{ref:A,"data-input-otp-container":!0,style:pe,className:h},je,y.createElement("div",{style:{position:"absolute",inset:0,pointerEvents:"none"}},Ae)))});zR.displayName="Input";function Bu(e,t){try{e.insertRule(t)}catch{console.error("input-otp could not insert CSS rule:",t)}}var Fne=`
[data-input-otp] {
  --nojs-bg: white !important;
  --nojs-fg: black !important;

  background-color: var(--nojs-bg) !important;
  color: var(--nojs-fg) !important;
  caret-color: var(--nojs-fg) !important;
  letter-spacing: .25em !important;
  text-align: center !important;
  border: 1px solid var(--nojs-fg) !important;
  border-radius: 4px !important;
  width: 100% !important;
}
@media (prefers-color-scheme: dark) {
  [data-input-otp] {
    --nojs-bg: black !important;
    --nojs-fg: white !important;
  }
}`;const VR=y.forwardRef(({className:e,containerClassName:t,...r},n)=>i.jsx(zR,{ref:n,containerClassName:De("flex items-center gap-2 has-[:disabled]:opacity-50",t),className:De("disabled:cursor-not-allowed",e),...r}));VR.displayName="InputOTP";const WR=y.forwardRef(({className:e,...t},r)=>i.jsx("div",{ref:r,className:De("flex items-center",e),...t}));WR.displayName="InputOTPGroup";const Mo=y.forwardRef(({index:e,className:t,...r},n)=>{const s=y.useContext(UR),{char:a,hasFakeCaret:o,isActive:l}=s.slots[e];return i.jsxs("div",{ref:n,className:De("relative flex h-10 w-10 items-center justify-center border-y border-r border-input text-sm transition-all first:rounded-l-md first:border-l last:rounded-r-md",l&&"z-10 ring-2 ring-ring ring-offset-background",t),...r,children:[a,o&&i.jsx("div",{className:"pointer-events-none absolute inset-0 flex items-center justify-center",children:i.jsx("div",{className:"h-4 w-px animate-caret-blink bg-foreground duration-1000"})})]})});Mo.displayName="InputOTPSlot";const Ine=y.forwardRef(({...e},t)=>i.jsx("div",{ref:t,role:"separator",...e,children:i.jsx(wF,{})}));Ine.displayName="InputOTPSeparator";const Lne=()=>{const{signIn:e,sendOTP:t,resetPasswordWithOTP:r,loading:n,user:s}=kt(),a=_o(),[o,l]=y.useState("login"),[c,u]=y.useState({email:"",password:"",rememberMe:!1,phoneNumber:"",otp:"",newPassword:"",confirmPassword:""}),[d,f]=y.useState(!1),[p,h]=y.useState(""),[g,m]=y.useState(""),[x,w]=y.useState(!1),[v,_]=y.useState(!1),[b,S]=y.useState(!1),[T,N]=y.useState(""),[C,E]=y.useState(null),[P,R]=y.useState(null),[j,M]=y.useState(!1);y.useEffect(()=>{s&&(console.log("User authenticated, redirecting to dashboard..."),a("/",{replace:!0}))},[s,a]);const A=async F=>{if(F.preventDefault(),d){m(c.email);const{error:D,otp:G}=await t(c.email);!D&&G&&(h(G),l("forgot-otp"))}else await e(c.email,c.password,c.rememberMe)},I=async F=>{F.preventDefault(),M(!0),R(null);try{const D=T.includes("@"),{error:G,otp:O}=await t(T);if(G)throw G;E(D?"email":"sms"),h(O||""),l("forgot-otp")}catch(D){R(D.message||"An unexpected error occurred")}finally{M(!1)}},X=async F=>{F.preventDefault(),c.otp===p?l("forgot-newPassword"):alert("Invalid OTP. Please try again.")},Y=async F=>{if(F.preventDefault(),c.newPassword!==c.confirmPassword){alert("Passwords do not match");return}const{error:D}=await r(g,c.otp,c.newPassword);D||(l("login"),f(!1),u(G=>({...G,password:"",newPassword:"",confirmPassword:"",otp:"",phoneNumber:""})),m(""))},z=(F,D)=>{u(G=>({...G,[F]:D}))},U=()=>{l("login"),f(!1),u(F=>({...F,otp:"",phoneNumber:"",newPassword:"",confirmPassword:""})),m("")},V=async()=>{if(o==="forgot-otp"){const{error:F,otp:D}=await t(g);!F&&D&&h(D)}};return i.jsx("div",{className:"min-h-screen bg-gradient-to-br from-secondary via-white to-secondary/50 flex items-center justify-center p-4",children:i.jsxs("div",{className:"w-full max-w-md",children:[i.jsxs("div",{className:"text-center mb-8",children:[i.jsx("div",{className:"w-20 h-20 flex items-center justify-center mx-auto mb-4 shadow-lg",children:i.jsx("img",{src:"/icons/icon-512.png",alt:"ISKCON Logo",className:"w-full h-full object-contain"})}),i.jsx("h1",{className:"text-3xl font-bold text-gray-900 mb-2",children:"ISKCON BUREAU"}),i.jsx("p",{className:"text-gray-600",children:"Management Portal"})]}),i.jsxs(Ye,{className:"shadow-xl border-0",children:[i.jsxs(ct,{className:"text-center",children:[i.jsxs(ft,{className:"flex items-center justify-center space-x-2",children:[i.jsx(nl,{className:"h-5 w-5 text-primary"}),i.jsx("span",{children:o.startsWith("forgot-")?"Reset Password":"Secure Login"})]}),i.jsxs(tn,{children:[o==="login"&&!d&&"Enter your credentials to sign in",o==="login"&&d&&"Enter your email to reset password",o==="forgot-otp"&&"Enter the OTP sent to your email",o==="forgot-newPassword"&&"Set your new password"]})]}),i.jsx(Je,{children:o==="login"?i.jsxs("form",{onSubmit:A,className:"space-y-4",children:[i.jsxs("div",{className:"space-y-2",children:[i.jsx(Ve,{htmlFor:"email",children:"Email Address"}),i.jsxs("div",{className:"relative",children:[i.jsx(ta,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400"}),i.jsx(dt,{id:"email",type:"email",placeholder:"your.email@iskconbureau.in",value:c.email,onChange:F=>z("email",F.target.value),className:"pl-10",required:!0})]})]}),!d&&i.jsxs(i.Fragment,{children:[i.jsxs("div",{className:"space-y-2",children:[i.jsx(Ve,{htmlFor:"password",children:"Password"}),i.jsxs("div",{className:"relative",children:[i.jsx(ti,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400"}),i.jsx(dt,{id:"password",type:x?"text":"password",placeholder:"Enter your password",value:c.password,onChange:F=>z("password",F.target.value),className:"pl-10 pr-10",required:!0}),i.jsx("button",{type:"button",onClick:()=>w(!x),className:"absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-400 hover:text-gray-600",children:x?i.jsx(nm,{className:"h-4 w-4"}):i.jsx(Or,{className:"h-4 w-4"})})]})]}),i.jsxs("div",{className:"flex items-center space-x-2",children:[i.jsx(Za,{id:"remember",checked:c.rememberMe,onCheckedChange:F=>z("rememberMe",F)}),i.jsx(Ve,{htmlFor:"remember",className:"text-sm",children:"Remember me"})]})]}),i.jsx(ue,{type:"submit",disabled:n,className:"w-full bg-primary hover:bg-primary/90",children:n?"Processing...":d?"Continue":"Sign In"}),i.jsx("div",{className:"text-center",children:i.jsx("button",{type:"button",onClick:()=>f(!d),className:"text-sm text-primary hover:underline",children:d?"Back to Login":"Forgot Password?"})})]}):d&&o==="login"?i.jsxs("form",{onSubmit:I,className:"space-y-4",children:[i.jsxs("div",{className:"space-y-2",children:[i.jsx(Ve,{htmlFor:"identifier",children:"Email or Phone"}),i.jsxs("div",{className:"relative",children:[i.jsx(ta,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400"}),i.jsx(dt,{id:"identifier",type:"text",placeholder:"your.email@iskconbureau.in or +1234567890",value:T,onChange:F=>N(F.target.value),className:"pl-10",required:!0})]})]}),P&&i.jsx("div",{className:"text-red-600 text-sm text-center",children:P}),i.jsx(ue,{type:"submit",disabled:j,className:"w-full bg-primary hover:bg-primary/90",children:j?"Processing...":"Continue"}),i.jsx("div",{className:"text-center",children:i.jsx("button",{type:"button",onClick:U,className:"text-sm text-gray-600 hover:text-primary",children:"Back to Login"})})]}):o==="forgot-otp"?i.jsxs("form",{onSubmit:X,className:"space-y-6",children:[i.jsxs("div",{className:"space-y-4",children:[i.jsxs("div",{className:"text-center",children:[C==="email"?i.jsx(ta,{className:"h-8 w-8 text-primary mx-auto mb-2"}):i.jsx(_f,{className:"h-8 w-8 text-primary mx-auto mb-2"}),i.jsxs("p",{className:"text-sm text-gray-600",children:["Enter the 6-digit code sent to ",T]})]}),i.jsxs("div",{className:"space-y-2",children:[i.jsx(Ve,{htmlFor:"otp",className:"text-center block",children:"Verification Code"}),i.jsx("div",{className:"flex justify-center",children:i.jsx(VR,{maxLength:6,value:c.otp,onChange:F=>z("otp",F),children:i.jsxs(WR,{children:[i.jsx(Mo,{index:0}),i.jsx(Mo,{index:1}),i.jsx(Mo,{index:2}),i.jsx(Mo,{index:3}),i.jsx(Mo,{index:4}),i.jsx(Mo,{index:5})]})})})]})]}),P&&i.jsx("div",{className:"text-red-600 text-sm text-center",children:P}),i.jsx(ue,{type:"submit",disabled:n||c.otp.length!==6,className:"w-full bg-primary hover:bg-primary/90",children:n?"Verifying...":"Verify OTP"}),i.jsxs("div",{className:"flex items-center justify-between text-sm",children:[i.jsxs("button",{type:"button",onClick:U,className:"flex items-center text-gray-600 hover:text-primary",children:[i.jsx(G0,{className:"h-4 w-4 mr-1"}),"Back"]}),i.jsx("button",{type:"button",onClick:V,className:"text-primary hover:underline",children:"Resend OTP"})]})]}):i.jsxs("form",{onSubmit:Y,className:"space-y-4",children:[i.jsxs("div",{className:"space-y-2",children:[i.jsx(Ve,{htmlFor:"newPassword",children:"New Password"}),i.jsxs("div",{className:"relative",children:[i.jsx(ti,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400"}),i.jsx(dt,{id:"newPassword",type:v?"text":"password",placeholder:"Enter new password",value:c.newPassword,onChange:F=>z("newPassword",F.target.value),className:"pl-10 pr-10",required:!0}),i.jsx("button",{type:"button",onClick:()=>_(!v),className:"absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-400 hover:text-gray-600",children:v?i.jsx(nm,{className:"h-4 w-4"}):i.jsx(Or,{className:"h-4 w-4"})})]})]}),i.jsxs("div",{className:"space-y-2",children:[i.jsx(Ve,{htmlFor:"confirmPassword",children:"Confirm Password"}),i.jsxs("div",{className:"relative",children:[i.jsx(ti,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400"}),i.jsx(dt,{id:"confirmPassword",type:b?"text":"password",placeholder:"Confirm new password",value:c.confirmPassword,onChange:F=>z("confirmPassword",F.target.value),className:"pl-10 pr-10",required:!0}),i.jsx("button",{type:"button",onClick:()=>S(!b),className:"absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-400 hover:text-gray-600",children:b?i.jsx(nm,{className:"h-4 w-4"}):i.jsx(Or,{className:"h-4 w-4"})})]})]}),i.jsx(ue,{type:"submit",disabled:n,className:"w-full bg-primary hover:bg-primary/90",children:n?"Updating...":"Update Password"})]})})]}),i.jsxs("div",{className:"text-center mt-6 text-xs text-gray-500",children:[i.jsx("p",{children:" 2025 ISKCON BUREAU Management Portal"}),i.jsx("p",{children:"Secure  Reliable  Confidential"})]})]})})},$ne=()=>{const[e]=l$(),t=_o(),{toast:r}=St(),[n,s]=y.useState(!0),[a,o]=y.useState("Initializing...");return y.useEffect(()=>{(async()=>{var c,u;try{o("Processing Microsoft callback...");const d=e.get("code"),f=e.get("state"),p=e.get("error"),h=e.get("error_description");if(console.log("Microsoft callback received:",{hasCode:!!d,hasState:!!f,error:p,errorDescription:h,timestamp:new Date().toISOString()}),p){console.error("Microsoft OAuth error:",p,h);const _={access_denied:"You cancelled the Microsoft authentication process.",invalid_request:"Invalid authentication request. Please try again.",invalid_client:"Microsoft application configuration error. Please contact support.",invalid_grant:"Authentication expired. Please try again.",unauthorized_client:"Application not authorized. Please contact support.",server_error:"Microsoft server error. Please try again later.",temporarily_unavailable:"Microsoft services temporarily unavailable. Please try again later."}[p]||h||`Authentication failed: ${p}`;r({title:"Microsoft Authentication Failed",description:_,variant:"destructive"}),t("/",{replace:!0});return}if(!d){console.error("Missing authorization code from Microsoft"),r({title:"Authentication Failed",description:"No authorization code received from Microsoft. Please try connecting again.",variant:"destructive"}),t("/",{replace:!0});return}if(!f){console.error("Missing state parameter from Microsoft"),r({title:"Authentication Failed",description:"Security validation failed. Please try connecting again.",variant:"destructive"}),t("/",{replace:!0});return}o("Validating session...");let g=null,m=null;try{g=sessionStorage.getItem("microsoft_auth_user_id"),m=sessionStorage.getItem("microsoft_auth_timestamp")}catch(v){console.error("Session storage access error:",v)}if(!g||g!==f){console.error("Session validation failed",{storedUserId:g,state:f}),r({title:"Session Error",description:"Authentication session is invalid. Please try connecting again.",variant:"destructive"}),t("/",{replace:!0});return}if(m){const v=Date.now()-parseInt(m),_=30*60*1e3;if(v>_){console.error("Authentication session expired"),r({title:"Session Expired",description:"Authentication session has expired. Please try connecting again.",variant:"destructive"}),t("/",{replace:!0});return}}o("Exchanging code for tokens...");let x,w;for(let v=1;v<=3;v++)try{console.log(`Microsoft auth attempt ${v}/3`),o(`Authenticating with Microsoft (attempt ${v}/3)...`);const{data:_,error:b}=await he.functions.invoke("microsoft-auth",{body:{code:d,user_id:f}});if(b)throw new Error(`Edge function error: ${b.message}`);if(_!=null&&_.error)throw new Error(_.error);if(!(_!=null&&_.success))throw new Error("Authentication failed - no success response");x=_,console.log("Microsoft authentication successful");break}catch(_){console.error(`Microsoft auth attempt ${v} failed:`,_),w=_,v<3&&await new Promise(b=>setTimeout(b,1e3*v))}if(!x)throw new Error(`Authentication failed after 3 attempts: ${(w==null?void 0:w.message)||"Unknown error"}`);o("Finalizing connection...");try{sessionStorage.removeItem("microsoft_auth_user_id"),sessionStorage.removeItem("microsoft_auth_nonce"),sessionStorage.removeItem("microsoft_auth_timestamp")}catch(v){console.warn("Session cleanup warning:",v)}try{localStorage.setItem("microsoft_auth_success","true"),localStorage.setItem("microsoft_auth_timestamp",Date.now().toString())}catch(v){console.warn("Local storage warning:",v)}r({title:"Microsoft Account Connected!",description:`Successfully connected to ${((c=x.user)==null?void 0:c.displayName)||((u=x.user)==null?void 0:u.mail)||"Microsoft 365"}`}),t("/?microsoft_connected=true",{replace:!0})}catch(d){console.error("Microsoft callback processing error:",d),o("Error occurred...");try{sessionStorage.removeItem("microsoft_auth_user_id"),sessionStorage.removeItem("microsoft_auth_nonce"),sessionStorage.removeItem("microsoft_auth_timestamp"),localStorage.setItem("microsoft_auth_last_error",JSON.stringify({message:d.message,timestamp:new Date().toISOString()}))}catch(f){console.warn("Error cleanup warning:",f)}r({title:"Connection Failed",description:d.message||"Failed to complete Microsoft authentication. Please try again.",variant:"destructive"}),t("/",{replace:!0})}finally{s(!1)}})()},[e,t,r]),n?i.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:i.jsxs("div",{className:"text-center max-w-md mx-auto p-6",children:[i.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto mb-4"}),i.jsx("h2",{className:"text-lg font-semibold text-gray-900 mb-2",children:"Connecting Microsoft Account"}),i.jsx("p",{className:"text-gray-600 mb-4",children:a}),i.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2",children:i.jsx("div",{className:"bg-blue-600 h-2 rounded-full animate-pulse transition-all duration-300",style:{width:"70%"}})}),i.jsx("p",{className:"text-sm text-gray-500 mt-4",children:"Please wait while we complete the connection..."})]})}):null},Bne=()=>{const e=_o();return console.log("NotFound - Page rendered for path:",window.location.pathname),i.jsx("div",{className:"min-h-screen bg-gradient-to-br from-secondary via-white to-secondary/50 flex items-center justify-center p-4",children:i.jsxs("div",{className:"text-center max-w-md",children:[i.jsx("div",{className:"w-20 h-20 bg-primary rounded-full flex items-center justify-center mx-auto mb-6 shadow-lg",children:i.jsx("div",{className:"w-12 h-12 bg-white rounded-full flex items-center justify-center",children:i.jsx("div",{className:"w-8 h-8 bg-primary rounded-full flex items-center justify-center",children:i.jsx("div",{className:"w-4 h-4 bg-white rounded-full"})})})}),i.jsx("h1",{className:"text-6xl font-bold text-primary mb-4",children:"404"}),i.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-2",children:"Page Not Found"}),i.jsx("p",{className:"text-gray-600 mb-8",children:"The page you're looking for doesn't exist or has been moved."}),i.jsxs("div",{className:"flex flex-col sm:flex-row gap-4 justify-center",children:[i.jsxs(ue,{onClick:()=>e(-1),variant:"outline",className:"flex items-center space-x-2",children:[i.jsx(G0,{className:"h-4 w-4"}),i.jsx("span",{children:"Go Back"})]}),i.jsxs(ue,{onClick:()=>e("/"),className:"flex items-center space-x-2 bg-primary hover:bg-primary/90",children:[i.jsx(wf,{className:"h-4 w-4"}),i.jsx("span",{children:"Go Home"})]})]}),i.jsx("div",{className:"mt-8 text-xs text-gray-500",children:i.jsx("p",{children:" 2024 ISKCON BUREAU Management Portal"})})]})})},Une=()=>{const{sendPushNotification:e}=q1();return _l(),xu(),jp(),y.useEffect(()=>{},[e]),y.useEffect(()=>{},[e]),y.useEffect(()=>{},[e]),{}},zne=new uL({defaultOptions:{queries:{retry:3,retryDelay:e=>Math.min(1e3*2**e,3e4),staleTime:5*60*1e3}}}),Qn=({children:e})=>{const{user:t,loading:r}=kt();return Une(),r?i.jsx(wC,{}):t?i.jsx(Y9,{children:e}):i.jsx(yC,{to:"/auth",replace:!0})},Vne=()=>{const e=y.useRef(!1);return y.useEffect(()=>{var t;e.current||(e.current=!0,(t=window.Capacitor)!=null&&t.isNative&&window.location.hash&&!window.location.pathname.includes(window.location.hash.substring(1))&&window.location.hash.substring(1))},[]),i.jsx(i.Fragment,{children:i.jsx(c$,{children:i.jsx(E7,{children:i.jsx(fL,{client:zne,children:i.jsxs(nu,{children:[i.jsx(SI,{}),i.jsx(t6,{}),i.jsx(o$,{children:i.jsx(y.Suspense,{fallback:i.jsx(wC,{}),children:i.jsxs(n$,{children:[i.jsx(Lr,{path:"/auth",element:i.jsx(Lne,{})}),i.jsx(Lr,{path:"/microsoft/callback",element:i.jsx($ne,{})}),i.jsx(Lr,{path:"/",element:i.jsx(Qn,{children:i.jsx(ZX,{})})}),i.jsx(Lr,{path:"/dashboard",element:i.jsx(yC,{to:"/",replace:!0})}),i.jsx(Lr,{path:"/meetings",element:i.jsx(Qn,{children:i.jsx(Gee,{})})}),i.jsx(Lr,{path:"/voting",element:i.jsx(Qn,{children:i.jsx(rN,{})})}),i.jsx(Lr,{path:"/polls/vote/:pollId",element:i.jsx(Qn,{children:i.jsx(rN,{})})}),i.jsx(Lr,{path:"/members",element:i.jsx(Qn,{children:i.jsx(nne,{})})}),i.jsx(Lr,{path:"/documents",element:i.jsx(Qn,{children:i.jsx(zh,{})})}),i.jsx(Lr,{path:"/documents/folder/:folderId",element:i.jsx(Qn,{children:i.jsx(zh,{})})}),i.jsx(Lr,{path:"/documents/doc/:docId",element:i.jsx(Qn,{children:i.jsx(zh,{})})}),i.jsx(Lr,{path:"/documents/folder/:folderId/doc/:docId",element:i.jsx(Qn,{children:i.jsx(zh,{})})}),i.jsx(Lr,{path:"/email",element:i.jsx(Qn,{children:i.jsx(fne,{})})}),i.jsx(Lr,{path:"/attendance",element:i.jsx(Qn,{children:i.jsx(pne,{})})}),i.jsx(Lr,{path:"/reports",element:i.jsx(Qn,{children:i.jsx(xne,{})})}),i.jsx(Lr,{path:"/settings",element:i.jsx(Qn,{children:i.jsx(Sne,{})})}),i.jsx(Lr,{path:"*",element:i.jsx(Bne,{})})]})})})]})})})})})};console.log("Main - Application starting...");var vN;console.log("Main - Environment:",{mode:"production",dev:!1,prod:!0,url:window.location.href,pathname:window.location.pathname,hash:window.location.hash,userAgent:navigator.userAgent,timestamp:new Date().toISOString(),isCapacitor:!!window.Capacitor,isNative:((vN=window.Capacitor)==null?void 0:vN.isNative)||!1});window.addEventListener("error",e=>{var t;console.error("Main - Global error caught:",{message:e.message,filename:e.filename,lineno:e.lineno,colno:e.colno,error:e.error,stack:(t=e.error)==null?void 0:t.stack,timestamp:new Date().toISOString()})});window.addEventListener("unhandledrejection",e=>{var t;console.error("Main - Unhandled promise rejection:",{reason:e.reason,promise:e.promise,stack:(t=e.reason)==null?void 0:t.stack,timestamp:new Date().toISOString()})});const Ha=document.getElementById("root");console.log("Main - Root element check:",{found:!!Ha,id:Ha==null?void 0:Ha.id,tagName:Ha==null?void 0:Ha.tagName});if(!Ha){console.error("Main - Root element not found! Creating fallback...");const e=document.createElement("div");e.id="root",e.style.width="100%",e.style.height="100vh",document.body.appendChild(e),console.log("Main - Created fallback root element")}console.log("Main - Creating React root...");const Wne=DE(Ha||document.getElementById("root"));try{console.log("Main - Rendering React application..."),Wne.render(i.jsx(y.StrictMode,{children:i.jsx(Vne,{})})),console.log("Main - React application rendered successfully")}catch(e){console.error("Main - Critical error rendering React application:",e);const t=document.createElement("div");t.innerHTML=`
    <div style="
      padding: 20px; 
      text-align: center; 
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
      min-height: 100vh;
      display: flex;
      flex-direction: column;
      justify-content: center;
      align-items: center;
      background: #f8f9fa;
    ">
      <div style="
        max-width: 500px;
        background: white;
        padding: 40px;
        border-radius: 8px;
        box-shadow: 0 2px 10px rgba(0,0,0,0.1);
      ">
        <h1 style="color: #dc3545; margin-bottom: 20px;">Application Error</h1>
        <p style="margin-bottom: 20px; color: #6c757d;">
          The ISKCON BUREAU Management Portal encountered an error and cannot load properly.
        </p>
        <button 
          onclick="window.location.reload()" 
          style="
            padding: 12px 24px; 
            background: #007bff; 
            color: white; 
            border: none; 
            border-radius: 6px; 
            cursor: pointer;
            font-size: 16px;
            margin-bottom: 20px;
          "
        >
          Refresh Page
        </button>
        <div style="
          margin-top: 20px; 
          padding: 15px; 
          background: #f8f9fa; 
          border: 1px solid #dee2e6; 
          border-radius: 6px;
          text-align: left;
        ">
          <p style="margin: 0; font-size: 14px; color: #6c757d; font-family: monospace;">
            Error: ${(e==null?void 0:e.toString())||"Unknown error"}
          </p>
          <p style="margin: 10px 0 0 0; font-size: 12px; color: #adb5bd;">
            Time: ${new Date().toISOString()}
          </p>
        </div>
      </div>
    </div>
  `,document.body.innerHTML="",document.body.appendChild(t)}
